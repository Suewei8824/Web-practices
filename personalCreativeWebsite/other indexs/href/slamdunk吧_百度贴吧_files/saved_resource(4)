var T,baidu=T=baidu||{version:"1.5.0"};baidu.guid="$BAIDU$",window[baidu.guid]=window[baidu.guid]||{},baidu.fn=baidu.fn||{},baidu.fn.blank=function(){},baidu.string=baidu.string||{},baidu.string.format=function(t,e){t=String(t);var i=Array.prototype.slice.call(arguments,1),n=Object.prototype.toString;return i.length?(i=1==i.length?null!==e&&/\[object Array\]|\[object Object\]/.test(n.call(e))?e:i:i,t.replace(/#\{(.+?)\}/g,function(t,e){var s=i[e];return"[object Function]"==n.call(s)&&(s=s(e)),"undefined"==typeof s?"":s})):t},baidu.format=baidu.string.format,baidu.object=baidu.object||{},baidu.object.each=function(t,e){var i,n,s;if("function"==typeof e)for(n in t)if(t.hasOwnProperty(n)&&(s=t[n],i=e.call(t,s,n),i===!1))break;return t},baidu.extend=baidu.object.extend=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},baidu.number=baidu.number||{},baidu.number.pad=function(t,e){var i="",n=0>t,s=String(Math.abs(t));return s.length<e&&(i=new Array(e-s.length+1).join("0")),(n?"-":"")+i+s},baidu.platform=baidu.platform||{},baidu.platform.isAndroid=/android/i.test(navigator.userAgent),baidu.platform.isIpad=/ipad/i.test(navigator.userAgent),baidu.platform.isIphone=/iphone/i.test(navigator.userAgent),baidu.swf=baidu.swf||{},baidu.browser=baidu.browser||{},baidu.browser.ie=baidu.ie=/msie (\d+\.\d+)/i.test(navigator.userAgent)?document.documentMode||+RegExp.$1:void 0,baidu.array=baidu.array||{},baidu.array.remove=function(t,e){for(var i=t.length;i--;)i in t&&t[i]===e&&t.splice(i,1);return t},baidu.lang=baidu.lang||{},baidu.lang.isArray=function(t){return"[object Array]"==Object.prototype.toString.call(t)},baidu.lang.isFunction=function(t){return"[object Function]"==Object.prototype.toString.call(t)},baidu.lang.toArray=function(t){if(null===t||void 0===t)return[];if(baidu.lang.isArray(t))return t;if("number"!=typeof t.length||"string"==typeof t||baidu.lang.isFunction(t))return[t];if(t.item){for(var e=t.length,i=new Array(e);e--;)i[e]=t[e];return i}return[].slice.call(t)},baidu.swf.getMovie=function(t){var e,i=document[t];return 9==baidu.browser.ie?i&&i.length?1==(e=baidu.array.remove(baidu.lang.toArray(i),function(t){return"embed"!=t.tagName.toLowerCase()})).length?e[0]:e:i:i||window[t]},baidu.swf.version=function(){var t=navigator;if(t.plugins&&t.mimeTypes.length){var e=t.plugins["Shockwave Flash"];if(e&&e.description)return e.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s)+r/,".")+".0"}else if(window.ActiveXObject&&!window.opera)for(var i=12;i>=2;i--)try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+i);if(n){var s=n.GetVariable("$version");return s.replace(/WIN/g,"").replace(/,/g,".")}}catch(a){}}(),baidu.string.encodeHTML=function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},baidu.encodeHTML=baidu.string.encodeHTML,baidu.swf.createHTML=function(t){t=t||{};var e,i,n,s,a,r,o=baidu.swf.version,u=t.ver||"6.0.0",l={},h=baidu.string.encodeHTML;for(s in t)l[s]=t[s];if(t=l,!o)return"";for(o=o.split("."),u=u.split("."),n=0;3>n&&(e=parseInt(o[n],10),i=parseInt(u[n],10),!(e>i));n++)if(i>e)return"";var d=t.vars,c=["classid","codebase","id","width","height","align"];if(t.align=t.align||"middle",t.classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000",t.codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0",t.movie=t.url||"",delete t.vars,delete t.url,"string"==typeof d)t.flashvars=d;else{var g=[];for(s in d)r=d[s],g.push(s+"="+encodeURIComponent(r));t.flashvars=g.join("&")}var p=["<object "];for(n=0,a=c.length;a>n;n++)r=c[n],p.push(" ",r,'="',h(t[r]),'"');p.push(">");var f={wmode:1,scale:1,quality:1,play:1,loop:1,menu:1,salign:1,bgcolor:1,base:1,allowscriptaccess:1,allownetworking:1,allowfullscreen:1,seamlesstabbing:1,devicefont:1,swliveconnect:1,flashvars:1,movie:1};for(s in t)r=t[s],s=s.toLowerCase(),f[s]&&(r||r===!1||0===r)&&p.push('<param name="'+s+'" value="'+h(r)+'" />');t.src=t.movie,t.name=t.id,delete t.id,delete t.movie,delete t.classid,delete t.codebase,t.type="application/x-shockwave-flash",t.pluginspage="http://www.macromedia.com/go/getflashplayer",p.push("<embed");var m;for(s in t)if(r=t[s],r||r===!1||0===r){if(new RegExp("^salign$","i").test(s)){m=r;continue}p.push(" ",s,'="',h(r),'"')}return m&&p.push(' salign="',h(m),'"'),p.push("></embed></object>"),p.join("")},baidu.swf.create=function(t,e){t=t||{};var i=baidu.swf.createHTML(t)||t.errorMessage||"";e&&"string"==typeof e&&(e=document.getElementById(e)),e?e.innerHTML=i:document.write(i)},function(){var t=window[baidu.guid];baidu.lang.guid=function(){return"TANGRAM__"+(t._counter++).toString(36)},t._counter=t._counter||1}(),window[baidu.guid]._instances=window[baidu.guid]._instances||{},baidu.lang.Class=function(t){this.guid=t||baidu.lang.guid(),window[baidu.guid]._instances[this.guid]=this},window[baidu.guid]._instances=window[baidu.guid]._instances||{},baidu.lang.Class.prototype.dispose=function(){delete window[baidu.guid]._instances[this.guid];for(var t in this)baidu.lang.isFunction(this[t])||delete this[t];this.disposed=!0},baidu.lang.Class.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"},baidu.lang.isString=function(t){return"[object String]"==Object.prototype.toString.call(t)},baidu.isString=baidu.lang.isString,baidu.lang.Event=function(t,e){this.type=t,this.returnValue=!0,this.target=e||null,this.currentTarget=null},baidu.lang.Class.prototype.addEventListener=function(t,e,i){if(baidu.lang.isFunction(e)){!this.__listeners&&(this.__listeners={});var n,s=this.__listeners;if("string"==typeof i&&i){if(/[^\w\-]/.test(i))throw"nonstandard key:"+i;e.hashCode=i,n=i}0!=t.indexOf("on")&&(t="on"+t),"object"!=typeof s[t]&&(s[t]={}),n=n||baidu.lang.guid(),e.hashCode=n,s[t][n]=e}},baidu.lang.Class.prototype.removeEventListener=function(t,e){if("undefined"==typeof e||(!baidu.lang.isFunction(e)||(e=e.hashCode))&&baidu.lang.isString(e)){!this.__listeners&&(this.__listeners={}),0!=t.indexOf("on")&&(t="on"+t);var i=this.__listeners;if(i[t])if("undefined"!=typeof e)i[t][e]&&delete i[t][e];else for(var n in i[t])delete i[t][n]}},baidu.lang.Class.prototype.dispatchEvent=function(t,e){baidu.lang.isString(t)&&(t=new baidu.lang.Event(t)),!this.__listeners&&(this.__listeners={}),e=e||{};for(var i in e)t[i]=e[i];var i,n=this.__listeners,s=t.type;if(t.target=t.target||this,t.currentTarget=this,0!=s.indexOf("on")&&(s="on"+s),baidu.lang.isFunction(this[s])&&this[s].apply(this,arguments),"object"==typeof n[s])for(i in n[s])n[s][i].apply(this,arguments);return t.returnValue},baidu.lang.createClass=function(t,e){e=e||{};var i=e.superClass||baidu.lang.Class,n=function(){i!=baidu.lang.Class?i.apply(this,arguments):i.call(this),t.apply(this,arguments)};n.options=e.options||{};var s=function(){},a=t.prototype;s.prototype=i.prototype;var r=n.prototype=new s;for(var o in a)r[o]=a[o];return"string"==typeof e.className&&(r._className=e.className),r.constructor=a.constructor,n.extend=function(t){for(var e in t)n.prototype[e]=t[e];return n},n},baidu.lang.inherits=function(t,e,i){var n,s,a=t.prototype,r=new Function;r.prototype=e.prototype,s=t.prototype=new r;for(n in a)s[n]=a[n];t.prototype.constructor=t,t.superClass=e.prototype,"string"==typeof i&&(s._className=i)},baidu.inherits=baidu.lang.inherits,baidu.lang.isBoolean=function(t){return"boolean"==typeof t},baidu.lang.isElement=function(t){return!(!t||!t.nodeName||1!=t.nodeType)},baidu.lang.isNumber=function(t){return"[object Number]"==Object.prototype.toString.call(t)&&isFinite(t)},baidu.lang.isObject=function(t){return"function"==typeof t||!(!t||"object"!=typeof t)},baidu.isObject=baidu.lang.isObject,baidu.fn.bind=function(t,e){var i=arguments.length>2?[].slice.call(arguments,2):null;return function(){var n=baidu.lang.isString(t)?e[t]:t,s=i?i.concat([].slice.call(arguments,0)):arguments;return n.apply(e||n,s)}},baidu.each=baidu.array.forEach=baidu.array.each=function(t,e,i){var n,s,a,r=t.length;if("function"==typeof e)for(a=0;r>a&&(s=t[a],n=e.call(i||t,s,a),n!==!1);a++);return t},baidu.array.some=function(t,e,i){for(var n=0,s=t.length;s>n;n++)if(n in t&&e.call(i||t,t[n],n))return!0;return!1},baidu.browser.chrome=/chrome\/(\d+\.\d+)/i.test(navigator.userAgent)?+RegExp.$1:void 0,baidu.browser.firefox=/firefox\/(\d+\.\d+)/i.test(navigator.userAgent)?+RegExp.$1:void 0,baidu.browser.isWebkit=/webkit/i.test(navigator.userAgent);try{/(\d+\.\d+)/.test(external.max_version)&&(baidu.browser.maxthon=+RegExp.$1)}catch(e){}!function(){var t=navigator.userAgent;baidu.browser.safari=/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(t)&&!/chrome/i.test(t)?+(RegExp.$1||RegExp.$2):void 0}(),baidu.dom=baidu.dom||{},baidu.dom.g=function(t){return"string"==typeof t||t instanceof String?document.getElementById(t):t&&t.nodeName&&(1==t.nodeType||9==t.nodeType)?t:null},baidu.g=baidu.G=baidu.dom.g,baidu.dom._styleFixer=baidu.dom._styleFixer||{},baidu.dom._styleFilter=baidu.dom._styleFilter||[],baidu.dom._styleFilter.filter=function(t,e,i){for(var n,s=0,a=baidu.dom._styleFilter;n=a[s];s++)(n=n[i])&&(e=n(t,e));return e},baidu.string.toCamelCase=function(t){return t.indexOf("-")<0&&t.indexOf("_")<0?t:t.replace(/[-_][^-_]/g,function(t){return t.charAt(1).toUpperCase()})},baidu.dom.setStyle=function(t,e,i){var n,s=baidu.dom;return t=s.g(t),e=baidu.string.toCamelCase(e),(n=s._styleFilter)&&(i=n.filter(e,i,"set")),n=s._styleFixer[e],n&&n.set?n.set(t,i):t.style[n||e]=i,t},baidu.setStyle=baidu.dom.setStyle,baidu.dom.setStyles=function(t,e){t=baidu.dom.g(t);for(var i in e)baidu.dom.setStyle(t,i,e[i]);return t},baidu.setStyles=baidu.dom.setStyles,baidu.dom._NAME_ATTRS=function(){var t={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"};return baidu.browser.ie<8?(t["for"]="htmlFor",t["class"]="className"):(t.htmlFor="for",t.className="class"),t}(),baidu.dom.setAttr=function(t,e,i){return t=baidu.dom.g(t),"style"==e?t.style.cssText=i:(e=baidu.dom._NAME_ATTRS[e]||e,t.setAttribute(e,i)),t},baidu.setAttr=baidu.dom.setAttr,baidu.dom.setAttrs=function(t,e){t=baidu.dom.g(t);for(var i in e)baidu.dom.setAttr(t,i,e[i]);return t},baidu.setAttrs=baidu.dom.setAttrs,baidu.dom.create=function(t,e){var i=document.createElement(t),n=e||{};return baidu.dom.setAttrs(i,n)},baidu.cookie=baidu.cookie||{},baidu.cookie._isValidKey=function(t){return new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(t)},baidu.cookie.getRaw=function(t){if(baidu.cookie._isValidKey(t)){var e=new RegExp("(^| )"+t+"=([^;]*)(;|$)"),i=e.exec(document.cookie);if(i)return i[2]||null}return null},baidu.cookie.get=function(t){var e=baidu.cookie.getRaw(t);return"string"==typeof e?e=decodeURIComponent(e):null},baidu.cookie.setRaw=function(t,e,i){if(baidu.cookie._isValidKey(t)){i=i||{};var n=i.expires;"number"==typeof i.expires&&(n=new Date,n.setTime(n.getTime()+i.expires)),document.cookie=t+"="+e+(i.path?"; path="+i.path:"")+(n?"; expires="+n.toGMTString():"")+(i.domain?"; domain="+i.domain:"")+(i.secure?"; secure":"")}},baidu.cookie.remove=function(t,e){e=e||{},e.expires=new Date(0),baidu.cookie.setRaw(t,"",e)},baidu.cookie.set=function(t,e,i){baidu.cookie.setRaw(t,encodeURIComponent(e),i)},baidu.sio=baidu.sio||{},baidu.sio._createScriptTag=function(t,e,i){t.setAttribute("type","text/javascript"),i&&t.setAttribute("charset",i),t.setAttribute("src",e),document.getElementsByTagName("head")[0].appendChild(t)},baidu.sio._removeScriptTag=function(t){if(t.clearAttributes)t.clearAttributes();else for(var e in t)t.hasOwnProperty(e)&&delete t[e];t&&t.parentNode&&t.parentNode.removeChild(t),t=null},baidu.sio.callByServer=function(t,e,i){function n(t){return function(){try{t?l.onfailure&&l.onfailure():(e.apply(window,arguments),clearTimeout(a)),window[s]=null,delete window[s]}catch(i){}finally{baidu.sio._removeScriptTag(o)}}}var s,a,r,o=document.createElement("SCRIPT"),u="bd__cbs__",l=i||{},h=l.charset,d=l.queryField||"callback",c=l.timeOut||0,g=new RegExp("(\\?|&)"+d+"=([^&]*)");baidu.lang.isFunction(e)?(s=u+Math.floor(2147483648*Math.random()).toString(36),window[s]=n(0)):baidu.lang.isString(e)?s=e:(r=g.exec(t))&&(s=r[2]),c&&(a=setTimeout(n(1),c)),t=t.replace(g,"$1"+d+"="+s),t.search(g)<0&&(t+=(t.indexOf("?")<0?"?":"&")+d+"="+s),baidu.sio._createScriptTag(o,t,h)};var mbox=mbox||{};T.extend(mbox,{namespace:function(){var t,e,i,n=arguments,s=null;for(t=0,len=n.length;len>t;t++)for(i=(""+n[t]).split("."),s=mbox,e="mbox"==i[0]?1:0;e<i.length;e+=1)s[i[e]]=s[i[e]]||{},s=s[i[e]];return s},Fuze:function(){var t,e,i;return t=[],e=function(e){i?e():t.push(e)},e.fire=function(){for(;t.length;)t.shift()();i=!0},e.extinguish=function(){i=!1},e.wettish=function(){this.fire(),this.extinguish()},e.clear=function(){for(;t.length;)t.shift();this.extinguish()},e},convertTime:function(t){var e,i;return t=Math.round(t/1e3),e=Math.floor(t/60),i=t%60,T.number.pad(e,2)+":"+T.number.pad(i,2)},Timer:function(t){var e=function(t,e){this._timer=function(){},this._listener=function(){},this._timerComplete=function(){},this._timerID=null,this._delay=this._remain=t,this._repeatCount=e||0,this._currentCount=0,this._isRunning=!1,this._startTime=this._endTime=0,this.EVENTS={TIMER:"timer",COMPLETE:"timerComplete"}};return e.prototype={_createTimer:function(e,i){var n=this;return 1==i?function(){return t.setTimeout(function(){n.reset(),n._listener(n._delay,i),n._timerComplete()},e)}:function(){return t.setInterval(function(){0!=i&&n._currentCount>=i?(n.reset(),n._timerComplete()):(n._currentCount++,n._listener(e,n._currentCount))},e)}},addEventListener:function(t,e){"timer"==t?(this._listener=e,this._timer=this._createTimer(this._delay,this._repeatCount)):"timerComplete"==t&&(this._timerComplete=e)},reset:function(){this.stop(),1==this._repeatCount&&(this._timer=this._createTimer(this._delay,this._repeatCount)),this._currentCount=0,this._remain=this._delay,this._startTime=this._endTime=0},start:function(){this._timerID||(this._timerID=this._timer(),1==this._repeatCount&&(this._startTime=(new Date).getTime()),this._isRunning=!0)},stop:function(){this._timerID&&(1==this._repeatCount?t.clearTimeout(this._timerID):t.clearInterval(this._timerID),this._timerID=null,this._isRunning=!1)},pause:function(){1==this._repeatCount?this._timerID&&(this.stop(),this._endTime=(new Date).getTime(),this._remain=this._remain-(this._endTime-this._startTime),this._remain>0?this._timer=this._createTimer(this._remain,1):this.reset()):this.stop()},getCurrentCount:function(){return this._currentCount},isRunning:function(){return this._isRunning}},e}(window),StopWatch:function(){var t=0,e=function(){this.startTime=0,this.isRunning=!1,this.isReset=!0,this.passedTime=0,t++};return e.prototype={reset:function(){this.startTime=0,this.pauseTime=0,this.passedTime=0,this.isRunning=!1,this.isReset=!0},start:function(){this.isReset?(this.reset(),this.startTime=(new Date).getTime()):this.isRunning||(this.startTime=(new Date).getTime()),this.isRunning=!0,this.isReset=!1},pause:function(){!this.isReset&&this.isRunning&&(this.pauseTime=(new Date).getTime(),this.passedTime+=this.pauseTime-this.startTime,this.isRunning=!1)},isRunning:function(){return this.isRunning},isReset:function(){return this.isReset},getTime:function(){return this.isReset?0:this.isRunning?(new Date).getTime()-this.startTime+this.passedTime:this.passedTime},getCounts:function(){return t}},e}(window)}),mbox.namespace("mbox.lang"),T.extend(mbox.lang,{createClass:function(t,e){var i=T.lang.createClass(t,e);return i.prototype.removeEventListener=function(t,e){if("undefined"==typeof e||(!baidu.lang.isFunction(e)||(e=e.hashCode))&&baidu.lang.isString(e)){!this.__listeners&&(this.__listeners={});var i=t.split(".");t.length>1&&(t=i[0],e=i[1]),0!=t.indexOf("on")&&(t="on"+t);var n=this.__listeners;if(n[t])if("undefined"!=typeof e)n[t][e]&&delete n[t][e];else for(var s in n[t])delete n[t][s]}},i.extend=function(t){for(var e in t)i.prototype[e]=function(t,e){return T.lang.isFunction(t)?function(){this.dispatchEvent(e,{name:e,arguments:arguments});var i=t.apply(this,arguments);return i}:t}(t[e],e);return i},i}});var mbox=mbox||{};!function(){var t="mbox";mbox.CONF={instanceCallName:t,autoPlay:!1,autoNext:!1,engineArg:{audio:{constructorName:"PlayEngine_Audio"},fmp:{constructorName:"PlayEngine_FMP_MP3",args:{swfPath:"http://play.baidu.com/player/static/flash/fmp.swf",instanceName:t+".player"}}},logOpt:{ref:"pc_widget_tieba"},songLinkHost:{link:"http://tingapi.ting.baidu.com/v1/restserver/ting?method=baidu.ting.song.play&format=jsonp&bit=128&songid=",lrc:"http://tingapi.ting.baidu.com/v1/restserver/ting?method=baidu.ting.song.lry&fromat=jsonp&songid=",sug:"http://tingapi.ting.baidu.com/v1/restserver/ting?method=baidu.ting.search.common&page_size=1&page_no=1&query="}}}(void 0);var PlayEngine_Interface=mbox.lang.createClass(function(){var t=0,e={mute:!1,volume:50},i=function(t){this.STATES={INIT:"init",READY:"ready",STOP:"stop",PLAY:"play",PAUSE:"pause",END:"end",BUFFERING:"buffering",PREBUFFER:"pre-buffer",ERROR:"error"},this.EVENTS={STATECHANGE:"player_playStateChange",POSITIONCHANGE:"player_positionChange",PROGRESS:"player_progress",ERROR:"player_error",INIT:"player_initSuccess",INITFAIL:"player_initFail"},t=t||{},this.mute="undefined"==typeof t.mute?e.mute:!!t.mute,this.volume="undefined"==typeof t.volume?e.volume:t.volume,this.ready=!1,this.url="",this.state=this.STATES.INIT,this.engineType="",this.stateStack=[this.STATES.INIT],this.supportMimeType=[]};return i.prototype={newId:function(){return"_m3_"+t++},init:function(){},reset:function(){},setUrl:function(){},getUrl:function(){return this.url},play:function(){},pause:function(){},stop:function(){},setMute:function(){},getMute:function(){return this.mute},setVolume:function(){},getVolume:function(){return this.volume},getState:function(){return""},setCurrentPosition:function(){},getCurrentPosition:function(){return 0},getLoadedPercent:function(){return 0},getLoadedBytes:function(){return 0},getTotalBytes:function(){return 0},getTotalTime:function(){return 0},getVersion:function(){return""},getEngineType:function(){return this.engineType},canPlayType:function(t){var e=this.getSupportMimeTypeList();return T.array.some(e,function(e){return t==e})},getSupportMimeTypeList:function(){return this.supportMimeType},setEventListener:function(t,e,i){var n=T.fn.bind(function(){return e.apply(this,arguments)},this);this.addEventListener(t,n,i)}},i}(window),{superClass:T.lang.Class,className:"PlayEngine_Interface"}),PlayEngine_Audio=mbox.lang.createClass(function(t){t=t||{},this.engineType="audio",this.contentType={mp3:["audio/mpeg","audio/mp3"],mp4:["audio/mp4","audio/MP4A-LATM","video/mpeg4","audio/mpeg4-generic"],m4a:["audio/mp4","audio/MP4A-LATM","video/mpeg4","audio/mpeg4-generic"],aac:["audio/aac","audio/aacp"],"3gp":["audio/3gpp","audio/3gpp2"],ogg:["audio/ogg","video/ogg","application/ogg","audio/vorbis"],oga:["audio/ogg","application/ogg","audio/vorbis"],wma:["audio/x-ms-wma"]},this.supportAudio="undefined"!=typeof Audio,this.supportMimeType=[],this.supportAudio&&(this.audio=new Audio,"function"==typeof this.audio.canPlayType&&T.object.each(this.contentType,T.fn.bind(function(t,e){for(var i=0;i<t.length;i++){var n=this.audio.canPlayType(t[i]);if("probably"==n||"maybe"==n){this.supportMimeType.push(e);break}}},this)),this.supportMimeType.length||(this.supportAudio=!1)),this.supportVolume=T.fn.bind(function(){return this.supportAudio?(this.audio.volume=.5,this.audio.volume<1):!1},this)()},{superClass:PlayEngine_Interface,className:"PlayEngine_Audio"}).extend({test:function(t){return t=!!t,!this.supportAudio&&t&&this.dispatchEvent(this.EVENTS.INITFAIL,{engineType:this.engineType}),this.supportAudio},init:function(){this.lastState=this.STATES.INIT,this.muted=this.audio.muted=!1,this.volume=50,this.audio.volume=.5,this.url="",this._definedEvents(),this.state=this.STATES.READY,this.dispatchEvent(this.EVENTS.INIT,{engineType:this.engineType,engine:this.audio})},reset:function(){this.supportAudio&&(this.url="",this.audio.pause(),this.state="ready",this.lastState="ready")},setUrl:function(t){this.supportAudio&&(this.url=t,this.audio.src=t,this.audio.load(),this._firePlayStateChange(this.STATES.PREBUFFER))},play:function(){if(this.supportAudio&&"ready"!=this.state)if(T.platform.isAndroid&&T.browser.isWebkit&&this.audio.readyState<3){var t=T.fn.bind(function(){this.audio.play(),this.audio.removeEventListener("canplay",t,!1)},this);this.audio.addEventListener("canplay",t,!1)}else this.audio.play()},pause:function(){this.supportAudio&&this.state!=this.STATES.STOP&&this.state!=this.STATES.READY&&this.state!=this.STATES.END&&(this.audio.pause(),this._firePlayStateChange(this.STATES.PAUSE))},stop:function(){this.supportAudio&&this.state!=this.STATES.READY&&(0!=this.audio.currentTime&&(this.audio.currentTime=0),this.audio.pause(),this._firePlayStateChange(this.STATES.STOP))},setMute:function(t){this.supportAudio&&(this.audio.muted=this.mute=t)},setVolume:function(t){this.supportAudio&&(t=T.lang.isNumber(t)?t:50,t=Math.max(Math.min(t,100),0),this.volume=t,this.audio.volume=t/100)},setCurrentPosition:function(t){if(this.supportAudio)if(T.platform.isAndroid&&this.audio.readyState<3){var e=T.fn.bind(function(){this.audio.currentTime=t/1e3,this.audio.play(),this.audio.removeEventListener("canplay",e,!1)},this);this.audio.addEventListener("canplay",e,!1)}else this.audio.currentTime=t/1e3,this.audio.play()},getCurrentPosition:function(){return this.supportAudio?Math.round(1e3*this.audio.currentTime):0},getLoadedPercent:function(){try{var t=this.audio.buffered.end(0),e=this.audio.duration;return e=isNaN(e)?0:e,Math.round(t/e*100)/100}catch(i){return 0}},getTotalTime:function(){if(!this.supportAudio)return 0;var t=this.audio.duration;return t=isNaN(t)?0:t,Math.round(1e3*t)},getState:function(){return this.state},_firePlayStateChange:function(t){this.state!=t&&(this.lastState=this.state,this.state=t,this.dispatchEvent(this.EVENTS.STATECHANGE,{newState:t,oldState:this.lastState,engineType:this.engineType}))},_definedEvents:function(){this.audio.addEventListener("error",T.fn.bind(function(){this._firePlayStateChange(this.STATES.ERROR),this.dispatchEvent(this.EVENTS.ERROR,{engineType:this.engineType})},this),!1),this.audio.addEventListener("ended",T.fn.bind(function(){this._firePlayStateChange(this.STATES.END)},this),!1),this.audio.addEventListener("playing",T.fn.bind(function(){this._firePlayStateChange(this.STATES.PLAY)},this),!1),this.audio.addEventListener("pause",T.fn.bind(function(){this.getState()==this.STATES.PLAY&&this._firePlayStateChange(this.getCurrentPosition()?this.STATES.PAUSE:this.STATES.STOP)},this),!1),this.audio.addEventListener("waiting",T.fn.bind(function(){this._firePlayStateChange(this.getCurrentPosition()?this.STATES.BUFFERING:this.STATES.PREBUFFER)},this),!1)}}),PlayEngine_FMP_MP3=mbox.lang.createClass(function(t){t=t||{},this.supportMimeType=["mp3"],this.engineType="fmp_mp3",this.swfPath="fmp_mp3.swf",this.flashVersionRequire=t.flashVersionRequire||"9.0.0",this.versionErrorMessage=t.versionErrorMessage||"",this.stateCode={"-2":this.STATES.INIT,"-1":this.STATES.READY,0:this.STATES.STOP,1:this.STATES.PLAY,2:this.STATES.PAUSE,3:this.STATES.END,4:this.STATES.BUFFERING,5:this.STATES.PREBUFFER,6:this.STATES.ERROR},this.flashLoaded=!1,this.flashReady=new mbox.Fuze},{superClass:PlayEngine_Interface,className:"PlayEngine_FMP_MP3"}).extend({test:function(t){return this._checkPlayer(t)},init:function(t){t=t||{};var e=t.el;this.instanceName=t.instanceName,this.swfPath=t.swfPath||this.swfPath;var i,n=this.newId();T.lang.isString(e)&&(e=T.g(e)),e||(e=T.dom.create("div"),document.body.appendChild(e)),i=T.dom.create("div"),e.appendChild(i),this.swfPath+="?"+n+"_"+Math.random(),T.swf.create({id:this.flashObjectId=n,width:"1px",height:"1px",ver:this.flashVersionRequire,errorMessage:this.versionErrorMessage,allowscriptaccess:"always",url:this.swfPath,bgcolor:"#ffffff",wmode:"window",scale:"noscale",vars:{_instanceName:this.instanceName+"",_buffertime:2e3}},i),this.flashObject=T.swf.getMovie(this.flashObjectId)},reset:function(){this.stop(),this.state!=this.STATES.INIT&&(this.url="",this.state=this.STATES.READY,this.stateStack=[this.STATES.READY])},setUrl:function(t){this.flashReady(T.fn.bind(function(){this.url=t,this.flashObject.closeStream(),this.flashObject.f_load(t)},this))},play:function(){this.flashReady(T.fn.bind(function(){this.state!=this.STATES.PLAY&&this.flashObject.f_play()},this))},pause:function(){this.flashReady(T.fn.bind(function(){this.state!=this.STATES.PAUSE&&this.state!=this.STATES.STOP&&this.state!=this.STATES.END&&this.flashObject.f_pause()},this))},stop:function(){this.flashReady(T.fn.bind(function(){this.state!=this.STATES.STOP&&this.flashObject.f_stop()},this))},setMute:function(t){this.flashReady(T.fn.bind(function(){this.mute=t,this.flashObject.setData("mute",t)},this))},setVolume:function(t){this.flashReady(T.fn.bind(function(){this.volume=t,this.flashObject.setData("volume",t)},this))},setCurrentPosition:function(t){this.flashReady(T.fn.bind(function(){this.flashObject.f_play(t)},this))},getCurrentPosition:function(){return this.flashLoaded?this.flashObject.getData("currentPosition"):0},getLoadedPercent:function(){return this.flashLoaded?this.flashObject.getData("loadedPct"):0},getTotalTime:function(){return this.flashLoaded?this.flashObject.getData("length"):0},getState:function(t){return T.lang.isNumber(t)?this.stateCode[t]:this.state},getVersion:function(){return T.swf.version},_firePlayStateChange:function(t){if(this.state!=t){this.state=t,this.stateStack.push(t);var e=this.stateStack.shift();this.dispatchEvent(this.EVENTS.STATECHANGE,{newState:t,oldState:e,engineType:this.engineType})}},_onLoad:function(){this.state=this.STATES.READY,this.stateStack=[this.state],this.dispatchEvent(this.EVENTS.INIT,{engineType:this.engineType,engine:this.flashObject}),setTimeout(T.fn.bind(function(){this.flashReady.fire(),this.flashLoaded=!0},this),0)},_onPlayStateChange:function(t){setTimeout(T.fn.bind(function(){this._firePlayStateChange(this.getState(t))},this),0)},_checkPlayer:function(t){t=!!t;var e=T.swf.version,i=this.flashVersionRequire;if(e){var n=e.split("."),s=i.split(".");return n[0]-s[0]>=0&&n[1]-s[1]>=0?!0:(t&&this.dispatchEvent(this.EVENTS.INITFAIL,{engineType:this.engineType}),!1)}return t&&this.dispatchEvent(this.EVENTS.INITFAIL,{engineType:this.engineType}),!1}}),PlayEngine=mbox.lang.createClass(function(t){t=t||{},this.subEnginesConf=[],this.subEnginesInitArgs={},this.curEngine=null,this.curEngineType="",this.unInitEngineList=[],this.engineList=[],this.engineTypeList=[],this.ready=!1,this.defaultExt=".mp3",this.coreContainer=null,this.EVENTS={STATECHANGE:"player_playStateChange",POSITIONCHANGE:"player_positionChange",PROGRESS:"player_progress",ERROR:"player_error",INIT:"player_initSuccess",INITFAIL:"player_initFail"},this.STATES={INIT:"init",READY:"ready",STOP:"stop",PLAY:"play",PAUSE:"pause",END:"end",BUFFERING:"buffering",PREBUFFER:"pre-buffer",ERROR:"error"},this.progressTimer=new mbox.Timer(200,0),this.positionTimer=new mbox.Timer(100,0),this._initEngines(t)},{className:"PlayEngine"}).extend({_error:function(t){throw new Error(t)},_initEngines:function(config){this.coreContainer=config.el||null,this.subEnginesConf=config.subEngines||[],T.array.each(this.subEnginesConf,T.fn.bind(function(item,index){var subEngineName=item.constructorName,args=item.args||{},subEngineConstructor;this.subEnginesInitArgs[subEngineName]=args;try{if(subEngineConstructor=eval(subEngineName),!T.lang.isFunction(subEngineConstructor))return}catch(e){return}var engine=new subEngineConstructor(args);this.unInitEngineList.push(engine)},this)),this.curEngine=this.unInitEngineList[0]},init:function(t){if(this.ready)return this._error("");if(t=t||{},this.subEnginesInitArgs=t.subEngines?t.subEngines:this.subEnginesInitArgs,this.coreContainer=t.el?t.el:this.coreContainer,!this.coreContainer){var e=T.dom.create("div",{id:"_player_container_"+T.lang.guid()});T.dom.setStyles(e,{width:"1px",height:"1px",overflow:"hidden"}),document.body.appendChild(e),this.coreContainer=t.el=e}T.array.each(this.unInitEngineList,T.fn.bind(function(t){var e=t.toString(),i="",n=/^\[object (.*)\]$/i;n.test(e)&&(i=RegExp.$1);var s=this.subEnginesInitArgs[i]||{};t.test(!0)&&(s.instanceName=s.instanceName+".engineList["+this.engineList.length+"]",s.el=s.el||this.coreContainer,this.engineList.push(t),t.init.apply(t,[s]))},this)),this.switchEngineByUrl(this.defaultExt),this.ready=!0,this._initProgressEvent(),this._initPositionChangeEvent()},canPlayType:function(t){return T.array.some(this.engineList,function(e){return e.canPlayType(t)})},getSupportMimeTypeList:function(){var t=[];return T.array.each(this.engineList,T.fn.bind(function(e){t=t.concat(e.getSupportMimeTypeList())},this)),t},switchEngineByUrl:function(t){var e=T.array.some(this.engineList,T.fn.bind(function(e){var i=e.getSupportMimeTypeList().join("|"),n=new RegExp("\\.("+i+")(\\?|$)","ig");return n.test(t)?(this.curEngine=e,this.curEngineType=e.getEngineType(),!0):void 0},this)),i=arguments[1];e||i||arguments.callee.apply(this,[this.defaultExt,!0])},switchEngineByMimeType:function(t){T.array.some(this.engineList,T.fn.bind(function(e){return e.canPlayType(t)?(this.curEngine=e,this.curEngineType=e.getEngineType(),!0):void 0},this))},reset:function(){this.curEngine.reset.apply(this.curEngine,arguments)},setUrl:function(t){var e=this.curEngine;this.switchEngineByUrl(t),e&&e!=this.curEngine&&e.stop(),this.curEngine&&this.curEngine.setUrl.apply(this.curEngine,arguments)},getUrl:function(){return this.curEngine.getUrl.apply(this.curEngine,arguments)},play:function(t){return"undefined"!=typeof t?this.setCurrentPosition(t):this.curEngine?this.curEngine.play.apply(this.curEngine,arguments):void 0},pause:function(){return this.curEngine?this.curEngine.pause.apply(this.curEngine,arguments):void 0},stop:function(){return this.curEngine?this.curEngine.stop.apply(this.curEngine,arguments):void 0},setMute:function(){var t=arguments;T.array.each(this.engineList,function(e){e.setMute.apply(e,t)})},getMute:function(){return this.curEngine?this.curEngine.getMute.apply(this.curEngine,arguments):!1},setVolume:function(){var t=arguments;T.array.each(this.engineList,function(e){e.setVolume.apply(e,t)})},getVolume:function(){return this.curEngine?this.curEngine.getVolume.apply(this.curEngine,arguments):0},setCurrentPosition:function(){return this.curEngine?this.curEngine.setCurrentPosition.apply(this.curEngine,arguments):void 0},getCurrentPosition:function(){return this.curEngine?this.curEngine.getCurrentPosition.apply(this.curEngine,arguments):0},getCurrentPositionString:function(){return mbox.convertTime(this.getCurrentPosition())},getLoadedPercent:function(){return this.curEngine?this.curEngine.getLoadedPercent.apply(this.curEngine,arguments):0},getLoadedBytes:function(){return this.curEngine?this.curEngine.getLoadedBytes.apply(this.curEngine,arguments):void 0},getTotalBytes:function(){return this.curEngine?this.curEngine.getTotalBytes.apply(this.curEngine,arguments):0},getTotalTime:function(){return this.curEngine?this.curEngine.getTotalTime.apply(this.curEngine,arguments):0},getTotalTimeString:function(){return mbox.convertTime(this.getTotalTime())},getCurEngine:function(){return this.curEngine},getEngineType:function(){return this.getCurEngine().getEngineType()},getVersion:function(){var t={};return T.array.each(this.engineList,function(e){t[e.getEngineType()]=e.getVersion()}),t},getState:function(){return this.curEngine?this.curEngine.getState.apply(this.curEngine,arguments):null},setEventListener:function(t,e,i){var n;n=t==this.EVENTS.INITFAIL||t==this.EVENTS.INIT?T.fn.bind(function(){e.apply(this,arguments)},this):T.fn.bind(function(t){t.target&&t.target.getEngineType()==this.curEngineType&&e.apply(this,arguments)},this),T.array.each(this.unInitEngineList,function(e){e.setEventListener(t,n,i)
})},removeEventListener:function(t,e){T.array.each(this.unInitEngineList,function(i){i.removeEventListener(t,e)})},_initProgressEvent:function(){this.progressTimer.addEventListener("timer",T.fn.bind(function(){var t=this.getLoadedPercent();this.curEngine.dispatchEvent(this.EVENTS.PROGRESS,{progress:t,totalBytes:this.getTotalBytes(),loadedBytes:this.getLoadedBytes(),totalTime:this.getTotalTime()}),1==t&&"wmp"!=this.curEngineType&&this.progressTimer.stop()},this)),this.setEventListener(this.EVENTS.STATECHANGE,T.fn.bind(function(t){var e=t.newState;switch(e){case this.STATES.PREBUFFER:case this.STATES.PLAY:this.getLoadedPercent()<1&&this.progressTimer.start();break;case this.STATES.STOP:case this.STATES.READY:case this.STATES.END:this.progressTimer.reset()}},this)),this.setEventListener("setUrl",T.fn.bind(function(){this.progressTimer.reset(),this.progressTimer.start()},this))},_initPositionChangeEvent:function(){this.positionTimer.addEventListener("timer",T.fn.bind(function(){var t=this.getCurrentPosition();this.curEngine.dispatchEvent(this.EVENTS.POSITIONCHANGE,{position:t})},this)),this.setEventListener(this.EVENTS.STATECHANGE,T.fn.bind(function(t){var e=t.newState;switch(e){case this.STATES.PLAY:this.positionTimer.start();break;case this.STATES.STOP:case this.STATES.PAUSE:this.positionTimer.pause(),this.curEngine.dispatchEvent(this.EVENTS.POSITIONCHANGE,{position:this.getCurrentPosition()});break;case this.STATES.READY:case this.STATES.END:this.positionTimer.reset()}},this)),this.setEventListener("setUrl",T.fn.bind(function(){this.positionTimer.reset()},this))}});mbox.SongModel=function(t){t=t||{},this.hasLink=!1,this.songId=0,this.songName="",this.artistId=0,this.artistName="",this.albumId=0,this.albumName="",this.songPicSmall="",this.songPicBig="",this.songPicRadio="",this.lrcLink="",this.time=0,this.songLink="",this.showLink="",this.format="",this.rate=0,this.size=0,this.lyricContent="",this.relateStatus=0,this.resourceType=0,this.copyType=0;for(var e in t){var i=t[e];if(!T.isString(this[e])&&""!=i){var n=+i;n==i?i=n:null==i&&(i="")}this[e]=i}},mbox.SongModel.prototype={set:function(t){for(var e in t){var i=t[e];if(!T.isString(this[e])&&""!=i){var n=+i;n==i?i=n:null==i&&(i="")}this[e]=i}},get:function(t){return this[t]},unset:function(t){delete this[t]}},function(){var t=T.lang.createClass(function(){this.allSongCache={},this.apiAddress=mbox.CONF.songLinkHost.link,this.lrcAddress=mbox.CONF.songLinkHost.lrc,this.sugAddress=mbox.CONF.songLinkHost.sug}).extend({createSongModel:function(t,e){var i=[],t=T.lang.toArray(t),e=T.lang.toArray(e);return T.each(t,function(t){t&&"null"!==t&&"undefined"!==t&&(this.allSongCache[t]||(this.allSongCache[t]=new mbox.SongModel({songId:t})),i.push(this.allSongCache[t]))},this),T.object.each(e,function(t){this.allSongCache[t.queryId||t.id]&&this.allSongCache[t.queryId||t.id].set(t)},this),i},fetchIdByQuery:function(t,e){var i=t.split("$$"),n=i[0]||i[2],s=i[1];T.sio.callByServer(this.sugAddress+n+" "+s,function(i){i.song_list&&i.song_list.length?e(i.song_list[0].song_id):e(t)})},fetchSong:function(t,e){t.hasLink?T.lang.isFunction(e.success)&&e.success(t,this):t.songId.toString().indexOf("$$")>-1?this.fetchIdByQuery(t.songId,T.fn.bind(function(i){T.sio.callByServer(this.apiAddress+i,function(i){if(22e3===i.error_code){var n=i.songinfo,s=i.bitrate;if(n.extra){var a=n.extra.split("$$");n.song_id=n.extra,n.title=a[0]||a[2],n.author=a[1]}t.set({hasLink:!0,songId:n.song_id,songName:n.title,artistId:n.ting_uid,artistName:n.author,albumId:n.album_id,albumName:n.album_title,songPicBig:n.pic_big,songPicSmall:n.pic_small||"http://mu9.bdstatic.com/player/t/i/JJn494Tv.jpg",songPicRadio:n.pic_radio,resourceType:n.resource_type,relateStatus:n.relate_status,copyType:n.copy_type,lrcLink:n.lrclink,rate:s.file_bitrate,songLink:s.file_link,showLink:s.show_link,format:s.file_extension,size:s.file_size,time:s.file_duration}),T.lang.isFunction(e.success)&&e.success(t,this)}else T.lang.isFunction(e.error)&&e.error(t,i.error_code)})},this)):T.sio.callByServer(this.apiAddress+t.songId,function(i){if(22e3===i.error_code){var n=i.songinfo,s=i.bitrate;if(n.extra){var a=n.extra.split("$$");n.song_id=n.extra,n.title=a[0]||a[2],n.author=a[1]}t.set({hasLink:!0,songId:n.song_id,songName:n.title,artistId:n.ting_uid,artistName:n.author,albumId:n.album_id,albumName:n.album_title,songPicBig:n.pic_big,songPicSmall:n.pic_small||"http://mu9.bdstatic.com/player/t/i/JJn494Tv.jpg",songPicRadio:n.pic_radio,resourceType:n.resource_type,relateStatus:n.relate_status,copyType:n.copy_type,lrcLink:n.lrclink,rate:s.file_bitrate,songLink:s.file_link,showLink:s.show_link,format:s.file_extension,size:s.file_size,time:s.file_duration}),T.lang.isFunction(e.success)&&e.success(t,this)}else T.lang.isFunction(e.error)&&e.error(t,i.error_code)})},getLrcContent:function(t,e){var i=T.lang.isFunction,n=i(e)?e:i(e.success)?e.success:function(){},s=i(e.error)?e.error:function(){};t.lrcContent?n(t.lrcContent):t.songLink&&t.lrcLink?T.sio.callByServer(this.lrcAddress+t.songId,function(e){e.lrcContent?(t.lrcContent=e.lrcContent,n(e.lrcContent)):s()}):s()}});mbox.SongDataModel=new t}(void 0),function(){var t={RANDOM:0,SINGLE:1,CYCLE:2};mbox.PlayList=T.lang.createClass(function(){this.curSongIndex=-1,this.curSong=null,this.songModels=[],this.mode=t.SINGLE}).extend({_random:function(){return parseInt(Math.random()*this.getLength(),10)},addSong:function(t){t=T.lang.toArray(t),t.length&&(this.songModels=this.songModels.concat(t),this.dispatchEvent("add:songModels",{songModels:t}))},removeSong:function(t){if(-1===t)this.reset(),this.dispatchEvent("remove:songModels",{indexes:e});else{var e=T.lang.toArray(t),i=e.length;if(i){e.sort(function(t,e){return t-e});for(var n=this.curSongIndex,s=n,a=!1;i--;){var r=e[i];this.songModels.splice(r,1),-1!==s&&(r===n&&(a=!0),n>=r&&n--)}a&&n++,-1!==s&&(0>n&&songlist.length>0?(n=0,a=!0):n>songlist.length-1&&(n=0)),a&&(this.curSong=songlist[n],this.curSongIndex=n),this.dispatchEvent("remove:songModels",{indexes:e})}}},prev:function(){var e=this.getLength(),i=-1===this.curSongIndex?0:(this.curSongIndex+e-1)%e;e&&(this.mode===t.RANDOM?this.setCurIndex(this._random()):this.setCurIndex(i))},next:function(){var e=this.getLength(),i=(this.curSongIndex+1)%e;e&&(this.mode===t.RANDOM?this.setCurIndex(this._random()):this.setCurIndex(i))},autoNext:function(){this.mode===t.SINGLE?this.setCurIndex(this.curSongIndex):this.next()},setCurIndex:function(t){this.curSongIndex=t,this.setCurSong(this.songModels[t]),this.dispatchEvent("change:curSongIndex",{index:t})},setCurSong:function(t){this.curSong=t,this.dispatchEvent("change:curSong",{curSong:t})},getCurIndex:function(){return this.curSongIndex},getCurSong:function(){return this.curSong},getSongList:function(){return this.songModels},setMode:function(t){this.mode=t},getMode:function(){return this.mode},getLength:function(){return this.songModels.length},reset:function(){this.curSongIndex=-1,this.curSong=null,this.songModels=[],this.playlist=[]},fetchLink:function(t){mbox.SongDataModel.fetchSong(this.curSong,t)}})}(),mbox.LogModel=T.lang.createClass(function(t,e){this.logUrl="http://nsclick.baidu.com/v.gif",this.playerRules={},this.playerRuleCtrl=null,this.player=t,this.playList=e,this.initLog()}).extend({initLog:function(){{var t=this;new mbox.PlayerLog({time:100,resetOnNoVoice:!0,type:"play100ms",player:this.player,handler:function(){t.sendLog("playsong100ms",t.logUrl,{sendCurSong:!0})}}),new mbox.PlayerLog({time:6e4,resetOnNoVoice:!1,type:"play60s",player:this.player,handler:function(){t.sendLog("60play",t.logUrl,{sendCurSong:!0})}})}this.player.setEventListener("setUrl",function(){t.sendLog("playstart",t.logUrl,{sendCurSong:!0})})},_addCurSong:function(t){var e={song_id:"songId",song_title:"songName",singer_id:"artistId",singer_name:"artistName",album_id:"albumId",album_name:"albumName",copytype:"copyType",format:"format",queryid:"queryId",rate:"rate",relatestatus:"relateStatus",resourcetype:"resourceType",songsize:"size",linkCode:"linkCode",lrcLink:"lrcLink",time:"time",status:"status",from:"from",link:"songLink"},i=this.playList.getCurSong();T.object.each(e,function(e,n){t.push(n+"="+encodeURIComponent(null==i[e]?"":i[e]))})},sendLog:function(t,e,i){var n=[],s=(new Date).getTime();window["naga_log_"+s]=new Image;var a=window["naga_log_"+s];n.push("pid=304"),n.push("url="),n.push("type="+t),i.sendCurSong&&this._addCurSong(n),i.pos&&n.push("pos="+i.pos),n.push("r"+Math.random()+"=1"),mbox.CONF.logOpt&&(mbox.CONF.logOpt.ref||(mbox.CONF.logOpt.ref="pc_aldsinglebox"),T.object.each(mbox.CONF.logOpt,function(t,e){n.push(e+"="+t)})),i.otherInfo&&_.each(i.otherInfo,function(t,e){n.push(e+"="+encodeURIComponent(t+""||""))}),a.onload=function(){a=null;try{delete window["naga_log_"+s]}catch(t){}},a.src=e+"?"+n.join("&")}}),mbox.PlayerLog=function(t){this.type=t.type,this.time=t.time,this.resetOnNoVoice=t.resetOnNoVoice,this.player=t.player,this.active=!1,this.timer=null,this.handlers=[],t.handler&&this.handlers.push(t.handler),this._init()},mbox.PlayerLog.prototype={_init:function(){this.timer||null==this.time||(this.timer=new mbox.Timer(this.time,1),this.addHandler(this.handler),this.timer.addEventListener("timer",T.fn.bind(function(){for(var t=0,e=this.handlers.length;e>t;t++)this.handlers[t]&&this.handlers[t].apply(this,arguments)},this)));var t=this.player.EVENTS.STATECHANGE,e=this.player.STATES;this.player.setEventListener("setUrl",T.fn.bind(function(){this.active=!0,this.timer.reset()},this)),this.player.setEventListener(t,T.fn.bind(function(t){this.active&&(t.newState==e.PLAY?this.timer.start():this.resetOnNoVoice?this.timer.reset():t.newState==e.PAUSE||t.newState==e.BUFFERING?t.oldState==e.PLAY&&this.timer.pause():this.timer.reset())},this))},addHandler:function(t){this.handlers.push(t)}},mbox.PlayCtrl=mbox.lang.createClass(function(t){var e=[],i=mbox.CONF.instanceCallName,n=mbox.CONF.engineArg;"object"!=typeof window[i]&&(window[i]={}),/(macintosh|iphone|ipod|ipad)/i.test(navigator.userAgent)?(e.push(n.audio),e.push(n.fmp)):(e.push(n.fmp),e.push(n.audio)),this.player=window[i].player=new PlayEngine({subEngines:e}),this.player.init(),this.curSong=null,this.playList=new mbox.PlayList,this.log=new mbox.LogModel(this.player,this.playList),window[i].logger=this.log,this._init(t),mbox.CONF.exportAPI&&(window[i][mbox.CONF.exportAPI]=this.exportAPI())}).extend({_init:function(t){t=t||{};var e=this.player,i=this.playList,n=t.songId||[],s=mbox.SongDataModel.createSongModel(n),a=this,r=T.lang.isFunction;t.logOpt&&T.object.extend(mbox.CONF.logOpt||{},t.logOpt),e.setEventListener(e.EVENTS.POSITIONCHANGE,function(e){var i=e.position,n=a.getTotalTime();r(t.onPositionChange)&&t.onPositionChange(i,100*i/n||0)}),r(t.onProgressChange)&&e.setEventListener(e.EVENTS.PROGRESS,function(e){t.onProgressChange(100*e.progress)}),e.setEventListener(e.EVENTS.STATECHANGE,function(n){switch(r(t.onPlayStateChange)&&t.onPlayStateChange(n.newState,n.oldState),n.newState){case e.STATES.END:mbox.CONF.autoNext?(i.autoNext(),a.play()):e.stop()}}),i.addEventListener("change:curSong",function(i){e.stop(),(a.curSong=i.curSong)?a.playList.fetchLink({success:function(e){r(t.onChangeCurSong)&&t.onChangeCurSong(e),a.dispatchEvent("fetch:link",{song:e})},error:function(e){r(t.onChangeCurSong)&&t.onChangeCurSong(null,e)}}):r(t.onChangeCurSong)&&t.onChangeCurSong(null)}),i.addSong(s),this.playList.setCurIndex(0),(void 0!==t.autoPlay?t.autoPlay:mbox.CONF.autoPlay)&&this.play()},getCurSong:function(){return this.curSong},getTotalTime:function(){return this.curSong&&1e3*this.curSong.time||this.player.getTotalTime()},setPlayIndex:function(t,e){this.playList.setCurIndex(t),e&&this.play()},play:function(){if(this.curSong&&this.curSong.songLink)this.curSong.songLink!==this.player.getUrl()&&(this.player.reset(),this.player.setUrl(this.curSong.songLink)),this.player.play();else{var t=this;this.addEventListener("fetch:link",function(e){if(!e.song)throw"fetch songLink fail";t.player.setUrl(e.song.songLink),t.player.play(),t.removeEventListener("fetch:link.link")},"link")}},pause:function(){this.player.pause()},stop:function(){this.player.stop()},exportAPI:function(){var t=this,e=this.player.EVENTS;return{getCurSong:function(){return t.curSong},getTotalTime:function(){return t.totalTime},getPlayerState:function(){return t.player.getState()},getPosition:function(){return t.player.getPosition()},getProgress:function(){return t.player.getProgress()},play:function(){t.play.apply(t,arguments)},pause:function(){t.pause()},stop:function(){t.stop()},listenToStateChange:function(i){t.player.setEventListener(e.STATECHANGE,i)},listenToPosChange:function(i){t.player.setEventListener(e.POSITIONCHAGNE,i)},listenToLoadedPercentChange:function(i){t.player.setEventListener(e.PROGRESS,i)},getCurIndex:function(){return t.playList.getCurIndex()},addSong:function(e){var i=T.lang.toArray(e);i.length&&"object"!=typeof i[0]&&(i=mbox.SongDataModel.createSongModel(i)),t.playList.addSong(i)},removeSong:function(e){t.playList.removeSong(e)},setPlayIndex:function(e,i){this.setPlayIndex.call(t,e,i)},setPlayMode:function(e){t.playList.setMode(e)}}}}),mbox.uiConf={prefix:"mbox",allWidget:["slider","time","volume","mute","title","lrc","album","playList","playBtn"],tpl:'<div class="mbox">                <div class="logo" ><a href="http://music.baidu.com" target="_blank" title="\u767E\u5EA6\u97F3\u4E50"></a></div>                <div class="player-main">                    <div class="album-pic mbox-album">                        <img class="pic" data-src="<%=songPicSmall%>"/>                    </div>                    <div class="right-wrapper">                        <div class="right-top">                            <div class="mbox-title player-title">                                <div class="song-name song-info" songid="<%=songId%>"><a href="http://music.baidu.com/song/<%=songId%>" target="_blank"><%=songName%></a></div>                                <span class="artist song-info">\u6B4C\u624B\uFF1A<span class="artist-name"><%var i =0, len = all_artist.length; for(;len -i; i++){%>                                    <a href="<%=all_artist_link[i]%>" target="_blank"><%=all_artist[i]%></a><%};%></span></span>                                <span class="album song-info">\u4E13\u8F91\uFF1A<span class="album-name"><a href="<%=albumLink%>" target="_blank"><%=albumName%></a></span></span>                                <span class="source song-info">\u6765\u6E90\uFF1A<span class="link-source"><a href="javascript:void(0)"></a></span></span>                                <div class="lrc"></div>                            </div>                            <div class="button-wrapper">                                <a class="button add-favour" href="javascript:void(0)" onclick="return false;" title="\u70B9\u51FB\u6536\u85CF"></a>                                <a class="button lrc-btn" href="javascript:void(0)" target="_blank" onclick="return false;" title="\u67E5\u770B\u5168\u90E8\u6B4C\u8BCD"></a>                                <a class="button download-btn" href="javascript:void(0)" target="_blank" onclick="return false;" title="\u4E0B\u8F7D\u6B4C\u66F2"></a>                                <a class="button go-to-listen-btn" href="javascript:void(0)" target="_blank" onclick="return false;" title="\u5F39\u51FA\u64AD\u653E"></a>                            </div>                        </div>                        <div class="bottom-bars">                            <div class="bottom-bars-item mbox-playBtn ctrl-btn stop"><a href="javascript:void(0)" onclick="return false;"></a></div>                            <div class="bottom-bars-item  progress "><div class="slider-wrapper mbox-slider"></div></div>                            <div class="bottom-bars-item mbox-time time"><%=curTime%>/<%=totalTime%></div>                            <div class="bottom-bars-item volume">                                <a class="volume-btn mbox-mute" href="javascript:void(0)" onclick="return false;"  title="">&nbsp</a>                                <div class="slider-wrapper mbox-volume"></div>                            </div>                        </div>                    </div>                </div>                </div>'},function(t){var e="undefined"==typeof module?t.baidu=t.baidu||{}:module.exports;e.template=function(e,n){var s=function(){if(!t.document)return i._compile(e);var n=document.getElementById(e);if(n){if(i.cache[e])return i.cache[e];var s=/^(textarea|input)$/i.test(n.nodeName)?n.value:n.innerHTML;return i._compile(s)}return i._compile(e)}(),a=i._isObject(n)?s(n):s;return s=null,a};var i=e.template;i.versions=i.versions||[],i.versions.push("1.0.6"),i.cache={},i.LEFT_DELIMITER=i.LEFT_DELIMITER||"<%",i.RIGHT_DELIMITER=i.RIGHT_DELIMITER||"%>",i.ESCAPE=!0,i._encodeHTML=function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\/g,"&#92;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},i._encodeReg=function(t){return String(t).replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")},i._encodeEventHTML=function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/\\\\/g,"\\").replace(/\\\//g,"/").replace(/\\n/g,"\n").replace(/\\r/g,"\r")},i._compile=function(t){var e="var _template_fun_array=[];\nvar fn=(function(__data__){\nvar _template_varName='';\nfor(name in __data__){\n_template_varName+=('var '+name+'=__data__[\"'+name+'\"];');\n};\neval(_template_varName);\n_template_fun_array.push('"+i._analysisStr(t)+"');\n_template_varName=null;\n})(_template_object);\nfn = null;\nreturn _template_fun_array.join('');\n";return new Function("_template_object",e)},i._isObject=function(t){return"function"==typeof t||!(!t||"object"!=typeof t)},i._analysisStr=function(t){var e=i.LEFT_DELIMITER,n=i.RIGHT_DELIMITER,s=i._encodeReg(e),a=i._encodeReg(n);return t=String(t).replace(new RegExp("("+s+"[^"+a+"]*)//.*\n","g"),"$1").replace(new RegExp("<!--.*?-->","g"),"").replace(new RegExp(s+"\\*.*?\\*"+a,"g"),"").replace(new RegExp("[\\r\\t\\n]","g"),"").replace(new RegExp(s+"(?:(?!"+a+")[\\s\\S])*"+a+"|((?:(?!"+s+")[\\s\\S])+)","g"),function(t,e){var i="";if(e)for(i=e.replace(/\\/g,"&#92;").replace(/'/g,"&#39;");/<[^<]*?&#39;[^<]*?>/g.test(i);)i=i.replace(/(<[^<]*?)&#39;([^<]*?>)/g,"$1\r$2");else i=t;return i}),t=t.replace(new RegExp("("+s+"[\\s]*?var[\\s]*?.*?[\\s]*?[^;])[\\s]*?"+a,"g"),"$1;"+n).replace(new RegExp("("+s+":?[hvu]?[\\s]*?=[\\s]*?[^;|"+a+"]*?);[\\s]*?"+a,"g"),"$1"+n).split(e).join("	"),t=i.ESCAPE?t.replace(new RegExp("\\t=(.*?)"+a,"g"),"',typeof($1) === 'undefined'?'':baidu.template._encodeHTML($1),'"):t.replace(new RegExp("\\t=(.*?)"+a,"g"),"',typeof($1) === 'undefined'?'':$1,'"),t=t.replace(new RegExp("\\t:h=(.*?)"+a,"g"),"',typeof($1) === 'undefined'?'':baidu.template._encodeHTML($1),'").replace(new RegExp("\\t(?::=|-)(.*?)"+a,"g"),"',typeof($1)==='undefined'?'':$1,'").replace(new RegExp("\\t:u=(.*?)"+a,"g"),"',typeof($1)==='undefined'?'':encodeURIComponent($1),'").replace(new RegExp("\\t:v=(.*?)"+a,"g"),"',typeof($1)==='undefined'?'':baidu.template._encodeEventHTML($1),'").split("	").join("');").split(n).join("_template_fun_array.push('").split("\r").join("\\'")}}(window),function(t,e){t.widget&&"function"===t.widget&&(t.box_widget=t.widget);var i=0,n=Array.prototype.slice,s=t.cleanData;t.cleanData=function(e){for(var i,n=0;null!=(i=e[n]);n++)try{t(i).triggerHandler("remove")}catch(a){}s(e)},t.box_widget=function(e,i,n){var s,a,r,o,u=e.split(".")[0];e=e.split(".")[1],s=u+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][s.toLowerCase()]=function(e){return!!t.data(e,s)},t[u]=t[u]||{},a=t[u][e],r=t[u][e]=function(t,e){return this._createWidget?(arguments.length&&this._createWidget(t,e),void 0):new r(t,e)},t.extend(r,a,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),o=new i,o.options=t.box_widget.extend({},o.options),t.each(n,function(e,s){t.isFunction(s)&&(n[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},n=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,a=this._superApply;return this._super=t,this._superApply=n,e=s.apply(this,arguments),this._super=i,this._superApply=a,e}}())}),r.prototype=t.box_widget.extend(o,{widgetEventPrefix:e},n,{constructor:r,namespace:u,widgetName:e,widgetBaseClass:s,widgetFullName:s}),a?(t.each(a._childConstructors,function(e,i){var n=i.prototype;t.box_widget(n.namespace+"."+n.widgetName,r,i._proto)}),delete a._childConstructors):i._childConstructors.push(r),t.box_widget.bridge(e,r)},t.box_widget.extend=function(i){for(var s,a,r=n.call(arguments,1),o=0,u=r.length;u>o;o++)for(s in r[o])a=r[o][s],r[o].hasOwnProperty(s)&&a!==e&&(i[s]=t.isPlainObject(a)?t.box_widget.extend({},i[s],a):a);return i},t.box_widget.bridge=function(i,s){var a=s.prototype.widgetFullName;t.fn[i]=function(r){var o="string"==typeof r,u=n.call(arguments,1),l=this;return r=!o&&u.length?t.box_widget.extend.apply(null,[r].concat(u)):r,o?this.each(function(){var n,s=t.data(this,a);return s?t.isFunction(s[r])&&"_"!==r.charAt(0)?(n=s[r].apply(s,u),n!==s&&n!==e?(l=n&&n.jquery?l.pushStack(n.get()):n,!1):void 0):t.error("no such method '"+r+"' for "+i+" widget instance"):t.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+r+"'")}):this.each(function(){var e=t.data(this,a);e?e.option(r||{})._init():new s(r,this)}),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.box_widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetName,this),t.data(n,this.widgetFullName,this),this._on({remove:"destroy"}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(i,n){var s,a,r,o=i;if(0===arguments.length)return t.box_widget.extend({},this.options);if("string"==typeof i)if(o={},s=i.split("."),i=s.shift(),s.length){for(a=o[i]=t.box_widget.extend({},this.options[i]),r=0;r<s.length-1;r++)a[s[r]]=a[s[r]]||{},a=a[s[r]];if(i=s.pop(),n===e)return a[i]===e?null:a[i];a[i]=n}else{if(n===e)return this.options[i]===e?null:this.options[i];o[i]=n}return this._setOptions(o),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,i){i?(e=t(e),this.bindings=this.bindings.add(e)):(i=e,e=this.element);var n=this;t.each(i,function(i,s){function a(){return n.options.disabled===!0||t(this).hasClass("ui-state-disabled")?void 0:("string"==typeof s?n[s]:s).apply(n,arguments)}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||t.guid++);var r=i.match(/^(\w+)\s*(.*)$/),o=r[1]+n.eventNamespace,u=r[2];u?n.widget().delegate(u,o,a):e.bind(o,a)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function i(){return("string"==typeof t?n[t]:t).apply(n,arguments)}var n=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var s,a,r=this.options[e];if(n=n||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(s in a)s in i||(i[s]=a[s]);return this.element.trigger(i,n),!(t.isFunction(r)&&r.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(n,s,a){"string"==typeof s&&(s={effect:s});var r,o=s?s===!0||"number"==typeof s?i:s.effect||i:e;s=s||{},"number"==typeof s&&(s={duration:s}),r=!t.isEmptyObject(s),s.complete=a,s.delay&&n.delay(s.delay),r&&t.effects&&(t.effects.effect[o]||t.uiBackCompat!==!1&&t.effects[o])?n[e](s):o!==e&&n[o]?n[o](s.duration,s.easing,a):n.queue(function(i){t(this)[e](),a&&a.call(n[0]),i()})}}),t.uiBackCompat!==!1&&(t.Widget.prototype._getCreateOptions=function(){return t.metadata&&t.metadata.get(this.element[0])[this.widgetName]})}(jQuery),function(t){var e=!1;t(document).mouseup(function(){e=!1}),t.box_widget("ui.box_mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!e){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var n=this,s=1==i.which,a="string"==typeof this.options.cancel&&i.target.nodeName?t(i.target).closest(this.options.cancel).length:!1;return s&&!a&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===t.data(i.target,this.widgetName+".preventClickEvent")&&t.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return n._mouseMove(t)},this._mouseUpDelegate=function(t){return n._mouseUp(t)},t(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),e=!0,!0)):!0}},_mouseMove:function(e){return!t.browser.msie||document.documentMode>=9||e.button?this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted):this._mouseUp(e)},_mouseUp:function(e){return t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target==this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(t){var e=5;t.box_widget("ui.box_slider",t.ui.box_mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",progressbar:!1,progress:0,constraintProgress:!1,range:!1,step:1,value:0,values:null},_create:function(){var i=this,n=this.options,s=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),a="<a class='ui-slider-handle ui-state-default ui-corner-all' hidefocus='true'><span></span></a>",r=n.values&&n.values.length||1,o=[];this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(n.disabled?" ui-slider-disabled ui-disabled":"")),this.range=t([]),n.range&&(n.range===!0&&(n.values||(n.values=[this._valueMin(),this._valueMin()]),n.values.length&&2!==n.values.length&&(n.values=[n.values[0],n.values[0]])),this.range=t("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===n.range||"max"===n.range?" ui-slider-range-"+n.range:""))),n.progressbar&&(this.progressbar=t("<div></div>").appendTo(this.element).addClass("ui-slider-progressbar ui-widget-header"));for(var u=s.length;r>u;u+=1)o.push(a);this.handles=s.add(t(o.join("")).appendTo(i.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(t){t.preventDefault()}).hover(function(){n.disabled||t(this).addClass("ui-state-hover ui-slider-handle-hover")},function(){t(this).removeClass("ui-state-hover ui-slider-handle-hover")}).focus(function(){n.disabled?t(this).blur():(t(".ui-slider .ui-state-focus").removeClass("ui-state-focus ui-slider-handle-focus"),t(this).addClass("ui-state-focus ui-slider-handle-focus"))}).blur(function(){t(this).removeClass("ui-state-focus ui-slider-handle-focus")}),this.handles.each(function(e){t(this).data("index.ui-slider-handle",e)}),this.handles.keydown(function(n){var s,a,r,o,u=t(this).data("index.ui-slider-handle");if(!i.options.disabled){switch(n.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(n.preventDefault(),!i._keySliding&&(i._keySliding=!0,t(this).addClass("ui-state-active ui-slider-handle-active"),s=i._start(n,u),s===!1))return}switch(o=i.options.step,a=r=i.options.values&&i.options.values.length?i.values(u):i.value(),n.keyCode){case t.ui.keyCode.HOME:r=i._valueMin();break;case t.ui.keyCode.END:r=i._valueMax();break;case t.ui.keyCode.PAGE_UP:r=i._trimAlignValue(a+(i._valueMax()-i._valueMin())/e);break;case t.ui.keyCode.PAGE_DOWN:r=i._trimAlignValue(a-(i._valueMax()-i._valueMin())/e);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(a===i._valueMax())return;r=i._trimAlignValue(a+o);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(a===i._valueMin())return;r=i._trimAlignValue(a-o)}i._slide(n,u,r)}}).keyup(function(e){var n=t(this).data("index.ui-slider-handle");i._keySliding&&(i._keySliding=!1,i._stop(e,n),i._change(e,n),t(this).removeClass("ui-state-active ui-slider-handle-active"))}),this._refreshValue(),this._refreshProgress(),this._animateOff=!1},destroy:function(){return this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"),this._mouseDestroy(),this},_mouseCapture:function(e){var i,n,s,a,r,o,u,l,h,d=this.options;return d.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(i),s=this._valueMax()-this._valueMin()+1,r=this,this.handles.each(function(e){var i=Math.abs(n-r.values(e));
s>i&&(s=i,a=t(this),o=e)}),d.range===!0&&this.values(1)===d.min&&(o+=1,a=t(this.handles[o])),u=this._start(e,o),u===!1?!1:(this._mouseSliding=!0,r._handleIndex=o,a.addClass("ui-state-active ui-slider-handle-active").focus(),l=a.offset(),h=!t(e.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=h?{left:0,top:0}:{left:e.pageX-l.left-a.width()/2,top:e.pageY-l.top-a.height()/2-(parseInt(a.css("borderTopWidth"),10)||0)-(parseInt(a.css("borderBottomWidth"),10)||0)+(parseInt(a.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,o,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active ui-slider-handle-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,n,s,a;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),n=i/e,n>1&&(n=1),0>n&&(n=0),"vertical"===this.orientation&&(n=1-n),s=this._valueMax()-this._valueMin(),a=this._valueMin()+n*s,this._trimAlignValue(a)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var n,s,a;this.options.values&&this.options.values.length?(n=this.values(e?0:1),2===this.options.values.length&&this.options.range===!0&&(0===e&&i>n||1===e&&n>i)&&(i=n),i!==this.values(e)&&(s=this.values(),s[e]=i,a=this._trigger("slide",t,{handle:this.handles[e],value:i,values:s}),n=this.values(e?0:1),a!==!1&&this.values(e,i,!0))):i!==this.value()&&(a=this._trigger("slide",t,{handle:this.handles[e],value:i}),a!==!1&&this.value(i))},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("change",t,i)}},_progress:function(t){var e={progress:this.options.progress};this._trigger("progress",t,e)},progress:function(t){var e=this._trimAlignProgress(t);return arguments.length&&this.options.progress!=e?(this.options.progress=e,this._refreshProgress(),this._progress(null),this.options.constraintProgress&&this.value()>e&&this.value(e),void 0):this.options.progress},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(e,i){var n,s,a;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),this._change(null,e),void 0;if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(n=this.options.values,s=arguments[0],a=0;a<n.length;a+=1)n[a]=this._trimAlignValue(s[a]),this._change(null,a);this._refreshValue()},_setOption:function(e,i){var n,s=0;switch(t.isArray(this.options.values)&&(s=this.options.values.length),t.Widget.prototype._setOption.apply(this,arguments),e){case"disabled":i?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover ui-slider-handle-hover"),this.handles.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this._refreshProgress();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=0;s>n;n+=1)this._change(null,n);this._animateOff=!1;break;case"progress":this._refreshProgress(),this._progress(null),this.options.constraintProgress&&this.options.value>this.options.progress&&(this._animateOff=!0,this.value(this.options.progress),this._animateOff=!1);break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._refreshProgress(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,n;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);for(i=this.options.values.slice(),n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(i[n]);return i},_trimAlignValue:function(t){if(t<=this._valueMin())return this._valueMin();if(!this.options.constraintProgress&&t>=this._valueMax())return this._valueMax();this.options.progressbar&&this.options.constraintProgress&&t>=this.options.progress&&(t=this.options.progress);var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,n=t-i;return 2*Math.abs(i)>=e&&(n+=i>0?e:-e),parseFloat(n.toFixed(5))},_trimAlignProgress:function(t){return t<=this._valueMin()?this._valueMin():t>=this._valueMax()?this._valueMax():t},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var e,i,n,s,a,r=this.options.range,o=this.options,u=this,l=this._animateOff?!1:o.animate,h={};this.options.values&&this.options.values.length?this.handles.each(function(n){e=(u.values(n)-u._valueMin())/(u._valueMax()-u._valueMin())*100,h["horizontal"===u.orientation?"left":"bottom"]=e+"%",t(this).stop(1,1)[l?"animate":"css"](h,o.animate),u.options.range===!0&&("horizontal"===u.orientation?(0===n&&u.range.stop(1,1)[l?"animate":"css"]({left:e+"%"},o.animate),1===n&&u.range[l?"animate":"css"]({width:e-i+"%"},{queue:!1,duration:o.animate})):(0===n&&u.range.stop(1,1)[l?"animate":"css"]({bottom:e+"%"},o.animate),1===n&&u.range[l?"animate":"css"]({height:e-i+"%"},{queue:!1,duration:o.animate}))),i=e}):(n=this.value(),s=this._valueMin(),a=this._valueMax(),e=a!==s?(n-s)/(a-s)*100:0,h["horizontal"===u.orientation?"left":"bottom"]=e+"%",this.handle.stop(1,0)[l?"animate":"css"](h,o.animate),"min"===r&&"horizontal"===this.orientation&&this.range.stop(1,0)[l?"animate":"css"]({width:e+"%"},o.animate),"max"===r&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-e+"%"},{queue:!1,duration:o.animate}),"min"===r&&"vertical"===this.orientation&&this.range.stop(1,0)[l?"animate":"css"]({height:e+"%"},o.animate),"max"===r&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-e+"%"},{queue:!1,duration:o.animate}))},_refreshProgress:function(){var t=this.options,e=this._valueMax(),i=t.progress,n=i/e*100;this.progressbar&&("horizontal"===this.orientation?this.progressbar.css({width:n+"%"}):this.progressbar.css({height:n+"%"}))},setLoading:function(t,e){var i;arguments.length<=1?(e=t,i=this.handle):i=this.handles.eq(t),i[e?"addClass":"removeClass"]("ui-slider-handle-loading")}}),t.extend(t.ui.box_slider,{version:"1.8.20"})}(jQuery),function(t){t.cutString=function(t,e,i){var n,s,a,r=t.length,o=0,u=0;for(s=0;r>s;s++)if(o+=t.charCodeAt(s)>128?2:1,o>e){n=t.substring(0,s-1)+"...";break}for(a=r;a>0;a--){if(s>=a||0===i)return n;if(u+=t.charCodeAt(s)>128?2:1,u>i)return n+=t.substring(a)}return t}}(jQuery),mbox.UiCtrl=mbox.lang.createClass(function(t,e){this.guid="mbox_ui_"+setTimeout(function(){},0),this.conf=e||mbox.uiConf,this.conf&&(this.widget={},this._init(t),this.EVENTS={POSITIONCHANGE:"ui_poschange",TOGGLEPLAY:"ui_toggleplay",VOLCHANGE:"ui_volchange",MUTECHANGE:"ui_mutechange"},this.volume=80,this.$root=$(t),this.active=!1)}).extend({_init:function(t){if(this.conf.tpl){for(var e=$(this.conf.tpl).appendTo(t||"body").css("display","none"),i=this.conf.allWidget,n=this.conf.prefix,s={},a=i.length-1;a>-1;a--){var r=e.find("."+n+"-"+i[a]),o=r.html();o=o&&o.replace(/&lt;%/g,"<%").replace(/%&gt;/g,"%>"),s[i[a]]={dom:r,tpl:o}}this.conf.domJson=s,e.css("display","block"),this.$root=e}var u=this.conf.domJson;for(var l in u)if(u.hasOwnProperty(l))switch(l){case"slider":this._initSlider(u[l]);break;case"volume":this.widget[l]=$(u[l].dom).box_slider({animate:!0,max:100,min:0,orientation:"horizental",progressbar:!1,range:"min",value:80}).bind("slide",T.fn.bind(function(t,e){this.active&&this.fireVolChange(+e.value,0===+e.value)},this)).bind("slidestop",T.fn.bind(function(){this.active||this.widget.volume.box_slider("option","value",this.volume)},this));break;case"mute":var h=this;this.widget[l]=$(u[l].dom).click(function(){var t=$(this).hasClass("mute");h.fireVolChange(h.volume,!t)});break;case"title":case"time":case"playList":case"album":this.widget[l]=$(u[l].dom),this.widget[l].tpl=u[l].tpl;break;case"playBtn":this.widget[l]=$(u[l].dom).bind("click",T.fn.bind(function(){var t=this.widget.playBtn.hasClass("stop");this.dispatchEvent(this.EVENTS.TOGGLEPLAY,{isPlay:t})},this))}this.conf.tpl&&this.tplToHtml()},_initSlider:function(t){var e=t.maxValue||1e4;this.widget.slider=$(t.dom).box_slider({animate:175,max:e,min:0,orientation:"horizontal",progressbar:!0,progress:0,constraintProgress:!0,range:"min",value:0}),this.widget.slider.maxValue=e,this.widget.slider.sliding=!1;var i=this;this.widget.slider.bind("slidestart",function(){i.widget.slider.isSliding=!0}).bind("slidestop",function(t,e){i.widget.slider.isSliding=!1,i.dispatchEvent(i.EVENTS.POSITIONCHANGE,{percent:e.value/i.widget.slider.maxValue}),!i.active&&i.widget.slider.box_slider("option","value",0)})},tplToHtml:function(t,e,i,n){function s(t){$(e).delegate("."+t,"click",function(){n.sendLog("click",n.logUrl,{pos:i[t]})})}if(this.widget.title){var a=this.createSongFilter(t);a.songName&&"\u8BE5\u6B4C\u66F2\u5DF2\u4E0B\u67B6"!==a.songName?this.widget.title.removeClass("grey"):this.widget.title.addClass("grey"),this.widget.title.html(baidu.template(this.widget.title.tpl,a))}if(this.widget.lrc&&this.widget.lrc.lrc("setLrc",""),this.widget.album){this.widget.album.html(baidu.template(this.widget.album.tpl,t));var r=this.widget.album.find("img");if(!r[0].src){var o=r.attr("data-src");o&&r.attr("src",o)}}this.widget.time&&this.widget.time.html(baidu.template(this.widget.time.tpl,{curTime:mbox.convertTime(0),totalTime:mbox.convertTime(0)}));for(var u in i)s(u)},fireVolChange:function(t,e){return this.active?(this.volume=t,e?(this.widget.mute&&this.widget.mute.addClass("mute").attr("title","\u53D6\u6D88\u9759\u97F3"),this.widget.volume&&this.widget.volume.box_slider("option","value",0)):(this.widget.mute&&this.widget.mute.removeClass("mute").attr("title","\u9759\u97F3"),this.widget.volume&&this.widget.volume.box_slider("option","value",this.volume)),this.dispatchEvent(this.EVENTS.VOLCHANGE,{volume:t}),this.dispatchEvent(this.EVENTS.MUTECHANGE,{mute:e}),!0):!1},setActive:function(t){this.active=t,this.$root[t?"addClass":"removeClass"]("active")},setShowLink:function(t,e){var i=t.showLink,n=i?$.cutString(i,16,5):"";("2"==t.resourceType.toString()||void 0===t.resourceType)&&($(e).find(".link-source").text(n).attr("href",i),$(e).find(".source").show())},createSongFilter:function(t){var e,i,n=[],s=[],a=[];if(t){e="http://music.baidu.com/",n=t.artistId.toString().split(","),s=t.artistName.split(","),a=[];for(var r=0,o=s.length;o>r;r++)a[r]=n[r]?e+"artist/"+n[r]:"javascript:;";i={songId:t.songId,songName:t.songName||"\u8BE5\u6B4C\u66F2\u5DF2\u4E0B\u67B6",albumId:t.albumId,albumLink:t.albumId?e+"album/"+t.albumId:"javascript:;",albumName:t.albumName,all_artist:s,all_artist_id:n,all_artist_link:a}}else i={songId:"",songName:"",albumId:"",albumLink:"",albumName:"",all_artist:s,all_artist_id:n,all_artist_link:a};return i}}),function(){var t=function(t,e){if([].indexOf)return[].indexOf.call(t,e);for(var i=t.length-1;i>-1;i--)if(t[i]===e)return i;return-1};mbox.Controller=function(t){this.playctrl=t,this.uiList=[]},mbox.Controller.prototype={_init:function(){},bindUi:function(e,i){if(t(this.uiList,e)>-1||!e)return!1;if(i&&this.uiList.length>0)for(var n=this.uiList.length;n;n--)this.unbindUi(this.uiList[n-1]),this.uiList.splice(n-1,1);this.bindPlayerEvent(this.playctrl,e),this.bindSongInfoEvent(this.playctrl,e),this.bindPlayListEvent(this.playctrl,e),this.bindUIEvent(this.playctrl,e),this.uiList.push(e);var s=this.playctrl.player;return this._onPosition(e,s.getCurrentPosition()),this._onProgress(e,s.getLoadedPercent()),this._onState(e,s.getState()),e.setActive(!0),e.fireVolChange(e.volume,!e.volume),!0},unbindUi:function(t){var e,i=playctrl.player,n=t.guid,s=i.EVENTS,a=t.EVENTS;for(e in s)s.hasOwnProperty(e)&&i.removeEventListener(s[e]+"."+n);for(e in a)a.hasOwnProperty(e)&&t.removeEventListener(a[e]+"."+n);playctrl.removeEventListener("fetch:link."+n),t.setActive(!1)},bindPlayListEvent:function(){},bindPlayerEvent:function(t,e){var i=t.player,n=e.guid;i.setEventListener(i.EVENTS.POSITIONCHANGE,T.fn.bind(function(t){this._onPosition(e,t.position)},this),n),i.setEventListener(i.EVENTS.PROGRESS,T.fn.bind(function(t){this._onProgress(e,t.progress)},this),n),i.setEventListener(i.EVENTS.STATECHANGE,T.fn.bind(function(t){this._onState(e,t.newState)},this),n)},bindSongInfoEvent:function(t,e){t.addEventListener("fetch:link",T.fn.bind(function(t){this._onSongInfo(e,t.song)},this),e.guid)},bindUIEvent:function(t,e){var i=t.player;e.addEventListener(e.EVENTS.POSITIONCHANGE,function(e){i.setCurrentPosition(t.getTotalTime()*e.percent)},e.guid),e.addEventListener(e.EVENTS.VOLCHANGE,function(t){i.setVolume(t.volume)},e.guid),e.addEventListener(e.EVENTS.TOGGLEPLAY,function(e){t.player[e.isPlay?"play":"pause"]()},e.guid),e.addEventListener(e.EVENTS.MUTECHANGE,function(t){i.setMute(t.mute)},e.guid)},_onSongInfo:function(t,e){if(t.widget.title){var i=t.createSongFilter(e);i.songName&&"\u8BE5\u6B4C\u66F2\u5DF2\u4E0B\u67B6"!==i.songName?t.widget.title.removeClass("grey"):t.widget.title.addClass("grey"),t.widget.title.html(baidu.template(t.widget.title.tpl,i))}if(t.widget.lrc&&e&&mbox.SongDataModel.getLrcContent(e,{success:function(e){t.widget.lrc.lrc("setLrc",e)},error:function(){t.widget.lrc.lrc("setLrc","")}}),t.widget.album){t.widget.album.html(baidu.template(t.widget.album.tpl,e));var n=t.widget.album.find("img");if(!n[0].src){var s=n.attr("data-src");s&&n.attr("src",s)}}if(t.widget.time){var a=this.playctrl.getTotalTime();t.widget.time.html(baidu.template(t.widget.time.tpl,{curTime:mbox.convertTime(0),totalTime:mbox.convertTime(a)}))}},_onPosition:function(t,e){var i=this.playctrl.getTotalTime();t.widget.slider&&!t.widget.slider.isSliding&&t.widget.slider.box_slider("option","value",e*t.widget.slider.maxValue/i||0),t.widget.lrc&&t.widget.lrc.lrc("scrollTo",e),t.widget.time&&t.widget.time.html(baidu.template(t.widget.time.tpl,{curTime:mbox.convertTime(e),totalTime:mbox.convertTime(i)}))},_onProgress:function(t,e){t.widget.slider&&!t.widget.slider.sliding&&t.widget.slider.box_slider("progress",e*t.widget.slider.maxValue)},_onState:function(t,e){if(t.widget.playBtn){var i=this.playctrl.player;playing=e===i.STATES.PLAY||e===i.STATES.PREBUFFER||e===i.STATES.BUFFERING,playing?t.widget.playBtn.removeClass("stop"):t.widget.playBtn.addClass("stop")}}}}(window);
;_.Module.define({path:"common/widget/MusicPlayer",requires:[],sub:{initial:function(t,i){window.playctrl||(window.playctrl=new window.mbox.PlayCtrl),this.api=window.playctrl.exportAPI(),this.log=window.playctrl.log,this.controller=new window.mbox.Controller(window.playctrl),this.logList={"song-name a":"song_title","artist-name a":"artist_name","album-name a":"album_name",logo:"logo","lrc-btn":"lrc","download-btn":"download","go-to-listen-btn":"to_musicbox"},this.ui=[];for(var o=0;o<t.length;o++)this.mboxInit(i[o],t[o],o);this.eventInit()},mboxInit:function(t,i,o){var n=this.ui,e=this.logList,a=this.log,l=this.api,s=this.controller;if(n[o]=new window.mbox.UiCtrl($(t)),"object"!=typeof i){var r=window.mbox.SongDataModel.createSongModel(i);window.mbox.SongDataModel.fetchSong(r[0],{success:function(i){n[o].tplToHtml(i,t,e,a),n[o].setShowLink(i,t)}})}else 1!=i.hasLink&&(i={hasLink:!0,songId:i.song_id,songName:i.title,artistId:i.ting_uid,artistName:i.author,albumId:i.album_id,albumName:i.album_title,songPicBig:i.pic_big,songPicSmall:i.pic_small,songPicRadio:i.pic_radio,resourceType:i.resource_type,relateStatus:i.relate_status,copyType:i.copy_type,lrcLink:i.lrclink,rate:i.file_bitrate,songLink:i.file_link,showLink:i.show_link,format:i.file_extension,size:i.file_size,time:i.file_duration}),n[o].tplToHtml(i,t,e,a),n[o].setShowLink(i,t);l.addSong(i),$(t).find(".ctrl-btn").click(function(){function i(t){return function(){s.bindUi(n[t],!0),l.setPlayIndex(t,!0)}}if($(t).find(".mbox-time").addClass("red_text"),!n[o].$root.hasClass("active")){window.playctrl.player.stop();var e=i(o);setTimeout(e,100)}})},eventInit:function(){$(document).delegate(".add-favour","click",function(){var t=this,i=$(this).parents(".right-top").find($(".song-name")).tbattr("songid"),o="http://tingapi.ting.baidu.com/v1/restserver/ting?method=baidu.ting.favorite.addSongFavorite&from=tieba";$.getJSON(o+"&callback=?",{songId:i},function(i){var o=i.error_code;22e3===o||22322===o?$(t).addClass("add-favour-red"):22452===o&&_.Module.use("common/widget/LoginDialog",["",""])})}).delegate(".lrc-btn","click",function(){var t=$(this).parents(".right-top").find($(".song-name")).tbattr("songid");window.open("http://music.baidu.com/song/"+t+"#song_lyric")}).delegate(".download-btn","click",function(){var t=$(this).parents(".right-top").find($(".song-name")).tbattr("songid");window.open("http://music.baidu.com/song/"+t+"/download")}).delegate(".go-to-listen-btn","click",function(){var t=$(this).parents(".right-top").find($(".song-name")).tbattr("songid");window.open("http://music.baidu.com//box?&&__methodName=mboxCtrl.playSong&__argsValue="+t)})}}});_.Module.define({path:"frs/widget/pic_sliding_window",sub:{_windowWidth:0,_jq_picsWrap:null,_jq_pics:null,_speed:"fast",_easing:"swing",initial:function(i){try{this._windowWidth=i.windowWidth,this._jq_pics=i.jq_pics,this._jq_picsWrap=i.jq_picsWrap,this._speed=i.speed||this._speed,this._easing=i.easing||this._easing}catch(s){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"frs:widget/pic_sliding_window/pic_sliding_window.js",method:"",ln:15}),s}},slideNext:function(){for(var i=this._jq_picsWrap.position(),s=i.left,t=-s+this._windowWidth,e=0,_=0,p=!1,h=this._jq_pics.size(),n=0;h>n;n++){var d=$(this._jq_pics.get(n)),a=d.position(),o=a.left,r=d.width(),c=o+r;if(c>t){e=n,_=o;break}}this._windowWidth+_>this._jq_picsWrap.width()&&(_=this._jq_picsWrap.width()-this._windowWidth,p=!0),_>0&&(this._jq_picsWrap.animate({left:-_+"px"},this._speend,this._easing),p&&this.trigger("lastend"))},slidePrev:function(){for(var i=this._jq_picsWrap.position(),s=i.left,t=-s,e=0,_=-1,p=!1,h=this._jq_pics.size(),n=0;h>n;n++){var d=$(this._jq_pics.get(n)),a=d.position(),o=d.width(),r=a.left,c=r+o;if(r>=t){t=c-this._windowWidth,0>t&&(t=0),e=n;break}}for(var n=e;n>=0;n--){var d=$(this._jq_pics.get(n)),a=d.position(),o=d.width(),r=a.left,c=r+o;if(t>=r||0==n){e=n,_=r;break}}p=0==_,_>=0&&(this._jq_picsWrap.animate({left:-_+"px"},this._speend,this._easing),p&&this.trigger("firstend"))}}});_.Module.define({path:"frs/widget/thread_media_list_bright",requires:["frs/widget/pic_sliding_window"],sub:{_jq_wrap:null,_jq_innerWrap:null,_jq_mediaListWrap:null,_slidingWindow:null,_jq_prevBtn:null,_jq_nextBtn:null,_options:{},initial:function(i,t){try{this._jq_wrap=i,this._jq_innerWrap=i.find(".j_small_list"),this._jq_prevBtn=i.find(".j_small_pic_pre"),this._jq_nextBtn=i.find(".j_small_pic_next"),this._jq_mediaListWrap=i.find(".j_threadlist_media"),null!=t&&(this._options=$.extend(this._options,t)),this._slidingWindow=this.use("frs/widget/pic_sliding_window",{windowWidth:this._jq_innerWrap.width(),jq_pics:this._jq_mediaListWrap.find("li"),jq_picsWrap:this._jq_mediaListWrap}),this._initBtn(),this._bindEvents()}catch(n){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message||n.description,path:"frs:widget/thread_media_list_bright/thread_media_list_bright.js",method:"",ln:31}),n}},_initBtn:function(){var i=this,t=this._jq_wrap.width();this._jq_mediaListWrap.css("float","left");setTimeout(function(){i._jq_mediaListWrap.find(".j_m_pic").load(function(){i._showBtn(t)}),i._showBtn(t)},500)},_showBtn:function(i){!this._jq_nextBtn.showed&&this._jq_mediaListWrap.width()-10>i&&(this._jq_nextBtn.show(),this._jq_nextBtn.showed=!0)},_nonShowBtn:function(){this._jq_prevBtn.hide(),this._jq_nextBtn.hide()},_bindEvents:function(){var i=this;this._jq_prevBtn.click(function(){try{i._slidingWindow.slidePrev(),i._jq_nextBtn.show()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/thread_media_list_bright/thread_media_list_bright.js",method:"",ln:73}),t}}),i._jq_nextBtn.click(function(){try{i._slidingWindow.slideNext(),i._jq_prevBtn.show()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/thread_media_list_bright/thread_media_list_bright.js",method:"",ln:77}),t}}),this._slidingWindow.bind("firstend",function(){i._jq_prevBtn.hide()}),this._slidingWindow.bind("lastend",function(){i._jq_nextBtn.hide()})}}});_.Module.define({path:"user/widget/SingleIcons",requires:["common/widget/Card"],sub:{_card:null,initial:function(){this._wrap=$("body"),this._bindEvents()},_bindEvents:function(){var t=this;t._wrap.on("mouseenter",".j_singleforum_show",function(o){o.currentTarget===this&&t._buildCard(this)}).on("mouseleave",".j_singleforum_show",function(){return t._card&&t._card.closeCard(),t._card=null,!1})},_buildCard:function(t){var o=$(t),e=o.getData(),n=this;e&&$.post("/icon/getForumNameByForumId",{forum_id:e.forum_id,tbs:PageData.tbs,ie:"utf-8"}).success(function(t){0==t.no&&n._buildPop(o,t.data)})},_getAllForumName:function(t){var o=[];for(var e in t)t.hasOwnProperty(e)&&o.push(t[e].forum_name);return o.join(",")},_buildPop:function(t,o){var e=this,n=e._getAllForumName(o),i="\u53EA\u5728"+n+"\u5427\u5C55\u793A",r=t.offset().left-50+t.width()/2,a=t.offset().top-18-12;this._card=this.use("common/widget/Card",{content:i,card_css:{top:a,left:r,width:100},clazz:"single_icon_class",auto_positon:!1,event_target:t,wrap:$("body")}),this._card.showCard({type:"delayShow",time:200})}}});_.Module.define({path:"user/widget/icon_tip",requires:["common/widget/Card"],sub:{_icon_tip:null,_icon_tip_ajax:null,_dialog:null,_iconData:{},_option:{width:300},initial:function(t){this.pageType=t.pageType,this.myIcons=t.myIcons,this.bindEvents()},bindEvents:function(){var t=this,i=$("body");i.find(".j_icon_slot").on("mouseenter",function(){t._icon_tip&&t._icon_tip.closeCard(),t.buildCard($(this))}).on("mouseleave",function(){t._icon_tip&&t._icon_tip.closeCard({type:"delayClose",time:200}),t._icon_tip=null}),i.on("click",".j_buy_icon_btn",function(i){i.preventDefault(),t.getOneIcon(t._iconData)}).on("click",".j_manage_icon_btn",function(i){i.preventDefault(),t.jumpToIhome()})},buildCard:function(t){var i=this;i._icon_tip&&(i._icon_tip.closeCard(),i._icon_tip=null);var n=t.getData();this._iconData=n;var e,a,o,r,c,l,_=_||1,s=50,p="http://tb1.bdstatic.com/tb/cms/com/icon/";if(n.sprite){if(e=n.sprite[n.value],!e)for(var u in n.sprite)if(n.sprite[u]&&(0!=n.value||"meizhi_level"==n.name)){e=n.sprite[u];break}a=e.split(","),o=a[0],r=a[1],l=p+n.category_id+"_36.png?stamp="+o,c='style="background: url('+l+") no-repeat -"+r*s+"px  -"+(_-1)*s+'px;"'}else c=t.css("background");var d=this.getIconTipHtml(n);if(!d)return!1;null==n.title&&(n.title=t.tbattr("title"));var f=['<div class="icon_tip_wrapper">','<div class="icon_tip_img" '+c+" />",'<div class="icon_tip_info">','<div class="icon_tip_title">'+n.title+(d.expired?d.expired:"")+"</div>",'<div class="icon_tip_intro">'+d.intro+"</div>",'<div class="icon_tip_btns">',d.btn,"</div>","</div>","</div>"].join(""),g={content:f,card_css:{width:i._option.width,zIndex:$.getcurzIndex()},auto_positon:!0,event_target:t,attr:"id='icon_tip'",wrap:$("body")};i._icon_tip=i.requireInstance("common/widget/Card",g),i._icon_tip.showCard({type:"delayShow",time:200})},getOneIcon:function(t){var i=this,n=t.name;if(n){var e=$.dialog.confirm("\u786E\u5B9A\u8D2D\u4E70\u3010"+t.title+"\u3011\u5370\u8BB0\u561B\uFF1F\u5C06\u6D88\u8017\u60A8"+t.price+"T\u8C46",{title:"\u8D2D\u4E70\u5370\u8BB0\u63D0\u793A",acceptValue:"\u786E\u5B9A",cancelValue:"\u53D6\u6D88"});e.bind("onaccept",function(t){t.stopImmediatePropagation();var e={ie:"utf-8"};e.tbs=PageData.tbs,e.icon_name=n,e.level=1,i._icon_tip_ajax&&i._icon_tip_ajax.abort(),i._icon_tip_ajax=$.ajax({type:"post",url:"/icon/buyIcon",data:e,dataType:"json"}).success(function(t){if(t&&0===t.no){var n=t.data;return n.icon_info?(i.showDialog("\u8D2D\u4E70\u6210\u529F"),$.tb.location.reload(),void 0):(i.showDialog("\u8D2D\u4E70\u51FA\u9519\uFF0C\u8BF7\u67E5\u770B\u8D2D\u4E70\u8BB0\u5F55\u786E\u8BA4\u662F\u5426\u8D2D\u4E70\u6210\u529F"),void 0)}t&&2270028===t.no?i.showDialog("T\u8C46\u4E0D\u8DB3"):i.showDialog("\u8D2D\u4E70\u51FA\u9519\uFF0C\u6CA1\u6709\u8D2D\u4E70\u6210\u529F")})}).bind("oncancel",function(){})}},getIconTipHtml:function(t){if(null==t.intro||null==t.intro_url)return!1;if(this.whetherIHaveTheIcon(t,this.myIcons))return{intro:"<p>"+t.intro+' <a target="_blank" href="'+t.intro_url+'">\u8BE6\u60C5\u300B</a></p>',btn:'<a class="btn_default btn_small j_manage_icon_btn " href="" target="_blank" >\u7BA1\u7406\u5370\u8BB0</a>'};if(null!=t.price&&0!=t.price){var i='<p>\u4EF7\u683C:<i class="icon_tbean" style="vertical-align:middle;"></i><span class="orange_text " >'+t.price+'</span> <a target="_blank" href="'+t.intro_url+'">\u8BE6\u60C5\u300B</a></p>';return{intro:i,btn:'<a class="btn_default btn_small j_buy_icon_btn"  >\u8D2D\u4E70\u5370\u8BB0</a>'}}return{intro:"<p>"+t.intro+' <a target="_blank" href="'+t.intro_url+'">\u8BE6\u60C5\u300B</a></p>',btn:'<a class="btn_default btn_small" target="_blank" href="'+t.intro_url+'" >\u83B7\u53D6\u5370\u8BB0</a>'}},jumpToIhome:function(){var t=$(".userinfo_honor"),i=t.find(".j_icon_slot");$.tb.location.getHref().match("/home/")&&t&&i?i.first().trigger("click"):window.open("/home/main?id="+PageData.user.portrait+"&fr=icon_tip#manage_icon")},whetherIHaveTheIcon:function(t,i){var n,e;for(e in i)if(n=i[e],t.name==n)return!0;return!1},showDialog:function(t){this._dialog&&this._dialog.close(),this._dialog=null,this._dialog=new $.dialog({title:"\u5370\u8BB0\u63D0\u793A",html:t})},formateDate:function(t){var i=new Date(1e3*parseInt(t));return i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()}}});_.Module.define({path:"frs/widget/Thread",sub:{initial:function(){try{this.checkLogin(),this.redirectLocal58()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/thread/thread.js",method:"",ln:7}),t}},remove:function(t,e){function a(){var e={kw:PageData.forum.name,fid:PageData.forum.id,tid:t};e.ie="utf-8",e.tbs=PageData.tbs,PostHandler.execute("threadDelete",e,function(t){var e=t,a='<div style="padding:20px 20px; text-align:center; line-height:20px;font-size:13px;">\u5220\u9664\u4E3B\u9898\u64CD\u4F5C\u5931\u8D25</div>';switch(e.no){case 0:$.tb.location.reload(!0);break;case 12:case 13:break;default:$.dialog.alert(a,{title:"\u64CD\u4F5C\u5931\u8D25",width:380})}})}e>=10?confirm("\u6B64\u4E3B\u9898\u5DF2\u6709\u8F83\u591A\u56DE\u590D\uFF0C\u60A8\u786E\u8BA4\u8981\u5220\u9664?")&&a():a()},checkLogin:function(){$(".j_user_card").on("click",function(){try{if(PageData.user.is_login)return;var t=$(this).tbattr("href"),e="http://tieba.baidu.com"+$.tb.unescapeHTML(t);return window.open("/f/user/passport?jumpUrl="+e+"&statsInfo=frs_user#login_anchor"),!1}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/thread/thread.js",method:"",ln:57}),a}})},redirectLocal58:function(){$("#thread_list .j_is_local58").each(function(){var t=$(this).closest(".thread_local_58").getData().id||0;$.ajax({url:"http://jump.luna.58.com/ext/adshow?callback=?",context:$(this)[0],data:{sr:"frs",tids:t},dataType:"jsonp"}).done(function(e){try{if(e.sd){var a="http://jump.luna.58.com/ext/tieba?tid="+t+"&sd="+e.sd+"&sr=frs";$(this).tbattr("href",a)}}catch(i){}})})}}});
;!function(e){e.fn.lazyload=function(o){var t={threshold:0,failurelimit:0,timeer:300,event:"scroll",container:window,autoLoop:!1,loadFunction:function(){}};o&&e.extend(t,o);var n=this;if("scroll"==t.event){var i,r=t.threshold,l=[];e(t.container).unbind("scroll.lazyLoad").bind("scroll.lazyLoad",function(){function o(a,h){var d=0;if(a!==!0?(t.threshold=0,l=[]):h&&(t.threshold+=r||500),l.length&&e.each(l,function(){this.loaded&&d++}),d!=l.length)i=setTimeout(function(){o(!0,!1)},t.timeer);else{l=[],d=0;for(var c=0;c<n.length;c++){var s=n[c];if(s.loaded)s.loading?l.push(s):(n.splice(c,1),c--);else if(e.abovethetop(s,t));else if(e.belowthefold(s,t)){if(++d>t.failurelimit)break}else e(s).trigger("appear"),l.push(s)}n.length?t.autoLoop&&(i=setTimeout(function(){o(!0,!0)},t.timeer)):e(t.container).unbind("scroll.lazyLoad")}}i&&clearTimeout(i),i=setTimeout(o,t.timeer)})}return this.each(function(){var o=this;e(o).one("appear",function(){this.loaded||t.loadFunction(o,0,{width:t.maxW,height:t.maxH})}),"scroll"!=t.event&&e(o).bind(t.event,function(){o.loaded||e(o).trigger("appear")})}),e(t.container).trigger(t.event),this},e.outofthefold=function(o){return void 0===o.container||o.container===window?e(window).scrollTop()-o.threshold<=10&&o.threshold+e(window).height()+10>=e(document).height():e(o.container).offset().top-o.threshold<=10&&o.threshold+e(window).height()+10>=e(o.container).height()},e.belowthefold=function(o,t){if(void 0===t.container||t.container===window)var n=e(window).height()+e(window).scrollTop();else var n=e(t.container).offset().top+e(t.container).height();return n+t.threshold<=e(o).offset().top},e.abovethetop=function(o,t){if(void 0===t.container||t.container===window)var n=e(window).scrollTop();else var n=e(t.container).offset().top;return e(o).offset()||console.log(o),n-t.threshold>=e(o).offset().top+e(o).height()}}(jQuery);
;_.Module.define({path:"frs/widget/ThreadList/TopListCookie",sub:{_tid:null,_max_num:10,initial:function(t){try{this._tid=t}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/thread_list_eden/js/top_list_cookie.js",method:"",ln:13}),i}},tidin:function(t){var t=t||"";return("-"+t+"-").indexOf("-"+this._tid+"-")>-1},deltid:function(t){var t=t||"";return t.replace(new RegExp("\\b("+this._tid+")+\\b\\-?|\\-?\\b("+this._tid+")+\\b","g"),"")},addtid:function(t){var t=t||"";if(this.tidin(t))return t;if(""!=t)var i=t.split("-");else var i=[];return i.push(this._tid),i.length>this._max_num&&i.shift(),i.join("-")}}});
;_.Module.define({path:"frs/widget/ThreadListEden",requires:["frs/widget/Thread","frs/widget/PictureRotation","album/widget/tbFav","frs/widget/PopVideo","common/widget/MusicPlayer","frs/widget/pic_sliding_window","frs/widget/ThreadList/TopListCookie"],sub:{_thread:null,_curPage:null,_isPm:null,_version:null,_picRotation:null,_options:{theme:"",bigPicSize:{width:534,height:"auto"},smallPicSize:{width:400,height:75}},initial:function(t,e,i,a,s){try{this._curPage=t,this._isPm=e,this._version=i,this._jqFav=null,this._userId=PageData.user.id||0,this._isLogin=PageData.user.is_login||!1,this._isNoUname=PageData.user.no_un||!1,this._setOptions(t,e,i,a);var n=this;F.use(["datalazyload"],function(t){window.datalazyload=new t($(document.body),{diff:500,autoDestroy:!1,imgFlag:"original",imgOnloadCallback:{listimg:function(){loadPic(this.img,0,n._options.smallPicSize)}}})}),this.render(),this._thread=this.use("frs/widget/Thread"),this._tbFav=this.use("album/widget/tbFav"),this._popVideo=this.use("frs/widget/PopVideo"),this.run(),this.brandShowCount(s)}catch(r){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:r.message||r.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:59}),r}},run:function(){this._picRotationInit(),this._picPagerInit(),this._initFav(),this._initPicList(),this._bindTopThreadEvent(),this._bindLocal58Events(),this._bindLocalNuomiEvents(),this._bindLocalGanjiEvents(),this._bindDirAdEvents(),this._bindMemberEvents(),this._bindGameEvents(),0!=$("#thread_list").find(".order_repost_wrap").length&&this._bindOrderRepostEvents(),this._bindThreadStat()},scrollRenderUpdate:function(){var t=this;setTimeout(function(){datalazyload.addElements($("img[original]")),datalazyload.refresh(),$(".voice_player .time").each(function(){$(window).trigger("initvoicelength",this)}),t._initPicList(),"undefined"!=typeof _threadBatchDelete&&_threadBatchDelete.addCheckedBox()},500)},render:function(){var t=this;$("ul").delegate(".j_threadlist_media","click",function(e){function i(t,e){return t?t.match(new RegExp("(\\s|^)"+e+"(\\s|$)")):!1}try{var a=e.target||e.srcElement,s=$.tb.unescapeHTML($(a).tbattr("class")),n=$(a).closest(".j_thread_list"),r=n.find(".j_threadlist_media");t.is_repost=r.hasClass("j_repost_media"),t._picWidth=t.is_repost?400:534;var o=n.getData();if(i(s,"j_m_music"))return t.mediaMusic(a,o);if(i(s,"j_m_pic"))return t.mediaPic(a,o);if(i(s,"j_m_pic_light"))return t.mediaPic($(a).prev().get(0),o);if(i(s,"vpic_wrap"))return t.mediaPic(a,o);if(i(s,"j_m_flash"))return t.mediaFlash(a,o);if(i(s,"j_m_vote"))return t.mediaVote(n,o)}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:123}),e}}),$("#thread_list").on("click",".j_retract",function(e){try{e.preventDefault(),t.closeMedia(this)}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:127}),e}}),$("#thread_pic").on("click",".j_retract",function(e){try{e.preventDefault(),t.closeMedia(this)}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:131}),e}});var e=$("#content_leftList").find(".j_thread_ad"),i=e.getData();e.delegate("a","mousedown",function(){var e=$(this);if(e.hasClass("j_th_tit")||e.hasClass("j_enter_pb"))t.sendAnyStats(i.ad_link);else if(e.hasClass("j_m_flash")){var a=["http://bzclk.baidu.com/video.php?page=frs&forumid=",PageData.forum.id,"&tid=",i.id].join("");t.sendAnyStats(a)}}),t.bakan_init()},renderBigImg:function(t,e){var i="";return"string"==typeof t&&(i='<img class="j_retract" id="'+e+'" src="'+t+"\" onerror=\"this.src='http://tb2.bdstatic.com/tb/static-frs/img/v2/picerr.gif';this.width=82;this.height=75;\" onclick=\"if(PageData.forum.forum_name == '\u9B54\u517D\u4E16\u754C') $.stats.sendRequest('fr=tb0_forum&st_mod=frs&st_type=big_pic&st_value=allclick');\" />"),i},onBigImgLoaded:function(t){var e=$(t),i=e.closest(".j_thread_list"),a=i.find(".j_threadlist_media"),s=a.hasClass("j_repost_media");s?resizePic_temp(t,this._options.smallPicSize.width,6e3):resizePic_temp(t,this._options.bigPicSize.width,6e3);var n=e.height();if(200>n){var r=Math.round((200-n)/2);e.css({"margin-top":r+"px","margin-bottom":r+"px"})}},loadedDefaultImg:function(t){{var e=this,i=$(t).tbattr("data-src");this._options.bigPicSize.width}$(t).one("load",function(){e.onBigImgLoaded(t)}),t.src=$.tb.unescapeHTML(i)},mediaPic:function(t,e){var i=this,a=!0,s=t.className;$(t).closest(".threadlist_text").find(".threadlist_media_num").hide(),t=-1!=s.indexOf("vpic_wrap")?$(t).find("img")[0]:t;var n=$(t).closest("li"),r=$(t).closest(".j_thread_list"),o=!1;if(window.FrsThreadItem)var d=window.FrsThreadItem.PicLivePost;if(n.siblings().each(function(){var t=$(this);0==t.find(".j_m_pic").length&&0==t.find("#updata_img_totopic").length&&"none"!=t.css("display")&&0==t.find(".j_img_more").length&&(a=!1)}),d&&(d._isPicTheme=0,1==$(t).closest("ul").find("#updata_img_totopic").length)){var c=$("#pic_theme_list .j_threadlist_piclist_detail");c.hide(),d._isPicTheme=1,clearTimeout(d.timeSet),d.timeSet=0}if(r.find(".j_m_albumpic").length>0&&(o=!0),a){var _=n.index(),l=n.siblings().find("img").length,h=new Array;d&&d._isPicTheme&&l>5&&(_>l-5&&(_=_+4-l),l-=5),r.find(".j_m_pic").each(function(){var t=$(this),e=t.tbattr("bpic");t.tbattr("src").match("/tb/static-frs/img/v2/picerr.gif")&&(e="http://tb2.bdstatic.com/tb/static-frs/img/v2/picerr.gif"),h.push(e)});for(var m=(new Date).getTime(),f=['<div class="media_box j_remove j_media_box">','<div class="media_disp">','<div class="media_pic_control">',this._mediaPic_renderBigPicControl({bigPicSrc:h[_],ctrlKey:m}),"</div>"].join(""),g="",p="big_img_"+m,u=0;l>=u;u++){if("bright"==i._options.theme)var b=['<div class="media_bigpic j_media_bigPic media_bigpic_hidden">','<div class="media_bigpic_wrap">',this.renderBigImg(h[u],"",e.id),"</div>",'<div class="media_bigpic_display_pre j_display_pre" cur="'+_+'" total="'+l+'"></div>','<div class="media_bigpic_display_next j_display_next" cur="'+_+'" total="'+l+'"></div>'].join("");else var b=['<div class="media_bigpic j_media_bigPic media_bigpic_hidden">','<div class="media_bigpic_wrap">',this.renderBigImg(h[u],"",e.id),"</div>"].join("");d&&d._isPicTheme&&(b+="<div class='big_image_open'>"+($(t).closest("li").tbattr("content")?$(t).closest("li").tbattr("content"):"")+"&nbsp;<a target='_blank' href='http://tieba.baidu.com/photo/p?tid="+$("#pic_theme_list").tbattr("tid")+"&kw="+PageData.forum.name_url+"&pid="+$(t).closest("li").tbattr("pid")+"&flux=1&pn=1&fp=1&see_lz=1&&pic_id="+h[u].substring(h[u].lastIndexOf("/")+1,h[u].lastIndexOf("."))+"'>\u8FDB\u5165\u8D34\u5B50>></a></div>"),b+="</div>",g+=b}var v=["</div>",this._mediaPic_renderBigPicBoxTail({theme:i._options.theme,curPic:_,totalPic:l,thread_field:e,isGoodAlbum:o,picLivePost:d}),"</div>"].join(""),w=f+g+v,j=$(w);i.addMediaBox(t,j),j.find(".j_media_bigPic img").one("load",function(){i.onBigImgLoaded(this),i._setBigImgUrl(this,e)});var y=r.find(".j_media_bigPic:eq("+_+")").removeClass("media_bigpic_hidden").find("img").tbattr("id",p);i.controlPreNextButton(_,l,r),i._checkAndSetImgFav(r.find(".j_favImg")),setTimeout(function(){i.autoScroll(r,350)},300)}else{var k=$(t).tbattr("bpic"),m=(new Date).getTime(),w=['<div class="media_box clearfix j_remove j_media_box">','<div class="media_disp">','<div class="media_pic_control">',this._mediaPic_renderBigPicControl({bigPicSrc:k,ctrlKey:m}),"</div>",'<div class="media_bigpic j_media_bigPic">',"<div>",this.renderBigImg(k,"big_img_"+m),"</div>","</div>","</div>",this._render_enter_pb({url:"/p/"+e.id,isGoodAlbum:o,hasBrandSkin:e.has_brandskin}),"</div>"].join(""),y=$(w).appendTo(r).find(".j_media_bigPic img").one("load",function(){i.onBigImgLoaded(this),i._setBigImgUrl(this,e)});this._setBigImgUrl(y[0],e)}return $(t).closest(".j_threadlist_li_right").addClass("hidePre"),"\u9B54\u517D\u4E16\u754C"==PageData.forum.forum_name&&$.stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=small_pic&st_value=allclick"),$.stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=pic_show_num&st_value=1"),!1},_mediaPic_renderBigPicControl:function(t){var e=['<a class="j_retract" href="#"><i class="icon_retract"></i>\u6536\u8D77</a>','<span class="line">|</span>','<a target="_blank"  class="j_ypic" href="'+t.bigPicSrc+'"><i class="icon_ypic"></i>\u67E5\u770B\u5927\u56FE</a>','<span class="line">|</span>','<a target="_blank" href="#" class="j_rotation_left" for="big_img_'+t.ctrlKey+'" onclick="return false;" ><i class="icon_turnleft"></i>\u5411\u5DE6\u8F6C</a>','<span class="line">|</span>','<a target="_blank" href="#" class="j_rotation_right" for="big_img_'+t.ctrlKey+'" onclick="return false;" ><i class="icon_turnright"></i>\u5411\u53F3\u8F6C</a>','<a target="_blank" href="#" onclick="return false;" class="tb_icon_fav j_favImg" data-src="'+t.bigPicSrc+'"><i class="icon_fav"></i>\u6536\u85CF</a>'].join("");return e},_mediaPic_renderBigPicBoxTail:function(t){var e="",i=['<a href="#" class="tb_btn_display_pre j_display_pre" style="display: none;" cur="'+t.curPic+'" total="'+t.totalPic+'"></a>','<a href="#" class="tb_btn_display_next j_display_next" style="display: none;" cur="'+t.curPic+'" total="'+t.totalPic+'"></a>'].join(""),a=this._render_enter_pb({url:"/p/"+t.thread_field.id,isGoodAlbum:t.isGoodAlbum,hasBrandSkin:t.thread_field.has_brandskin});return"bright"!=t.theme&&(e+=i),t.picLivePost&&t.picLivePost._isPicTheme||(e+=a),e},_getSearch:function(t){return t.replace(/http:\/\/box\.baidu\.com\/widget\/flash\/bdspacesong\.swf\?/g,"")},_getSearchValue:function(t,e){var i=e.replace(/^\?/,""),a={};if(!i)return void 0===t?a:void 0;i=i.split("&amp;");for(var s,n=0,r=i.length;r>n;n++)s=i[n].indexOf("="),s>0?a[i[n].substring(0,s)]=i[n].substring(s+1):a[i[n]]="";return void 0===t?a:a[t]},_musicCount:0,stopPlayMusic:function(){window.playctrl&&window.playctrl.player.stop()},mediaMusic:function(t,e){var i=['<div dr="J" class="media_box j_remove j_media_box">','<div class="media_disp">','<div class="media_pic_control">','<a class="j_retract" href="#"><i class="icon_retract"></i>\u6536\u8D77</a>',"</div>",'<div class="j_music_box"></div>',"</div>",this._render_enter_pb({url:"/p/"+e.id,hasBrandSkin:e.has_brandskin}),"</div>"].join(""),a=$(i);this.addMediaBox(t,a);var s=this,n=$(t).tbattr("data-video").replace(/autoPlay=false/g,"autoPlay=true"),r=a.find(".j_music_box"),o=s._getSearch(n),d=s._getSearchValue("song_id",o);return d?(s.musicPlayer?s.musicPlayer.mboxInit(r,d,s._musicCount):(s.musicPlayer=s.use("common/widget/MusicPlayer",[],[]),s.musicPlayer.mboxInit(r,d,s._musicCount)),s._musicCount++):r.html('<embed scale="noborder" allowfullscreen="true" allowscriptaccess="never" src="'+n+'" menu="false" loop="false" play="true" wmode="transparent" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" class="BDE_Music" height="95" width="400">'),$(t).closest(".j_threadlist_li_right").addClass("hidePre"),$(t).closest(".threadlist_text").find(".threadlist_media_num").hide(),!1},mediaFlash:function(t,e){var i=this,a=$(t).tbattr("data-video"),s=['<div dr="H" class="media_box j_remove j_media_box">','<div class="media_disp j_media_disp">','<div class="media_pic_control">','<a class="j_retract j_retract_media" href="#"><i class="icon_retract"></i>\u6536\u8D77</a>','<span class="line">|</span>','<a class="pop_media j_pop_media" href="#"><i class="icon_pop"></i>\u5F39\u51FA</a>',"</div>",'<embed scale="noborder" allowfullscreen="true" allowscriptaccess="never" src="'+a+'" menu="false" loop="false" play="true" wmode="transparent" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" class="BDE_Flash" width="'+this._options.bigPicSize.width+'" height="386">',"</div>",this._render_enter_pb({url:"/p/"+e.id,hasBrandSkin:e.has_brandskin}),"</div>"].join(""),n=$(t).closest(".j_thread_list");return i.autoScroll(n,400,function(){i.addMediaBox(t,$(s)),$(t).closest(".j_threadlist_li_right").addClass("hidePre")},520),$(t).closest(".threadlist_text").find(".threadlist_media_num").hide(),i._videoStats(a),!1},addMediaBox:function(t,e){var i=$(t).closest(".j_thread_list"),a=$(t).closest(".j_threadlist_media"),s=a.hasClass("j_repost_media");s?e.appendTo(a.parent()):e.appendTo(i)},_render_enter_pb:function(t){var e=t.hasBrandSkin?"enter_pb_brandskin":"",i=['<div class="j_enter_pb_wrapper enter_pb_wrapper '+e+'"><a href="'+t.url+'" class="ui_btn ui_btn_m_special j_enter_pb enter_pb" target="_blank">',"<span>","<em>",t.isGoodAlbum?"\u8FDB\u5165\u56FE\u518C":"\u8FDB\u5165\u8D34\u5B50","</em> ","bright"!=this._options.theme?'<i class="ui_btn_icon ui_btn_icon_lt"></i>':"","</span>","</a></div>"].join("");return i},autoScroll:function(t,e,i,a){var s=t.height(),n=$(window),r=n.scrollTop(),o=t.offset(),d=o.top,c=n.height(),_=d+(a?a:s)-r;if(_>c){var l=d-5;c>s&&!i&&(l=d+s-c+10);var h=window.navigator.userAgent.match(/chrome/i),m=h?document.body:document.documentElement;i||($.stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=pic_hide_click&st_value=1"),$(document).bind("mousewheel.scroll",function(){$.stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=pic_stop_scroll&st_value=1"),$(m).stop(),$(document).unbind("mousewheel.scroll")})),$(m).animate({scrollTop:l},e,"swing",function(){$(document).unbind("mousewheel.scroll"),i&&i()})}else i&&i()},mediaVote:function(t,e){if(!frs.ThreadList.hasMediaBox(e.id)){var i=['<div dr="I" class="media_box j_remove j_media_box" id="box_'+e.id+'">','<div class="media_disp">','<div class="media_pic_control">','<a class="tb_icon_retract j_retract"  href="#">\u6536\u8D77</a>',"</div>",'<div id="voteFlashPanel_'+e.id+'"></div>',"</div>",this._render_enter_pb({url:"/p/"+e.id}),"</div>"].join("");this.addMediaBox(thread,$(i)),thread.find(".j_threadlist_li_right").addClass("hidePre"),$.JsLoadManager.use("http://tb1.bdstatic.com/tb/js/forumFlashBuilder.js",function(){ForumFlashBuilder.buildEmbed("voteFlashPanel_"+e.id,{id:"voteFlash_"+e.id,width:200,height:100,allowscriptaccess:"always",flashvars:"home=http://tieba.baidu.com&page=frs",src:"http://tb1.bdstatic.com/tb/flash/vote.swf?r="+e.id+e.vid+"&voteId="+e.vid+"&tn=ajaxCanVote&stamp="+(new Date).getTime()})}),$(t).closest(".threadlist_text").find(".threadlist_media_num").hide()}},closeMedia:function(t){function e(t){var e=ot=0;if(t.offsetParent)do e+=t.offsetLeft,ot+=t.offsetTop;while(t=t.offsetParent);return{left:e,top:ot}}if(1==$(t).closest("ul").find("#updata_img_totopic").length){var i=$("#pic_theme_list .j_threadlist_piclist_detail");i.show(),window.FrsThreadItem&&(window.FrsThreadItem.PicLivePost.timeSet=setTimeout(window.FrsThreadItem.PicLivePost.rollPic,30),window.FrsThreadItem.PicLivePost._isPicTheme=0),$(this).closest("div").css("height","100px"),$("#pic_turn").css("height","100px")}var a=$(t).closest(".j_thread_list");a.find(".threadlist_media_num").show();var s=a.find(".j_threadlist_li_right").removeClass("hidePre").end().find(".media_box");if(s.find(".j_music_box").length>0&&this.stopPlayMusic(),s.hasClass("j_remove")){var n=e(a[0]).top,r=$(document).scrollTop();r>n&&$(document).scrollTop(n),s.remove(),$(t).closest("j_media_box").find(".j_enter_pb_wrapper").remove()}else s.hide()},hasMediaBox:function(t){return $("#box_"+t)[0]?($("#box_"+t).show().parent().addClass("hidePre"),!0):!1},bakan_init:function(){$(".th_bakan").each(function(){var t=$(this).closest(".j_thread_list"),e=t.getData();$.get("/bakan/sys/get_bakan_by_thread?fid="+PageData.forum.id+"&tid="+e.id,function(e){var i=$.parseJSON(e);0==i.error_no?t.find(".threadlist_abs").append(i.msg.brief).after('<div class="m_bakan"><a href="/bakan/view?kw='+PageData.forum.name_url+"&kid="+i.msg.bakan_id+'" target="_blank"><img style="height:75px;width:auto;vertical-align: baseline;" src="http://imgsrc.baidu.com/forum/pic/item/'+i.msg.pic_url+'.jpg" height="75"/></a><a href="/bakan/view?kw='+PageData.forum.name_url+"&kid="+i.msg.bakan_id+'" target="_blank">\u672C\u671F\u5427\u520A<em>&#187;</em></a></div>'):t.find(".threadlist_abs").append('<div class="m_bakan"><a href="/bakan/view?kw='+PageData.forum.name_url+"&kid="+i.msg.bakan_id+'" target="_blank"><img style="height:75px;width:auto;vertical-align: baseline;" src="http://imgsrc.baidu.com/forum/pic/item/'+i.msg.pic_url+'.jpg" height="75"/></a><a href="/bakan/view?kw='+PageData.forum.name_url+"&kid="+i.msg.bakan_id+'" target="_blank">\u672C\u671F\u5427\u520A<em>&#187;</em></a></div>')})})},toTop:function(){function t(){i=Math.floor(i/2),window.scrollTo(0,i),i>2?e=setTimeout(t,40):(window.scrollTo(0,0),clearTimeout(e))}var e=null,i=$(window).scrollTop();$.browser.msie?window.scrollTo(0,0):t()},sendAnyStats:function(t){if(document.images){var e=new Image;window["bd_pv_"+(new Date).getTime()]=e,t=t+"&t="+(new Date).getTime(),t.indexOf("http://")<0&&(t="http://"+t),e.src=t,e=null}},max_width:function(){$(window).width()>1261?$("body").addClass("maxw"):$("body").removeClass("maxw")},_setOptions:function(t,e,i,a){null!=a&&(this._options=$.extend(this._options,a),"bright"==a.theme&&null==a.smallPicSize&&(this._options.smallPicSize.height=90))},_picRotationInit:function(){var t=this;this._picRotation=this.use("frs/widget/PictureRotation"),$("#thread_list").delegate(".j_rotation_left","click",function(e){try{t._rotationHandler(this,"left"),$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"rot_img_left"}),e.preventDefault()}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:701}),i}}),$("#thread_list").delegate(".j_rotation_right","click",function(e){try{t._rotationHandler(this,"right"),$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"rot_img_right"}),e.preventDefault()}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:711}),i}}),$("#thread_pic").delegate(".j_rotation_left","click",function(e){try{t._rotationHandler(this,"left"),$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"rot_img_left"}),e.preventDefault()}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:721}),i}}),$("#thread_pic").delegate(".j_rotation_right","click",function(e){try{t._rotationHandler(this,"right"),$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/pv.gif",{fr:"tb0_forum",st_mod:"frs",st_type:"rot_img_right"}),e.preventDefault()}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:731}),i}}),$("#container").delegate(".j_favImg","click",function(e){try{t._favBtnClick(this),e.preventDefault()}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:738}),i}})},_rotationHandler:function(t,e){var i=this,a=$(t).tbattr("for"),s=document.getElementById(a),n=$(s),r=n.parent().height();i._picRotation.rotationSimple(s,e,this._options.bigPicSize.width),n.height()<r&&n.parent().height(r)},controlPreNextButton:function(t,e,i){var a=i.find(".j_display_pre"),s=i.find(".j_display_next");0==t?a.hide():a.show(),t==e?s.hide():s.show()},_picPagerInit:function(){var t=this;$("#thread_list").delegate(".j_display_pre","click",function(e){try{var i=e.target||e.srcElement;return"\u9B54\u517D\u4E16\u754C"==PageData.forum.forum_name&&$.stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=pic&st_value=allclick"),t.picPager(i,-1),!1}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:779}),e}}),$("#thread_list").delegate(".j_display_next","click",function(e){try{var i=e.target||e.srcElement;return"\u9B54\u517D\u4E16\u754C"==PageData.forum.forum_name&&$.stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=pic&st_value=allclick"),t.picPager(i,1),!1}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:786}),e}}),$("#thread_topic").delegate(".j_display_pre","click",function(e){try{var i=e.target||e.srcElement;return t.picPager(i,-1),!1}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:791}),e}}),$("#thread_pic").delegate(".j_display_pre","click",function(e){try{var i=e.target||e.srcElement;return t.picPager(i,-1),!1}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:796}),e}}),$("#thread_pic").delegate(".j_display_next","click",function(e){try{var i=e.target||e.srcElement;return t.picPager(i,1),!1}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:801}),e}}),$("#thread_topic").delegate(".j_display_next","click",function(e){try{var i=e.target||e.srcElement;return t.picPager(i,1),!1}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:806}),e}})},picPager:function(t,e){var i=this,a=new Array,s=$(t).closest(".j_thread_list");s.find(".j_m_pic").each(function(){var t=$(this).tbattr("src").replace(/\/abpic\//,"/pic/");window.FrsThreadItem&&window.FrsThreadItem.PicLivePost._isPicTheme&&(t="http://imgsrc.baidu.com/forum/pic/item/"+$(this).tbattr("src").split("/").pop()),a.push(t)});var n=parseInt($(t).tbattr("cur")),r=parseInt($(t).tbattr("total")),o=$("#pic_theme_list"),d=s.find(".j_media_bigPic:eq("+n+")"),c=d.find("img").tbattr("id");d.addClass("media_bigpic_hidden").find("img").tbattr("id",""),n+=e,window.FrsThreadItem&&window.FrsThreadItem.PicLivePost._isPicTheme&&s.find(".big_image_open").eq(n).html(o.find("#pic_turn li").eq(n).tbattr("content")+"&nbsp;<a target='_blank' href='http://tieba.baidu.com/photo/p?tid="+$("#pic_theme_list").tbattr("tid")+"&kw="+PageData.forum.name_url+"&pid="+$(t).closest("li").tbattr("pid")+"&flux=1&pn=1&fp=1&see_lz=1&&pic_id="+a[n].substring(a[n].lastIndexOf("/")+1,a[n].lastIndexOf("."))+"'>\u8FDB\u5165\u8D34\u5B50>></a>");var _=s.getData();i._checkAndSetImgFav(s.find(".j_favImg").tbattr("data-src",a[n]));var l=s.find(".j_media_bigPic:eq("+n+")").removeClass("media_bigpic_hidden").find("img").tbattr("id",c);this._setBigImgUrl(l[0],_),s.find(".j_display_pre").tbattr("cur",n.toString()),s.find(".j_display_next").tbattr("cur",n.toString()),i.controlPreNextButton(n,r,s)},_favBtnClick:function(t){return t=$(t),t.data("clicking")?!1:(t.data("clicking",!0),this._jqFav=t,this._isLogin?(t.hasClass("done")?(t.data("clicking",!1),window.open("http://xiangce.baidu.com/opencom/picture/fav/rewrite")):(this._checkAndSetImgFav(t,!0),this._tbFav.addToFav()),void 0):(TbCom.process("User","buildLoginFrame",null,null,null,"fav_img"),void 0))},_checkAndSetImgFav:function(t,e){if(t.tbattr("data-src")){var i;if(this._jqFav=t,e){var a=t.closest(".j_thread_list"),s=$.tb.unescapeHTML(a.find('a.j_th_tit,a.th_tit,a[target="_blank"]').tbattr("title"));i={sourceURL:$.tb.location.getHref(),imgUrl:$.tb.unescapeHTML(t.tbattr("data-src")),descript:s}}else i={imgUrl:$.tb.unescapeHTML(t.tbattr("data-src"))};this._tbFav.checkStatus(i)}},_initFav:function(){var t={userId:this._userId},e=this;this._tbFav.setConf(t);var i={tags:"\u767E\u5EA6\u8D34\u5427,"+PageData.forum.forum_name+"\u5427"};this._tbFav.setData(i),this._tbFav.bind("check_status_success",function(t,i){e._favCheckSuccess(i)}),this._tbFav.bind("add_to_fav_success",function(t,i){0==i.errno&&i.data&&0!=i.data.status?e._hasFavImg():alert("\u7F51\u7EDC\u5FD9\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5"),e._jqFav.data("clicking",!1)})},_favCheckSuccess:function(t){"hit_cache"==t||0==t.errno&&t.data&&0!=t.data.status?this._hasFavImg():this._notFavImg()},_hasFavImg:function(){this._jqFav.addClass("done").html("<i class='icon_fav'></i>\u5DF2\u6536\u85CF").tbattr("title","\u67E5\u770B\u5DF2\u6536\u85CF\u56FE\u7247")},_notFavImg:function(){this._jqFav.removeClass("done").html("<i class='icon_fav'></i>\u6536\u85CF").tbattr("title","\u6536\u85CF\u5230\u767E\u5EA6\u76F8\u518C")},_getPhotoPageByUrl:function(t,e){var i=t.src,a=i.substring(i.lastIndexOf("/")+1,i.lastIndexOf("."));if(e.is_repost){var s=$(t).closest(".j_frs_repost"),n=s.getData();return"/photo/p?kw="+n.fname+"&flux=1&tid="+n.tid+"&pic_id="+a+"&pn=1&see_lz=1"}return"/photo/p?kw="+PageData.forum.name_url+"&flux=1&tid="+e.id+"&pic_id="+a+"&pn=1&see_lz=1"},_setBigImgUrl:function(t,e){var i=t.src,a=t.width,s=t.height,n=80,r=80,o=$(t).closest(".j_media_box"),d=$(t).closest(".media_bigpic"),c=o.find(".j_ypic");d.hasClass("media_bigpic_hidden")||(a>n&&s>r&&a*s>=1e4&&PageData.forum.has_picture_frs?c.tbattr("href",this._getPhotoPageByUrl(t,e)):c.tbattr("href",i))},_videoStats:function(t){var e=t.match(/http:\/\/([^\/]*)\/.*/);if(null!=e&&null!=e[1]){var i=e[1];$.stats.sendRequest("fr=tb0_forum&st_type=videoclick&st_mod=frs&provider="+i)}},_initPicList:function(){var t=this;setTimeout(function(){$("#thread_list").find(".j_small_wrap").each(function(){"true"!=$(this).tbattr("is_handle")&&(t.use("frs/widget/thread_media_list_bright",$(this),null),$(this).tbattr("is_handle","true"))})},500)},_showErrorTip:function(t){var e="";switch(Number(t)){case 8:case 9:case 220012:e="\u4F60\u5728\u672C\u5427\u88AB\u5C01\u7981\uFF0C\u6682\u65F6\u4E0D\u80FD\u8FDB\u884C\u64CD\u4F5C";break;case 220:e="\u4F60\u88AB\u5427\u4E3B\u52A0\u5165\u9ED1\u540D\u5355\uFF0C\u6682\u65F6\u4E0D\u80FD\u8FDB\u884C\u64CD\u4F5C";break;case 2130008:e="\u4F60\u4ECA\u5929\u5DF2\u7ECF\u6295\u8FC7\u7968\u4E86";break;case 3110003:e="\u540C\u65F6\u6709\u592A\u591A\u4EBA\u5728\u6295\u7968\u4E86\uFF0C\u8BF7\u7A0D\u540E\u518D\u6765~";break;default:e="\u670D\u52A1\u5668\u51FA\u9519\u5566~\u8BF7\u518D\u8BD5\u4E00\u6B21\u5427"}var i=new Array;i.push('<div style="text-align:center;color:#333333;font-size:14px;padding:10px 10px 0;">'+e+"</div>");new $.dialog({html:i.join(""),showTitle:!0,draggable:!1,width:300,height:40})},_bindTopThreadEvent:function(){var t=this,e=$("#thread_top_folder"),i=$("#thread_top_list");e.length&&e.on("click",function(){try{i.children("li").slideDown(),$(this).hide();for(var e=$(this).data("field"),a=$.cookie("top_list")||"",s=0,n=e.length;n>s;s++){var r=t.use("frs/widget/ThreadList/TopListCookie",e[s]);a=r.deltid(a)}$.cookie("top_list",a,{expires:72,path:"/"})}catch(o){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:o.message||o.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1051}),o}}),i.find(".j_thread_hidden").on("click",function(){try{$(this).parents(".j_thread_list").slideUp(),e.show();var i=$(this).data("field"),a=i.tid,s=$.cookie("top_list")||"",n=t.use("frs/widget/ThreadList/TopListCookie",a);n.tidin(s)||$.cookie("top_list",n.addtid(s),{expires:72,path:"/"})}catch(r){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:r.message||r.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1068}),r}})},_bindLocalNuomiEvents:function(){var t=this;if($(".thread_local_nuomi").length>0){var e=$(".thread_local_nuomi").getData(),i=e.fc_nuomi,a=e.sc_nuomi;t._stats("frs_6_floor","\u7CEF\u7C73","\u5C55\u73B0",i,a),$(".thread_local_nuomi").on("mouseenter",function(){$(this).find(".localnuomi_cancel").show()}).on("mouseleave",function(){var t=$(this).find(".localnuomi_cancel");t.hasClass("_sel")||t.hide()}).on("click",".localnuomi_cancel",function(){try{$(this).toggleClass("_sel"),$(this).siblings(".localnuomi_cancel_wrapper").toggle()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1090}),t}}).on("click",".threadlist_title",function(){try{t._stats("frs_6_floor","\u7CEF\u7C73","\u70B9\u51FB",i,a)}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1094}),e}}).on("click",".localnuomi_cancel_wrapper a",function(){try{var t=new Date,e=new Date(new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()+864e5);$.cookie("nuomi_shield",1,{expires:e,path:"/"}),$(this).parents(".thread_local_nuomi").slideUp()}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1104}),i}})}},_bindLocalGanjiEvents:function(){var t=this;if($(".thread_local_ganji").length>0){{$(".thread_local_ganji").getData()}t._stats("frs_3_floor","\u8D76\u96C6","\u5C55\u73B0"),$(".thread_local_ganji").on("mouseenter",function(){$(this).find(".localganji_cancel").show()}).on("mouseleave",function(){var t=$(this).find(".localganji_cancel");t.hasClass("_sel")||t.hide()}).on("click",".localganji_cancel",function(){try{$(this).toggleClass("_sel"),$(this).siblings(".localganji_cancel_wrapper").toggle()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1125}),t}}).on("click",".threadlist_title",function(){try{t._stats("frs_3_floor","\u8D76\u96C6","\u70B9\u51FB")}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1129}),e}}).on("click",".localganji_cancel_wrapper a",function(){try{var t=new Date,e=new Date(new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()+864e5);$.cookie("ganji_shield",1,{expires:e,path:"/"}),$(this).parents(".thread_local_ganji").slideUp()}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1139}),i}})}},_bindLocal58Events:function(){var t=this;if($(".threadlist_bright .thread_local_58").length>0){var e=$(".threadlist_bright .thread_local_58").first().getData(),i=e.fc_58,a=e.sc_58;t._stats("frs_3_floor","58","\u5C55\u73B0",i,a)}$(".threadlist_bright").on("click",".thread_local_58 .threadlist_title",function(){try{var e=$(this).closest(".thread_local_58").getData(),i=e.fc_58,a=e.sc_58;t._stats("frs_3_floor","58","\u70B9\u51FB",i,a)}catch(s){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1155}),s}}),$(".threadlist_bright").on("mouseenter",".j_thread_list",function(){$(this).find(".local58_cancel").show()}).on("mouseleave",".j_thread_list",function(){var t=$(this).find(".local58_cancel");t.hasClass("_sel")||t.hide()}),$(".threadlist_bright").on("click",".local58_cancel",function(){try{$(this).toggleClass("_sel"),$(this).siblings(".local58_cancel_wrapper").toggle()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1168}),t}}),$(".threadlist_bright").on("click",".local58_cancel_wrapper a",function(){try{var e=$(this).closest(".thread_local_58").getData(),i=e.fc_58,a=e.sc_58;return t._stats("\u5C4F\u853D","58","\u70B9\u51FB",i,a),t._local58Cancel($(this)),!1}catch(s){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1176}),s}})},_bindDirAdEvents:function(){$(".threadlist_bright .thread_dir_ad").length>0&&$.stats.track("\u6E38\u620F_\u60A0\u6D0B\u68CB\u724C","\u6E38\u620F\u63A8\u5E7F\u8D34","frs","view"),$(".threadlist_bright").on("click",".thread_dir_ad .threadlist_title",function(){try{$.stats.track("\u6E38\u620F_\u60A0\u6D0B\u68CB\u724C","\u6E38\u620F\u63A8\u5E7F\u8D34","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1185}),t}})},_local58Cancel:function(t){var e=new Date,i=new Date(new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()+864e5);
$.cookie("58_shield",1,{expires:i,path:"/"}),t.parents(".thread_local_58").slideUp()},_stats:function(t,e,i,a,s){$.stats.track(t,e+"_ad\u5B9E\u9A8C","frs",i,{obj_type:a,obj_subtype:s})},_bindMemberEvents:function(){$(".threadlist_bright").on("mouseover",".j_beMember",function(){$(this).css({"background-color":"#ffffe5"})}).on("mouseout",".j_beMember",function(){$(this).css({"background-color":"#fff"})})},_bindOrderRepostEvents:function(){var t=$("#thread_list");t.delegate(".j_order_repost_toggle","click",function(t){try{var e=$(this),i=e.closest(".order_repost_wrap"),a=i.find(".j_order_repost_countdown"),s=i.find(".order_repost_time"),n=a.find(".j_order_repost_countdown_d"),r=a.find(".j_order_repost_countdown_h"),o=a.find(".j_order_repost_countdown_m"),d=a.find(".j_order_repost_countdown_s"),c=i.find(".j_order_repost_award_list"),_=1e3*a.tbattr("data-time"),l="\u5C55\u5F00"==e.text()?"\u6536\u8D77":"\u5C55\u5F00",h=0;t.preventDefault(),i.toggleClass("order_repost_fold"),e.text(l),i.hasClass("order_repost_fold")?(c.wrap("<marquee></marquee>"),clearInterval(h)):(c.parent().is("marquee")&&c.unwrap("<marquee></marquee>"),_-+new Date>0&&(h=setInterval(function(){var t=+new Date,e=_-t;return oneDay=864e5,oneHour=36e5,oneMin=6e4,oneSnd=1e3,newDay=0,newHour=0,newMin=0,newSnd=0,1e3>e?(d.text("00"),s.text("\u6D3B\u52A8\u5DF2\u7ED3\u675F"),clearInterval(h),void 0):(newDay=Math.floor(e/oneDay),newHour=Math.floor((e-newDay*oneDay)/oneHour),newMin=Math.floor((e-newDay*oneDay-newHour*oneHour)/oneMin),newSnd=Math.floor((e-newDay*oneDay-newHour*oneHour-newMin*oneMin)/oneSnd),n.text(10>newDay?"0"+newDay:newDay),r.text(10>newHour?"0"+newHour:newHour),o.text(10>newMin?"0"+newMin:newMin),d.text(10>newSnd?"0"+newSnd:newSnd),void 0)},1e3)))}catch(m){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:m.message||m.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1265}),m}})},_bindThreadStat:function(){if("1"!=$(".content_leftList").tbattr("data-bindthreadttat")){var t=PageUnit.load("thread_list_firstpage_floor_stat");t&&($(".content_leftList").on("click",".threadlist_bright .j_thread_list .threadlist_title a",function(){try{var t=$.tb.location.getSearchValue().pn;if(t&&t>0)return;if(!$(this).closest(".j_thread_list",".content_leftList").parent().hasClass("threadlist_bright"))return;var e=0;e+=$(".threadlist_bright .thread_notice").length,e+=$(".threadlist_bright .thread_top_list_folder").length;var i=$(this).closest(".j_thread_list",".content_leftList").index()+1;i-=e,$.stats.track(i,"frs_thread_stat","frs","click",{obj_type:"\u5206\u53D1"})}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1289}),a}}),$(".content_leftList").tbattr("data-bindthreadttat","1"))}},_bindGameEvents:function(){this._bindGameImgViewer(),this._bindGameDescViewer(),this._addGameTrack(),this._addGameDownloadEvent()},_addGameTrack:function(){$("#thread_list").on("click",".mobile_game_gift_link",function(){try{var t=$(this),e=t.tbattr("href");$.stats.track("\u793C\u5305","\u6E38\u620F\u5427\u6E38\u620F\u8D34","frs","click",{obj_link:e})}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1308}),i}}),$("#thread_list").on("click",".j_game_thread_play_outer",function(){try{var t=$(this),e=t.data("game_id");$.stats.track("\u5F00\u59CB\u6E38\u620F","\u6E38\u620F\u5427\u6E38\u620F\u8D34","frs","click",{obj_game_id:e})}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1316}),i}})},_bindGameImgViewer:function(){},_addGameDownloadEvent:function(){$(".j_game_thread_download").on("click",".j_game_thread_download_btn",function(){try{var t=$(this).closest(".j_game_thread_download_outer"),e=t.data("game_id"),i=t.data("game_name"),a=$(this).closest(".j_thread_list").index()+1;$("#thread_list .thread_top_list_folder").length>0&&a--,10>a&&(a="0"+a),$.stats.track("p10"+a,"mg_pioneerba","frs","download",{obj_id:e,obj_name:i,obj_ref:3000602})}catch(s){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1349}),s}}),$(".j_game_thread_download").on("mouseenter",".j_game_thread_download_btn",function(){var t=$(this),e=t.tbattr("href"),i=t.tbattr("data-to-detail"),a=t.next(),s=a.find(".j_game_thread_download_qrcode_img");"-1"!=i&&$.JsLoadManager.use("../../../static/js/qrcode.js",function(){s.html(""),new window.QRCode(s[0],{text:e,width:80,height:80}),a.show()})}),$(".j_game_thread_download").on("mouseleave",".j_game_thread_download_btn",function(){var t=$(this),e=t.next();e.hide()})},_bindGameDescViewer:function(){$(".game_thread_detail_main").on("click",".j_text_more",function(){try{var t=$(this),e=t.data("show"),i="";"text_detail"==e?(i=t.getData().text_cutoff,t.html('[\u8BE6\u7EC6\u4ECB\u7ECD<span class="slide_btn downward"></span>]'),t.data("show","text_cutoff")):e&&"text_cutoff"!=e||(i=t.getData().text_detail,t.html('[\u6536\u8D77\u4ECB\u7ECD<span class="slide_btn upward"></span>]'),t.data("show","text_detail")),t.siblings(".j_text_show").html(i)}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/thread_list_eden/js/thread_list_eden_main.js",method:"",ln:1396}),a}})},brandShowCount:function(t){var e=t.brandskin_show_count;e>0&&$.stats.track("\u5C55\u793A","\u53D1\u5E16\u7279\u578B\u5C55\u793A\u6570\u91CF","frs","show",{show_count:e})}}}),FrsThread={},FrsThread.resizePic=function(t,e,i,a,s){function n(t,e,i,a){var s=0,n=t,r=e;switch(t>i&&(s+=1),e>a&&(s+=2),s){case 1:n=i,n=e*i/t;case 2:r=a,n=t*a/e;case 3:r=e/a>t/i?a:e*i/t,n=e/a>t/i?t*a/e:i}return 0!=s&&(d=!0),[n,r]}var r=e||120,o=i||120,d=!1,c=t;if(0==c.width||0==c.height)return!1;var _=n(c.width,c.height,r,o);return"undefined"!=typeof a&&(t=a),s&&s(a,_[0]),t.style.width=_[0]+"px",t.style.height=_[1]+"px",t.style.visibility="visible",d};
;var TiebaFrs={_picWidth:534,resizePic:function(i,e,t,a){function s(i,e,t,a){var s=0,r=i,c=e;switch(i>t&&(s+=1),e>a&&(s+=2),s){case 1:r=t,r=e*t/i;case 2:c=a,r=i*a/e;case 3:c=e/a>i/t?a:e*t/i,r=e/a>i/t?i*a/e:t}return 0!=s&&(n=!0),[r,c]}var r=e||120,c=t||120,n=!1,d=i;if(0==d.width||0==d.height)return!1;var o=s(d.width,d.height,r,c);return"undefined"!=typeof a&&(i=a),i.style.width=o[0]+"px",i.style.height=o[1]+"px",i.style.visibility="visible",n},closeMedia:function(i){var e=$("#"+i);if(e){var t=e.closest(".j_thread_list"),a=t.find(".j_remove");a.remove()}},PreviewImage:function(i,e,t){var a=$("#"+i);if(a){var s=a.closest(".j_thread_list"),r=(new Date).getTime(),c=['<div dr="G" class="media_box j_remove j_media_box">','<div class="media_disp">','<div class="media_pic_control">','<a class="tb_icon_retract"  href="#" >\u6536\u8D77</a>','<span class="line">|</span>','<a target="_blank"  class="tb_icon_ypic j_ypic" href="'+e+'">\u67E5\u770B\u539F\u56FE</a>','<span class="line">|</span>','<a target="_blank" href="#" class="tb_icon_turnleft j_rotation_left" for="big_img_'+r+'" onclick="return false;" >\u5411\u5DE6\u8F6C</a>','<span class="line">|</span>','<a target="_blank" href="#" class="tb_icon_turnright j_rotation_right" for="big_img_'+r+'" onclick="return false;" >\u5411\u53F3\u8F6C</a>',"</div>",'<div class="media_bigpic j_media_bigPic">','<img id="big_img_'+r+'" src="'+e+'" onload="TiebaFrs.resizePic(this,'+this._picWidth+',6000);" onerror="this.src=\'http://tb2.bdstatic.com/tb/static-frs/img/v2/picerr.gif\';this.width=82;this.height=75;"/>',"</div>","</div>","</div>"].join("");s.find(".threadlist_tuiguang_nomedia").before(c),s.find("a.tb_icon_retract").bind("click",function(){try{return TiebaFrs.closeMedia(i),t&&t(),!1}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/api.js",method:"",ln:100}),e}}),s.find("div.j_media_bigPic img").bind("click",function(){try{return TiebaFrs.closeMedia(i),t&&t(),!1}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/api.js",method:"",ln:107}),e}})}},PreviewVideo:function(i,e,t){var a=$("#"+i);if(a){var s=a.closest(".j_thread_list"),r=['<div dr="H" class="media_box j_remove j_media_box">','<div class="media_disp">','<div class="media_pic_control">','<a class="tb_icon_retract"  href="#">\u6536\u8D77</a>',"</div>",'<embed scale="noborder" allowfullscreen="true" allowscriptaccess="never" src="'+$.tb.escapeHTML(e)+'" menu="false" loop="false" play="true" wmode="transparent" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" class="BDE_Flash" width="'+this._picWidth+'" height="386">',"</div>","</div>"].join("");s.find(".threadlist_tuiguang_nomedia").before(r),s.find("a.tb_icon_retract").bind("click",function(){try{return TiebaFrs.closeMedia(i),t&&t(),!1}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/thread_list_eden/js/api.js",method:"",ln:137}),e}})}}};_.Module.define({path:"common/widget/AudioPlayer",requires:[],sub:{defaultOptions:{src:"http://play.baidu.com/player/static/flash/fmp.swf"},isReady:!1,isPlaying:!1,isMute:!1,volume:void 0,url:"",initial:function(t){var e=this;this.options=$.extend(this.defaultOptions,t);var i=$("<div></div>").css({width:1,height:1,overflow:"hidden"});i.appendTo("body"),i.html(this.renderSwf(this.options.src)),$swf=i.find("object");var s=$.browser.msie?$swf[0]:$swf.find("embed")[0];this.$container=i,this.$swf=$swf,this.swfObject=s;var a=setInterval(function(){100===e.swfObject.PercentLoaded()&&(clearInterval(a),setTimeout(function(){e.onSwfLoaded()},100))},100);window.pl=this},onSwfLoaded:function(){this.isReady=!0,this.bindEvents(),this.trigger("playerloaded",this)},renderSwf:function(){var t=['<object id="audio_player_core" width="#{width}" height="#{height}" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#4,0,0,0">','<param name="quality" value="high" />','<param name="allowscriptaccess" value="always">','<param name="scale" value="noscale">','<param name="wmode" value="window">','<param name="movie" value="#{srcWithStamp}">','<embed name="audio_player_core" width="#{width}" height="#{height}" allowscriptaccess="always" wmode="window" scale="noscale" src="#{srcWithStamp}" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">',"</object>"].join("");return function(e){return $.tb.format(t,{src:e,srcWithStamp:e,width:1,height:1})}}(),bindEvents:function(){this.bind("reset",this._reset,this),this.bind("load",this._load,this),this.bind("play",this._play,this),this.bind("pause",this._pause,this),this.bind("stop",this._stop,this),this.bind("setmute",this._setMute,this)},_reset:function(){this.stop(),this.url="",this.isPlaying=!1},_load:function(t,e,i,s){function a(){var t=n._getLoadedPercent();return t>.3?(n.trigger("songloaded",t),n.failHandler&&clearTimeout(n.failHandler),i&&i(),!0):!1}var n=this;this.url=e,this.swfObject.closeStream(),this.swfObject.f_load(e),this.failHandler&&clearTimeout(this.failHandler),this.failHandler=setTimeout(function(){s&&s()},5e3),this.checkLoadedHandler&&clearTimeout(this.checkLoadedHandler),this.checkLoadedHandler=setTimeout(function(){a()||(n.checkLoadedHandler=setTimeout(arguments.callee,50))},50)},_play:function(t,e,i,s){function a(){var t=n._getCurrentPosition();return i&&i({percent:t,totalTime:n._getTotalTime(),currentTime:n._getCurrentTime()}),1==t?(n.trigger("playfinish",t),s&&s(),!0):!1}var n=this;if(!this.isPlaying){var o=this._getTotalTime();this.swfObject.f_play(),this.checkFinishedHandler&&clearTimeout(this.checkFinishedHandler),this.isPlaying=!0,e&&e({totalTime:o}),this.checkFinishedHandler=setTimeout(function(){a()||(n.checkFinishedHandler=setTimeout(arguments.callee,500))},1e3)}},_pause:function(){this.isPlaying&&(this.swfObject.f_pause(),this.isPlaying=!1)},_stop:function(){this.swfObject.f_stop(),this.checkFinishedHandler&&clearTimeout(this.checkFinishedHandler),this.isPlaying=!1},_setMute:function(t,e){this.isMute=e,this.swfObject.setData("mute",e)},_setVolume:function(t,e){this.volume=e,this.swfObject.setData("volume",e)},_setCurrentPosition:function(){},_getCurrentPosition:function(){return this.swfObject.getData("postionPct")},_getLoadedPercent:function(){return this.swfObject.getData("loadedPct")},_getTotalTime:function(){return this.swfObject.getData("length")},_getCurrentTime:function(){return this.swfObject.getData("currentPosition")}}});_.Module.define({path:"common/widget/Voice",requires:["common/widget/Card","common/widget/AudioPlayer"],sub:{version:"0.1",api:"/voice/index?",pidWhiteList:[40649447103,40649504943,40649558518,40649601183],initial:function(t){if(!PageData.pbVoiceLoaded){PageData.pbVoiceLoaded=!0;this.product=PageData.product,this.product&&(this.api=t&&t.api||this.api,this.useMd5=t&&t.useMd5,this.canPlay=t&&t.canPlay,$("body").on("click",".voice_player a ",function(t){t.preventDefault()}),this.initPlayer(),$(window).bind("initvoicelength",function(t,e){var a=$(e),i=a.find(".minute"),n=a.find(".second");if(i.length>0||n.length>0&&n.text()>=30)a.width(125);else if(n.length>0){var r=n.text();5>=r?a.width(50):a.width(50+3*(r-5))}}),$(".voice_player .time").each(function(){$(window).trigger("initvoicelength",this)}))}},initPlayer:function(){var t=this;this.player=this.use("common/widget/AudioPlayer"),this.player.bind("playerloaded",function(){t.bindPlayerEvent(),t.player._setVolume("",100)})},bindPlayerEvent:function(){var t=this,e=this.animateIcon,a=this.player,i=null;$("body").on("click",".voice_player a",function(n){function r(t){t.totalTime>0&&!m.data("time")&&0!=t.totalTime&&m.data("time",t.totalTime)}function o(e){var a=(0!=e.totalTime?e.totalTime:m.data("time"))-e.currentTime;t.updateTime(m,a)}function s(){p.data("state",""),t.resetTime(m),e.reset(c)}n.preventDefault(),$.stats.track("voice_btn_total","pc_voice");{var l,d,p=$(this).parent(".voice_player"),c=p.find(".speaker"),m=p.find(".time"),u=p.hasClass("voice_player_mini");u?"lzl":t.product}if(p.hasClass("in_live_thread")){var g=p.data("info")||{};l=g.tid,d=g.pid}else"pb"===t.product?(l=PageData.thread&&PageData.thread.thread_id,d=u?p.parents(".j_lzl_s_p").getData().spid:p.parents(".l_post").getData().content.post_id):"frs"==t.product?l=p.parents(".j_thread_list").data("field").id:"index"==t.product&&(l=p.data("tid"));var h="";if(h=1==t.useMd5?t.api+"?voice_md5="+p.data("md5")+"&kw="+PageData.forum.forum_name+"&tbs="+PageData.tbs:t.api+"tid="+l+(d?"&pid="+d:""),1!=t.canPlay&&-1==$.inArray(d,t.pidWhiteList))return i&&(a.trigger("stop"),t.resetPrevPlayer(i)),void 0;if("playing"===p.data("state"))a.trigger("stop"),p.data("state",""),e.reset(c),t.resetTime(m),$.stats.track("voice_stop","pc_voice");else{t.resetPrevPlayer(i),a.trigger("stop"),p.data("state","playing"),e.set(c,"loading"),$.stats.track("voice_play","pc_voice");var f=m.find(".minute"),v=m.find(".second"),y=f.length>0?+f.html():0,_=v.length>0?+v.html():0;m.data("time",6e4*y+1e3*_),a.trigger("load",h,function(){a.trigger("play",r,o,s),e.set(c,"playing")},function(){a.trigger("stop"),p.data("state",""),e.reset(c),t.resetTime(m);var i=$.tb.alert({title:"\u64AD\u653E\u5931\u8D25",message:"\u6211\u4E0D\u662F\u6545\u610F\u7684\uFF0C\u64AD\u653E\u5931\u8D25\u4E86\uFF0C\u8BF7\u518D\u8BD5\u4E00\u4E0B\u5427~",buttons:[{text:"\u786E\u8BA4"}],width:310});i.modal.bind("click",function(){i.hide()})}),i=p}})},updateTime:function(t,e){e=e||t.data("time")||0;var a=Math.floor(e/6e4),i=Math.round(e%6e4/1e3),n="";a>0&&(n+='<span class="minute">'+a+"</span>'"),(i>0||a>0)&&(n+='<span class="second">'+i+'</span>"'),t.html(n)},resetTime:function(t){this.updateTime(t)},resetPrevPlayer:function(t){if(t){var e=t.find(".speaker"),a=t.find(".time");t.data("state",""),this.resetTime(a),this.animateIcon.reset(e)}},animateIcon:function(){function t(t,e){if($.browser.mozilla){var a=t.parent().parent().hasClass("loading")?"loading":"playing",i=t.parent().parent().parent().hasClass("voice_player_mini")?"mini":"normal",n=e+"px "+o[i][a]+"px";t.css("background-position",n)}else t.css("background-position-x",e)}function e(e,o){l&&a(l),a(e),l=e,e.parent().parent().addClass(o);var d=e.parent().parent().parent().hasClass("voice_player_mini")?"mini":"normal";"playing"===o?(e.parent().parent().hasClass("voice_player_mini")?t(e,-38):t(e,-58),s=setTimeout(function(){var a=0;return function(){a=(a+1)%4,t(e,i[d][a]),s=setTimeout(arguments.callee,r[o])}}(),r[o])):"loading"===o&&(e.parent().parent().hasClass("voice_player_mini")?t(e,-1):t(e,-1),s=setTimeout(function(){var a=0;return function(){a=(a+1)%12,t(e,-1-a*n[d]),s=setTimeout(arguments.callee,r[o])}}(),r[o]))}function a(e){clearTimeout(s),e.parent().parent().removeClass("loading playing"),e.parent().parent().parent().hasClass("voice_player_mini")?t(e,-38):t(e,-58)}var i={normal:[-1,-20,-39,-58],mini:[1,-12,-25,-38]},n={normal:20,mini:15},r={playing:400,loading:100},o={normal:{playing:-202,loading:-167},mini:{playing:-264,loading:-237}},s=null,l=null;return{set:e,reset:a}}()}});_.Module.define({path:"pb/widget/Repost",requires:["common/component/JsPager"],sub:{initial:function(e,t){try{var a=this;this.like_list=e,this.is_overflow=t,this.user=PageData.user,this.can_submit=!0,$(".j_repost_btn").on("click",function(){try{var e=$(this).getData();return a.j_repost_btn_click=$(this),a.tid=e.tid,a.title=$(this).tbattr("data-title"),a.original_forum_id=e.fid,a.showDialog(),!1}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/repost/repost.js",method:"",ln:25}),t}}),$(".j_forum_link").on("mousedown",function(){({st_mod:"repost_forum",st_type:"enterba",st_from:PageData.product,st_uid:PageData.user.user_id,st_benba:encodeURIComponent(PageData.forum.forum_name),st_goto:encodeURIComponent($(this).text())})})}catch(s){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"pb:widget/repost/repost.js",method:"",ln:37}),s}},resizePic:function(){this.j_pb_repost=$("#j_pb_repost"),this.j_pb_repost_content=this.j_pb_repost.find(".j_repost_content"),$("#j_pb_repost img").one("load",function(){$.resizePic($(this),500,9999)})},initScrollPanel:function(){var e=this;$.JsLoadManager.use("http://tieba.baidu.com/tb/static-common/lib/jquery-ui-1.10.0.draggable.min.js",function(){_.Module.use("common/widget/ScrollPanel",{container:"#j_pb_repost_detail",height:352,_scrollStep:120,content:""},function(t){e.scrollPanel=t,t.setContent(e.j_pb_repost_content[0])})})},initPager:function(){var e=this,t=this.j_pb_repost.find(".j_repost_btn"),a=t.getData()&&t.getData().tid;if(a){var s=this.j_pb_repost.find(".repost_pager"),i=s.getData().total_page;_.Module.use("common/component/JsPager",{container:s,current:1,amount:8,total:i},function(t){t.bind("pageChange",function(s,i){var o="/p/repost";$.ajax({url:o,type:"post",data:{t_id:a,pn:i},dataType:"json"}).done(function(a){if(0===a.no){for(var s='<ul class="repost_content j_repost_content">',o="",n=0;n<a.data.content_list.length;n++)o=a.data.content_list[n],s+=0===n?'<li class="repost_floor repost_floor_first clearfix">':'<li class="repost_floor clearfix">',s+=o.content,s+='<span class="floor_num">'+o.floor+"\u697C</span></li>";s+="</ul>",e.scrollPanel.setContent(s),$("#j_pb_repost img").one("load",function(){$.resizePic($(this),500,9999)}),t.initial({current:i})}})})})}},showDialog:function(){if(this.isLogin()){var e;this.initData(),0===this.like_forums_names.length?(e="\u4EB2\uFF0C\u76EE\u524D\u53EA\u80FD\u8F6C\u53D1\u5230\u4F60\u5173\u6CE8\u7684\u5427\u54E6\uFF0C\u8BF7\u5148\u53BB\u201C\u5173\u6CE8\u201D\u4F60\u8981\u8F6C\u53D1\u5230\u7684\u5427\u3002",this.showErrDialog(e)):1==this.like_forums_names.length&&this.like_forums_names[0]==PageData.forum.forum_name?(e="\u4EB2\uFF0C\u53EA\u80FD\u8F6C\u53D1\u5230\u672C\u5427\u4E4B\u5916\u4F60\u5173\u6CE8\u8FC7\u7684\u5427\u54E6\uFF0C\u8BF7\u5148\u53BB\u201C\u5173\u6CE8\u201D\u4F60\u8981\u8F6C\u53D1\u5230\u7684\u5427\u3002",this.showErrDialog(e)):this.showRepostDialog()}},initData:function(){this.like_forums_names=[],this.can_post_forums=[];var e={},t=null;if(this.like_list)for(var a=0;a<this.like_list.length;a++)t=this.like_list[a],t.id=t.id,t.forum_name=$.tb.unescapeHTML(t.forum_name.replace(/\s/g," ")),this.like_forums_names.push(t.forum_name),this.can_post_forums.push(t.forum_name),e[t.forum_name]=t;this.like_forums=e},showErrDialog:function(e){new $.dialog({html:'<span class="repost_err_dlg">'+e+"</span>",title:"\u8F6C\u53D1\u63D0\u793A",showShadow:!0,width:420})},showRepostDialog:function(){var e=this;this.dlg?(this.dlg.show(),this.dlg.setContent(this.getRepostHtml())):this.dlg=new $.dialog({html:e.getRepostHtml(),title:"\u8F6C\u53D1",showShadow:!0,width:420,hideOnclose:!0}),this.getElement(),this.bindEvent()},getRepostHtml:function(){var e=['<div class="repost_dialog" id="j_repost_dialog">','<div class="repost_item repost_item_title ui-front clearfix">','<label for="j_repost_title" class="repost_label">\u8D34\u5B50\uFF1A</label><span class="repost_title">'+$.tb.subByte(PageData.thread.title,36)+"</span>","</div>",'<div class="repost_item repost_item_fname j_forum_name_wrap ui-front clearfix">','<label for="j_forum_name" class="repost_label">\u8F6C\u53D1\u5230\uFF1A</label><input type="text" class="ui_textfield repost_text_fname" id="j_forum_name">',"</div>",'<div class="like_forums j_like_forums clearfix">'].join(""),t=[];for(var a in this.like_forums)if(this.like_forums[a].id!=this.original_forum_id&&this.like_forums[a].forum_name!=PageData.forum.forum_name){var s={id:this.like_forums[a].id,forum_name:this.like_forums[a].forum_name};t.push('<a href="javascript:void(0)" title="'+this.like_forums[a].forum_name+'" '+$.tb.dataField(s)+' class="like_forums_item j_like_forum_item"><span>'+this.like_forums[a].forum_name+"\u5427</span></a>")}t=t.join("");var i=["</div>",'<div class="repost_item repost_item_reason j_reason_wrap">','<label for="j_reason" class="repost_label">\u7406\u7531\uFF1A</label><textarea class="ui_textfield repost_text_reason" id="j_reason"></textarea>',"</div>",'<a href="javascript:void(0)" class="ui_btn ui_btn_m" id="j_submit">',"<span><em>\u8F6C \u53D1</em></span>","</a>","</div>"].join("");return e+t+i},getElement:function(){var e=this.j_repost_dlg=$("#j_repost_dialog");this.j_dlg_content=e.parents(".dialogJcontent"),this.j_like_forums=e.find(".j_like_forums"),this.j_forum_name_wrap=e.find(".j_forum_name_wrap"),this.j_forum_name=e.find("#j_forum_name"),this.j_reason=e.find("#j_reason"),this.j_submit=e.find("#j_submit")},bindEvent:function(){var e=this;$.JsLoadManager.use("http://tb1.bdstatic.com/tb/static-common/js/jquery-ui-autocomplete.min.js",function(){e.j_forum_name.autocomplete({source:e.can_post_forums,minLength:0}),e.j_forum_name.bind("click",function(){try{$(this).autocomplete("search","")}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/repost/repost.js",method:"",ln:231}),e}})}),this.bindPlaceholderEvent(),this.bindWordLimitEvent(),this.bindLikedForumsClickEvent(),this.bindSubmitEvent()},bindPlaceholderEvent:function(){_.Module.use("common/widget/Placeholder",["#j_forum_name","\u8BF7\u9009\u62E9\u4F60\u8981\u8F6C\u53D1\u5230\u7684\u5427"],function(){}),_.Module.use("common/widget/Placeholder",["#j_reason","\u8FD9\u4E2A\u6D3B\u52A8\u5F88\u7ED9\u529B\uFF0C\u5C0F\u4F19\u4F34\u4EEC\u4E0D\u8981\u9519\u8FC7\u54E6\uFF01"],function(){})},bindWordLimitEvent:function(){var e=this,t={container:".j_reason_wrap",inputObj:"#j_reason",showLimit:280,maxNum:280,numStyle:{color:"red"}};_.Module.use("common/widget/WordLimit",[t],function(t){e.word_limit_instance=t,t.init()})},bindLikedForumsClickEvent:function(){var e,t=this;this.j_like_forums.delegate(".j_like_forum_item","click",function(){try{return e=$(this).getData(),t.j_forum_name.val(e.forum_name.replace(/\s/g," ")).trigger("change"),t.j_forum_name_wrap.find("a").remove(),t.j_forum_name_wrap.append($(this).clone()),t.j_like_forums.find("a").removeClass("disabled"),$(this).addClass("disabled"),t.j_forum_name.addClass("disabled").autocomplete({disabled:!0}),!1}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"pb:widget/repost/repost.js",method:"",ln:276}),a}}),this.j_forum_name_wrap.delegate(".j_like_forum_item","click",function(){try{return title=$(this).tbattr("title"),t.j_forum_name.val("").trigger("change"),t.j_like_forums.find('a[title="'+title.replace(/\s/g," ")+'"]').removeClass("disabled"),$(this).remove(),t.j_forum_name.removeClass("disabled").autocomplete({disabled:!1}),!1}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/repost/repost.js",method:"",ln:286}),e}})},bindSubmitEvent:function(){var e=this;this.j_submit.bind("click",function(){try{return e.isLogin&&e.checkInputs(function(){e.can_submit&&e.initPostData()}),!1}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/repost/repost.js",method:"",ln:299}),t}})},checkInputs:function(e){var t=this,a=this.j_forum_name.val();return""===a?(this.can_submit=!1,this.msgDialog("FNAME IS NULL"),!1):t.word_limit_instance.exceed?(this.can_submit=!1,!1):(this.can_submit=!0,$.get("/f/commit/share/fnameShareApi",{ie:"utf-8",fname:a.replace(/\s/g," ")},function(a){return a&&0!==a.no?(t.can_submit=!1,t.msgDialog("FNAME NOT EXSIT"),!1):(a&&0==a.no&&(t.can_submit=!0,t.target_fid=a.data.fid,e()),void 0)},"json"),!0)},initPostData:function(){{var e=this;this.j_forum_name.val()}this.target_fid=this.target_fid,this.repost_reason=this.j_reason.val()||"\u8FD9\u4E2A\u6D3B\u52A8\u5F88\u7ED9\u529B\uFF0C\u5C0F\u4F19\u4F34\u4EEC\u4E0D\u8981\u9519\u8FC7\u54E6\uFF01",this.post_obj={ptid:e.tid,title:e.title,ftid:e.target_fid,content:e.repost_reason,ie:"utf-8",tbs:PageData.tbs,new_vcode:1,tag:11},this.postData()},showCaptchaDialog:function(e){var t=this,a=e.data.vcode.str_reason,s=e.data.vcode.thread_content;a=a.replace(/\u53D1\u8D34/g,"\u8F6C\u8D34"),_.Module.use("common/component/CaptchaDialog",{title:"\u8F6C\u53D1",message:a,vCode:e.data.vcode.captcha_vcode_str,vCodeType:e.data.vcode.captcha_code_type,forumName:PageData.forum.forum_name,forumId:t.target_fid,postType:"thread",paramsCallback:function(){var e={title:t.title,content:t.repost_reason};return $.extend(e,s)}},function(e){t.captchaDialog=e,e.bind("onclose",function(){return e.hide(),!1}),e.bind("onaccept",function(){t.post_obj.vcode=e.getInputValue(),t.post_obj.vcode_md5=e.getVCode(),t.postData()}),e.show()})},postData:function(){var e=this,t="/relay/commit";$.ajax({url:t,type:"post",data:e.post_obj,dataType:"json"}).done(function(t){if(0===t.no){e.showSuccess(t.new_thread_id,t.new_post_id);var a=e.j_repost_btn_click.closest(".j_repost_btn_wrap").find(".j_repost_count"),s=a.text();"(+1)"==s&&(s="0"),s=s.replace(/\d+/,function(e){return e=parseInt(e)+1,e+""}),a.text(s),setTimeout(function(){$.tb.location.reload()},200)}else 40===t.no?e.captchaDialog?(e.captchaDialog.setTip(t.data.vcode.str_reason),e.captchaDialog.updateCaptchaImg(t.data.vcode.captcha_vcode_str,t.data.vcode.captcha_code_type),e.captchaDialog.show(),e.captchaDialog.focus()):e.showCaptchaDialog(t):e.msgDialog(t.no)}).fail(function(){e.msgDialog("POST ERROR")})},isLogin:function(){return this.user.is_login?this.user.no_un?(TbCom.process("User","buildUnameFrame"),!1):!0:(_.Module.use("common/widget/LoginDialog",["","userBar"]),!1)},showSuccess:function(e,t){var a=this,s=(this.j_repost_dlg.parent().height(),"/p/"+e+(t?"?pid="+t+"#"+t:"")),i=['<div class="editor_tip_show j_repost_msg editor_tip_show_repost" style="top: 125px; left: 155px;">','<div class="editor_banned_tip_info">','<span style="display:block;height:17px;line-height:17px;font-weight:bold;"><img style="float:left;margin-right:4px;" src="http://static.tieba.baidu.com/tb/static-pb/img/success.gif" alt="ok"/>\u8F6C\u53D1\u6210\u529F\uFF01</span>','<a class="repost_link" target="_blank" href="'+s+'">\u67E5\u770B\u8F6C\u8D34</a>',"</div>","</div>"].join("");this.j_dlg_content.addClass("gray_wrap"),this.j_repost_dlg.append(i),setTimeout(function(){a.j_dlg_content.removeClass("gray_wrap"),a.j_repost_dlg.find(".j_repost_msg").remove(),a.dlg.hide()},3e3)},msgDialog:function(e){var t,a=this;switch(e){case"FNAME IS NULL":t="\u8BF7\u9009\u62E9\u8981\u8F6C\u53D1\u7684\u5427";break;case"NOT LIKE":t="\u53EA\u80FD\u8F6C\u53D1\u5230\u4F60\u5173\u6CE8\u8FC7\u7684\u5427";break;case"FNAME NOT EXSIT":t="\u8BE5\u5427\u4E0D\u5B58\u5728\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165";break;case"POST ERROR":t="\u7CFB\u7EDF\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5";break;case 3001:t="\u7528\u6237\u540D\u4E0D\u5B58\u5728";break;case 3002:t="\u4E0D\u80FD\u8F6C\u53D1\u5230\u539F\u8D34\u6240\u5728\u7684\u5427";break;case 3003:t="\u7528\u6237id\u4E0D\u5B58\u5728";break;case 3004:t="\u8F6C\u53D1\u7406\u7531\u4E0D\u80FD\u8D85\u8FC7140\u4E2A\u6C49\u5B57";break;case 3005:case 3006:t="\u8BE5\u8D34\u5427\u4E0D\u5B58\u5728";break;case 3007:t="\u7CFB\u7EDF\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5";break;case 3008:t="\u539F\u8D34\u5DF2\u88AB\u5220\u9664";break;case 3009:t="\u53EA\u6709\u666E\u901A\u8D34\u624D\u53EF\u4EE5\u8F6C\u53D1";break;case 3011:t="\u8F6C\u53D1\u5931\u8D25\uFF0C\u4F60\u6CA1\u6709\u5173\u6CE8\u8BE5\u5427";break;case 10:t="\u8D34\u5B50\u5185\u5BB9\u5305\u542B\u592A\u5C11\u7684\u6587\u5B57";break;case 11:t="\u8D34\u5B50\u6807\u9898\u548C\u5185\u5BB9\u592A\u957F";break;case 12:t="\u64CD\u4F5C\u5931\u8D25\uFF0C\u60A8\u7684\u8D26\u53F7\u56E0\u8FDD\u89C4\u64CD\u4F5C\u800C\u88AB\u5C01\u7981&nbsp;&nbsp;<a href='/pmc/main?fid="+this.target_fid+'\' target="_blank">\u67E5\u770B\u5C01\u7981\u4FE1\u606F</a>';break;case 13:t="\u60A8\u7684\u7F51\u7EDC\u5730\u5740\u7531\u4E8E\u975E\u6CD5\u64CD\u4F5C\u88AB\u5C01";break;case 14:t="\u60A8\u53D1\u5E03\u7684\u8D34\u5B50\u5DF2\u7ECF\u5B58\u5728";break;case 501:case 15:t="\u8BF7\u4E0D\u8981\u53D1\u8868\u542B\u6709\u4E0D\u9002\u5F53\u5185\u5BB9\u7684\u7559\u8A00<br>\u8BF7\u4E0D\u8981\u53D1\u8868\u5E7F\u544A\u8D34";break;case 20:t="\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u7684\u6807\u9898\u6216\u6B63\u6587\u5305\u542B\u592A\u5C11\u7684\u6587\u5B57\uFF0C\u8BF7\u4FEE\u6539\u540E\u518D\u53D1\u8868";break;case 17:t="\u672C\u5427\u5F53\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u53D1\u8D34\uFF01";break;case 9:case 22:t="\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u7CFB\u7EDF\u9700\u8981\u6838\u5B9E\u8BE5\u8D34\u5B50\u5185\u5BB9\u662F\u5426\u542B\u6709\u4E0D\u826F\u4FE1\u606F\uFF0C\u8D34\u5B50\u5728\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85";break;case 33:t="\u60A8\u53D1\u8D34\u592A\u5FEB\u4E86:) \u8BF7\u7A0D\u540E\u518D\u53D1";break;case 34:t="\u60A8\u8BF4\u8BDD\u592A\u5FEB\u4E86:) \u8BF7\u5148\u505C\u4E0B\u6765\u559D\u676F\u8336\u5427\uFF0C\u6216\u8005\u53EF\u4EE5\u53BB\u522B\u7684\u5427\u770B\u770B\u54E6\uFF0C\u4E00\u5B9A\u4F1A\u53D1\u73B0\u8FD8\u6709\u60A8\u611F\u5174\u8DA3\u7684\u8BDD\u9898";break;case 36:t="\u8BF7\u4E0D\u8981\u53D1\u5E7F\u544A\u8D34\uFF01";break;case 37:t="\u60A8\u5DF2\u5C1D\u8BD5\u63D0\u4EA4\u591A\u6B21\u4E86\uFF0C\u8BF7\u8FD4\u56DE\u540E\u5237\u65B0\u9875\u9762\uFF0C\u65B9\u53EF\u91CD\u65B0\u53D1\u8D34";break;case 38:t="\u9A8C\u8BC1\u7801\u8D85\u65F6\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165";break;case 39:t="\u7531\u4E8E\u60A8\u591A\u6B21\u8F93\u9519\u9A8C\u8BC1\u7801\uFF0C\u8BF7\u60A8\u8FD4\u56DE\u540E\u5237\u65B0\u9875\u9762\uFF0C\u65B9\u53EF\u91CD\u65B0\u53D1\u8D34";break;case 41:t="\u60A8\u7684\u8D34\u5B50\u53EF\u80FD\u5305\u542B\u4E0D\u5408\u9002\u7684\u5185\u5BB9\uFF0C\u8BF7\u60A8\u786E\u5B9A\u540E\u518D\u63D0\u4EA4";break;case 42:t="\u60A8\u7684\u53D1\u8D34\u884C\u4E3A\u88AB\u7CFB\u7EDF\u8BA4\u4E3A\u6709\u53D1\u5E7F\u544A\u5ACC\u7591\uFF0C\u8BF7\u60A8\u7A0D\u540E\u518D\u53D1";break;case 43:t="\u60A8\u7684\u53D1\u8D34\u884C\u4E3A\u6216\u8D34\u5B50\u5185\u5BB9\u6709\u5E7F\u544A\u6216\u4E0D\u5408\u9002\u7684\u7279\u5F81\uFF0C\u8BF7\u60A8\u786E\u5B9A\u540E\u518D\u53D1\u9001";break;case 44:t="\u5BF9\u4E0D\u8D77\uFF0C\u672C\u5427\u6682\u65F6\u9650\u5236\u90E8\u5206\u7528\u6237\u53D1\u8868\u4E3B\u9898\u8D34\u5B50\uFF0C\u60A8\u53EF\u4EE5\u6D4F\u89C8\u6216\u56DE\u590D\u672C\u5427\u5176\u5B83\u5185\u5BB9\uFF0C\u7ED9\u60A8\u5E26\u6765\u4E0D\u4FBF\u5E0C\u671B\u5F97\u5230\u60A8\u7684\u8C05\u89E3\u3002";break;case 100:t="\u5BF9\u4E0D\u8D77\uFF0C\u672C\u5427\u6682\u65F6\u9650\u5236\u90E8\u5206\u7528\u6237\u4F7F\u7528\u5B8C\u6574\u7684\u8D34\u5427\u529F\u80FD\uFF0C\u60A8\u53EF\u4EE5\u6D4F\u89C8\u672C\u5427\u5176\u5B83\u5185\u5BB9\uFF0C\u7ED9\u60A8\u5E26\u6765\u4E0D\u4FBF\u5E0C\u671B\u5F97\u5230\u60A8\u7684\u8C05\u89E3\u3002";break;case 308:t="\u7528\u6237\u6743\u9650\u4E0D\u8DB3";break;case 701:case 901:t="\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u8D34\uFF0C\u672C\u5427\u4E0D\u5141\u8BB8\u672A\u767B\u5F55\u7528\u6237\u53D1\u8D34\uFF0C\u767B\u5F55\u7528\u6237\u4E0D\u53D7\u5F71\u54CD\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F";break;case 702:case 902:t="\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u8D34\uFF0C\u672C\u5427\u9650\u5236\u90E8\u5206\u7528\u6237\u53D1\u8D34\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F";break;case 703:case 903:t="\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u8D34\uFF0C\u672C\u5427\u88AB\u8BBE\u7F6E\u4E3A\u4EC5\u672C\u5427\u4F1A\u5458\u624D\u80FD\u53D1\u8D34\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F\u3002<a href='/' target=_blank>\u70B9\u6B64\u7533\u8BF7\u52A0\u5165</a>\u672C\u5427\u4F1A\u5458";break;case 704:case 904:t="\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u8D34\uFF0C\u672C\u5427\u88AB\u8BBE\u7F6E\u4E3A\u4EC5\u672C\u5427\u7BA1\u7406\u56E2\u961F\u624D\u80FD\u53D1\u8D34\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F";break;case 705:case 905:t="\u672C\u5427\u5F53\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u53D1\u8D34\uFF01";break;case 45:t="\u62B1\u6B49\uFF0C\u60A8\u63D0\u4EA4\u7684\u8D34\u5427\u540D\u79F0\u542B\u7279\u6B8A\u5B57\u7B26\uFF0C\u76EE\u524D\u65E0\u6CD5\u521B\u5EFA\uFF0C\u63A8\u8350\u60A8\u4F7F\u7528\u6C49\u5B57\u3001\u5B57\u6BCD\u6216\u6570\u5B57\u4F5C\u4E3A\u8D34\u5427\u540D\u79F0";break;case 900:t="\u4E3A\u62B5\u5FA1\u6316\u575F\u5371\u5BB3\uFF0C\u672C\u5427\u5427\u4E3B\u5DF2\u653E\u51FA\u8D34\u5427\u795E\u517D--\u8D85\u7EA7\u9759\u6B62\u86D9\uFF0C\u672C\u8D34\u6682\u65F6\u65E0\u6CD5\u56DE\u590D\u3002";break;case 4010:t="\u60A8\u7684\u8D26\u53F7\u5B58\u5728\u5B89\u5168\u98CE\u9669\u6682\u4E0D\u80FD\u8F6C\u8D34\uFF0C\u8BF7\u5148\u8FDB\u884C\u624B\u673A\u7ED1\u5B9A\u540E\u518D\u8F6C\u8D34\u5427\u3002";break;case 3013:t="\u6682\u4E0D\u652F\u6301\u8F6C\u53D1\u5230\u8BE5\u5427\uFF0C\u8BF7\u6362\u4E00\u4E2A\u5427\u8BD5\u8BD5\u3002";break;case 49992:t="\u60A8\u7684\u64CD\u4F5C\u592A\u9891\u7E41\uFF0C\u8BF7\u7A0D\u5019\u518D\u8BD5";break;default:t="\u53D1\u751F\u672A\u77E5\u9519\u8BEF"}var s,i=175-t.length%19*6;s=['<div class="editor_tip_show j_repost_msg" style="top: 120px; left: '+i+'px;">','<div class="editor_banned_tip_info">','<span style="font-weight:bold;">'+t+"</span>","</div>","</div>"].join(""),this.j_dlg_content.addClass("gray_wrap"),this.j_repost_dlg.append(s),setTimeout(function(){a.j_dlg_content.removeClass("gray_wrap"),a.j_repost_dlg.find(".j_repost_msg").remove()},1500)}}});_.Module.define({path:"encourage/widget/meizhi_vote",requires:["common/component/Card"],sub:{_visit_card:null,_vote_card:null,_visit_card_ajax:null,_vote_button:null,_visit_card_option:{width:280,height:237},_special_visit_card_option:{width:280,height:210},initial:function(){this._wrap=$("body"),this._is_meizhi=PageData.user.is_login&&PageData.user.meizhi_level>=0?!0:!1,this.bindEvents()},bindEvents:function(){var t=this;this._wrap.delegate(".j_meizhi_vip","mouseenter",function(){return t.buildVisitCard(this),!1}),this._wrap.delegate(".j_meizhi_vip","mouseleave",function(){return t._visit_card_ajax&&t._visit_card_ajax.abort(),t._visit_card&&t._visit_card.closeCard({type:"delayClose",time:200}),t._visit_card=null,!1}),this._wrap.delegate(".j_meizhi_vote","click",function(e){return t._vote_card&&(t._vote_card.closeCard(),t._vote_card=null,t._vote_button==e.target)?(e.preventDefault(),!1):(t.buildVoteCard(this),t._vote_button=e.target,e.preventDefault(),void 0)})},buildVoteCard:function(t){var e=this,i=$(t).getData(),a=i.user_id;$.ajax({type:"post",url:"/encourage/get/meizhi/panel",data:{user_id:a},dataType:"json"}).success(function(i){if(0==i.no){var o=i.data,n=e.buildVoteBtnGroup(o.can_vote,a,o.vote_count),s=$(t),_=s.offset().left-140+s.outerWidth(!0)/2,d=s.offset().top-64-12;e._vote_card&&(e._vote_card.closeCard(),e._vote_card=null),e._vote_card=e.use("common/component/Card",{content:n,card_css:{top:d,left:_,width:280,height:64},attr:"id='meizhi_vote_card'",wrap:$("body")}),e.bindVoteCardEvent()}})},bindVoteCardEvent:function(){var t=this;t._vote_card.showCard(),t._vote_card._j_card.delegate(".j_vote_button","click",function(){$.stats.track("frs_btn","meizhi_vote"),t.vote(this)})},vote:function(t){var e=this,i=$(t),a=i.getData(),o=a.vote_type,n="/encourage/post/meizhi/checkvcode",s="/encourage/post/meizhi/getvcode";_.Module.use("common/component/PostorServiceMeizhi",[],function(t){t.postHandler({data:{content:"",tbs:PageData.tbs,fid:PageData.forum.id||PageData.forum.forum_id,kw:PageData.forum.name,uid:a.user_id,scid:PageData.user.id||0,vtype:o,ie:"utf-8",vcode:""},checkUrl:n,vCodeUrl:s,url:"/encourage/post/meizhi/vote",type:"vote",success:function(t){var a=t,n=$('<img class="add_one_icon" src="/tb/static-encourage/img/meizhi/add_one.gif">');n.appendTo(i).animate({top:"-=20",opacity:0},1e3);var s=e.cutVoteCount(a.vote_count[o]);s=s?s:1,i.find(".j_vote_count").text(s);var _=i.parent();_.find(".j_vote_text").addClass("vote_text_small"),_.find(".j_vote_count").removeClass("hide"),_.siblings(".j_vote_tip").text("\u6295\u7968\u6210\u529F\uFF0C\u5BF9\u8BE5\u7528\u6237\u6BCF\u56DB\u5C0F\u65F6\u53EA\u80FD\u6295\u7968\u4E00\u6B21\u3002"),_.addClass("disabled").find(".j_vote_button").removeClass("j_vote_button"),1==a.hasCheckVcode&&e._msgDialog(),$.stats.track("vote_succ","meizhi_vote")}})})},_msgDialog:function(){var t={image:'<img style="border:none;" src="http://tb1.bdstatic.com/tb/img/messageFace.gif">',subMessage:"\u6295\u7968\u6210\u529F",message:"",dialogSet:{width:410,height:50,title:"\u53D1\u8D77\u6295\u7968"}},e='<div style="margin: 0px 30px 0px 30px;font-size:14px;line-height:20px;text-align:left;font-family: "\u5B8B\u4F53";"><table style="width:90%"><tbody><tr><td width="60">'+t.image+'</td><td valign="middle" style="font-size:20px;line-height:22px;font-family: "\u9ED1\u4F53";">'+t.subMessage+"</td></tr></tbody></table>"+t.message+"</div>";$.dialog.alert(e,t.dialogSet)},buildVisitCard:function(t){var e=this,i=$(t).parent().getData(),a=i.user_id;this._visit_card_ajax&&this._visit_card_ajax.abort(),this._visit_card_ajax=$.ajax({type:"post",url:"/encourage/get/meizhi/panel",data:{user_id:a,type:1},dataType:"json"}).success(function(i){if(0==i.no){var o=i.data,n=o.level-1?o.level-1:"",s=e.calPercent(o.vote_count),_="/i/sys/jump?un="+encodeURIComponent(o.uname)+"&ie=utf-8",d=o.group_info.has_group,v=d?'<span class="group_icon" title="\u5FEB\u5230\u88D9\u91CC\u6765">&nbsp;</span>':"",r=d?'<div class="clearfix"><span style="display:inline;float:left;">Ta\u7684\u7FA4\u7EC4\uFF1A</span><a class="group_name" href="/group/index?id='+o.group_info.group_id+'" target = "_blank" >'+o.group_info.group_name+"</a></div>":"",c=["<a href="+_+' title="\u5934\u50CF" class="meizhi_avatar" target="_blank"><img src="'+o.avatar+'"></a>','<div class="meizhi_corner"></div>','<div class="meizhi_info">','<h1 class="clearfix"><a class="name" href='+_+' title="\u540D\u5B57" target="_blank">'+o.uname+"</a>"+v+"</h1>",r,'<div>\u7B49\u7EA7\uFF1A<span class="level">MVP'+n+"</span></div>",'<div>\u6240\u5728\u5427\uFF1A<span class="forum_name">'+o.forum_name+"\u5427</span></div>","</div>",'<p><a href = "/p/'+o.thread_id+'" target = "_blank" >\u770B\u770BTa\u7684\u8BA4\u8BC1\u8D34>>></a></p>',"<p>\u5DF2\u6295\u7968\u6BD4\u4F8B\uFF1A</p>",'<div class="meizhi_vote_weight_wrap">','<span class="vote_weight_meizhi" style="width:'+s.meizhi_orign_percent+'%">'+s.meizhi_need_percent+"</span>",'<span class="vote_weight_weiniang" style="width:'+s.weiniang_orign_percent+'%;">'+s.weiniang_need_percent+"</span>",'<span class="vote_weight_renyao" style="width:'+s.renyao_orign_percent+'%;">'+s.renyao_need_percent+"</span>","</div>"].join(""),l=e._is_meizhi;l||(c+=o.can_vote?'<p class="j_vote_tip">\u6295\u51FA\u65E0\u8282\u64CD\u7684\u771F\u8BDA\u4E00\u7968\uFF01</p>':"<p>\u6295\u7968\u6210\u529F\uFF0C\u5BF9\u8BE5\u7528\u6237\u6BCF\u56DB\u5C0F\u65F6\u53EA\u80FD\u6295\u7968\u4E00\u6B21\u3002</p>"),c+=e.buildVoteBtnGroup(o.can_vote,a,o.vote_count),c+=e.addTip(o,l);var u=$(t),p=l?e._special_visit_card_option:e._visit_card_option;e._visit_card&&(e._visit_card.closeCard(),e._visit_card=null),e._visit_card=e.use("common/component/Card",{content:c,card_css:{width:p.width,height:p.height},auto_positon:!0,event_target:u,attr:"id='meizhi_visit_card'",wrap:$("body")}),e.bindVisitCardEvent()}})},addTip:function(t,e){var i;return i=e?'<p class="level_up_tip"><span class="level_up_tip_title">\u5B8C\u6210\u5EA6:</span>\u83B7\u5F97'+t.exp_value+"\u70B9\u7ECF\u9A8C\u3001"+t.levelup_left+"\u5F20\u59B9\u7EB8\u7968\u540E\u5347\u7EA7</p>":'<a class="meizhi_card_tip" href="http://tieba.baidu.com/tb/zt/meizhi/index.html" target="_blank">\u4EC0\u4E48\u662F\u59B9\u7EB8\u8BA4\u8BC1\u7CFB\u7EDF>></a>'},calPercent:function(t){var e=t.meizhi+t.weiniang+t.renyao,i=Math.round(t.meizhi/e*100),a=Math.round(t.weiniang/e*100),o=100-i-a,n=10,s=i>n?i+"%":"",_=a>n?a+"%":"",d=o>n?o+"%":"";$.browser.msie&&$.browser.version<8&&(i>30?i-=1:a>30?a-=1:o>30&&(o-=1));var v={meizhi_orign_percent:i,weiniang_orign_percent:a,renyao_orign_percent:o,meizhi_need_percent:s,weiniang_need_percent:_,renyao_need_percent:d};return v},buildVoteBtnGroup:function(t,e,i){var a;if(this._is_meizhi)a=['<div class="meizhi_vote_button_wrap meizhi_disabled">','<div class="vote_button vote_button_meizhi">','<div class="vote_text vote_text_small">\u59B9\u7EB8</div>','<div class="vote_count">'+this.cutVoteCount(i.meizhi)+"</div>","</div>",'<span class="btn_split"></span>','<div class="vote_button vote_button_weiniang">','<div class="vote_text vote_text_small">\u4F2A\u5A18</div>','<div class="vote_count">'+this.cutVoteCount(i.weiniang)+"</div>","</div>",'<span class="btn_split"></span>','<div class="vote_button vote_button_renyao">','<div class="vote_text vote_text_small">\u4EBA\u5996</div>','<div class="vote_count">'+this.cutVoteCount(i.renyao)+"</div>","</div>","</div>"].join("");else if(t){var o={user_id:e,vote_type:"meizhi"},n={user_id:e,vote_type:"weiniang"},s={user_id:e,vote_type:"renyao"};a=['<div class="meizhi_vote_button_wrap">','<div class="j_vote_button vote_button vote_button_meizhi"'+$.tb.dataField(o)+">",'<div class="vote_text j_vote_text">\u59B9\u7EB8</div>','<div class="vote_count j_vote_count hide">'+this.cutVoteCount(i.meizhi)+"</div>","</div>",'<div class="j_vote_button vote_button vote_button_weiniang"'+$.tb.dataField(n)+">",'<div class="vote_text j_vote_text">\u4F2A\u5A18</div>','<div class="vote_count j_vote_count hide">'+this.cutVoteCount(i.weiniang)+"</div>","</div>",'<div class="j_vote_button vote_button vote_button_renyao"'+$.tb.dataField(s)+">",'<div class="vote_text j_vote_text">\u4EBA\u5996</div>','<div class="vote_count j_vote_count hide">'+this.cutVoteCount(i.renyao)+"</div>","</div>","</div>"].join("")}else a=['<div class="meizhi_vote_button_wrap disabled">','<div class="vote_button vote_button_meizhi">','<div class="vote_text vote_text_small">\u59B9\u7EB8</div>','<div class="vote_count">'+this.cutVoteCount(i.meizhi)+"</div>","</div>",'<div class="vote_button vote_button_weiniang">','<div class="vote_text vote_text_small">\u4F2A\u5A18</div>','<div class="vote_count">'+this.cutVoteCount(i.weiniang)+"</div>","</div>",'<div class="vote_button vote_button_renyao">','<div class="vote_text vote_text_small">\u4EBA\u5996</div>','<div class="vote_count">'+this.cutVoteCount(i.renyao)+"</div>","</div>","</div>"].join("");return a},cutVoteCount:function(t){return t>9999?"9999+":t},bindVisitCardEvent:function(){var t=this;this._visit_card.showCard({type:"delayShow",time:200}),this._visit_card._j_card.delegate(".j_vote_button","click",function(){$.stats.track("card_btn","meizhi_vote"),t.vote(this)})}}});
;var Thread_add_result={resultNo:0,fid:"",tid:"",vid:"",sign:"",bdauditreason:0,bdQueryWordEnc:"",autoMsg:"",is_login:0,init:function(e){if(Thread_add_result&&e.data&&"object"==typeof e.data)for(var a in e.data)Thread_add_result[a]=e.data[a];Thread_add_result.resultNo=e.no},isNeedWaitForCheck:function(){var e=!1;switch(this.resultNo){case 9:case 20:case 23:e=!0}return e},isNeedBindPhone:function(){return 4010==this.resultNo},Action_FocusTitle:"focusTitle",Action_FocusContent:"focusContent",Action_ClearYZM:"clearYZM",Action_FocusUrl:"focusUrl",Action_GoToHead:"goToHead",Action_FlushAndGoToHead:"flushAndGoToHead",getActionType:function(){var e="";switch(this.resultNo){case 10:case 14:case 501:case 15:case 36:case 41:case 42:case 43:case 46:case 9001:case 10010:case 10011:case 10012:case 10013:case 220012:case 220015:case 220035:case 2130001:case 2130007:case 2130008:case 2130009:case 2130011:case 2130012:case 2130014:case 2130005:e=this.Action_FocusContent;break;case 11:case 20:e=this.Action_FocusTitle;break;case 17:case 0:e=this.Action_FlushAndGoToHead;break;case 22:case 9:case 23:case 119:case 44:case 100:case 703:case 704:case 705:e=this.Action_GoToHead;break;case 38:case 39:case 40:e=this.Action_ClearYZM;break;case 1120:case 1121:e=this.Action_FocusUrl}return e},getMessage:function(){var e="",a=null;if(this.resultNo>=901&&this.resultNo<=950)return Thread_add_result.autoMsg;switch(null==a&&(a=PageData.forum?PageData.forum.id:null),null==a&&(a=PageData.forum_id),null==a&&(a=PageData.forumID),this.resultNo){case 10:e="\u8D34\u5B50\u5185\u5BB9\u5305\u542B\u592A\u5C11\u7684\u6587\u5B57";break;case 11:e="\u8D34\u5B50\u6807\u9898\u548C\u5185\u5BB9\u592A\u957F";break;case 12:e=null!=a?"\u64CD\u4F5C\u5931\u8D25\uFF0C\u60A8\u7684\u8D26\u53F7\u56E0\u8FDD\u89C4\u64CD\u4F5C\u800C\u88AB\u5C01\u7981&nbsp;&nbsp;<a href='/pmc/main' target=\"_blank\">\u67E5\u770B\u5C01\u7981\u4FE1\u606F</a>":"\u64CD\u4F5C\u5931\u8D25";break;case 13:e=null!=a?"\u64CD\u4F5C\u5931\u8D25\uFF0C\u60A8\u7684\u7F51\u7EDC\u5730\u5740\u7531\u4E8E\u975E\u6CD5\u64CD\u4F5C\u88AB\u5C01<br/><a href='/upc/userinfo?fid="+a+'\' target="_blank">\u67E5\u770B\u5C01\u7981\u4FE1\u606F</a>':"\u60A8\u7684\u7F51\u7EDC\u5730\u5740\u7531\u4E8E\u975E\u6CD5\u64CD\u4F5C\u88AB\u5C01 ";break;case 14:e="\u60A8\u53D1\u5E03\u7684\u8D34\u5B50\u5DF2\u7ECF\u5B58\u5728";break;case 501:case 15:e="\u8BF7\u4E0D\u8981\u53D1\u8868\u542B\u6709\u4E0D\u9002\u5F53\u5185\u5BB9\u7684\u7559\u8A00<br>\u8BF7\u4E0D\u8981\u53D1\u8868\u5E7F\u544A\u8D34";break;case 16:e="\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6240\u8F93\u5165\u7684\u8D34\u5427\u4E0D\u5B58\u5728\u3002\u7531\u4E8E\u7CFB\u7EDF\u5347\u7EA7\u7EF4\u62A4\uFF0C\u65B0\u5EFA\u8D34\u5427\u529F\u80FD\u6682\u505C\uFF0C\u5E0C\u671B\u5F97\u5230\u60A8\u7684\u8C05\u89E3\uFF01";break;case 19:case 200:case 201:case 202:e="\u60A8\u7684\u7528\u6237\u540D\u6216\u8005\u5BC6\u7801\u586B\u5199\u6709\u8BEF\uFF0C\u8BF7\u786E\u8BA4\u540E\u518D\u53D1\u8868";break;case 20:e="\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u7684\u6807\u9898\u6216\u6B63\u6587\u5305\u542B\u592A\u5C11\u7684\u6587\u5B57\uFF0C\u8BF7\u4FEE\u6539\u540E\u518D\u53D1\u8868";break;case 17:e="\u672C\u5427\u5F53\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u53D1\u8D34\uFF01";break;case 18:case 21:e="\u5176\u4ED6\u672A\u77E5\u539F\u56E0";break;case 22:e="\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u7531\u4E8E\u7279\u6B8A\u539F\u56E0\u6211\u4EEC\u9700\u8981\u6838\u5B9E\u8BE5\u8D34\u5185\u5BB9\u662F\u5426\u542B\u6709\u4E0D\u826F\u4FE1\u606F\uFF0C\u6211\u4EEC\u4F1A\u572810\u5206\u949F\u5185\u786E\u8BA4\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85\uFF01";break;case 9:e=this.getCheckMessage(this.bdauditreason);break;case 33:e=1==Thread_add_result.is_login?"\u60A8\u53D1\u8D34\u592A\u5FEB\u4E86:) \u8BF7\u7A0D\u540E\u518D\u53D1":"\u60A8\u53D1\u8D34\u901F\u5EA6\u592A\u5FEB\u4E86\u3002\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u8D34\uFF0C\u7CFB\u7EDF\u5BF9\u533F\u540D\u53D1\u8D34\u8FDB\u884C\u4E25\u683C\u7684\u63A7\u5236\uFF0C\u767B\u5F55\u7528\u6237\u4E0D\u53D7\u5F71\u54CD";break;case 34:e=1==Thread_add_result.is_login?"\u60A8\u8BF4\u8BDD\u592A\u5FEB\u4E86:) \u8BF7\u5148\u505C\u4E0B\u6765\u559D\u676F\u8336\u5427\uFF0C\u6216\u8005\u53EF\u4EE5\u53BB\u522B\u7684\u5427\u770B\u770B\u54E6\uFF0C\u4E00\u5B9A\u4F1A\u53D1\u73B0\u8FD8\u6709\u60A8\u611F\u5174\u8DA3\u7684\u8BDD\u9898":"\u60A8\u53D1\u8D34\u901F\u5EA6\u592A\u5FEB\u4E86\u3002\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u7CFB\u7EDF\u5BF9\u533F\u540D\u53D1\u8D34\u8FDB\u884C\u4E25\u683C\u7684\u63A7\u5236\uFF0C\u767B\u5F55\u7528\u6237\u4E0D\u53D7\u5F71\u54CD";break;case 220034:e="\u60A8\u8BF4\u8BDD\u592A\u5FEB\u4E86:) \u8BF7\u5148\u505C\u4E0B\u6765\u559D\u676F\u8336\u5427\uFF0C\u6216\u8005\u53EF\u4EE5\u53BB\u522B\u7684\u5427\u770B\u770B\u54E6\uFF0C\u4E00\u5B9A\u4F1A\u53D1\u73B0\u8FD8\u6709\u60A8\u611F\u5174\u8DA3\u7684\u8BDD\u9898";break;case 220035:e="\u4EB2\uFF0C\u5DF2@\u4E0D\u5C11\u4EBA\u4E86\uFF0C\u4EE5\u514D\u6253\u6405\u66F4\u591A\u4EBA\uFF0C\u6B47\u4E00\u4F1A\u5427~";break;case 35:e=1==Thread_add_result.is_login?"\u4EB2\uFF0C\u5DF2@\u4E0D\u5C11\u4EBA\u4E86\uFF0C\u4EE5\u514D\u6253\u6405\u66F4\u591A\u4EBA\uFF0C\u6B47\u4E00\u4F1A\u5427~":"\u60A8\u53D1\u8D34\u901F\u5EA6\u592A\u5FEB\u4E86\u3002\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u8D34\uFF0C\u7CFB\u7EDF\u5BF9\u533F\u540D\u53D1\u8D34\u8FDB\u884C\u4E25\u683C\u7684\u63A7\u5236\uFF0C\u767B\u5F55\u7528\u6237\u4E0D\u53D7\u5F71\u54CD";break;case 36:e="\u8BF7\u4E0D\u8981\u53D1\u5E7F\u544A\u8D34\uFF01";break;case 37:e="\u60A8\u5DF2\u5C1D\u8BD5\u63D0\u4EA4\u591A\u6B21\u4E86\uFF0C\u8BF7\u8FD4\u56DE\u540E\u5237\u65B0\u9875\u9762\uFF0C\u65B9\u53EF\u91CD\u65B0\u53D1\u8D34";break;case 38:e="\u9A8C\u8BC1\u7801\u8D85\u65F6\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165";break;case 39:e="\u7531\u4E8E\u60A8\u591A\u6B21\u8F93\u9519\u9A8C\u8BC1\u7801\uFF0C\u8BF7\u60A8\u8FD4\u56DE\u540E\u5237\u65B0\u9875\u9762\uFF0C\u65B9\u53EF\u91CD\u65B0\u53D1\u8D34";break;case 40:e="\u9A8C\u8BC1\u7801\u8F93\u5165\u9519\u8BEF\uFF0C\u8BF7\u60A8\u8FD4\u56DE\u540E\u91CD\u65B0\u8F93\u5165";break;case 41:e="\u60A8\u7684\u8D34\u5B50\u53EF\u80FD\u5305\u542B\u4E0D\u5408\u9002\u7684\u5185\u5BB9\uFF0C\u8BF7\u60A8\u786E\u5B9A\u540E\u518D\u63D0\u4EA4";break;case 42:e="\u60A8\u7684\u53D1\u8D34\u884C\u4E3A\u88AB\u7CFB\u7EDF\u8BA4\u4E3A\u6709\u53D1\u5E7F\u544A\u5ACC\u7591\uFF0C\u8BF7\u60A8\u7A0D\u540E\u518D\u53D1";break;case 43:e="\u60A8\u7684\u53D1\u8D34\u884C\u4E3A\u6216\u8D34\u5B50\u5185\u5BB9\u6709\u5E7F\u544A\u6216\u4E0D\u5408\u9002\u7684\u7279\u5F81\uFF0C\u8BF7\u60A8\u786E\u5B9A\u540E\u518D\u53D1\u9001";break;case 23:e="\u60A8\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u9700\u8981\u7CFB\u7EDF\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u5EFA\u7ACB\u8D34\u5427";break;case 119:e="\u5BF9\u4E0D\u8D77\uFF0C\u672C\u4E3B\u9898\u7684\u56DE\u590D\u6570\u5DF2\u7ECF\u8FBE\u5230\u4E0A\u9650\uFF0C\u611F\u8C22\u60A8\u7684\u53C2\u4E0E\uFF0C\u6B22\u8FCE\u60A8\u6D4F\u89C8\u672C\u5427\u7684\u5176\u5B83\u4E3B\u9898";break;case 1120:e="\u62B1\u6B49\uFF0C\u60A8\u8F93\u5165\u7684\u56FE\u7247\u3001\u89C6\u9891\u94FE\u63A5\u5730\u5740\u9519\u8BEF\uFF0C\u60A8\u53EF\u4EE5\u70B9\u51FB<a href='http://www.baidu.com/search/post_img.html' target='_blank'>\u67E5\u770B\u76F8\u5173\u5E2E\u52A9</a>\u6216\u8FD4\u56DE\u4FEE\u6539";break;case 1121:e="\u62B1\u6B49\uFF0C\u89C6\u9891\u670D\u52A1\u5347\u7EA7\u4E2D\uFF0C\u60A8\u6682\u65F6\u65E0\u6CD5\u53D1\u8868\u5E26\u6709\u89C6\u9891\u7684\u8D34\u5B50\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u8BF7\u539F\u8C05";break;case 44:e="\u5BF9\u4E0D\u8D77\uFF0C\u672C\u5427\u6682\u65F6\u9650\u5236\u90E8\u5206\u7528\u6237\u53D1\u8868\u4E3B\u9898\u8D34\u5B50\uFF0C\u60A8\u53EF\u4EE5\u6D4F\u89C8\u6216\u56DE\u590D\u672C\u5427\u5176\u5B83\u5185\u5BB9\uFF0C\u7ED9\u60A8\u5E26\u6765\u4E0D\u4FBF\u5E0C\u671B\u5F97\u5230\u60A8\u7684\u8C05\u89E3\u3002";break;case 100:e="\u5BF9\u4E0D\u8D77\uFF0C\u672C\u5427\u6682\u65F6\u9650\u5236\u90E8\u5206\u7528\u6237\u4F7F\u7528\u5B8C\u6574\u7684\u8D34\u5427\u529F\u80FD\uFF0C\u60A8\u53EF\u4EE5\u6D4F\u89C8\u672C\u5427\u5176\u5B83\u5185\u5BB9\uFF0C\u7ED9\u60A8\u5E26\u6765\u4E0D\u4FBF\u5E0C\u671B\u5F97\u5230\u60A8\u7684\u8C05\u89E3\u3002";break;case 701:e="\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u4E0D\u5141\u8BB8\u672A\u767B\u5F55\u7528\u6237\u53D1\u8D34\uFF0C\u767B\u5F55\u7528\u6237\u4E0D\u53D7\u5F71\u54CD\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F";break;case 702:e="\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u9650\u5236\u90E8\u5206\u7528\u6237\u53D1\u8D34\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F";break;case 703:e="\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u88AB\u8BBE\u7F6E\u4E3A\u4EC5\u672C\u5427\u4F1A\u5458\u624D\u80FD\u53D1\u8D34\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F\u3002<a href='/f?kw="+this.bdQueryWordEnc+"#1' target=_blank>\u70B9\u6B64\u7533\u8BF7\u52A0\u5165</a>\u672C\u5427\u4F1A\u5458";break;case 704:e="\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u88AB\u8BBE\u7F6E\u4E3A\u4EC5\u672C\u5427\u7BA1\u7406\u56E2\u961F\u624D\u80FD\u53D1\u8D34\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F";break;case 705:e="\u672C\u5427\u5F53\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u53D1\u8D34\uFF01";break;case 706:e="\u62B1\u6B49\uFF0C\u672C\u8D34\u6682\u65F6\u65E0\u6CD5\u56DE\u590D\u3002";break;case 45:e="\u62B1\u6B49\uFF0C\u60A8\u63D0\u4EA4\u7684\u8D34\u5427\u540D\u79F0\u542B\u7279\u6B8A\u5B57\u7B26\uFF0C\u76EE\u524D\u65E0\u6CD5\u521B\u5EFA\uFF0C\u63A8\u8350\u60A8\u4F7F\u7528\u6C49\u5B57\u3001\u5B57\u6BCD\u6216\u6570\u5B57\u4F5C\u4E3A\u8D34\u5427\u540D\u79F0";break;case 46:e="\u62B1\u6B49\uFF0C\u60A8\u7684\u8D34\u5B50\u8FC7\u957F\uFF0C\u65E0\u6CD5\u6B63\u5E38\u63D0\u4EA4\u3002\u5EFA\u8BAE\u60A8\u7CBE\u7B80\u6216\u5206\u6BB5\u540E\u91CD\u65B0\u63D0\u4EA4\uFF0C\u8C22\u8C22!";break;case 800:break;case 801:break;case 802:break;case 803:break;case 804:break;case 805:break;case 806:break;case 807:break;case 808:break;case 809:break;case 814:break;case 815:e="\u62B1\u6B49\uFF0C\u60A8\u5DF2\u9000\u51FA\u767B\u5F55\u6216\u672A\u8D2D\u4E70\u97F3\u4E50\u9053\u5177\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\u91CD\u8BD5";break;case 900:e="\u4E3A\u62B5\u5FA1\u6316\u575F\u5371\u5BB3\uFF0C\u672C\u5427\u5427\u4E3B\u5DF2\u653E\u51FA\u8D34\u5427\u795E\u517D--\u8D85\u7EA7\u9759\u6B62\u86D9\uFF0C\u672C\u8D34\u6682\u65F6\u65E0\u6CD5\u56DE\u590D\u3002";break;case 961:e="\u53D1\u8D34\u5931\u8D25\uFF0C\u60A8\u8F93\u5165\u7684\u56FE\u7247\u5730\u5740\u6709\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u66F4\u6B63\u540E\u518D\u6B21\u53D1\u5E03\uFF1A\uFF09";break;case 9001:e="\u7531\u4E8E\u533F\u540D\u72B6\u6001\u6216\u672C\u5427\u8BBE\u7F6E\uFF0C\u65E0\u6CD5\u53D1\u8868\u5E26\u6709\u56FE\u7247\u7684\u4E3B\u9898\u3002";break;case 2100:e="\u5185\u5BB9\u542B\u6709\u9AD8\u7EA7\u5B57\u4F53\u6548\u679C\uFF0C\u4FDD\u6301\u8FDE\u7EED\u7B7E\u5230\u5C31\u80FD\u4F7F\u7528\u54E6~~";break;case 4010:e="\u60A8\u7684\u8D26\u53F7\u5B58\u5728\u5B89\u5168\u98CE\u9669\u6682\u4E0D\u80FD\u53D1\u8D34\uFF0C\u8BF7\u5148\u8FDB\u884C\u624B\u673A\u7ED1\u5B9A\u540E\u518D\u53D1\u8D34\u5427\u3002";break;case 9e3:e="\u60A8\u8FD8\u6CA1\u6709\u7528\u6237\u540D\uFF0C\u4E0D\u80FD\u5728\u672C\u5427\u53D1\u8D34\u3002\u8BF7\u5148\u586B\u5199\u7528\u6237\u540D\u3002";break;case 10010:e="\u60A8\u7684\u6027\u522B\u65E0\u6CD5\u8FDB\u884C\u59B9\u7EB8\u8BA4\u8BC1</br><a style = 'font-size:12px;' href = 'http://www.baidu.com/p/setting/profile/basic' target ='_blank'>\u53BB\u4FEE\u6539\u6211\u7684\u6027\u522B>><a>";break;case 10012:e="\u8BF7\u4E0A\u4F20\u81F3\u5C11\u4E00\u5F20\u56FE\u7247\u3002";break;case 10013:e="\u60A8\u53D1\u5F80\u7684\u5427\u672A\u5F00\u901A\u59B9\u7EB8\u8BA4\u8BC1\u529F\u80FD\u3002";break;case 2130001:e="\u8BF7\u4E0D\u8981\u7ED9\u975E\u59B9\u7EB8\u7528\u6237\u6295\u7968\u3002";break;case 2130007:e="\u60A8\u7684\u8D26\u53F7\u5DF2\u88AB\u5C01\u7981\u3002";break;case 2130008:e="\u60A8\u5DF2\u7ECF\u7ED9\u8BE5\u7528\u6237\u6295\u8FC7\u7968\u3002";break;case 2130009:e="\u6295\u7968\u5931\u8D25\u3002";break;case 2130005:e="\u60A8\u5DF2\u7ECF\u53D1\u8D77\u8FC7\u59B9\u7EB8\u8BA4\u8BC1\u8D34</br><a href='/p/"+Thread_add_result.thread_id+"' target = '_blank' >http://tieba.baidu.com/p/"+Thread_add_result.thread_id+"</a>";break;case 2130011:e="\u59B9\u7EB8\u8BA4\u8BC1\u7528\u6237\u4E4B\u95F4\u4E0D\u80FD\u76F8\u4E92\u6295\u7968\u3002";break;case 220012:e="\u60A8\u7684\u8D26\u53F7\u5DF2\u88AB\u5C01\u7981\u3002";break;case 220013:e="\u60A8\u7684IP\u5DF2\u88AB\u5C01\u7981\u3002";break;case 225001:e="\u60A8\u7684\u8D26\u53F7\u7981\u6B62\u8D34\u6761\u3002";break;case 220015:e="\u60A8\u8F93\u5165\u7684\u5185\u5BB9\u542B\u6709\u654F\u611F\u4FE1\u606F\u3002";break;case 219e4:e="<p>\u62B1\u6B49\u60A8\u6CA1\u6709\u8D34\u6761\u9053\u5177\u4E86\u4E0D\u80FD\u53D1\u5E03\u8D34\u6761\u4FE1\u606F\u3002</p><p>PS\uFF1A\u53D1\u8D34,\u56DE\u8D34,\u53C2\u52A0\u6D3B\u52A8\u90FD\u6709\u673A\u4F1A\u83B7\u5F97\u8D34\u6761\u9053\u5177\u3002</p>";break;case 2130012:e="\u4E0D\u80FD\u7ED9\u81EA\u5DF1\u6295\u7968\u3002";break;case 2130014:e="\u4E0D\u80FD\u7ED9\u7537\u6027\u7528\u6237\u6295\u7968";break;case 2190001:e="\u60A8\u8BF4\u8BDD\u592A\u5FEB\u5566\uFF0C\u8BF7\u4F11\u606F\u4E00\u4E0B\u3002";break;case 2190002:e="\u62B1\u6B49\uFF0C\u6BCF10\u5206\u949F\u53EA\u80FD\u62A2\u4E00\u6B21\u8D34\u6761\u3002";break;case 2190003:e="<p>\u771F\u9057\u61BE~\u60A8\u6CA1\u6709\u62A2\u5230\u8D34\u6761\u9053\u5177\u3002</p><p>PS\uFF1A\u7B49\u7EA7\u8D8A\u9AD8\u83B7\u5F97\u9053\u5177\u51E0\u7387\u8D8A\u9AD8\u54E6\uFF01</p>";break;case 2190004:e="\u670D\u52A1\u5668\u5FD9\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5";break;case 2190005:e="\u60A8\u7684\u8D26\u53F7\u5DF2\u88AB\u5C01\u7981\u3002";break;case 2190006:e="\u8D34\u6761\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A\u3002";break;case 2190007:e="\u8D34\u6761\u5185\u5BB9\u8FC7\u957F\u3002";break;case 2190008:e="\u4ECA\u5929\u7684\u9053\u5177\u88AB\u62A2\u5B8C\u5566\uFF0C\u660E\u5929\u7EE7\u7EED\u52A0\u6CB9\uFF01";break;default:e="\u672A\u77E5\u9519\u8BEF\u3002"}return e},getCheckMessage:function(e){var a="";switch(e){case-61:a="\u60A8\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u4E3A\u4E86\u4FDD\u8BC1\u8D34\u5B50\u8D28\u91CF\uFF0C\u672C\u5427\u6240\u53D1\u7684\u8D34\u5B50\u5F85\u7CFB\u7EDF\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85";break;case-62:a="\u60A8\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u4E3A\u4E86\u4FDD\u8BC1\u8D34\u5B50\u8D28\u91CF\uFF0C\u672C\u5427\u8D34\u56FE\u7684\u8D34\u5B50\u9700\u8981\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85";break;case-74:case-75:case-60:a="\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u7CFB\u7EDF\u9700\u8981\u6838\u5B9E\u8BE5\u8D34\u5B50\u5185\u5BB9\u662F\u5426\u542B\u6709\u4E0D\u826F\u4FE1\u606F\uFF0C\u8D34\u5B50\u5728\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85";break;case-70:a="\u60A8\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u4E3A\u4E86\u63A7\u5236\u5E7F\u544A\u8D34\uFF0C\u9700\u8981\u901A\u8FC7\u5BA1\u6838\u540E\u624D\u80FD\u53D1\u5E03\u3002\u767B\u9646\u7F72\u540D\u53D1\u8D34\u4E0D\u53D7\u6B64\u9650\u5236\u3002";break;case-71:a="\u60A8\u53D1\u8868\u7684\u5E16\u5B50\u592A\u957F\u4E86\u3002\u4E3A\u4E86\u9632\u6B62\u704C\u6C34\uFF0C\u9700\u7CFB\u7EDF\u5BA1\u6838\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u7A0D\u540E\u67E5\u770B";break;default:a="\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u7CFB\u7EDF\u9700\u8981\u6838\u5B9E\u8BE5\u8D34\u5B50\u5185\u5BB9\u662F\u5426\u542B\u6709\u4E0D\u826F\u4FE1\u606F\uFF0C\u8D34\u5B50\u5728\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85"}return a}};_.Module.define({path:"ihome/widget/Interaction",sub:{initial:function(n){n?(this.dataObj=n,this._bindEvents()):this._bindFloatEvents()},_resetDataObj:function(n){this.dataObj=n},_follow:function(n,t){var o=this;if(!PageData.user.is_login)return TbCom.process("User","buildLoginFrame"),!1;if(PageData.user.no_un)return TbCom.process("User","buildUnameFrame"),!1;var e=o._addLoading(n,0);$.tb.post("/home/post/follow",{un:t.un,tbs:t.tbs},function(t){t?0==t.no?o._clearLoading(n,e,0):1130036==t.no?o._showError("\u8BE5\u7528\u6237\u4E0D\u5E0C\u671B\u88AB\u4ED6\u4EBA\u5173\u6CE8",n,0):2260001==t.no?o._showError("\u64CD\u4F5C\u592A\u9891\u7E41\uFF0C\u8BF7\u6B47\u6B47\uFF01",n,0):o._showError("\u5173\u6CE8\u5931\u8D25",n,0):o._showError("\u5173\u6CE8\u5931\u8D25",n,0)})},_showError:function(n,t,o){var e=new $.dialog({html:'<p style="text-align:center">'+n+"<p>",width:300,height:30});e.bind("onclose",function(){var n=1==o?"btn-sub btn-middle btn_concern_done":"btn_concern btn-attention btn-middle",e=1==o?"\u53D6\u6D88\u5173\u6CE8":"\u5173\u6CE8";t.text(e).removeClass().addClass(n)})},_addLoading:function(n,t){var o=$("<span></span>"),e="",r=0,a=[".","..","..."],i=["\u5173\u6CE8\u4E2D","\u53D6\u6D88\u4E2D"],s=setInterval(function(){e=a[r++%3],o.text(e)},400);return n.text(i[t]).append(o),s},_clearLoading:function(n,t,o){var e=1==o?"btn_concern btn-attention btn-small":"btn_concern_done btn-sub btn-small",r=1==o?"\u5173\u6CE8":"\u53D6\u6D88\u5173\u6CE8";n.text(r).removeClass().addClass(e),clearInterval(t)},_unfollow:function(n,t){var o=this;if(!PageData.user.is_login)return TbCom.process("User","buildLoginFrame"),!1;if(PageData.user.no_un)return TbCom.process("User","buildUnameFrame"),!1;var e=o._addLoading(n,1);$.tb.post("/home/post/unfollow",{un:t.un,tbs:t.tbs},function(t){t&&0==t.no?o._clearLoading(n,e,1):2260001==t.no?o._showError("\u64CD\u4F5C\u592A\u9891\u7E41\uFF0C\u8BF7\u6B47\u6B47\uFF01",n,0):o._showError("\u53D6\u6D88\u5173\u6CE8\u5931\u8D25",n,1)})},_bindEvents:function(){var n=this;$("#userinfo_wrap").delegate(".btn_concern","click",function(){return n._follow($(this),n.dataObj),!1}),$("#userinfo_wrap").delegate(".btn_concern_done","click",function(){return n._unfollow($(this),n.dataObj),!1})},_bindFloatEvents:function(){var n=this;$("body").delegate(".card_headinfo_wrap .btn_concern","click",function(){return n._follow($(this),n.dataObj),!1}),$("body").delegate(".card_headinfo_wrap .btn_concern_done","click",function(){return n._unfollow($(this),n.dataObj),!1})}}});_.Module.define({path:"common/widget/UserHead",sub:{initial:function(){this.initOptions()},initOptions:function(){this.options={gif:["1100001","1100002","1100003","1100013","1100015","1100016","1100017","1100019"],filter:[]}},getImgFormat:function(t){var r="png";return-1!=$.inArray(t,this.options.gif)&&(r="gif"),r},getHeadUrl:function(t){var r=t.mParr_props&&t.mParr_props.portrait||"",i="";return i=r.end_time>Env.server_time/1e3?r.url:"http://tb.himg.baidu.com/sys/portrait/item/"+t.portrait},getHeadFrameStyle:function(t,r){var i=t.mParr_props&&t.mParr_props.avatarframe||"",e="",n=null,o={hasFrame:!1,stylestr:""};return i.end_time>Env.server_time/1e3&&(e=i.props_id,n=["width:"+r+"px","height:"+r+"px","padding:10px","background:url(/tb/static-common/img/props/"+r+"/"+e+"."+this.getImgFormat(e)+") no-repeat","border:none","left:-6px","top:-6px"],o={hasFrame:!0,stylestr:n.join(";")}),o}}});_.Module.define({path:"ihome/widget/MonthIcon",sub:{iconTitle:{"01":"\u6469\u7FAF\u5EA7","02":"\u6C34\u74F6\u5EA7","03":"\u53CC\u9C7C\u5EA7","04":"\u767D\u7F8A\u5EA7","05":"\u91D1\u725B\u5EA7","06":"\u53CC\u5B50\u5EA7","07":"\u5DE8\u87F9\u5EA7","08":"\u72EE\u5B50\u5EA7","09":"\u5904\u5973\u5EA7",10:"\u5929\u79E4\u5EA7",11:"\u5929\u874E\u5EA7",12:"\u5C04\u624B\u5EA7"},initial:function(){},getMonthIcon:function(i,n){i=i||{},n=n||1;var t='<div class="month_icon_theme_'+n+'">',o="",e={};for(var a in i){var c=a.length;if(6==c){var h=a.substr(c-2,2);e[h]=i[a]}else 2==c&&(e[a]=i[a])}for(var l in this.iconTitle)o=e&&e[l]?" month_icon_"+l:" month_icon_gray_"+l,t+='<a href="/tbmall/monthicon" target="_blank" title="'+this.iconTitle[l]+'" class="'+o+'"></a>';return t+="</div>"}}});_.Module.define({path:"props/widget/Residual",requires:[],sub:{initial:function(i){this.dataObj=i,this.initOptions()},initOptions:function(){this.options={1070001:"worship",1070002:"egg"}},getResidualKey:function(i){for(var e=i.props||{},s=null,n="",t=["1070002","1070001"],a=0;a<t.length;a++)if(s=e[t[a]],s&&s.num>0&&s.end_time>Env.server_time/1e3){n=this.options[t[a]];break}return n},showUI:function(i){var e=i.wrap,s="",n=null,t=i.key||this.getResidualKey(i);t&&(s="residual_wrap residual_wrap_"+t,n=e.find(".residual_wrap"),n[0]?n.removeClass().addClass(s):(n=$('<div class="'+s+'"></div>'),e.append(n)))}}});_.Module.define({path:"ihome/widget/UserVisitCard",requires:["common/widget/Card","UserVisitCardBase","ihome/widget/Interaction","props/widget/Residual","common/widget/JoinVipDialog"],sub:{_visit_card:null,_visit_card_ajax:null,_option:{width:370},initial:function(i,a){window.Page&&Page.checkLoadedModules("UserVisitCard")||(this.dataObj=i,this._wrap=$("body"),this._util=this.use("userVisitCardBase"),this._interaction=this.use("ihome/widget/Interaction"),this._residual=this.use("props/widget/Residual"),a||this.bindEvents())},bindEvents:function(){var i=this;this._wrap.delegate(".j_user_card","mouseenter",function(){return i.buildCard($(this)),!1}),this._wrap.delegate(".j_user_card","mouseleave",function(){return i._visit_card_ajax&&i._visit_card_ajax.abort(),i._visit_card&&i._visit_card.closeCard({type:"delayClose",time:200}),i._visit_card=null,!1}),this._wrap.delegate(".card_userinfo_close","click",function(){return $("#user_visit_card").remove(),!1})},buildCard:function(i){var a=this;a._visit_card&&(a._visit_card.closeCard(),a._visit_card=null);var t='<div class="user_card_loading"><img src="http://tb2.bdstatic.com/tb/static-ihome/img/loading2.gif"/>\u6B63\u5728\u52A0\u8F7D\uFF0C\u8BF7\u7A0D\u540E...</div>',e={content:t,card_css:{width:a._option.width,zIndex:$.getcurzIndex()},auto_positon:!0,event_target:i,attr:"id='user_visit_card'",wrap:$("body")};a._visit_card=a.use("common/widget/Card",e),a._visit_card.showCard({type:"delayShow",time:200}),a.buildVisitCard(i)},getVisitCardContent:function(i){var a=this,t={ie:"utf-8"};i.un?t.un=i.un:t.id=i.id,$.ajax({type:"get",url:"/home/get/panel",data:t,dataType:"json"}).success(function(t){if(t&&0===t.no){var e=t.data;e.bg_id=i.bg_id;var r=a._util.getVisitCardTpl(1,e,!0);i.wrap.html(r)}else{var r='<div class="user_card_loading">\u7F51\u7EDC\u9519\u8BEF<a href="#" id="user_card_reload" class="user_card_reload">\u5237\u65B0</a></div>';i.wrap.html(r)}i.callBack&&$.isFunction(i.callBack)&&i.callBack()})},buildVisitCard:function(i){var a=this,t={ie:"utf-8"};i.getData().un?t.un=i.getData().un:t.id=i.getData().id,a._visit_card_ajax&&a._visit_card_ajax.abort(),a._visit_card_ajax=$.ajax({type:"get",url:"/home/get/panel",data:t,dataType:"json"}).success(function(t){if(t&&0===t.no){var e=t.data,r=e.name==a.dataObj.uname,s=a._util.getVisitCardTpl(r,e,!0);a._visit_card.setContent(s),a._visit_card._j_card.bindData({un:e.name}),a._visit_card.showCard(),a._interaction._resetDataObj({is_login:PageData.user.is_login,un:e.name,tbs:PageData.tbs}),a._residual.showUI({wrap:$("#user_visit_card .userinfo_head_wrap"),props:e.appraise||{}}),a._visit_card._j_card.find(".j_user_visit_card_joinvip").on("click",function(){_.Module.use("common/widget/JoinVipDialog",[],function(i){i.getMemberDialog()})}),$.stats.track("cardinfo","ihome_v1")}else{var s='<div class="user_card_loading">\u7F51\u7EDC\u9519\u8BEF<a href="#" id="user_card_reload" class="user_card_reload">\u5237\u65B0</a></div>';a._visit_card.setContent(s),$("#user_card_reload").on("click",function(){return a.buildCard(i),!1})}})},bindVisitCardEvent:function(){var i=this;i._visit_card.showCard({type:"delayShow",time:200}),$.stats.track("cardinfo","ihome_v1")}}});
;_.Module.define({path:"ihome/widget/UserVisitCard/UserVisitCardBase",requires:["user/widget/Icons","common/widget/UserHead","common/widget/MemberApi","ihome/widget/MonthIcon"],sub:{countLen:0,initial:function(){},getVisitCardTpl:function(e,a,r){var t=PageData.product||"",n=this.use("user/widget/Icons"),i=this.use("common/widget/UserHead"),s=this.use("ihome/widget/MonthIcon"),o=this.use("common/widget/MemberApi"),_=i.getHeadFrameStyle(a,"105"),c={head_img:"/tb/static-ihome/img/panel_"+a.bg_id+".jpg",concernClass:"0"==a.can_followed?"btn_concern_done btn-sub":"btn_concern btn-attention",concernText:"0"==a.can_followed?"\u53D6\u6D88\u5173\u6CE8":"\u5173\u6CE8",un:encodeURIComponent(a.name),btn_group:r?this.getBtnGroup(a):"",frameClass:_.hasFrame?"card_userinfo_left_frame":"",frameStyle:_.stylestr,portrait:i.getHeadUrl(a),fr:t,icon_pre:n.getPreIconHtml(a.mParr_props,a.free_flag),member_class:o.getMemberNameClass(a.mParr_props,a.free_flag),name:a.profession_manager_nick_name||a.name_show,icon:n.getIconsHtml(a),sex:a.sex,tb_age:"-"==a.tb_age?a.tb_age:a.tb_age+"\u5E74",post_num:a.post_num,good_num:a.good_num,honor:s.getMonthIcon(a.tbmall_month_icon,2),honor_margin:this.getHonorMargin(),vip_tips:this.getVipTips(a)};a.is_verify&&"0"!==a.is_verify&&(c.verify_info=this.getVerifyHTML(a.identify_info));var l="";e||(l='<div class="interaction_wrap interaction_wrap_theme2"><a class="btn-small #{concernClass}" target="_blank" href="#" onclick="return false">#{concernText}</a><a class="btn-small btn-default" target="_blank" href="http://msg.baidu.com/ms?ct=21&cm=1&tn=bmSendMessage&un=#{un}">\u79C1\u4FE1</a></div>'),console.log(l);var m=['<div class="card_headinfo_wrap" id="card_headinfo_wrap">','<img class="card_userinfo_img" src="#{head_img}"/>','<a class="card_userinfo_guide" target="_blank" href="/tbmall/propslist?category=113"></a>',l,"</div>",'<div class="card_userinfo_wrap clearfix">','<div class="card_userinfo_left #{frameClass}">','<div class="userinfo_head_wrap">','<div class="userinfo_head" style="#{frameStyle}"></div>','<a href="/home/main?un=#{un}&fr=#{fr}&ie=utf-8" class="j_avatar" target="_blank"><img src="#{portrait}"/></a>',"</div>","</div>",'<div class="card_userinfo_middle">','<div class="card_userinfo_title clearfix">','#{icon_pre}<a href="/home/main?un=#{un}&fr=#{fr}&ie=utf-8" target="_blank" class="userinfo_username #{member_class}">#{name}</a>#{icon}',"</div>",'<div class="card_userinfo_num clearfix">','<span class="userinfo_sex userinfo_sex_#{sex}"></span>',"<span>\u5427\u9F84:#{tb_age}</span>",'<span class="userinfo_split"></span>',"<span>\u53D1\u8D34:#{post_num}</span>","</div>",'<div class="card_userinfo_honor honor_margin_#{honor_margin} clearfix">',"#{honor}","</div>","#{vip_tips}","</div>","</div>","#{verify_info}"].join("");return $.tb.format(m,c)},getBtnGroup:function(e){var a="";if(e.id!==PageData.user.id){var r=e.can_begcard,t="";0==r?t='<a class="btn_begcard j_begcard" href="#"></a>':1==r?t='<a class="btn_begcard btn_forbidden">\u5DF2\u7533\u8BF7</a>':2==r&&(t='<a class="btn_begcard btn_forbidden">\u5DF2\u4EA4\u6362</a>');var n={private_msg:"http://msg.baidu.com/ms?ct=21&cm=1&tn=bmSendMessage&un="+encodeURIComponent(e.name),btn_begcard:t};a=['<div class="card_btn_grounps">','<a class="btn_privatemsg" target="_blank" href="#{private_msg}"></a>',"#{btn_begcard}","</div>"].join(""),a=$.tb.format(a,n)}return a},getIcon:function(e){var a="";return e.identity&&(a+='<span title="\u8D34\u5427\u5B9E\u540D\u8BA4\u8BC1" class="card_userinfo_icon card_icon_verify"></span>'),e.meizhi_level>0&&(a+='<a href="/p/'+e.meizhi_thread_id+'" target="_blank" title="\u8D34\u5427\u59B9\u7EB8\u8BA4\u8BC1" class="card_userinfo_icon meizhi_vip card_icon_meizhi_vip'+e.meizhi_level+'"></a>'),a},getHonor:function(e){if(e.novice)return'<div class="grade_level grade_level_novice" title="\u8D34\u5427\u83DC\u9E1F">\u8D34\u5427\u83DC\u9E1F</div>';var a={manager:{title:"\u5427\u4E3B",level:19},assist:{title:"\u5C0F\u5427\u4E3B",level:20},picadmin:{title:"\u56FE\u7247\u5C0F\u7F16",level:21},videoadmin:{title:"\u89C6\u9891\u5C0F\u7F16",level:22},novice:{title:"\u83DC\u9E1F",level:23}},r=e.manager,t=null,n="",i="";this.countLen=0;for(var s in r){t=r[s];var o=t.forum_list.join("\u3001"),_=a[s];o=t.count>2?o+"\u7B49\u5427"+_.title:o+"\u5427"+_.title,n+=this.getHonorItem(_.level,t.count,o),this.countLen+=String(t.count).length}var c=e.grade,l=[];for(var m in c)l.push(m);l.sort(function(e,a){return a-e});for(var f=0,d=l.length;d>f;f++){t=c[l[f]];var o=t.forum_list.join("\u3001");t.count>2&&(o+="\u5427\u7B49"),i+=this.getHonorItem(l[f],t.count,o),this.countLen+=String(t.count).length}return n+i},getHonorMargin:function(){var e={2:"8px",3:"6px",4:"4px"},a=this.countLen-4;return e[a]||""},getHonorItem:function(e,a,r){var t={level:e,title:r,count:a},n=['<div class="grade_level grade_level_#{level}" title="#{title}">',"<span>#{count}</span>","</div>"].join("");return $.tb.format(n,t)},getVerifyHTML:function(e){for(var a={verify_reason:e[0]&&e[0].v_reason,verify_forums:""},r=['<div class="verify_wrap">','<div class="verify_content">','<div class="verify_desc">',"<span>\u5B98\u65B9\u8BA4\u8BC1\uFF1A</span>","<span>#{verify_reason}</span>","</div>",'<div class="verify_forum">','<a class="verify_home" href="http://v.tieba.baidu.com/" target="_blank">\u7533\u8BF7\u4F01\u4E1A\u5B98\u65B9\u5427</a>',"<span>\u5165\u9A7B\u5427\uFF1A</span>","#{verify_forums}","<span>\u5B98\u65B9\u5427\u4E3B</span>","</div>","</div>","</div>"].join(""),t=0;t<e.length;t++)a.verify_forums+=this.getVForumItem(t,e[t].forum_name);return $.tb.format(r,a)},getVForumItem:function(e,a){var r="",t={},n=[];return a.length>5?(r=a.substring(0,5),r+="..."):r=a,t={index:e,verify_forum_name:r,origin_forum_name:encodeURIComponent(a)},n=['<span class="verify_forum_info">','<a target="_blank" class="verify_forum_name_#{index}" href="/f?ie=utf-8&kw=#{origin_forum_name}">#{verify_forum_name}</a>','<a target="_blank" href="http://v.tieba.baidu.com/">','<img class="verify_forum_icon" src="http://tb2.bdstatic.com/tb/static-ihome/img/platform_blue_icon14.gif" alt="\u5B98\u65B9\u8BA4\u8BC1\u56FE\u6807" title="\u767E\u5EA6\u8D34\u5427\u5B98\u65B9\u5E73\u53F0\u8BA4\u8BC1">',"</a>","</span>"].join(""),$.tb.format(n,t)},getVipTips:function(e){var a="",r=(new Date).getTime()/1e3;return e.mParr_props&&e.mParr_props.level&&e.mParr_props.level.end_time>r&&(a='<p class="user_card_vip_tips"><a href="javascript:;" class="j_user_visit_card_joinvip" target="_blank">\u5F00\u901A\u4F1A\u5458</a>\u5C0A\u4EAB\u6635\u79F0\u7EA2\u540D\u7279\u6743 <a href="/tbmall/tshow?tab=detail&c=15" target="_blank">\u4E86\u89E3\u7279\u6743</a> </p>'),a}}});_.Module.define({path:"frs/widget/piaowu_tj",sub:{initial:function(){try{this._tongji()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/piaowu_tj/piaowu_tj.js",method:"",ln:6}),t}},_tongji:function(){$.stats.track("frs_\u5E16\u5B50\u5165\u53E3","\u660E\u661F\u7968\u52A1\u4E8C\u671F","frs","\u5C55\u73B0");var t=$(".j_piao_info_buy_btn");len=t.size(),len>0&&t.bind("click",function(){try{$.stats.track("frs_\u5E16\u5B50\u5165\u53E3","\u660E\u661F\u7968\u52A1\u4E8C\u671F","frs","\u70B9\u51FB")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/piaowu_tj/piaowu_tj.js",method:"",ln:31}),t}})}}});_.Module.define({path:"common/component/SlideShow",sub:{defaultOptions:{delayLoadPic:!1,effect:"slide",activeClass:"tbui_slideshow_active",baseZIndex:0,interval:5e3,slide:{speed:500},fade:{speed:500},triggerHandler:"click"},initial:function(t){t=$.extend({},this.defaultOptions,t);var i=this;this.options=t,this.animating=!1,this.current=0,this.vendorPrefix=!1,this.$nav=$(t.nav),this.$navItem=this.$nav.children(),this.total=this.$navItem.size()||t.total,this.$container=$(t.target),this.$list=this.$container.children(".tbui_slideshow_list"),this.$tokens=this.$list.children(),t.width||(t.width=this.$container.width()),t.height||(t.height=this.$container.height()),this.$container.add(this.$list).css({width:t.width,height:t.height}),this.interval=t.interval||5e3,this.picLoadedIndex={},this.$navItem.first().addClass(t.activeClass),this.$tokens.first().show(),this.showOriPic(0),"click"==t.triggerHandler?this.$navItem.click(function(){var e=this;t.auto&&i.stop(),this.delayHandler=setTimeout(function(){i.delayHandler=null,i.setActive($(e).index())},10)}).bind("mouseout",function(){t.auto&&i.play(),this.delayHandler&&clearTimeout(this.delayHandler)}):"hover"==t.triggerHandler&&this.$navItem.hover(function(){var e=this;t.auto&&i.stop(),this.delayHandler=setTimeout(function(){i.delayHandler=null,i.setActive($(e).index())},200)},function(){t.auto&&i.play(),this.delayHandler&&clearTimeout(this.delayHandler)}),this.effectHandler=this["_"+t.effect],t.auto&&(this.play(),this.$list.hover(function(){i.stop()},function(){i.play()})),t.next&&$(t.next).click(function(t){t.preventDefault(),t.stopPropagation(),i.next()}),t.prev&&$(t.prev).click(function(t){t.preventDefault(),t.stopPropagation(),i.prev()})},setActive:function(t){return this.animating||t===this.current?!1:(this.$navItem.removeClass(this.options.activeClass).eq(t).addClass(this.options.activeClass),this.effectHandler(t),this.showOriPic(t),!0)},next:function(){var t=this.current+1;t==this.total&&(t=0),this.setActive(t)},prev:function(){var t=this.current-1;-1==t&&(t=this.total-1),this.setActive(t)},play:function(){var t=this;null==this.autoHandler&&(this.autoHandler=setInterval(function(){t.next()},this.options.interval))},showOriPic:function(t){if(this.options.delayLoadPic&&!this.picLoadedIndex["_"+t]){for(var i,e=this.$tokens.eq(t).find("img"),n=e.length,s=0;n>s;s++){i=$(e[s]);var a=i.tbattr("orisrc");a&&i.tbattr("src",a)}this.picLoadedIndex["_"+t]=1}},stop:function(){clearInterval(this.autoHandler),this.autoHandler=null},_slide:function(t){var i,e,n,s,a,o,r,h=this;this.animating=!0,i=this.current,r=t>i?1:-1,e=t>i?-this.options.width:this.options.width,s=t,this.$tokens.eq(i).siblings().css({display:"none",left:0,zIndex:0+this.options.baseZIndex}),this.$tokens.eq(s).css({display:"block",left:r*this.options.width,zIndex:10+this.options.baseZIndex}),this.vendorPrefix?(a=this.vendorPrefix,o=a+"Transform",n=a+"TransitionDuration",this.$list[0].style[o]="translateX("+e+"px)",this.$list[0].style[n]=this.options.slide.speed+"ms",this.$list.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){h.$list[0].style[o]="",h.$list[0].style[n]="",h.$tokens.eq(s).css({left:0}),h.$tokens.eq(i).css({display:"none",left:0,zIndex:0}),h.animating=!1,h.current=s,h.$list.unbind("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd"),h.trigger("animateEnd")})):h.$list.stop().animate({left:e},this.options.slide.speed,function(){h.$list.css({left:0}),h.$tokens.eq(s).css({left:0}),h.$tokens.eq(i).css({display:"none",left:0,zIndex:0}),h.current=s,h.animating=!1,h.trigger("animateEnd")})},_fade:function(t){var i,e,n=this;this.animating=!0,i=this.current,e=t,this.$tokens.eq(e).css({display:"none",left:0,zIndex:10+this.options.baseZIndex}),this.$tokens.eq(i).stop().fadeOut(this.options.fade.speed),this.$tokens.eq(e).stop().fadeIn(this.options.fade.speed,function(){n.$tokens.eq(e).css({zIndex:0+n.options.baseZIndex}),n.animating=!1,n.current=e,n.trigger("animateEnd")})},_getVendorPrefix:function(){var t,i,e,n,s;for(t=document.body||document.documentElement,e=t.style,n="Transition",s=["Moz","Webkit","Khtml","O","ms"],i=0;i<s.length;){if("string"==typeof e[s[i]+n])return s[i];i++}return!1}}});_.Module.define({path:"frs/widget/ForumRecommend",requires:["common/component/SlideShow"],sub:{_slideShow:null,_slideConfig:{nav:".recommend_nav",target:"#slide_show",activeClass:"active",interval:5e3,auto:!1,next:".exchange",prev:"",delayLoadPic:!0,slide:{speed:1e3}},initial:function(){try{$.stats.track("\u76F8\u5173\u5427\u63A8\u8350","\u5C55\u793A\u91CF","frs","click",{});var e=this,t=$("#forum_recommend"),i=t.find(".slide_nav li").length;e._slideShow=e.use("common/component/SlideShow",e._slideConfig),t.on("click",".j_recommend_flow_click",function(e){var t=$(e.currentTarget);if(!PageData.user.is_login)return TbCom.process("User","buildLoginFrame"),!1;if("1"===$(this).tbattr("is_clicked"))return!1;var i={fid:$(this).getData("data-fid").fid,fname:$.tb.escapeHTML($(this).tbattr("title")),uid:PageData.user.user_name,ie:"gbk",tbs:$(this).getData("data-tbs").tbs};$.post("/f/like/commit/add",i,function(e){"undefined"==typeof e.no?$.dialog.alert("<p style='text-align: center;'>\u8BF7\u6C42\u5F02\u5E38\uFF0C\u8BF7\u91CD\u8BD5\uFF01</p>",{title:"\u5173\u6CE8\u7ED3\u679C",acceptValue:"\u786E\u5B9A"}):($.dialog.alert("<p style='text-align: center;'>\u5173\u6CE8\u6210\u529F\uFF01</p>",{title:"\u5173\u6CE8\u7ED3\u679C",acceptValue:"\u786E\u5B9A"}),t.removeClass("btn-attention").addClass("btn-sub").text("\u5DF2\u5173\u6CE8"),t.tbattr("is_clicked","1"))},"json"),$.stats.track("\u76F8\u5173\u5427\u63A8\u8350","\u5355\u4E2A\u5173\u6CE8\u7684\u70B9\u51FB\u91CF","frs","click",{})}),t.find(".all_attention").bind("click",function(){if(!PageData.user.is_login)return TbCom.process("User","buildLoginFrame"),!1;$.stats.track("\u76F8\u5173\u5427\u63A8\u8350","\u4E00\u952E\u5173\u6CE8","frs","click",{});for(var a=t.find(".active"),n=t.find(".list"+a.text()),o=n.children(".recommend_item"),c=0;c<o.length;c++){var r=o.eq(c).find(".recommend_flow a"),s={fid:r.getData("data-fid").fid,fname:$.tb.escapeHTML(r.tbattr("title")),uid:PageData.user.user_name,ie:"gbk",tbs:r.getData("data-tbs").tbs};$.post("/f/like/commit/add",s)}return $.dialog.alert("<p style='text-align: center;'>\u5173\u6CE8\u6210\u529F\uFF01</p>",{title:"\u5173\u6CE8\u7ED3\u679C",acceptValue:"\u786E\u5B9A"}),1==i?(t.hide(),void 0):(n.remove(),a.remove(),i-=1,e._slideShow=e.use("common/component/SlideShow",e._slideConfig),1==i?t.find(".exchange").hide():e._slideShow.next(),void 0)}),t.on("click",".exchange",function(){try{$.stats.track("\u76F8\u5173\u5427\u63A8\u8350","\u6362\u4E00\u6362","frs","click",{})}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/forum_recommend/forum_recommend.js",method:"",ln:143}),e}}),t.on("click",".recommend_forum_pic",function(){$.stats.track("\u76F8\u5173\u5427\u63A8\u8350","\u5427\u5934\u56FE\u7684\u70B9\u51FB\u91CF","frs","click",{})}),t.on("click",".recommend_item_p .name",function(){$.stats.track("\u76F8\u5173\u5427\u63A8\u8350","\u5427\u540D\u7684\u70B9\u51FB\u91CF","frs","click",{})}),t.on("click",".recommend_item",function(){try{$.stats.track("\u76F8\u5173\u5427\u63A8\u8350","\u56DB\u4E2A\u63A8\u8350\u4F4D\u5206\u522B\u70B9\u51FB\u91CF","frs","click",{})}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/forum_recommend/forum_recommend.js",method:"",ln:161}),e}})}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/forum_recommend/forum_recommend.js",method:"",ln:163}),a}}}});_.Module.define({path:"tbmall/component/captcha_payment",sub:{initial:function(a){this.reCommitUrl=a.url,this.data=a.data},showCaptcha:function(a,t){var e=this,c=PageData.tbs||PageData.user.tbs,o=2150040==e.data.no?"\u6B63\u786E\u8F93\u5165\u9A8C\u8BC1\u7801\u540E\uFF0C\u53EF\u7EE7\u7EED\u8D2D\u4E70":"\u9A8C\u8BC1\u7801\u8F93\u5165\u9519\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165";this.requireInstanceAsync("common/component/CaptchaDialog",{message:e.data.data.captcha_str_reason,vCode:e.data.data.captcha_vcode_str,vCodeType:e.data.data.captcha_code_type,exceptionalAccount:0,title:"T\u8C46\u652F\u4ED8\u9A8C\u8BC1\u7801",message:o,forumName:"",modal:!0,forumId:0,checkUrl:"/tbmall/vcode/safecheckvcode?tbs="+c,vCodeUrl:"/tbmall/vcode/safegetvcode",paramsCallback:function(){return{tbs:c}}},function(e){e.bind("onclose",function(){e.hide(),$.tb.location.reload()}),e.bind("onaccept",function(){var c={};c.captcha_input_str=e.getInputValue(),c.captcha_vcode_str=e.getVCode(),"function"==typeof a&&(t?a.call(t,c):a(c))}),e.show()})}}});_.Module.define({path:"tbmall/widget/paykey_rsa",requires:[],sub:{RSA:{},publicKey:"",setKey:function(){this.publicKey=pkey},getKey:function(){var t=this;$.ajax({url:"/tbmall/pass/getpubkey",type:"get",dataType:"json",success:function(e){PageData.publicKey=e.data.pubkey,t.publicKey=PageData.publicKey}})},vcode:function(t){var e=new this.RSA;return e.setKey(this.publicKey),encodeURIComponent(e.encrypt(t))},initial:function(t){var e=this,i=$.extend({},t);PageData.publicKey||i.publicKey?this.publicKey=PageData.publicKey:this.getKey(),function(t){function e(t,e,i){null!=t&&("number"==typeof t?this.fromNumber(t,e,i):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function i(){return new e(null)}function r(t,e,i,r,s,n){for(;--n>=0;){var o=e*this[t++]+i[r]+s;s=Math.floor(o/67108864),i[r++]=67108863&o}return s}function s(t,e,i,r,s,n){for(var o=32767&e,h=e>>15;--n>=0;){var a=32767&this[t],u=this[t++]>>15,c=h*a+u*o;a=o*a+((32767&c)<<15)+i[r]+(1073741823&s),s=(a>>>30)+(c>>>15)+h*u+(s>>>30),i[r++]=1073741823&a}return s}function n(t,e,i,r,s,n){for(var o=16383&e,h=e>>14;--n>=0;){var a=16383&this[t],u=this[t++]>>14,c=h*a+u*o;a=o*a+((16383&c)<<14)+i[r]+s,s=(a>>28)+(c>>14)+h*u,i[r++]=268435455&a}return s}function o(t){return Ui.charAt(t)}function h(t,e){var i=Oi[t.charCodeAt(e)];return null==i?-1:i}function a(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function u(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+DV:this.t=0}function c(t){var e=i();return e.fromInt(t),e}function f(t,i){var r;if(16==i)r=4;else if(8==i)r=3;else if(256==i)r=8;else if(2==i)r=1;else if(32==i)r=5;else{if(4!=i)return this.fromRadix(t,i),void 0;r=2}this.t=0,this.s=0;for(var s=t.length,n=!1,o=0;--s>=0;){var a=8==r?255&t[s]:h(t,s);0>a?"-"==t.charAt(s)&&(n=!0):(n=!1,0==o?this[this.t++]=a:o+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this[this.t++]=a>>this.DB-o):this[this.t-1]|=a<<o,o+=r,o>=this.DB&&(o-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),n&&e.ZERO.subTo(this,this)}function p(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function l(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var i,r=(1<<e)-1,s=!1,n="",h=this.t,a=this.DB-h*this.DB%e;if(h-->0)for(a<this.DB&&(i=this[h]>>a)>0&&(s=!0,n=o(i));h>=0;)e>a?(i=(this[h]&(1<<a)-1)<<e-a,i|=this[--h]>>(a+=this.DB-e)):(i=this[h]>>(a-=e)&r,0>=a&&(a+=this.DB,--h)),i>0&&(s=!0),s&&(n+=o(i));return s?n:"0"}function d(){var t=i();return e.ZERO.subTo(this,t),t}function g(){return this.s<0?this.negate():this}function y(t){var e=this.s-t.s;if(0!=e)return e;var i=this.t;if(e=i-t.t,0!=e)return this.s<0?-e:e;for(;--i>=0;)if(0!=(e=this[i]-t[i]))return e;return 0}function m(t){var e,i=1;return 0!=(e=t>>>16)&&(t=e,i+=16),0!=(e=t>>8)&&(t=e,i+=8),0!=(e=t>>4)&&(t=e,i+=4),0!=(e=t>>2)&&(t=e,i+=2),0!=(e=t>>1)&&(t=e,i+=1),i}function b(){return this.t<=0?0:this.DB*(this.t-1)+m(this[this.t-1]^this.s&this.DM)}function T(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s}function S(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s}function R(t,e){var i,r=t%this.DB,s=this.DB-r,n=(1<<s)-1,o=Math.floor(t/this.DB),h=this.s<<r&this.DM;for(i=this.t-1;i>=0;--i)e[i+o+1]=this[i]>>s|h,h=(this[i]&n)<<r;for(i=o-1;i>=0;--i)e[i]=0;e[o]=h,e.t=this.t+o+1,e.s=this.s,e.clamp()}function D(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t)return e.t=0,void 0;var r=t%this.DB,s=this.DB-r,n=(1<<r)-1;e[0]=this[i]>>r;for(var o=i+1;o<this.t;++o)e[o-i-1]|=(this[o]&n)<<s,e[o-i]=this[o]>>r;r>0&&(e[this.t-i-1]|=(this.s&n)<<s),e.t=this.t-i,e.clamp()}function E(t,e){for(var i=0,r=0,s=Math.min(t.t,this.t);s>i;)r+=this[i]-t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r-=t[i],e[i++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=0>r?-1:0,-1>r?e[i++]=this.DV+r:r>0&&(e[i++]=r),e.t=i,e.clamp()}function x(t,i){var r=this.abs(),s=t.abs(),n=r.t;for(i.t=n+s.t;--n>=0;)i[n]=0;for(n=0;n<s.t;++n)i[n+r.t]=r.am(0,s[n],i,n,0,r.t);i.s=0,i.clamp(),this.s!=t.s&&e.ZERO.subTo(i,i)}function w(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var r=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,r,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()}function K(t,r,s){var n=t.abs();if(!(n.t<=0)){var o=this.abs();if(o.t<n.t)return null!=r&&r.fromInt(0),null!=s&&this.copyTo(s),void 0;null==s&&(s=i());var h=i(),a=this.s,u=t.s,c=this.DB-m(n[n.t-1]);c>0?(n.lShiftTo(c,h),o.lShiftTo(c,s)):(n.copyTo(h),o.copyTo(s));var f=h.t,p=h[f-1];if(0!=p){var l=p*(1<<this.F1)+(f>1?h[f-2]>>this.F2:0),d=this.FV/l,g=(1<<this.F1)/l,y=1<<this.F2,v=s.t,b=v-f,T=null==r?i():r;for(h.dlShiftTo(b,T),s.compareTo(T)>=0&&(s[s.t++]=1,s.subTo(T,s)),e.ONE.dlShiftTo(f,T),T.subTo(h,h);h.t<f;)h[h.t++]=0;for(;--b>=0;){var S=s[--v]==p?this.DM:Math.floor(s[v]*d+(s[v-1]+y)*g);if((s[v]+=h.am(0,S,s,b,0,f))<S)for(h.dlShiftTo(b,T),s.subTo(T,s);s[v]<--S;)s.subTo(T,s)}null!=r&&(s.drShiftTo(f,r),a!=u&&e.ZERO.subTo(r,r)),s.t=f,s.clamp(),c>0&&s.rShiftTo(c,s),0>a&&e.ZERO.subTo(s,s)}}}function A(t){var r=i();return this.abs().divRemTo(t,null,r),this.s<0&&r.compareTo(e.ZERO)>0&&t.subTo(r,r),r}function B(t){this.m=t}function U(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function O(t){return t}function V(t){t.divRemTo(this.m,null,t)}function N(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function J(t,e){t.squareTo(e),this.reduce(e)}function I(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function P(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function M(t){var r=i();return t.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),t.s<0&&r.compareTo(e.ZERO)>0&&this.m.subTo(r,r),r}function L(t){var e=i();return t.copyTo(e),this.reduce(e),e}function q(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=32767&t[e],r=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(i=e+this.m.t,t[i]+=this.m.am(0,r,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function C(t,e){t.squareTo(e),this.reduce(e)}function H(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function j(){return 0==(this.t>0?1&this[0]:this.s)}function k(t,r){if(t>4294967295||1>t)return e.ONE;var s=i(),n=i(),o=r.convert(this),h=m(t)-1;for(o.copyTo(s);--h>=0;)if(r.sqrTo(s,n),(t&1<<h)>0)r.mulTo(n,o,s);else{var a=s;s=n,n=a}return r.revert(s)}function F(t,e){var i;return i=256>t||e.isEven()?new B(e):new P(e),this.exp(t,i)}function _(){var t=i();return this.copyTo(t),t}function z(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Z(){return 0==this.t?this.s:this[0]<<24>>24}function G(){return 0==this.t?this.s:this[0]<<16>>16}function Y(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function W(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function Q(t){if(null==t&&(t=10),0==this.signum()||2>t||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),s=c(r),n=i(),o=i(),h="";for(this.divRemTo(s,n,o);n.signum()>0;)h=(r+o.intValue()).toString(t).substr(1)+h,n.divRemTo(s,n,o);return o.intValue().toString(t)+h}function X(t,i){this.fromInt(0),null==i&&(i=10);for(var r=this.chunkSize(i),s=Math.pow(i,r),n=!1,o=0,a=0,u=0;u<t.length;++u){var c=h(t,u);0>c?"-"==t.charAt(u)&&0==this.signum()&&(n=!0):(a=i*a+c,++o>=r&&(this.dMultiply(s),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(i,o)),this.dAddOffset(a,0)),n&&e.ZERO.subTo(this,this)}function te(t,i,r){if("number"==typeof i)if(2>t)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),ae,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(i);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(e.ONE.shiftLeft(t-1),this);else{var s=new Array,n=7&t;s.length=(t>>3)+1,i.nextBytes(s),n>0?s[0]&=(1<<n)-1:s[0]=0,this.fromString(s,256)}}function ee(){var t=this.t,e=new Array;e[0]=this.s;var i,r=this.DB-t*this.DB%8,s=0;if(t-->0)for(r<this.DB&&(i=this[t]>>r)!=(this.s&this.DM)>>r&&(e[s++]=i|this.s<<this.DB-r);t>=0;)8>r?(i=(this[t]&(1<<r)-1)<<8-r,i|=this[--t]>>(r+=this.DB-8)):(i=this[t]>>(r-=8)&255,0>=r&&(r+=this.DB,--t)),0!=(128&i)&&(i|=-256),0==s&&(128&this.s)!=(128&i)&&++s,(s>0||i!=this.s)&&(e[s++]=i);return e}function ie(t){return 0==this.compareTo(t)}function re(t){return this.compareTo(t)<0?this:t}function se(t){return this.compareTo(t)>0?this:t}function ne(t,e,i){var r,s,n=Math.min(t.t,this.t);for(r=0;n>r;++r)i[r]=e(this[r],t[r]);if(t.t<this.t){for(s=t.s&this.DM,r=n;r<this.t;++r)i[r]=e(this[r],s);i.t=this.t}else{for(s=this.s&this.DM,r=n;r<t.t;++r)i[r]=e(s,t[r]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()}function oe(t,e){return t&e}function he(t){var e=i();return this.bitwiseTo(t,oe,e),e}function ae(t,e){return t|e}function ue(t){var e=i();return this.bitwiseTo(t,ae,e),e}function ce(t,e){return t^e}function fe(t){var e=i();return this.bitwiseTo(t,ce,e),e}function pe(t,e){return t&~e}function le(t){var e=i();return this.bitwiseTo(t,pe,e),e}function de(){for(var t=i(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function ge(t){var e=i();return 0>t?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function ye(t){var e=i();return 0>t?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function me(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function ve(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+me(this[t]);return this.s<0?this.t*this.DB:-1}function be(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function Te(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=be(this[i]^e);return t}function Se(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function Re(t,i){var r=e.ONE.shiftLeft(t);return this.bitwiseTo(r,i,r),r}function De(t){return this.changeBit(t,ae)}function Ee(t){return this.changeBit(t,pe)}function xe(t){return this.changeBit(t,ce)}function we(t,e){for(var i=0,r=0,s=Math.min(t.t,this.t);s>i;)r+=this[i]+t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r+=t[i],e[i++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=0>r?-1:0,r>0?e[i++]=r:-1>r&&(e[i++]=this.DV+r),e.t=i,e.clamp()}function Ke(t){var e=i();return this.addTo(t,e),e}function Ae(t){var e=i();return this.subTo(t,e),e}function Be(t){var e=i();return this.multiplyTo(t,e),e}function Ue(){var t=i();return this.squareTo(t),t}function Oe(t){var e=i();return this.divRemTo(t,e,null),e}function Ve(t){var e=i();return this.divRemTo(t,null,e),e}function Ne(t){var e=i(),r=i();return this.divRemTo(t,e,r),new Array(e,r)}function Je(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Ie(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function Pe(){}function Me(t){return t}function Le(t,e,i){t.multiplyTo(e,i)}function qe(t,e){t.squareTo(e)}function Ce(t){return this.exp(t,new Pe)}function He(t,e,i){var r=Math.min(this.t+t.t,e);for(i.s=0,i.t=r;r>0;)i[--r]=0;var s;for(s=i.t-this.t;s>r;++r)i[r+this.t]=this.am(0,t[r],i,r,0,this.t);for(s=Math.min(t.t,e);s>r;++r)this.am(0,t[r],i,r,0,e-r);i.clamp()}function je(t,e,i){--e;var r=i.t=this.t+t.t-e;for(i.s=0;--r>=0;)i[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)i[this.t+r-e]=this.am(e-r,t[r],i,0,0,this.t+r-e);i.clamp(),i.drShiftTo(1,i)}function ke(t){this.r2=i(),this.q3=i(),e.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Fe(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=i();return t.copyTo(e),this.reduce(e),e}function _e(t){return t}function ze(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Ze(t,e){t.squareTo(e),this.reduce(e)}function Ge(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function $e(t,e){var r,s,n=t.bitLength(),o=c(1);if(0>=n)return o;r=18>n?1:48>n?3:144>n?4:768>n?5:6,s=8>n?new B(e):e.isEven()?new ke(e):new P(e);var h=new Array,a=3,u=r-1,f=(1<<r)-1;if(h[1]=s.convert(this),r>1){var p=i();for(s.sqrTo(h[1],p);f>=a;)h[a]=i(),s.mulTo(p,h[a-2],h[a]),a+=2}var l,d,g=t.t-1,y=!0,v=i();for(n=m(t[g])-1;g>=0;){for(n>=u?l=t[g]>>n-u&f:(l=(t[g]&(1<<n+1)-1)<<u-n,g>0&&(l|=t[g-1]>>this.DB+n-u)),a=r;0==(1&l);)l>>=1,--a;if((n-=a)<0&&(n+=this.DB,--g),y)h[l].copyTo(o),y=!1;else{for(;a>1;)s.sqrTo(o,v),s.sqrTo(v,o),a-=2;a>0?s.sqrTo(o,v):(d=o,o=v,v=d),s.mulTo(v,h[l],o)}for(;g>=0&&0==(t[g]&1<<n);)s.sqrTo(o,v),d=o,o=v,v=d,--n<0&&(n=this.DB-1,--g)}return s.revert(o)}function Ye(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var r=e;e=i,i=r}var s=e.getLowestSetBit(),n=i.getLowestSetBit();if(0>n)return e;for(n>s&&(n=s),n>0&&(e.rShiftTo(n,e),i.rShiftTo(n,i));e.signum()>0;)(s=e.getLowestSetBit())>0&&e.rShiftTo(s,e),(s=i.getLowestSetBit())>0&&i.rShiftTo(s,i),e.compareTo(i)>=0?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return n>0&&i.lShiftTo(n,i),i}function We(t){if(0>=t)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(0==e)i=this[0]%t;else for(var r=this.t-1;r>=0;--r)i=(e*i+this[r])%t;return i}function Qe(t){var i=t.isEven();if(this.isEven()&&i||0==t.signum())return e.ZERO;for(var r=t.clone(),s=this.clone(),n=c(1),o=c(0),h=c(0),a=c(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),i?(n.isEven()&&o.isEven()||(n.addTo(this,n),o.subTo(t,o)),n.rShiftTo(1,n)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;s.isEven();)s.rShiftTo(1,s),i?(h.isEven()&&a.isEven()||(h.addTo(this,h),a.subTo(t,a)),h.rShiftTo(1,h)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(s)>=0?(r.subTo(s,r),i&&n.subTo(h,n),o.subTo(a,o)):(s.subTo(r,s),i&&h.subTo(n,h),a.subTo(o,a))}return 0!=s.compareTo(e.ONE)?e.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a}function Xe(t){var e,i=this.abs();if(1==i.t&&i[0]<=Vi[Vi.length-1]){for(e=0;e<Vi.length;++e)if(i[0]==Vi[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<Vi.length;){for(var r=Vi[e],s=e+1;s<Vi.length&&Ni>r;)r*=Vi[s++];for(r=i.modInt(r);s>e;)if(r%Vi[e++]==0)return!1}return i.millerRabin(t)}function ti(t){var r=this.subtract(e.ONE),s=r.getLowestSetBit();if(0>=s)return!1;var n=r.shiftRight(s);t=t+1>>1,t>Vi.length&&(t=Vi.length);for(var o=i(),h=0;t>h;++h){o.fromInt(Vi[Math.floor(Math.random()*Vi.length)]);var a=o.modPow(n,this);if(0!=a.compareTo(e.ONE)&&0!=a.compareTo(r)){for(var u=1;u++<s&&0!=a.compareTo(r);)if(a=a.modPowInt(2,this),0==a.compareTo(e.ONE))return!1;if(0!=a.compareTo(r))return!1}}return!0}function ei(){this.i=0,this.j=0,this.S=new Array}function ii(t){var e,i,r;for(e=0;256>e;++e)this.S[e]=e;for(i=0,e=0;256>e;++e)i=i+this.S[e]+t[e%t.length]&255,r=this.S[e],this.S[e]=this.S[i],this.S[i]=r;this.i=0,this.j=0}function ri(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function si(){return new ei}function ni(t){Ii[Pi++]^=255&t,Ii[Pi++]^=t>>8&255,Ii[Pi++]^=t>>16&255,Ii[Pi++]^=t>>24&255,Pi>=Mi&&(Pi-=Mi)}function oi(){ni((new Date).getTime())}function hi(){if(null==Ji){for(oi(),Ji=si(),Ji.init(Ii),Pi=0;Pi<Ii.length;++Pi)Ii[Pi]=0;Pi=0}return Ji.next()}function ai(t){var e;for(e=0;e<t.length;++e)t[e]=hi()}function ui(){}function ci(t,i){return new e(t,i)}function fi(t,i){if(i<t.length+11)return console.error("Message too long for RSA"),null;for(var r=new Array,s=t.length-1;s>=0&&i>0;){var n=t.charCodeAt(s--);128>n?r[--i]=n:n>127&&2048>n?(r[--i]=63&n|128,r[--i]=n>>6|192):(r[--i]=63&n|128,r[--i]=n>>6&63|128,r[--i]=n>>12|224)}r[--i]=0;for(var o=new ui,h=new Array;i>2;){for(h[0]=0;0==h[0];)o.nextBytes(h);r[--i]=h[0]}return r[--i]=2,r[--i]=0,new e(r)}function pi(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function li(t,e){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=ci(t,16),this.e=parseInt(e,16)):console.error("Invalid RSA public key")}function di(t){return t.modPowInt(this.e,this.n)}function gi(t){var e=fi(t,this.n.bitLength()+7>>3);if(null==e)return null;var i=this.doPublic(e);if(null==i)return null;var r=i.toString(16);return 0==(1&r.length)?r:"0"+r}function yi(t,e){for(var i=t.toByteArray(),r=0;r<i.length&&0==i[r];)++r;if(i.length-r!=e-1||2!=i[r])return null;for(++r;0!=i[r];)if(++r>=i.length)return null;for(var s="";++r<i.length;){var n=255&i[r];128>n?s+=String.fromCharCode(n):n>191&&224>n?(s+=String.fromCharCode((31&n)<<6|63&i[r+1]),++r):(s+=String.fromCharCode((15&n)<<12|(63&i[r+1])<<6|63&i[r+2]),r+=2)}return s}function mi(t,e,i){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=ci(t,16),this.e=parseInt(e,16),this.d=ci(i,16)):console.error("Invalid RSA private key")}function vi(t,e,i,r,s,n,o,h){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=ci(t,16),this.e=parseInt(e,16),this.d=ci(i,16),this.p=ci(r,16),this.q=ci(s,16),this.dmp1=ci(n,16),this.dmq1=ci(o,16),this.coeff=ci(h,16)):console.error("Invalid RSA private key")}function bi(t,i){var r=new ui,s=t>>1;this.e=parseInt(i,16);for(var n=new e(i,16);;){for(;this.p=new e(t-s,1,r),0!=this.p.subtract(e.ONE).gcd(n).compareTo(e.ONE)||!this.p.isProbablePrime(10););for(;this.q=new e(s,1,r),0!=this.q.subtract(e.ONE).gcd(n).compareTo(e.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var o=this.p;this.p=this.q,this.q=o}var h=this.p.subtract(e.ONE),a=this.q.subtract(e.ONE),u=h.multiply(a);if(0==u.gcd(n).compareTo(e.ONE)){this.n=this.p.multiply(this.q),this.d=n.modInverse(u),this.dmp1=this.d.mod(h),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}}function Ti(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),i=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(i)<0;)e=e.add(this.p);return e.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)}function Si(t){var e=ci(t,16),i=this.doPrivate(e);return null==i?null:yi(i,this.n.bitLength()+7>>3)}function Ri(t){var e,i,r="";for(e=0;e+3<=t.length;e+=3)i=parseInt(t.substring(e,e+3),16),r+=Ci.charAt(i>>6)+Ci.charAt(63&i);for(e+1==t.length?(i=parseInt(t.substring(e,e+1),16),r+=Ci.charAt(i<<2)):e+2==t.length&&(i=parseInt(t.substring(e,e+2),16),r+=Ci.charAt(i>>2)+Ci.charAt((3&i)<<4));(3&r.length)>0;)r+=Hi;return r}function Di(t){var e,i,r="",s=0;for(e=0;e<t.length&&t.charAt(e)!=Hi;++e)v=Ci.indexOf(t.charAt(e)),0>v||(0==s?(r+=o(v>>2),i=3&v,s=1):1==s?(r+=o(i<<2|v>>4),i=15&v,s=2):2==s?(r+=o(i),r+=o(v>>2),i=3&v,s=3):(r+=o(i<<2|v>>4),r+=o(15&v),s=0));return 1==s&&(r+=o(i<<2)),r}var Ei,xi=0xdeadbeefcafe,wi=15715070==(16777215&xi);wi&&"Microsoft Internet Explorer"==navigator.appName?(e.prototype.am=s,Ei=30):wi&&"Netscape"!=navigator.appName?(e.prototype.am=r,Ei=26):(e.prototype.am=n,Ei=28),e.prototype.DB=Ei,e.prototype.DM=(1<<Ei)-1,e.prototype.DV=1<<Ei;var Ki=52;e.prototype.FV=Math.pow(2,Ki),e.prototype.F1=Ki-Ei,e.prototype.F2=2*Ei-Ki;var Ai,Bi,Ui="0123456789abcdefghijklmnopqrstuvwxyz",Oi=new Array;for(Ai="0".charCodeAt(0),Bi=0;9>=Bi;++Bi)Oi[Ai++]=Bi;for(Ai="a".charCodeAt(0),Bi=10;36>Bi;++Bi)Oi[Ai++]=Bi;for(Ai="A".charCodeAt(0),Bi=10;36>Bi;++Bi)Oi[Ai++]=Bi;B.prototype.convert=U,B.prototype.revert=O,B.prototype.reduce=V,B.prototype.mulTo=N,B.prototype.sqrTo=J,P.prototype.convert=M,P.prototype.revert=L,P.prototype.reduce=q,P.prototype.mulTo=H,P.prototype.sqrTo=C,e.prototype.copyTo=a,e.prototype.fromInt=u,e.prototype.fromString=f,e.prototype.clamp=p,e.prototype.dlShiftTo=T,e.prototype.drShiftTo=S,e.prototype.lShiftTo=R,e.prototype.rShiftTo=D,e.prototype.subTo=E,e.prototype.multiplyTo=x,e.prototype.squareTo=w,e.prototype.divRemTo=K,e.prototype.invDigit=I,e.prototype.isEven=j,e.prototype.exp=k,e.prototype.toString=l,e.prototype.negate=d,e.prototype.abs=g,e.prototype.compareTo=y,e.prototype.bitLength=b,e.prototype.mod=A,e.prototype.modPowInt=F,e.ZERO=c(0),e.ONE=c(1),Pe.prototype.convert=Me,Pe.prototype.revert=Me,Pe.prototype.mulTo=Le,Pe.prototype.sqrTo=qe,ke.prototype.convert=Fe,ke.prototype.revert=_e,ke.prototype.reduce=ze,ke.prototype.mulTo=Ge,ke.prototype.sqrTo=Ze;var Vi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Ni=(1<<26)/Vi[Vi.length-1];e.prototype.chunkSize=Y,e.prototype.toRadix=Q,e.prototype.fromRadix=X,e.prototype.fromNumber=te,e.prototype.bitwiseTo=ne,e.prototype.changeBit=Re,e.prototype.addTo=we,e.prototype.dMultiply=Je,e.prototype.dAddOffset=Ie,e.prototype.multiplyLowerTo=He,e.prototype.multiplyUpperTo=je,e.prototype.modInt=We,e.prototype.millerRabin=ti,e.prototype.clone=_,e.prototype.intValue=z,e.prototype.byteValue=Z,e.prototype.shortValue=G,e.prototype.signum=W,e.prototype.toByteArray=ee,e.prototype.equals=ie,e.prototype.min=re,e.prototype.max=se,e.prototype.and=he,e.prototype.or=ue,e.prototype.xor=fe,e.prototype.andNot=le,e.prototype.not=de,e.prototype.shiftLeft=ge,e.prototype.shiftRight=ye,e.prototype.getLowestSetBit=ve,e.prototype.bitCount=Te,e.prototype.testBit=Se,e.prototype.setBit=De,e.prototype.clearBit=Ee,e.prototype.flipBit=xe,e.prototype.add=Ke,e.prototype.subtract=Ae,e.prototype.multiply=Be,e.prototype.divide=Oe,e.prototype.remainder=Ve,e.prototype.divideAndRemainder=Ne,e.prototype.modPow=$e,e.prototype.modInverse=Qe,e.prototype.pow=Ce,e.prototype.gcd=Ye,e.prototype.isProbablePrime=Xe,e.prototype.square=Ue,ei.prototype.init=ii,ei.prototype.next=ri;var Ji,Ii,Pi,Mi=256;if(null==Ii){Ii=new Array,Pi=0;var Li;if("Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto){var qi=window.crypto.random(32);for(Li=0;Li<qi.length;++Li)Ii[Pi++]=255&qi.charCodeAt(Li)}for(;Mi>Pi;)Li=Math.floor(65536*Math.random()),Ii[Pi++]=Li>>>8,Ii[Pi++]=255&Li;Pi=0,oi()}ui.prototype.nextBytes=ai,pi.prototype.doPublic=di,pi.prototype.setPublic=li,pi.prototype.encrypt=gi,pi.prototype.doPrivate=Ti,pi.prototype.setPrivate=mi,pi.prototype.setPrivateEx=vi,pi.prototype.generate=bi,pi.prototype.decrypt=Si,function(){var t=function(t,r,s){var n=new ui,o=t>>1;this.e=parseInt(r,16);var h=new e(r,16),a=this,u=function(){var r=function(){if(a.p.compareTo(a.q)<=0){var t=a.p;a.p=a.q,a.q=t}var i=a.p.subtract(e.ONE),r=a.q.subtract(e.ONE),n=i.multiply(r);0==n.gcd(h).compareTo(e.ONE)?(a.n=a.p.multiply(a.q),a.d=h.modInverse(n),a.dmp1=a.d.mod(i),a.dmq1=a.d.mod(r),a.coeff=a.q.modInverse(a.p),setTimeout(function(){s()},0)):setTimeout(u,0)},c=function(){a.q=i(),a.q.fromNumberAsync(o,1,n,function(){a.q.subtract(e.ONE).gcda(h,function(t){0==t.compareTo(e.ONE)&&a.q.isProbablePrime(10)?setTimeout(r,0):setTimeout(c,0)})})},f=function(){a.p=i(),a.p.fromNumberAsync(t-o,1,n,function(){a.p.subtract(e.ONE).gcda(h,function(t){0==t.compareTo(e.ONE)&&a.p.isProbablePrime(10)?setTimeout(c,0):setTimeout(f,0)})})};setTimeout(f,0)};setTimeout(u,0)};pi.prototype.generateAsync=t;var r=function(t,e){var i=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(i.compareTo(r)<0){var s=i;i=r,r=s}var n=i.getLowestSetBit(),o=r.getLowestSetBit();if(0>o)return e(i),void 0;o>n&&(o=n),o>0&&(i.rShiftTo(o,i),r.rShiftTo(o,r));var h=function(){(n=i.getLowestSetBit())>0&&i.rShiftTo(n,i),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),i.compareTo(r)>=0?(i.subTo(r,i),i.rShiftTo(1,i)):(r.subTo(i,r),r.rShiftTo(1,r)),i.signum()>0?setTimeout(h,0):(o>0&&r.lShiftTo(o,r),setTimeout(function(){e(r)},0))};setTimeout(h,10)};e.prototype.gcda=r;var s=function(t,i,r,s){if("number"==typeof i)if(2>t)this.fromInt(1);else{this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),ae,this),this.isEven()&&this.dAddOffset(1,0);var n=this,o=function(){n.dAddOffset(2,0),n.bitLength()>t&&n.subTo(e.ONE.shiftLeft(t-1),n),n.isProbablePrime(i)?setTimeout(function(){s()},0):setTimeout(o,0)};setTimeout(o,0)}else{var h=new Array,a=7&t;h.length=(t>>3)+1,i.nextBytes(h),a>0?h[0]&=(1<<a)-1:h[0]=0,this.fromString(h,256)}};e.prototype.fromNumberAsync=s}();var Ci="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Hi="=",ji=ji||{};ji.env=ji.env||{};var ki=ji,Fi=Object.prototype,_i="[object Function]",zi=["toString","valueOf"];ji.env.parseUA=function(t){var e,i=function(t){var e=0;return parseFloat(t.replace(/\./g,function(){return 1==e++?"":"."}))},r=navigator,s={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:r&&r.cajaVersion,secure:!1,os:null},n=t||navigator&&navigator.userAgent,o=$.tb.location,h=o&&o.getHref();return s.secure=h&&0===h.toLowerCase().indexOf("https"),n&&(/windows|win32/i.test(n)?s.os="windows":/macintosh/i.test(n)?s.os="macintosh":/rhino/i.test(n)&&(s.os="rhino"),/KHTML/.test(n)&&(s.webkit=1),e=n.match(/AppleWebKit\/([^\s]*)/),e&&e[1]&&(s.webkit=i(e[1]),/ Mobile\//.test(n)?(s.mobile="Apple",e=n.match(/OS ([^\s]*)/),e&&e[1]&&(e=i(e[1].replace("_","."))),s.ios=e,s.ipad=s.ipod=s.iphone=0,e=n.match(/iPad|iPod|iPhone/),e&&e[0]&&(s[e[0].toLowerCase()]=s.ios)):(e=n.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/),e&&(s.mobile=e[0]),/webOS/.test(n)&&(s.mobile="WebOS",e=n.match(/webOS\/([^\s]*);/),e&&e[1]&&(s.webos=i(e[1]))),/ Android/.test(n)&&(s.mobile="Android",e=n.match(/Android ([^\s]*);/),e&&e[1]&&(s.android=i(e[1])))),e=n.match(/Chrome\/([^\s]*)/),e&&e[1]?s.chrome=i(e[1]):(e=n.match(/AdobeAIR\/([^\s]*)/),e&&(s.air=e[0]))),s.webkit||(e=n.match(/Opera[\s\/]([^\s]*)/),e&&e[1]?(s.opera=i(e[1]),e=n.match(/Version\/([^\s]*)/),e&&e[1]&&(s.opera=i(e[1])),e=n.match(/Opera Mini[^;]*/),e&&(s.mobile=e[0])):(e=n.match(/MSIE\s([^;]*)/),e&&e[1]?s.ie=i(e[1]):(e=n.match(/Gecko\/([^\s]*)/),e&&(s.gecko=1,e=n.match(/rv:([^\s\)]*)/),e&&e[1]&&(s.gecko=i(e[1]))))))),s},ji.env.ua=ji.env.parseUA(),ji.isFunction=function(t){return"function"==typeof t||Fi.toString.apply(t)===_i},ji._IEEnumFix=ji.env.ua.ie?function(t,e){var i,r,s;for(i=0;i<zi.length;i+=1)r=zi[i],s=e[r],ki.isFunction(s)&&s!=Fi[r]&&(t[r]=s)}:function(){},ji.extend=function(t,e,i){if(!e||!t)throw new Error("extend failed, please check that all dependencies are included.");var r,s=function(){};if(s.prototype=e.prototype,t.prototype=new s,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Fi.constructor&&(e.prototype.constructor=e),i){for(r in i)ki.hasOwnProperty(i,r)&&(t.prototype[r]=i[r]);ki._IEEnumFix(t.prototype,i)}},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var i=t.toString(16);if("-"!=i.substr(0,1))i.length%2==1?i="0"+i:i.match(/^[0-7]/)||(i="00"+i);else{var r=i.substr(1),s=r.length;s%2==1?s+=1:i.match(/^[0-7]/)||(s+=2);for(var n="",o=0;s>o;o++)n+="f";var h=new e(n,16),a=h.xor(t).add(e.ONE);i=a.toString(16).replace(/^-/,"")}return i},this.getPEMStringFromHex=function(t,e){var i=CryptoJS.enc.Hex.parse(t),r=CryptoJS.enc.Base64.stringify(i),s=r.replace(/(.{64})/g,"$1\r\n");return s=s.replace(/\r\n$/,""),"-----BEGIN "+e+"-----\r\n"+s+"\r\n-----END "+e+"-----\r\n"}},KJUR.asn1.ASN1Object=function(){var t="";this.getLengthHexFromValue=function(){if("undefined"==typeof this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+t.length+",v="+this.hV;var e=this.hV.length/2,i=e.toString(16);if(i.length%2==1&&(i="0"+i),128>e)return i;var r=i.length/2;if(r>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);var s=128+r;return s.toString(16)+i},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},KJUR.asn1.DERAbstractString=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.str?this.setString(t.str):"undefined"!=typeof t.hex&&this.setStringHex(t.hex))},ji.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractTime=function(){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(t){utc=t.getTime()+6e4*t.getTimezoneOffset();var e=new Date(utc);return e},this.formatDate=function(t,e){var i=this.zeroPadding,r=this.localDateToUTC(t),s=String(r.getFullYear());"utc"==e&&(s=s.substr(2,2));var n=i(String(r.getMonth()+1),2),o=i(String(r.getDate()),2),h=i(String(r.getHours()),2),a=i(String(r.getMinutes()),2),u=i(String(r.getSeconds()),2);return s+n+o+h+a+u+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setByDateValue=function(t,e,i,r,s,n){var o=new Date(Date.UTC(t,e-1,i,r,s,n,0));this.setByDate(o)},this.getFreshValueHex=function(){return this.hV}},ji.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractStructured=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,"undefined"!=typeof t&&"undefined"!=typeof t.array&&(this.asn1Array=t.array)},ji.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object),KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},ji.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object),KJUR.asn1.DERInteger=function(t){KJUR.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var i=new e(String(t),10);this.setByBigInteger(i)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.bigint?this.setByBigInteger(t.bigint):"undefined"!=typeof t["int"]?this.setByInteger(t["int"]):"undefined"!=typeof t.hex&&this.setValueHex(t.hex))},ji.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object),KJUR.asn1.DERBitString=function(t){KJUR.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t
},this.setUnusedBitsAndHexValue=function(t,e){if(0>t||t>7)throw"unused bits shall be from 0 to 7: u = "+t;var i="0"+t;this.hTLV=null,this.isModified=!0,this.hV=i+e},this.setByBinaryString=function(t){t=t.replace(/0+$/,"");var e=8-t.length%8;8==e&&(e=0);for(var i=0;e>=i;i++)t+="0";for(var r="",i=0;i<t.length-1;i+=8){var s=t.substr(i,8),n=parseInt(s,2).toString(16);1==n.length&&(n="0"+n),r+=n}this.hTLV=null,this.isModified=!0,this.hV="0"+e+r},this.setByBooleanArray=function(t){for(var e="",i=0;i<t.length;i++)e+=1==t[i]?"1":"0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),i=0;t>i;i++)e[i]=!1;return e},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.hex?this.setHexValueIncludingUnusedBits(t.hex):"undefined"!=typeof t.bin?this.setByBinaryString(t.bin):"undefined"!=typeof t.array&&this.setByBooleanArray(t.array))},ji.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object),KJUR.asn1.DEROctetString=function(t){KJUR.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},ji.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},ji.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object),KJUR.asn1.DERObjectIdentifier=function(t){var i=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},r=function(t){var r="",s=new e(t,10),n=s.toString(2),o=7-n.length%7;7==o&&(o=0);for(var h="",a=0;o>a;a++)h+="0";n=h+n;for(var a=0;a<n.length-1;a+=7){var u=n.substr(a,7);a!=n.length-7&&(u="1"+u),r+=i(parseInt(u,2))}return r};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var e="",s=t.split("."),n=40*parseInt(s[0])+parseInt(s[1]);e+=i(n),s.splice(0,2);for(var o=0;o<s.length;o++)e+=r(s[o]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueName=function(t){if("undefined"==typeof KJUR.asn1.x509.OID.name2oidList[t])throw"DERObjectIdentifier oidName undefined: "+t;var e=KJUR.asn1.x509.OID.name2oidList[t];this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.oid?this.setValueOidString(t.oid):"undefined"!=typeof t.hex?this.setValueHex(t.hex):"undefined"!=typeof t.name&&this.setValueName(t.name))},ji.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.DERUTF8String=function(t){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},ji.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNumericString=function(t){KJUR.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},ji.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERPrintableString=function(t){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},ji.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERTeletexString=function(t){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},ji.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERIA5String=function(t){KJUR.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},ji.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERUTCTime=function(t){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},"undefined"!=typeof t&&("undefined"!=typeof t.str?this.setString(t.str):"undefined"!=typeof t.hex?this.setStringHex(t.hex):"undefined"!=typeof t.date&&this.setByDate(t.date))},ji.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERGeneralizedTime=function(t){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen"),this.hV=stohex(this.s)},"undefined"!=typeof t&&("undefined"!=typeof t.str?this.setString(t.str):"undefined"!=typeof t.hex?this.setStringHex(t.hex):"undefined"!=typeof t.date&&this.setByDate(t.date))},ji.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERSequence=function(t){KJUR.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++){var i=this.asn1Array[e];t+=i.getEncodedHex()}return this.hV=t,this.hV}},ji.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERSet=function(t){KJUR.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var i=this.asn1Array[e];t.push(i.getEncodedHex())}return t.sort(),this.hV=t.join(""),this.hV}},ji.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERTaggedObject=function(t){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,i){this.hT=e,this.isExplicit=t,this.asn1Object=i,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=i.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.tag&&(this.hT=t.tag),"undefined"!=typeof t.explicit&&(this.isExplicit=t.explicit),"undefined"!=typeof t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},ji.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object),function(t){"use strict";var e,i={};i.decode=function(i){var r;if(e===t){var s="0123456789ABCDEF",n=" \f\n\r	\u2028\u2029";for(e=[],r=0;16>r;++r)e[s.charAt(r)]=r;for(s=s.toLowerCase(),r=10;16>r;++r)e[s.charAt(r)]=r;for(r=0;r<n.length;++r)e[n.charAt(r)]=-1}var o=[],h=0,a=0;for(r=0;r<i.length;++r){var u=i.charAt(r);if("="==u)break;if(u=e[u],-1!=u){if(u===t)throw"Illegal character at offset "+r;h|=u,++a>=2?(o[o.length]=h,h=0,a=0):h<<=4}}if(a)throw"Hex encoding incomplete: 4 bits missing";return o},window.Hex=i}(),function(t){"use strict";var e,i={};i.decode=function(i){var r;if(e===t){var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="= \f\n\r	\u2028\u2029";for(e=[],r=0;64>r;++r)e[s.charAt(r)]=r;for(r=0;r<n.length;++r)e[n.charAt(r)]=-1}var o=[],h=0,a=0;for(r=0;r<i.length;++r){var u=i.charAt(r);if("="==u)break;if(u=e[u],-1!=u){if(u===t)throw"Illegal character at offset "+r;h|=u,++a>=4?(o[o.length]=h>>16,o[o.length]=h>>8&255,o[o.length]=255&h,h=0,a=0):h<<=6}}switch(a){case 1:throw"Base64 encoding incomplete: at least 2 bits missing";case 2:o[o.length]=h>>10;break;case 3:o[o.length]=h>>16,o[o.length]=h>>8&255}return o},i.re=/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,i.unarmor=function(t){var e=i.re.exec(t);if(e)if(e[1])t=e[1];else{if(!e[2])throw"RegExp out of sync";t=e[2]}return i.decode(t)},window.Base64=i}(),function(t){"use strict";function e(t,i){t instanceof e?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=i)}function i(t,e,i,r,s){this.stream=t,this.header=e,this.length=i,this.tag=r,this.sub=s}var r=100,s="\u2026",n={tag:function(t,e){var i=document.createElement(t);return i.className=e,i},text:function(t){return document.createTextNode(t)}};e.prototype.get=function(e){if(e===t&&(e=this.pos++),e>=this.enc.length)throw"Requesting byte offset "+e+" on a stream of length "+this.enc.length;return this.enc[e]},e.prototype.hexDigits="0123456789ABCDEF",e.prototype.hexByte=function(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(15&t)},e.prototype.hexDump=function(t,e,i){for(var r="",s=t;e>s;++s)if(r+=this.hexByte(this.get(s)),i!==!0)switch(15&s){case 7:r+="  ";break;case 15:r+="\n";break;default:r+=" "}return r},e.prototype.parseStringISO=function(t,e){for(var i="",r=t;e>r;++r)i+=String.fromCharCode(this.get(r));return i},e.prototype.parseStringUTF=function(t,e){for(var i="",r=t;e>r;){var s=this.get(r++);i+=128>s?String.fromCharCode(s):s>191&&224>s?String.fromCharCode((31&s)<<6|63&this.get(r++)):String.fromCharCode((15&s)<<12|(63&this.get(r++))<<6|63&this.get(r++))}return i},e.prototype.parseStringBMP=function(t,e){for(var i="",r=t;e>r;r+=2){var s=this.get(r),n=this.get(r+1);i+=String.fromCharCode((s<<8)+n)}return i},e.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,e.prototype.parseTime=function(t,e){var i=this.parseStringISO(t,e),r=this.reTime.exec(i);return r?(i=r[1]+"-"+r[2]+"-"+r[3]+" "+r[4],r[5]&&(i+=":"+r[5],r[6]&&(i+=":"+r[6],r[7]&&(i+="."+r[7]))),r[8]&&(i+=" UTC","Z"!=r[8]&&(i+=r[8],r[9]&&(i+=":"+r[9]))),i):"Unrecognized time: "+i},e.prototype.parseInteger=function(t,e){var i=e-t;if(i>4){i<<=3;var r=this.get(t);if(0===r)i-=8;else for(;128>r;)r<<=1,--i;return"("+i+" bit)"}for(var s=0,n=t;e>n;++n)s=s<<8|this.get(n);return s},e.prototype.parseBitString=function(t,e){var i=this.get(t),r=(e-t-1<<3)-i,s="("+r+" bit)";if(20>=r){var n=i;s+=" ";for(var o=e-1;o>t;--o){for(var h=this.get(o),a=n;8>a;++a)s+=h>>a&1?"1":"0";n=0}}return s},e.prototype.parseOctetString=function(t,e){var i=e-t,n="("+i+" byte) ";i>r&&(e=t+r);for(var o=t;e>o;++o)n+=this.hexByte(this.get(o));return i>r&&(n+=s),n},e.prototype.parseOID=function(t,e){for(var i="",r=0,s=0,n=t;e>n;++n){var o=this.get(n);if(r=r<<7|127&o,s+=7,!(128&o)){if(""===i){var h=80>r?40>r?0:1:2;i=h+"."+(r-40*h)}else i+="."+(s>=31?"bigint":r);r=s=0}}return i},i.prototype.typeName=function(){if(this.tag===t)return"unknown";var e=this.tag>>6,i=(this.tag>>5&1,31&this.tag);switch(e){case 0:switch(i){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+i.toString(16)}case 1:return"Application_"+i.toString(16);case 2:return"["+i+"]";case 3:return"Private_"+i.toString(16)}},i.prototype.reSeemsASCII=/^[ -~]+$/,i.prototype.content=function(){if(this.tag===t)return null;var e=this.tag>>6,i=31&this.tag,n=this.posContent(),o=Math.abs(this.length);if(0!==e){if(null!==this.sub)return"("+this.sub.length+" elem)";var h=this.stream.parseStringISO(n,n+Math.min(o,r));return this.reSeemsASCII.test(h)?h.substring(0,2*r)+(h.length>2*r?s:""):this.stream.parseOctetString(n,n+o)}switch(i){case 1:return 0===this.stream.get(n)?"false":"true";case 2:return this.stream.parseInteger(n,n+o);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(n,n+o);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(n,n+o);case 6:return this.stream.parseOID(n,n+o);case 16:case 17:return"("+this.sub.length+" elem)";case 12:return this.stream.parseStringUTF(n,n+o);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(n,n+o);case 30:return this.stream.parseStringBMP(n,n+o);case 23:case 24:return this.stream.parseTime(n,n+o)}return null},i.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},i.prototype.print=function(e){if(e===t&&(e=""),document.writeln(e+this),null!==this.sub){e+="  ";for(var i=0,r=this.sub.length;r>i;++i)this.sub[i].print(e)}},i.prototype.toPrettyString=function(e){e===t&&(e="");var i=e+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(i+="+"),i+=this.length,32&this.tag?i+=" (constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(i+=" (encapsulates)"),i+="\n",null!==this.sub){e+="  ";for(var r=0,s=this.sub.length;s>r;++r)i+=this.sub[r].toPrettyString(e)}return i},i.prototype.toDOM=function(){var t=n.tag("div","node");t.asn1=this;var e=n.tag("div","head"),i=this.typeName().replace(/_/g," ");e.innerHTML=i;var r=this.content();if(null!==r){r=String(r).replace(/</g,"&lt;");var s=n.tag("span","preview");s.appendChild(n.text(r)),e.appendChild(s)}t.appendChild(e),this.node=t,this.head=e;var o=n.tag("div","value");if(i="Offset: "+this.stream.pos+"<br/>",i+="Length: "+this.header+"+",i+=this.length>=0?this.length:-this.length+" (undefined)",32&this.tag?i+="<br/>(constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(i+="<br/>(encapsulates)"),null!==r&&(i+="<br/>Value:<br/><b>"+r+"</b>","object"==typeof oids&&6==this.tag)){var h=oids[r];h&&(h.d&&(i+="<br/>"+h.d),h.c&&(i+="<br/>"+h.c),h.w&&(i+="<br/>(warning!)"))}o.innerHTML=i,t.appendChild(o);var a=n.tag("div","sub");if(null!==this.sub)for(var u=0,c=this.sub.length;c>u;++u)a.appendChild(this.sub[u].toDOM());return t.appendChild(a),e.onclick=function(){t.className="node collapsed"==t.className?"node":"node collapsed"},t},i.prototype.posStart=function(){return this.stream.pos},i.prototype.posContent=function(){return this.stream.pos+this.header},i.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},i.prototype.fakeHover=function(t){this.node.className+=" hover",t&&(this.head.className+=" hover")},i.prototype.fakeOut=function(t){var e=/ ?hover/;this.node.className=this.node.className.replace(e,""),t&&(this.head.className=this.head.className.replace(e,""))},i.prototype.toHexDOM_sub=function(t,e,i,r,s){if(!(r>=s)){var o=n.tag("span",e);o.appendChild(n.text(i.hexDump(r,s))),t.appendChild(o)}},i.prototype.toHexDOM=function(e){var i=n.tag("span","hex");if(e===t&&(e=i),this.head.hexNode=i,this.head.onmouseover=function(){this.hexNode.className="hexCurrent"},this.head.onmouseout=function(){this.hexNode.className="hex"},i.asn1=this,i.onmouseover=function(){var t=!e.selected;t&&(e.selected=this.asn1,this.className="hexCurrent"),this.asn1.fakeHover(t)},i.onmouseout=function(){var t=e.selected==this.asn1;this.asn1.fakeOut(t),t&&(e.selected=null,this.className="hex")},this.toHexDOM_sub(i,"tag",this.stream,this.posStart(),this.posStart()+1),this.toHexDOM_sub(i,this.length>=0?"dlen":"ulen",this.stream,this.posStart()+1,this.posContent()),null===this.sub)i.appendChild(n.text(this.stream.hexDump(this.posContent(),this.posEnd())));else if(this.sub.length>0){var r=this.sub[0],s=this.sub[this.sub.length-1];this.toHexDOM_sub(i,"intro",this.stream,this.posContent(),r.posStart());for(var o=0,h=this.sub.length;h>o;++o)i.appendChild(this.sub[o].toHexDOM(e));this.toHexDOM_sub(i,"outro",this.stream,s.posEnd(),this.posEnd())}return i},i.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},i.decodeLength=function(t){var e=t.get(),i=127&e;if(i==e)return i;if(i>3)throw"Length over 24 bits not supported at position "+(t.pos-1);if(0===i)return-1;e=0;for(var r=0;i>r;++r)e=e<<8|t.get();return e},i.hasContent=function(t,r,s){if(32&t)return!0;if(3>t||t>4)return!1;var n=new e(s);3==t&&n.get();var o=n.get();if(o>>6&1)return!1;try{var h=i.decodeLength(n);return n.pos-s.pos+h==r}catch(a){return!1}},i.decode=function(t){t instanceof e||(t=new e(t,0));var r=new e(t),s=t.get(),n=i.decodeLength(t),o=t.pos-r.pos,h=null;if(i.hasContent(s,n,t)){var a=t.pos;if(3==s&&t.get(),h=[],n>=0){for(var u=a+n;t.pos<u;)h[h.length]=i.decode(t);if(t.pos!=u)throw"Content size is not correct for container starting at offset "+a}else try{for(;;){var c=i.decode(t);if(0===c.tag)break;h[h.length]=c}n=a-t.pos}catch(f){throw"Exception while decoding undefined length content: "+f}}else t.pos+=n;return new i(r,o,n,s,h)},i.test=function(){for(var t=[{value:[39],expected:39},{value:[129,201],expected:201},{value:[131,254,220,186],expected:16702650}],r=0,s=t.length;s>r;++r){var n=new e(t[r].value,0),o=i.decodeLength(n);o!=t[r].expected&&document.write("In test["+r+"] expected "+t[r].expected+" got "+o+"\n")}},window.ASN1=i}(),ASN1.prototype.getHexStringValue=function(){var t=this.toHexString(),e=2*this.header,i=2*this.length;return t.substr(e,i)},pi.prototype.parseKey=function(t){try{var e=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,i=e.test(t)?Hex.decode(t):Base64.unarmor(t),r=ASN1.decode(i);if(9===r.sub.length){var s=r.sub[1].getHexStringValue();this.n=ci(s,16);var n=r.sub[2].getHexStringValue();this.e=parseInt(n,16);var o=r.sub[3].getHexStringValue();this.d=ci(o,16);var h=r.sub[4].getHexStringValue();this.p=ci(h,16);var a=r.sub[5].getHexStringValue();this.q=ci(a,16);var u=r.sub[6].getHexStringValue();this.dmp1=ci(u,16);var c=r.sub[7].getHexStringValue();this.dmq1=ci(c,16);var f=r.sub[8].getHexStringValue();this.coeff=ci(f,16)}else{if(2!==r.sub.length)return!1;var p=r.sub[1],l=p.sub[0],s=l.sub[0].getHexStringValue();this.n=ci(s,16);var n=l.sub[1].getHexStringValue();this.e=parseInt(n,16)}return!0}catch(d){return!1}},pi.prototype.getPrivateBaseKey=function(){var t={array:[new KJUR.asn1.DERInteger({"int":0}),new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({"int":this.e}),new KJUR.asn1.DERInteger({bigint:this.d}),new KJUR.asn1.DERInteger({bigint:this.p}),new KJUR.asn1.DERInteger({bigint:this.q}),new KJUR.asn1.DERInteger({bigint:this.dmp1}),new KJUR.asn1.DERInteger({bigint:this.dmq1}),new KJUR.asn1.DERInteger({bigint:this.coeff})]},e=new KJUR.asn1.DERSequence(t);return e.getEncodedHex()},pi.prototype.getPrivateBaseKeyB64=function(){return Ri(this.getPrivateBaseKey())},pi.prototype.getPublicBaseKey=function(){var t={array:[new KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new KJUR.asn1.DERNull]},e=new KJUR.asn1.DERSequence(t);t={array:[new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({"int":this.e})]};var i=new KJUR.asn1.DERSequence(t);t={hex:"00"+i.getEncodedHex()};var r=new KJUR.asn1.DERBitString(t);t={array:[e,r]};var s=new KJUR.asn1.DERSequence(t);return s.getEncodedHex()},pi.prototype.getPublicBaseKeyB64=function(){return Ri(this.getPublicBaseKey())},pi.prototype.wordwrap=function(t,e){if(e=e||64,!t)return t;var i="(.{1,"+e+"})( +|$\n?)|(.{1,"+e+"})";return t.match(RegExp(i,"g")).join("\n")},pi.prototype.getPrivateKey=function(){var t="-----BEGIN RSA PRIVATE KEY-----\n";return t+=this.wordwrap(this.getPrivateBaseKeyB64())+"\n",t+="-----END RSA PRIVATE KEY-----"},pi.prototype.getPublicKey=function(){var t="-----BEGIN PUBLIC KEY-----\n";return t+=this.wordwrap(this.getPublicBaseKeyB64())+"\n",t+="-----END PUBLIC KEY-----"},pi.prototype.hasPublicKeyProperty=function(t){return t=t||{},t.hasOwnProperty("n")&&t.hasOwnProperty("e")},pi.prototype.hasPrivateKeyProperty=function(t){return t=t||{},t.hasOwnProperty("n")&&t.hasOwnProperty("e")&&t.hasOwnProperty("d")&&t.hasOwnProperty("p")&&t.hasOwnProperty("q")&&t.hasOwnProperty("dmp1")&&t.hasOwnProperty("dmq1")&&t.hasOwnProperty("coeff")},pi.prototype.parsePropertiesFrom=function(t){this.n=t.n,this.e=t.e,t.hasOwnProperty("d")&&(this.d=t.d,this.p=t.p,this.q=t.q,this.dmp1=t.dmp1,this.dmq1=t.dmq1,this.coeff=t.coeff)};var Zi=function(t){pi.call(this),t&&("string"==typeof t?this.parseKey(t):(this.hasPrivateKeyProperty(t)||this.hasPublicKeyProperty(t))&&this.parsePropertiesFrom(t))};Zi.prototype=new pi,Zi.prototype.constructor=Zi;var Gi=function(t){t=t||{},this.default_key_size=parseInt(t.default_key_size)||1024,this.default_public_exponent=t.default_public_exponent||"010001",this.log=t.log||!1,this.key=null};Gi.prototype.setKey=function(t){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new Zi(t)},Gi.prototype.setPrivateKey=function(t){this.setKey(t)},Gi.prototype.setPublicKey=function(t){this.setKey(t)},Gi.prototype.decrypt=function(t){try{return this.getKey().decrypt(Di(t))}catch(e){return!1}},Gi.prototype.encrypt=function(t){try{return Ri(this.getKey().encrypt(t))}catch(e){return console.log(arguments),!1}},Gi.prototype.getKey=function(t){if(!this.key){if(this.key=new Zi,t&&"[object Function]"==={}.toString.call(t))return this.key.generateAsync(this.default_key_size,this.default_public_exponent,t),void 0;this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},Gi.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},Gi.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},Gi.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},Gi.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},t.JSEncrypt=Gi}(e.RSA),e.RSA=e.RSA.JSEncrypt}}});_.Module.define({path:"tbmall/widget/paykey_dialog",requires:["tbmall/widget/paykey_rsa"],sub:{ERROR:{2270018:"",1990005:"\u652F\u4ED8\u5BC6\u7801\u9A8C\u8BC1\u9519\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF0C\u60A8\u8FD8\u6709{#NUM#}\u6B21\u8F93\u5165\u673A\u4F1A",2190005:'\u4F60\u5DF2\u8F93\u5165\u5BC6\u7801\u9519\u8BEF5\u6B21\uFF0C\u652F\u4ED8\u5BC6\u7801\u88AB\u9501\u5B9A\uFF0C\u8BF7<a target="_blank" href="/tbmall/pass/set">\u627E\u56DE\u5BC6\u7801</a>'},MAX_ERR_TIME:5,_setTpl:['<div id="paykey_set_dialog" class="paykey_set_dialog clearfix">',"<p>\u8BF7\u8BBE\u7F6E\u652F\u4ED8\u5BC6\u7801\u540E\u5B8C\u6210\u6D88\u8D39</br>\uFF08\u53EF\u964D\u4F4ET\u8C46\u88AB\u76D7\u98CE\u9669\uFF0C\u4FDD\u969C\u8D22\u4EA7\u5B89\u5168\uFF09</p>",'<div class="paykey_btn_area clearfix">','<a href="/tbmall/pass/set" target="_blank" class="paykey_set_accept_btn paykey_set_btn" id="paykey_set_accept_btn">\u7ACB\u5373\u8BBE\u7F6E</a>','<a href="#" class="paykey_set_cancel_btn paykey_set_btn" id="paykey_set_cancel_btn">\u4E0B\u6B21\u518D\u8BF4</a>',"</div>","</div>"].join(""),_inputTpl:['<div id="paykey_set_dialog" class="paykey_set_dialog clearfix">','<form id="paykey_set_form">','<div class="paykey_input_area">',"<span>\u8BF7\u8F93\u5165\u652F\u4ED8\u5BC6\u7801</span>",'<input type="password" class="j_paykey_input paykey_input" id="paykey_input"/>','<p id="paykey_input_msg" class="paykey_input_msg">{#ERROR#}</p>',"</div>",'<div class="paykey_btn_area clearfix">','<a class="j_paykey_submit_btn paykey_submit_btn paykey_set_btn" id="paykey_submit_btn">\u63D0\u4EA4</a>','<a href="/tbmall/pass/set" target="_blank" class="j_paykey_cancel_btn  paykey_set_btn" id="paykey_cancel_btn">\u5FD8\u8BB0\u5BC6\u7801</a>',"</div>","</form>","</div>"].join(""),_dialog:null,conf:{},initial:function(a){this.conf=$.extend(this.conf,a),this.RSA=this.use("tbmall/widget/paykey_rsa")},showDialog:function(a,e,t){var i=e;2==arguments.length&&(t=e,i=null),2===this.conf.showType?this.inputPasskeyDialog(a,i,t):1===this.conf.showType?this.setPasskeyDialog(a,i,t):"function"==typeof a&&(t?a.call(t):a())},inputPasskeyDialog:function(a,e,t){var i=this;2==arguments.length&&(t=e);var s=this._inputTpl;if(this.conf.errType&&(s=s.replace("{#ERROR#}",this.ERROR[this.conf.errType])),this.conf.errTime){var n=this.MAX_ERR_TIME-this.conf.errTime;s=s.replace("{#NUM#}",n)}this._dialog=new $.dialog({html:s,title:"\u652F\u4ED8\u5BC6\u7801",draggable:!1,width:420});var l=function(){var e=$("#paykey_input").val();if(!e)return $("#paykey_input_msg").text("\u8BF7\u8F93\u5165\u652F\u4ED8\u5BC6\u7801"),void 0;var s=i.RSA.vcode(e);"function"==typeof a&&(t?a.call(t,{password:s}):a({password:s})),i._dialog.close()};$("#paykey_submit_btn").click(function(a){a.preventDefault(),l()}),$("#paykey_set_form").submit(function(a){a.preventDefault(),l()}),this._dialog.onclose(function(){"function"==typeof e&&(t?e.call(t):e())})},setPasskeyDialog:function(a,e,t){var i=this;2==arguments.length&&(t=e),this._dialog=new $.dialog({html:this._setTpl,title:"\u63D0\u793A",draggable:!1,width:420}),$("#paykey_set_accept_btn").click(function(){i._dialog.close()}),$("#paykey_set_cancel_btn").click(function(){i._dialog.close()}),this._dialog.element.find(".dialogJclose").on("click",function(){"function"==typeof e&&(t?e.call(t,{ignore_set_paypass:1}):e({ignore_set_paypass:1}))})}}});_.Module.define({path:"tbmall/widget/paykey_mobile",requires:[],sub:{_conf:{token:"",type:"bind"},initial:function(e){this._conf=$.extend(this._conf,e)},show:function(e,i,s,t){"check"===this._conf.type?this.showMobileCheck(e,i,s,t):this.showMobileBind(e,i,s,t)},showMobileCheck:function(e,i,s,t){var o=this,n="undefined"!=typeof Env&&Env.server_time?Env.server_time:(new Date).getTime();PageData.user.setpass;var c=t||"\u4E3A\u4E86\u4FDD\u969C\u60A8\u7684\u8D22\u4EA7\u5B89\u5168\uFF0C\u8BF7\u9A8C\u8BC1\u5BC6\u4FDD\u624B\u673A\u540E\u8FDB\u884C\u652F\u4ED8\u3002";$.JsLoadManager.use(["http://passport.baidu.com/passApi/js/uni_forceverify_wrapper.js?cdnversion="+Math.floor(n/6e4),"http://passport.bdimg.com/passApi/js/wrapper.js?cdnversion="+Math.floor(n/6e4)],function(){var t=passport.pop.initForceverify({token:o._conf.token,curType:"mobile",title:"\u6D88\u8D39\u9A8C\u8BC1\u5BC6\u4FDD\u624B\u673A",msg:c,onRender:function(){var e=$(this.getById("mask")),i=$(this.getById("wrapper"));e.css("zIndex",5e4+parseInt(e.css("zIndex"))),i.css("zIndex",5e4+parseInt(i.css("zIndex")))},onHide:function(){s=s||o,"function"==typeof i&&i.call(s,{})},onSendvcodeSuccess:function(){},onSubmitSuccess:function(){s=s||o,"function"==typeof e&&e.call(s,{mobile_check:1})}});t.show()},!0,"utf-8")},showMobileBind:function(e,i,s,t){var o=this;if(o.bindMobileDialog)return o.bindMobileDialog.show(),void 0;var n="undefined"!=typeof Env&&Env.server_time?Env.server_time:(new Date).getTime();$.JsLoadManager.use(["http://passport.baidu.com/passApi/js/uni_armorwidget_wrapper.js?cdnversion="+Math.floor(n/6e4),"http://passport.bdimg.com/passApi/js/wrapper.js?cdnversion="+Math.floor(n/6e4)],function(){var n=t||"\u7ED1\u5B9A\u624B\u673A\u662F\u76EE\u524D\u6700\u7B80\u5355\u6709\u6548\u964D\u4F4E\u8D26\u53F7\u88AB\u76D7\u98CE\u9669\u7684\u65B9\u6CD5~\u8BF7\u7ED1\u5B9A\u540E\u8FDB\u884C\u652F\u4ED8";o._conf.firstFlag&&(n="\u4E3A\u4FDD\u969C\u8D22\u4EA7\u5B89\u5168\uFF0C\u5EFA\u8BAE\u60A8\u7ED1\u5B9A\u624B\u673A\u540E\u8FDB\u884C\u6D88\u8D39\uFF0C\u82E5\u60F3\u6B8B\u5FCD\u7684\u62D2\u7EDD\u8BF7\u5173\u95ED\u6D6E\u5C42\u540E\u7EE7\u7EED\u6D88\u8D39\u3002"),o.bindMobileDialog=passport.pop.ArmorWidget("bindmobile",{token:o._conf.token,title:"\u5B89\u5168\u53CB\u60C5\u63D0\u793A",msg:n,auth_title:"\u6D88\u8D39\u9A8C\u8BC1\u5BC6\u4FDD\u624B\u673A",auth_msg:"\u60A8\u6B63\u5728\u8FDB\u884C\u652F\u4ED8\u5BC6\u7801\u8BBE\u7F6E\uFF0C\u4E3A\u4E86\u60A8\u7684\u8D26\u53F7\u5B89\u5168\uFF0C\u8BF7\u5148\u9A8C\u8BC1\u5BC6\u4FDD\u4FE1\u606F\u3002",onRender:function(){var e=$(this.getById("mask")),i=$(this.getById("wrapper"));e.css("zIndex",5e4+parseInt(e.css("zIndex"))),i.css("zIndex",5e4+parseInt(i.css("zIndex")))},onHide:function(){o.bindid||(s=s||o,"function"==typeof i&&i.call(s))},onSendvcodeSuccess:function(){},onSubmitSuccess:function(i){o.bindid=i.bindid,s=s||o;var t={bindid:o.bindid};o.showSetMobileCheck(t,e,s)}}),o.bindMobileDialog.show()},!0,"utf-8"),$.ajax({url:"/tbmall/pass/setAuthPhone",type:"post",data:{type:1,tbs:PageData.tbs}})},_setTpl:['<a class="dialogJclose j_set_mobile_check_dialogJclose" title="\u5173\u95ED\u672C\u7A97\u53E3">&nbsp;</a>','<div class="set_mobile_check_wrap" id="set_mobile_check_wrap">','<div class="set_mobile_check_msg">','<span class="set_mobile_check_icon"></span>','<span class="set_mobile_check_title">\u64CD\u4F5C\u6210\u529F</span>',"</div>","<p>\u4E3A\u4FDD\u969C\u8D26\u53F7T\u8C46\u5B89\u5168\uFF0C\u5EFA\u8BAE\u60A8\u9009\u62E9\u5F00\u542F\u624B\u673A\u9A8C\u8BC1\u529F\u80FD</p>",'<div class="set_mobile_check_operator">','<a href="#" class="set_mobile_check_select">','<input type="radio" class="j_set_mobile_check_ok set_mobile_check_radio" name="set_mobile_check_radio" checked/>\u5355\u7B14T\u8C46\u6D88\u8D39\u8D85\u8FC7100000\u5F00\u542F\u624B\u673A\u9A8C\u8BC1\u529F\u80FD',"</a>",'<a href="#" class="set_mobile_check_select">','<input type="radio" class="j_set_mobile_check_cancel set_mobile_check_radio" name="set_mobile_check_radio"/>\u4E0D\u5F00\u542F\u624B\u673A\u9A8C\u8BC1\u529F\u80FD',"</a>",'<a href="#" class="j_set_mobile_check_submit set_mobile_check_submit ui_btn ui_btn_m"><span><em>\u786E\u5B9A</em></span></a>',"</div>","</div>"].join(""),showSetMobileCheck:function(e,i,s){var t=this,o=new $.dialog({html:this._setTpl,showTitle:!1,height:260,width:420}),n=$(o.element);t.openCheck=1;var c=function(){$.ajax({url:"/tbmall/pass/setAuthPhone",type:"post",dataType:"json",data:{type:t.openCheck,tbs:PageData.tbs},success:function(e){0===e.no?setTimeout(function(){o.close()},1e3):$.dialog.alert("\u6D88\u8D39\u624B\u673A\u9A8C\u8BC1\u529F\u80FD\u8BBE\u7F6E\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")},error:function(){$.dialog.alert("\u6D88\u8D39\u624B\u673A\u9A8C\u8BC1\u529F\u80FD\u8BBE\u7F6E\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}})};n.find(".j_set_mobile_check_submit").click(function(){c()}),n.find(".j_set_mobile_check_ok").click(function(){t.openCheck=1}),n.find(".j_set_mobile_check_cancel").click(function(){t.openCheck=0}),n.find(".j_set_mobile_check_dialogJclose").click(function(){t.openCheck=1,c()}),o.onclose(function(){"function"==typeof i&&i.call(s,e)})}}});_.Module.define({path:"tbmall/widget/TbeanSafe",requires:["tbmall/component/captcha_payment","tbmall/widget/paykey_dialog","tbmall/widget/paykey_mobile"],sub:{ERROR:{},initial:function(t){this._initParam(t),this._handleErr()},needCheck:function(){return!!this.type},getType:function(){return this.type},_initParam:function(t){t=$.extend({json:{},sucCallback:function(){},errCallback:function(){}},t),this.type=0,this._json=t.json||{},this._no=this._json.no||this._json.errno,this._msg=this._json.msg,this._data=this._json.data||{},this._content=t.content,this._sucCall=$.isFunction(t.sucCallback)?t.sucCallback:function(){},this._errCall=$.isFunction(t.errCallback)?t.errCallback:function(){},this._mobileMsg="undefined"!=typeof t.tbeanOptions?t.tbeanOptions.mobileMsg:""},_handleErr:function(){switch(this._no){case 360007:case 2150040:this._initCaptcha(),this.type=1;break;case 2270018:case 1990005:case 2190005:this._initPaykey(2),this.type=2;break;case 2270066:this._initPaykey(1),this.type=2;break;case 2270040:this._initFirstMobile("bind"),this.type=3;break;case 2270041:this._initMobile("bind"),this.type=3;break;case 2270042:this._initMobile("check"),this.type=3;break;case 2270072:this._initFrozen(),this.type=4}},_initCaptcha:function(){var t=this.use("tbmall/component/captcha_payment",{data:this._json});t.showCaptcha(this._sucCall,this._content,this._errCall)},_initPaykey:function(t){var i=this.use("tbmall/widget/paykey_dialog",{showType:t,errType:this._no,errTime:this._data.wrongtime});i.showDialog(this._sucCall,this._errCall,this._content)},_initMobile:function(t){var i=this,e=this.use("tbmall/widget/paykey_mobile",{token:i._data.token,type:t});e.show(this._sucCall,this._errCall,this._content,this._mobileMsg)},_initFirstMobile:function(t){var i=this,e=this.use("tbmall/widget/paykey_mobile",{token:i._data.token,type:t,firstFlag:!0});e.show(this._sucCall,this._sucCall,this._content)},_FROZEN_TPL:['<div id="tdou_frozen_dialog" class="tdou_frozen_dialog clearfix">',"<p>\u60A8\u7684\u8D26\u53F7\u5904\u4E8E\u5F02\u5E38\u72B6\u6001\uFF0C\u6682\u65F6\u4E0D\u80FD\u6D88\u8D39T\u8C46\uFF0C\u7ED9\u60A8\u9020\u6210\u7684\u4E0D\u4FBF\u656C\u8BF7\u8C05\u89E3\u3002</p>",'<div class="tdou_frozen_btn_area clearfix">','<a href="#" target="_blank" class="tdou_frozen_accept_btn tdou_frozen_btn" id="tdou_frozen_accept_btn">\u786E\u5B9A</a>','<a href="#" class="tdou_frozen_cancel_btn tdou_frozen_btn" id="tdou_frozen_cancel_btn">\u53D6\u6D88</a>',"</div>","</div>"].join(""),_initFrozen:function(){var t=this,i=new $.dialog({html:t._FROZEN_TPL,title:"T\u8C46\u51BB\u7ED3\u63D0\u793A"});$(i.element).find(".tdou_frozen_btn").click(function(t){t.preventDefault(),i.close()}),i.onclose(function(){"function"==typeof t._errCall&&t._errCall()})}}});_.Module.define({path:"tbmall/widget/TbeanSafeAjax",requires:["tbmall/widget/TbeanSafe"],sub:{initial:function(a){this.options=a||{}},ajax:function(a){var t=this,e=a.success||function(){},n=a.data||{},s=function(s){var i=t.use("tbmall/widget/TbeanSafe",{json:s,sucCallback:function(e){var s=$.extend({},n,e),i=$.extend({},a);i.data=s,t.ajax(i)},tbeanOptions:t.options});i.needCheck()||e(s)};return a.success=s,a.type=a.type||"post",a.dataType=a.dataType||"json",$.ajax(a)},post:function(a,t,e){var n={url:a,data:t,success:e};return this.ajax(n)}}});_.Module.define({path:"tbmall/widget/forumMemberDialog",requires:["tbmall/widget/tbean_safe_ajax","common/widget/cashierDialog","common/widget/messenger","common/widget/baseUserData","common/widget/payMember"],sub:{opts:{},initial:function(e){var t=this,s={is_show_features:!0,is_show_forum:!0,current_time_order:1,current_option:null,current_time_unit:3,current_forum_id:"",current_forum_name:""};this.opts=$.extend({},s,e),this.tpl_data.forums=this.opts.forums,this.opts.scores=this.opts.scores||PageData.scores,this.forumMemberTitle=this.opts.is_celebrity_forum?"\u5427\u4F1A\u5458":"\u5427\u7279\u6743\u5305",this.safeAjax=this.use("tbmall/widget/tbean_safe_ajax"),this.showDialog({showTitle:!1,width:886,height:t.opts.cnt_height||295,html:t.buildInitHtml()}),t.opts.current_option=$($(".sel_time .j_pertime_unit")[t.opts.current_time_order]),t.opts.current_option.addClass("current_time_unit"),t.bindEvents()},bindEvents:function(){var e=this,t=$(".excharge_bd"),s=$("#customForum");t.delegate(".j_charge_tdou","click",function(t){var i=e.getTimeValue(),o=e.opts.scores,r=0;o&&(r=o.scores_money+o.scores_other);var a=parseInt(5e3*i),n=$("#customTime").val();return t.preventDefault(),e.opts.is_show_forum?e.util._isEmpty($("#customForum").val())?(e.showErrorForum("empty"),void 0):$.trim(n).length>0&&!e.util._isPositiveDigital(n)?(e._printTimeErrorInfo("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u6570\u503C"),void 0):parseInt($.trim(n),10)>120?(e._printTimeErrorInfo("\u6700\u591A\u5145\u503C120\u4E2A\u6708"),$(this).val(120),void 0):e.opts.isClickByUser?a>r?(e.initTdouNotEnough(r,a),void 0):(e.initBuyMember(),void 0):(e.checkHasForum(s.val(),function(t){e.opts.current_forum_id=t.data.forum_id,e.opts.current_forum_name=t.data.forum_name,a>r?e.initTdouNotEnough(r,a):e.initBuyMember()}),void 0):a>r?(e.initTdouNotEnough(r,a),void 0):(e.initBuyMember(),void 0)}),$(".j_close_excharge").on("click",function(t){t.preventDefault(),e.closeDialog()}),$(".excharge_bd").delegate(".j_pertime_unit","click",function(t){t.preventDefault(),e.changeCurrentOpt($(this),"current_time_unit"),e._close_tip_bubble(),e.changeTdouNum(),$("#customTime").val("")}),$(".excharge_bd").delegate("#customTime","focus",function(){e.changeCurrentOpt($(this).closest(".j_customTime_unit"),"current_time_unit"),e.changeTdouNum()}),$(".excharge_bd").delegate("#customTime","keyup",function(){var t=$(this).val();return $.trim(t).length>0&&!e.util._isPositiveDigital(t)?(e._printTimeErrorInfo("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u6570\u503C"),void 0):parseInt($.trim(t),10)>120?(e._printTimeErrorInfo("\u6700\u591A\u5145\u503C120\u4E2A\u6708"),$(this).val(120),e.changeTdouNum(),void 0):(e._close_tip_bubble(),e.changeTdouNum(),void 0)}),$(".sel_forum").delegate(".j_forum_unit","click",function(t){t.preventDefault();var i=$(this),o=i.data("forumid"),r=decodeURIComponent(i.text());e.hideErrorForum(),e.opts.current_forum_id=o,e.opts.current_forum_name=r,e.opts.isClickByUser=!0,s.val(r),$(".j_show_more").hasClass("show_more_forums_list")&&$(".j_show_more").removeClass("show_more_forums_list")}),$(".sel_forum").delegate("#customForum","keyup",function(){var t=e.opts.current_forum_name,i=$.trim(s.val());t!==i&&(e.opts.isClickByUser=!1),""===i&&e.hideErrorForum()}),$(".sel_forum").delegate("#customForum","blur",function(){var t=s.val();return e.util._isEmpty(t)?(e.showErrorForum("empty"),void 0):$.trim(t).length>0&&!e.util._isPositiveDigital(t)?(e._printTimeErrorInfo("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u6570\u503C"),void 0):parseInt($.trim(t),10)>120?(e._printTimeErrorInfo("\u6700\u591A\u5145\u503C120\u4E2A\u6708"),$(this).val(120),void 0):(e._close_tip_bubble(),e.checkHasForum(t),void 0)}),$(".sel_forum").delegate(".j_get_more_f","click",function(e){e.preventDefault(),$(".j_show_more").toggleClass("show_more_forums_list")}),$(".excharge_bd").delegate(".j_get_tdou","click",function(t){t.preventDefault(),e.closeDialog(),_.Module.use("common/widget/JoinVipDialog",[],function(e){e.getMemberDialog()})})},initTdouNotEnough:function(e,t){var s=this,i=s.getTimeValue(),o={month:i,baidu_charge:t,tdou_num:e};s.closeDialog(),s.chargeFailFn($.extend({},o,{f_name:s.opts.current_forum_name}))},initBuyMember:function(){var e=this,t=e.getTimeValue(),s=PageData.user?PageData.user.mParr_props?PageData.user.mParr_props.forum_member?PageData.user.mParr_props.forum_member[e.opts.current_forum_id]:null:null:null,i=function(){e.safeAjax.ajax({url:"/tbmall/mall/buyForumMember",data:{tbs:PageData.tbs,forum_id:e.opts.current_forum_id,buy_num:t},success:function(t){e.closeDialog(),e.chargeSuccessFn(t)}})},o=PageData.user?PageData.user.mParr_props?PageData.user.mParr_props.level?2===PageData.user.mParr_props.level.props_id?PageData.user.mParr_props.level.end_time:0:null:null:null,r=s?s.end_time:0,a=r||o,a=Math.max(Math.max(r,o),1*new Date/1e3);if(t>=24||a&&parseInt(a)+31*t*24*60*60-1*new Date/1e3>=64281600){var n=new $.dialog({html:['<a class="outpage_close j_close_excharge" href="#"></a>','<div class="long_time_area">','<p class="long_time_msg">\u5F00\u901A<b>\u3010'+e.opts.current_forum_name+e.forumMemberTitle+"\u3011</b></p>",'<p class="long_time_msg"><b>\u7279\u6743\u65F6\u957F\u6700\u591A\u8FDE\u7EED\u5151\u636224\u4E2A\u6708\uFF0C\u8D85\u51FA\u90E8\u5206\u53EA\u8D60\u9001\u7ECF\u9A8C\u548C\u9053\u5177\u3002</b></p>','<p class="long_time_msg">\u672C\u6B21\u5151\u6362\u9700\u8981<span class="tdou_num">'+5e3*t+"</span></p>",'<div class="long_time_operation">','<a href="#" class="long_time_cancel_btn j_close_excharge">\u53D6&nbsp;\u6D88</a>','<a href="#" class="long_time_accept_btn j_accept_excharge">\u786E&nbsp;\u8BA4</a>',"</div>","</div>"].join(""),width:460,height:170,showTitle:!1}),l=n.element;l.on("click",".j_close_excharge",function(e){e.preventDefault(),n.close()}).on("click",".j_accept_excharge",function(e){e.preventDefault(),i(),n.close()})}else i()},changeCurrentOpt:function(e,t){var s=this;s.opts.current_option&&s.opts.current_option.removeClass(t),s.opts.current_option=e,s.opts.current_option.addClass(t)},changeTdouNum:function(){var e=this;$(".sel_tdou .tdou_num").text(5e3*e.getTimeValue())},getTimeValue:function(){var e=$.trim($("#customTime").val());return this.opts.current_option&&this.opts.current_option.data("value")?this.opts.current_option.data("value"):0===e.length&&""===e?0:e},chargeSuccessFn:function(e){var t=this,s={0:{html:t.buildSuccessHtml(e.data),height:456},2270046:{html:t.buildEnoughHtml(),height:216}};0==e.no&&(t.opts.scores=$.extend(t.opts.scores,e.data.left_scores)),t.showDialog({width:537,height:s[e.no].height,showTitle:!1,html:s[e.no].html}),$(".j_close_excharge, .j_excharge_confirm").on("click",function(e){e.preventDefault(),t.closeDialog(),$.tb.location.reload()})},chargeFailFn:function(e){var t=this;t.showDialog({width:537,height:226,showTitle:!1,html:t.buildFailHtml(e)}),$(".j_close_excharge").on("click",function(e){e.preventDefault(),t.closeDialog()}),$(".j_get_tdou").on("click",function(e){e.preventDefault(),t.closeDialog(),_.Module.use("common/widget/tcharge_dialog")})},buildInitHtml:function(){var e=this,t=baidu.template,s=e.opts.is_show_forum?"\u5151\u6362"+e.forumMemberTitle:"\u5151\u6362\u3010"+e.opts.current_forum_name+"\u5427\u3011"+e.forumMemberTitle;return['<a class="outpage_close j_close_excharge" href="#"></a>','<div class="excharge_hd">',$.tb.format(e.tpl.hd,{title:s}),"</div>",'<div class="excharge_bd">','<div class="lp">',t(e.tpl.bd_lp_t,{forum_member_title:e.forumMemberTitle}),e.opts.is_show_features?t(e.tpl.features,e.tpl_data):"","</div>",'<div class="rp">',e.opts.is_show_forum?t(e.tpl.bd_rp_forum,e.tpl_data):"",t(e.tpl.bd_rp_time,e.tpl_data),'<p class="long_time_warning" ',e.opts.is_celebrity_forum?'style="visibility: hidden;"':"",">\u7279\u6743\u5305\u65F6\u957F(\u7D2F\u8BA1\u8D85\u7EA7\u4F1A\u5458)\u6700\u591A\u8FDE\u7EED24\u4E2A\u6708\uFF0C\u8D85\u51FA\u90E8\u5206\u53EA\u8D60\u9001\u7ECF\u9A8C\u548C\u9053\u5177\u3002</p>",$.tb.format(e.tpl.bd_rp_tdou,{tdou_num:5e3*e.opts.current_time_unit}),t(e.tpl.bd_rp_btn,{tip:e.opts.is_celebrity_forum?"\u8D85\u7EA7\u4F1A\u5458\u514D\u8D39\u62E5\u6709":"\u8D85\u7EA7\u4F1A\u5458\u514D\u8D39\u4F7F\u7528\u7279\u6743"}),"</div>","</div>"].join("")},buildSuccessHtml:function(e){{var t=this;baidu.template}return['<a class="outpage_close j_close_excharge" href="#"></a>','<div class="excharge_hd">',$.tb.format(t.tpl.hd,{title:"\u5151\u6362\u3010"+t.opts.current_forum_name+"\u5427\u3011"+t.forumMemberTitle}),"</div>",'<div class="excharge_bd excharge_succ_bd">',$.tb.format(t.tpl.charge_success,$.extend(e,{end_time:t.util._getDate(e.end_time),forum_member_title:t.forumMemberTitle})),"</div>"].join("")},buildEnoughHtml:function(){return['<a class="outpage_close j_close_excharge" href="#"></a>','<div class="excharge_bd excharge_enough_bd">','<p class="main_intro">\u60A8\u5DF2\u5F00\u901A25\u4E2A\u5427\u7684\u7279\u6743\u5305\uFF0C\u8FBE\u5230\u7279\u6743\u5305\u6570\u91CF\u4E0A\u9650</p>','<p class="sub_intro">\u7ACB\u5373\u5F00\u901A\u8D34\u5427\u4F1A\u5458\uFF0C\u5C3D\u4EAB\u8D34\u5427\u7279\u6743\u65E0\u4E0A\u9650</p>','<a class="j_charge_confirm charge_tdou btn_default btn_small" href="#">\u5F00\u901A\u8D85\u7EA7\u4F1A\u5458</a>',"</div>"].join("")},buildFailHtml:function(e){var t=this,s=baidu.template;return['<a class="outpage_close j_close_excharge" href="#"></a>','<div class="excharge_hd">',$.tb.format(t.tpl.hd,{title:"\u5151\u6362\u3010"+t.opts.current_forum_name+"\u5427\u3011"+t.forumMemberTitle}),"</div>",'<div class="excharge_bd excharge_fail_bd">','<div class="lp">',s(t.tpl.bd_lp_t,{forum_member_title:t.forumMemberTitle}),"<p>\u65F6\u957F\uFF1A"+e.month+"\u4E2A\u6708</p>","</div>",'<div class="rp">',$.tb.format(t.tpl.charge_fail,e),"</div>","</div>"].join("")},tpl_data:{forums:null,features:[{type:"\u7EA2\u8272\u6807\u9898"},{type:"\u7ECF\u9A8C\u52A0\u901F"},{type:"\u76F4\u9001\u7ECF\u9A8C"},{type:"\u8865\u7B7E\u5361",num:"1"},{type:"\u9B54\u62DC",num:"1"},{type:"\u9B54\u86CB",num:"1"}],bd_rp_time:[1,3,6,12]},tpl:{hd:'<p class="title">#{title}</p>',bd_lp_t:['<div class="intro">',"<h5>\u3010<%=forum_member_title%>\u3011</h5>",'<span class="forum_img_box"></span>','<p class="tdou_num"><strong>5000</strong>/\u6708</p>',"</div>"].join(""),features:['<ul class="features">',"<%for(var i = 0; i< features.length; i++){%>",'<li class="feature_<%=i%>"><%=features[i].type%>',"<%if (!!features[i].num) {%>","<strong>X<%= features[i].num %></strong>","<%}%>","</li>","<%}%>","</ul>"].join(""),bd_rp_forum:['<div class="sel_forum">','<span class="sel_label">\u8BF7\u9009\u62E9\u5427:</span>','<div class="sel_cnt">','<input id="customForum" type="text" value=""/>\u5427','<span class="error_forum_tip empty_forum_tip">\u8BF7\u9009\u62E9\u4E00\u4E2A\u5427</span>','<span class="error_forum_tip hasNot_forum_tip">\u8BE5\u5427\u4E0D\u5B58\u5728</span>',"</div>",'<div class="forum_lists j_show_more">',"<%if (forums.length <= 6) {%>","<%for(var i = 0; i < forums.length; i++) {%>",'<a class="per_forum_unit j_forum_unit" data-forumId="<%=forums[i].id%>" href="#"><%=forums[i]["f_name"]%></a>',"<%}%>","<%}else {%>",'<a class="j_get_more_f">','<span class="more_forum_btn"><ins></ins>\u66F4\u591A</span>','<span class="less_forum_btn"><ins></ins>\u5173\u95ED</span>',"</a>","<%for(var i = 0; i < 6; i++) {%>",'<a class="per_forum_unit j_forum_unit" data-forumId="<%=forums[i].id%>" href="#"><%=forums[i]["f_name"]%></a>',"<%}%>",'<div class="more_forums">',"<%for(var i = 6; i < forums.length; i++) {%>",'<a class="j_forum_unit per_forum_unit" data-forumId="<%=forums[i].id%>" href="#"><%=forums[i].f_name%></a>',"<%}%>","</div>","<%}%>","</div>","</div>"].join(""),bd_rp_time:['<div class="sel_time">','<span class="sel_label">\u8BF7\u9009\u62E9\u65F6\u957F:</span>','<span class="sel_cnt">',"<%for(var i = 0; i< bd_rp_time.length; i++){%>",'<a class="j_pertime_unit per_time_unit" data-value="<%=bd_rp_time[i]%>">',"<strong><%=bd_rp_time[i]%></strong>\u4E2A\u6708",'<span class="decorate_icon"></span>',"</a>","<%}%>",'<a class="j_customTime_unit per_time_unit custom_time">','<input id="customTime" type="text" value=""/><span>\u4E2A\u6708</span>','<span class="decorate_icon"></span>',"</a>","</span>","</div>"].join(""),bd_rp_tdou:['<div class="sel_tdou">','<span class="sel_label">\u9700\u8981T\u8C46:</span>','<span class="tdou_num">#{tdou_num}</span>',"</div>"].join(""),bd_rp_btn:['<a class="j_charge_tdou btn_default btn_small charge_tdou" href="#">\u7ACB\u5373\u5151\u6362</a>','<p class="be_svip"><a class="j_get_tdou" href="#"><%=tip%></a></p>'].join(""),charge_success:['<div class="charge_success_info">','<p class="charge_month_num">\u60A8\u5DF2\u7ECF\u6210\u529F\u5151\u6362<strong class="forum_name">\u3010#{forum_name}#{forum_member_title}\u3011</strong></p>','<p class="expire_date">\u6709\u6548\u671F\u81F3#{end_time}</p>',"</div>",'<ul class="charge_success_feature">','<li class="s_feature_1">',"<p>\u7EA2\u8272\u6807\u9898</p>","<span></span>","</li>",'<li class="s_feature_2">',"<p>\u7ECF\u9A8C\u52A0\u901F</p>","<span></span>","</li>",'<li class="s_feature_3">',"<p>\u76F4\u9001\u7ECF\u9A8C</p>","<span></span>","</li>",'<li class="s_feature_4">',"<p>\u9053\u5177\u8D60\u9001</p>",'<span class="props_1">\u8865\u7B7E\u5361X1</span>','<span class="props_2">\u9B54\u62DCX1</span>','<span class="props_3">\u9B54\u86CBX1</span>',"</li>","</ul>",'<p class="success_btns">','<a class="charge_tdou btn_default btn_small" href="/tbmall/mall/forumMember">\u8BE6\u7EC6\u4E86\u89E3\u7279\u6743</a>','<a class="j_excharge_confirm charge_tdou btn_default btn_small" href="#">\u5173\u95ED</a>',"</p>"].join(""),charge_fail:['<div class="fail_cnt">','<p>\u5F00\u901A<strong class="forum_name">\u3010#{f_name}\u3011</strong>#{month}\u4E2A\u6708</p>','<p>\u8BE5\u7279\u6743\u9700\u8981<span class="orange_num">#{baidu_charge}</span></p>','<p>\u5F53\u524D\u60A8\u4EC5\u6709<span class="orange_num">#{tdou_num}</span></p>',"</div>",'<a class="j_get_tdou charge_tdou btn_default  btn_small" href="#">\u83B7\u53D6T\u8C46</a>'].join("")},showErrorForum:function(e){$(".error_forum_tip").hide(),$("."+e+"_forum_tip").css("display","inline-block")},hideErrorForum:function(){$(".error_forum_tip").hide()},checkHasForum:function(e,t){var s=this;$.post("../get/checkForum",{forum_name:encodeURIComponent(e),tbs:PageData.tbs}).done(function(e){0===e.no&&(0===e.data.forum_id&&null===e.data.forum_name?s.showErrorForum("hasNot"):(s.hideErrorForum(),$.isFunction(t)&&t(e)))})},showDialog:function(e){this._dialog=new $.dialog(e)},closeDialog:function(){this._dialog&&this._dialog.close()},_build_tip_bubble:function(e){var t=this,s={content:e,arrow_dir:"up",bubble_css:{top:t.opts.is_show_forum?124:52,right:45,width:130,"z-index":9999},arrow_pos:{left:10},attr:"",wrap:$(".sel_time"),closeBtn:!0};this.opts.tip_bubble=new UiBubbleTipBase(s);var i=this.opts.tip_bubble;i.showBubble(),i.bind("onclose",function(){t._close_tip_bubble()})},_close_tip_bubble:function(){this.opts.tip_bubble&&this.opts.tip_bubble.hideBubble()},_show_tip_bubble:function(){this.opts.tip_bubble&&this.opts.tip_bubble.showBubble()},_printTimeErrorInfo:function(e){this.opts.tip_bubble?this._show_tip_bubble():this._build_tip_bubble(e)},util:{_isEmpty:function(e){return 0===$.trim(e).length},_isPositiveDigital:function(e){return/^[1-9]+[0-9]*]*$/.test(e)},_getDate:function(e){var t=new Date(1e3*e),s=t.getFullYear(),i=t.getMonth()+1,o=t.getDate();return s+"\u5E74"+i+"\u6708"+o+"\u65E5"}}}});_.Module.define({path:"user/widget/celebrity_forum_dialog",requires:["tbmall/widget/forumMemberDialog"],sub:{initial:function(i){this._params=i,this._user=PageData.user,this._bindEvents()},_bindEvents:function(){var i=this._params.$root,s=this;i.on("click",function(){if(!s._user.is_login)return s.requireInstanceAsync("common/widget/LoginDialog"),void 0;var i=$(this).data("forumid")||s._params.forumId||PageData.forum.id;$.post("/celebrity/submit/getForumSupport",{forum_id:i,tbs:PageData.tbs},function(i){if(i.data&&i.data.length>0){var t=s.formatForumSupportData(i.data[0]);s._showDialog(t)}})})},formatForumSupportData:function(i){var s,t=i.npc_info.level_id;return s=3>=t?"1":t>3&&5>=t?"2":t>5&&7>=t?"2_1":t>7&&9>=t?"2_2":t>9&&11>=t?"3":t>11&&13>=t?"3_1":t>13&&15>=t?"3_2":"4",i.npc_info.lvStyle=s,i},_showDialog:function(i){var s='<div class="celebrity_forum_dialog_wrap">  <div class="dialog_content">   <div class="dialog_left">    <div class="npc_info">     <a href="/celebrity/rankHome" target="_blank">     <img src="http://himg.baidu.com/sys/portraitm/item/<%=npc_info.npc_avatar%>" width="140" height="140" />     </a>     <div class="user_level">      <p class="uname"><a href="/celebrity/rankHome" target="_blank"><%=npc_info.npc_name%></a><i class="icon_red"></i></p>      <a href="/f/like/level?kw=<%=encodeURIComponent(npc_info.npc_forum_name)%>&ie=utf-8" target="_blank" title="\u672C\u5427\u5934\u8854<%=npc_info.level_id%>\u7EA7\uFF0C\u7ECF\u9A8C\u503C<%=npc_info.cur_score%>\uFF0C\u70B9\u51FB\u8FDB\u5165\u672C\u5427\u5934\u8854\u8BF4\u660E\u9875" class="badge_f badge badge_lv<%=npc_info.lvStyle%>">       <div class="badge_name"><%=npc_info.level_name%></div>       <div class="badge_index"><%=npc_info.level_id%></div>      </a>      <div class="exp">       <div class="exp_lable">\u7ECF\u9A8C\uFF1A</div>       <a class="exp_bar exp_bar_f" href="/f/like/level?kw=<%=encodeURIComponent(npc_info.npc_forum_name)%>&ie=utf-8" target="_blank">        <div class="exp_bar_current exp_bar_current_f" style="width:<%=(npc_info.cur_score * 100) / (npc_info.cur_score + npc_info.score_left)%>%;"></div>        <div class="exp_num">         <span class="exp_current_num"><%=npc_info.cur_score%></span>         <span>/<%=npc_info.cur_score + npc_info.score_left%></span>        </div>       </a>      </div>      <p>\u540D\u4EBA\u699C\u6392\u540D\uFF1A<span class="red_text"><%=npc_info.npc_rank%></span></p>      <p><a href="/celebrity/rankHome" target="_blank">\u67E5\u770B\u540D\u4EBA\u699C>></a></p>     </div>    </div>    <div class="npc_sign_info">     <div class="info_top">      \u52A9\u653B\u8BE6\u60C5     </div>     <div class="info_content">      <p class="today">\u4ECA\u65E5\u52A9\u653B\u4EBA\u6570\uFF1A<b><%=npc_info.total_person%></b></p>      <div class="detail">       <div class="col2_left">        <p class="orange_text"><%=user.my_continue_days%></p>        <p>\u6211\u8FDE\u7EED\u52A9\u653B</p>       </div>       <div class="col2_right">        <p class="orange_text"><%=user.my_total_days%></p>        <p>\u6211\u7D2F\u79EF\u52A9\u653B</p>       </div>      </div>     </div>    </div>    <div class="npc_sign">     <a href="javascript:;" data-forumid="<%=npc_info.npc_forum_id%>" data-npcid="<%=npc_info.npc_id%>" class="sign_btn j_sign_btn <% if (user.is_signed) { %> disable <% } %>"><% if (user.is_signed) { %>\u4ECA\u65E5\u5DF2\u52A9\u653B<% } else { %>\u70B9\u6211\u52A9\u653B<% } %></a>    </div>   </div>   <div class="dialog_right">    <div class="scroll_wrapper">    <ul>     <% for (var i = 0, l = props.length; i < l; i++) { %>     <li class="npc_prop_item">      <div class="item_pic">       <img src="<%=props[i].logo_picurl%>" width="70" height="70" />       <% if (props[i].is_unlock == 0) { %>        <div class="lock" style="height: <%=100 - props[i].lock_npc_percent %>%"></div>        <div class="lock_num">        <% if (props[i].lock_npc_percent == 0) { %>         <i class="icon_lock"></i>        <% } else { %>         <%= props[i].lock_npc_percent %>%        <% } %>        </div>       <% } %>      </div>      <div class="item_intro">        <h4><%=props[i].title%></h4>        <p>\u89E3\u9501\u6761\u4EF6\uFF1A         <%=npc_info[\'npc_name\']%>\u8D26\u53F7\u8FBE\u5230<b><%=props[i].lock_npc_level%></b>\u7EA7</p>        <p>\u9886\u53D6\u6761\u4EF6\uFF1A        <% if (props[i].props_category == 300) { %>         \u6BCF\u5929\u53EF\u4F7F\u75281\u6B21\uFF0C\u672C\u5427\u4F1A\u5458\u4F7F\u7528\u6B21\u6570\u4E0D\u9650        <% } else { %>         <% if (props[i].limit_sign_level == 0 && props[i].lock_need_vip == 0) { %>          \u65E0         <% }         if (props[i].limit_sign_level > 0) { %>          <%=npc_info[\'npc_fans_name\']%>\u8FDE\u7EED\u52A9\u653B<b><%=props[i].limit_sign_level%></b>\u6B21         <% }          if ( props[i].lock_need_vip == 1 ) {            if (props[i].limit_sign_level > 0) {%>\uFF0C<% } %>          <span class="red_text">\u672C\u5427\u4F1A\u5458\u4E13\u5C5E</span>         <% }         }        %>       </p>      </div>      <div class="item_action">       <% if (props[i].is_unlock == 0) { %>        <button class="btn_sub btn_middle btn_disable">\u5F85\u89E3\u9501</button>       <% } else if (props[i].can_get == 0) { %>        <button class="btn_sub btn_middle btn_disable">\u5F85\u9886\u53D6</button>       <% } else if (props[i].is_used == 0) { %>        <button class="btn_default btn_middle j_btn_get" data-propsid="<%=props[i].props_id%>">&nbsp;\u9886&nbsp;&nbsp;\u53D6&nbsp;</button>       <% } else if (props[i].props_category == 200 || props[i].props_category == 113 || props[i].props_category == 300) { %>        <button class="btn_sub btn_middle btn_disable" data-propsid="<%=props[i].props_id%>">\u5DF2\u83B7\u5F97</button>       <% } else { %>        <button class="btn_sub btn_middle j_btn_unuse" data-propsid="<%=props[i].props_id%>">\u53D6\u6D88\u4F7F\u7528</button>       <% } %>       </div>     </li>     <% } %>    </ul>    </div>   </div>  </div>  <div class="dialog_footer">   <p>    <span class="grey_text">\u52A9\u653B\u8BF4\u660E: </span>    \u666E\u901A\u52A9\u653B,\u672C\u5427\u7ECF\u9A8C<span class="orange_text">+1</span>,    \u540D\u4EBA\u7ECF\u9A8C<span class="orange_text">+0.01</span>    &nbsp;&nbsp;    <%=npc_info.npc_forum_name%>\u5427\u4F1A\u5458\u52A9\u653B,\u672C\u5427\u7ECF\u9A8C<span class="orange_text">+2</span>,    \u540D\u4EBA\u7ECF\u9A8C<span class="orange_text">+0.1</span>    &nbsp;&nbsp;    <a class="btn_default btn_small j_buy_npc_member" data-fid="<%=npc_info[\'npc_forum_id\']%>" data-fname="<%=npc_info[\'npc_forum_name\']%>" href="javascript:;">\u5151\u6362\u672C\u5427\u4F1A\u5458</a>   </p>  </div> </div>',t=baidu.template(s,i),a=i.npc_info||{};this._dialog=new $.dialog({holderClassName:"celebrity_forum_dialog",html:t,width:715,height:526,title:"\u52A0\u5165"+a.npc_fans_name+",\u53C2\u52A0"+a.npc_forum_name+"\u517B\u6210\u8BA1\u5212",draggable:!1}),this._bindDialogEvents(this._dialog)},_bindDialogEvents:function(i){var s=this,t=$(i.element);t.find(".j_sign_btn").on("click",function(){if(!$(this).hasClass("disable")){var i=$(this).data("npcid"),t=$(this).data("forumid");$.post("/celebrity/submit/support",{forum_id:t,npc_id:i,tbs:PageData.tbs},function(i){switch(i.no){case 0:s._dialog.close();var t=s.formatForumSupportData(i.data);s._showDialog(t);break;case 340027:$.dialog.alert("\u5F88\u62B1\u6B49\uFF0C\u5C01\u7981\u7528\u6237\u65E0\u6CD5\u52A9\u653B",{title:"\u63D0\u793A"});break;default:$.dialog.alert("\u62BD\u98CE\u4E86~",{title:"\u63D0\u793A"})}})}}),t.find(".j_buy_npc_member").on("click",function(){var i=$(this).data("fid"),t=$(this).data("fname"),a={scores_money:0,scores_other:0};s.requireInstance("tbmall/widget/forumMemberDialog",{is_show_features:!1,is_show_forum:!1,current_forum_id:i,current_forum_name:t,scores:s._user.Parr_scores?s._user.Parr_scores:a,cnt_height:225,is_celebrity_forum:!0,callback:function(){$.tb.location.reload()}}),s._dialog.close()}),t.on("click",".j_btn_get",function(){var i=this,s=$(this).data("propsid");$.post("/celebrity/submit/getNpcProps",{props_id:s,tbs:PageData.tbs},function(s){0==s.no?200==s.data.props_category||300==s.data.props_category||113==s.data.props_category?$(i).text("\u5DF2\u83B7\u5F97").tbattr("class","btn_sub btn_middle btn_disable"):$(i).text("\u53D6\u6D88\u4F7F\u7528").tbattr("class","btn_sub btn_middle j_btn_unuse"):$.dialog.alert("\u62BD\u98CE\u4E86")})}),t.on("click",".j_btn_unuse",function(){var i=this,s=$(this).data("propsid");$.post("/tbmall/post/closeProps",{props_id:s,tbs:PageData.tbs},function(s){0==s.no?$(i).html("&nbsp;\u9886&nbsp;&nbsp;\u53D6&nbsp;").tbattr("class","btn_default btn_middle j_btn_get"):$.dialog.alert("\u62BD\u98CE\u4E86")})})}}});_.Module.define({path:"user/widget/celebrity",requires:["tbmall/widget/forumMemberDialog","encourage/widget/npc_vote/npc_vote_action","user/widget/celebrity_forum_dialog"],sub:{initial:function(e){this.$root=$("#celebrity"),this.forum=PageData.forum,this.user=PageData.user,this.opt=e,this._bindEvents()},_bindEvents:function(){var e=this;this.$root.find(".j-gift-buy").on("click",function(){var r={scores_money:0,scores_other:0};e.requireInstance("tbmall/widget/forumMemberDialog",{is_show_features:!1,is_show_forum:!1,current_forum_id:e.forum.forum_id,current_forum_name:e.forum.forum_name,scores:e.user.Parr_scores?e.user.Parr_scores:r,cnt_height:225,is_celebrity_forum:!0,callback:function(){$.tb.location.reload()}})}),this.requireInstance("encourage/widget/npc_vote/npc_vote_action",{$root:e.$root}),this.requireInstance("user/widget/celebrity_forum_dialog",{$root:e.$root.find(".j-btn-celebrity"),celebrity:e.opt.celebrity})}}});_.Module.define({path:"encourage/widget/npc_vote/npc_vote_action",sub:{initial:function(e){this._opt=e,this._bindEvents()},_bindEvents:function(){var e=this,t=this._opt.$root;t.on("click",".j-btn-vote",function(){if(!PageData.user.is_login)return e.requireInstanceAsync("common/widget/LoginDialog"),void 0;var a=$(this).data("id"),n=$(this).data("forumname");$.post("/celebrity/submit/voteNpc",{tbs:PageData.tbs,id:a},function(a){switch(a.no){case 0:t.find(".j_vote_npc_"+a.data.id).find(".j_vote_num").text(a.data.vote_num),e._success();break;case 952710:e._attention(n);break;case 11e4:e.requireInstanceAsync("common/widget/LoginDialog");break;case 952711:e._alert({msg:"\u5427\u7B49\u7EA7\u8FBE\u5230"+(a.data+1)+"\u7EA7\u624D\u80FD\u652F\u6301\u672C\u5427\u54E6"});break;case 952712:e._alert({msg:"\u60A8\u7533\u8BF7\u7684\u540D\u4EBA\u5DF2\u522B\u7533\u8BF7\u8FC7\u4E86~"});break;case 952713:e._alert({msg:"\u672C\u671F\u6295\u7968\u7ED3\u675F\uFF0C\u4E0B\u4E00\u671F\u5373\u5C06\u542F\u52A8\uFF0C\u656C\u8BF7\u671F\u5F85"});break;case 952709:e._alert({msg:"\u5F53\u524D\u7528\u6237\u4E0D\u662F\u5427\u4E3B"});break;case 65534:e._alert({msg:"\u6BCF\u5929\u53EA\u80FD\u7ED93\u4E2A\u5427\u6295\u7968 \u0CA5_\u0CA5"});break;case 65533:e._alert({msg:"\u6BCF\u5929\u53EA\u80FD\u7ED9\u4E00\u4E2A\u5427\u62951\u7968\uFF0C\u8BF7\u660E\u5929\u7EE7\u7EED\u652F\u6301"});break;case 65532:e._alert({msg:"IP\u4E00\u5929\u8D85\u8FC7500"});break;default:$.dialog.alert(a.error,{title:"\u63D0\u793A"})}})})},_success:function(){var e='<div class="npc-vote-dialog"><p>\u6295\u7968\u6210\u529F</p><div class="btn-group"><a href="/celebrity/rankHome#npc_vote" class="btn-default btn-small mr10 j-see-rank">\u67E5\u770B\u699C\u5355</a> <a href="javascript:;" class="btn-sub btn-small j_close">\u53D6 \u6D88</a></div></div>',t=this._alert({html:e});$(t.element).find(".j-see-rank").on("click",function(){t.close()})},_alert:function(e){var t=e.html||'<div class="npc-vote-dialog"><p>'+e.msg+'</p><div class="btn-group">  <a href="#" class="btn-default btn-small j_close">\u786E \u8BA4</a></div></div>',a=new $.dialog({width:380,html:t,title:"\u63D0\u793A",draggable:!1});return $(a.element).find(".j_close").on("click",function(){return a.close(),!1}),a},_attention:function(e){var t='<div class="npc-vote-dialog"><p>\u672A\u5173\u6CE8\u672C\u5427\u4E0D\u80FD\u6295\u7968\u54E6~</p><div class="btn-group"> <a href="/f?kw='+encodeURIComponent(e)+'" class="btn-default btn-small">\u53BB\u5173\u6CE8</a></div></div>';new $.dialog({width:350,html:t,title:"\u63D0\u793A",draggable:!1})}}});_.Module.define({path:"common/widget/tchargeDialog",requires:[],sub:{initial:function(t){var e=this;e.requireInstanceAsync("common/widget/Tdou",[],function(a){t&&t.chargeType&&"platform"==t.chargeType?a.factory("payment",t):(t&&(e.consumption_path=t.consumption_path,e.desc=t.desc,e.current_need_tdou=t.current_need_tdou,e.is_direct_cashier=t.is_direct_cashier),t&&e.is_direct_cashier?a.factory("auto_direct",t):a.factory("get_icon",e.consumption_path||""))})},_tbmallCashier:function(){var t=window.open("");$.get("/tbmall/getPayUrl?terminal=pc&pay_type=2",function(e){e.data&&(t.location.href=e.data)})}}});_.Module.define({path:"adsense/widget/tool_async",requires:[],sub:{initial:function(){this.dataHandler=this.requireInstance("adsense/widget/data_handler_async",[])},genMd5:function(e){var a="AS"+this.genRandChar(),t=(new Date).getTime();return a+e.substr(-3)+(""+t).substr(-6)},genQaClassName:function(){return"1"==$.tb.location.getSearchValue("__qa_page_diff")?"__qa_page_diff":""},genRandChar:function(){var e="abcdefghijklmnopqrstuvwxyz";return e[this._randomInt(0,e.length-1)]},_randomInt:function(e,a){return e-=1,Math.ceil(e+Math.random()*(a-e))},getStatsUrl:function(e,a){var t;return t=a.click_url_params?this.getUrl({url:"/link",tbjump:a.click_url_params,extra:{obj_id:a.id}}):e},getUrl:function(e){var a=$.getPageData("forum"),t=$.getPageData("user"),r=$.getPageData("context.thread_info",{}),n=e.url?e.url:"",i=$.getPageData("product",""),u=["client_type=pc_web","tbjump="+(e.tbjump?e.tbjump:""),"task="+(e.task?e.task:""),"locate="+(e.locate?e.locate:""),"page="+(e.page?e.page:""!=i?i:"MODULE_NAME"),"type=click","fid="+(a.forum_id?a.forum_id:""),"fname="+(a.forum_name?a.forum_name:""),"uid="+(t.user_id?t.user_id:""),"uname="+(t.user_name?t.user_name:""),"is_new_user="+(t.is_new_user?t.is_new_user:""),"tid="+(r.thread_id?r.thread_id:""),"_t="+(new Date).getTime()];return e.extra&&$.each(e.extra,function(e,a){u.push(e+"="+a)}),n+"?"+u.join("&")},getDirInfo:function(){var e=this.dataHandler.getData();return{forum_dir:$.getPageData("forum.first_class",""),forum_second_dir:$.getPageData("forum.second_class",""),forum_vdir:$.getPageData("forum_vdir","",e)}},getSpecialInfo:function(e){for(var a=this.dataHandler.getData(),t={},r=0,n=e.length;n>r;r++)t[e[r]]=a[e[r]];return t}}});
_.Module.define({path:"comforum/widget/gameBannerSsjj",requires:[],sub:{initial:function(){this.bindEvents()},bindEvents:function(){var n=$(".game_banner_ssjj");n.on("click",".j_to_game",function(){$.stats.track("FRS\u9875\u5934\u90E8","\u6E38\u620FBanner","","click",{obj_name:"\u751F\u6B7B\u72D9\u51FB"})})}}});_.Module.define({path:"comforum/widget/gameBannerCommon",requires:[],sub:{initial:function(e){this._server_time=1e3*e.server_time,this._gameName=e.game_name,this._btns=e.btns,this._splitLine=e.split_line||"",this._countdownStatus="open",this._flashVars=e.flashVars||"",this._video_url=e.video_url||!1,this._video_size=$.extend({width:"auto",height:"auto"},e.video_size),this._video_auto_play="true"==e.video_auto_play,this._baidu_browser_config=e.baidu_browser_config||!1,this._bgHoverPreLoader(),this._bindEvents(),this._countdownInit(),this._baiduBrowserPluginInit()},_bindEvents:function(){var e=$(".game_banner_common_wapper");this.$banner=e;var t=this;e.on("click",".a_btn",function(){if(t._aBtnClick($(this))){var e=$(this).data("tracktype");return e=e||"",$.stats.track(e,"\u6E38\u620FBanner","","click",{obj_name:t._gameName}),!0}return!1}).on("click",".game_banner_close",function(){$.stats.track("FRS\u9875\u5934\u90E8\u5173\u95ED","\u6E38\u620FBanner","","click",{obj_name:t._gameName}),e.slideUp()}),$(".game_banner_common_wapper").on("mouseenter",".a_btn",function(){t._aBtnHoverIn($(this))}),$(".game_banner_common_wapper").on("mouseleave",".a_btn",function(){t._aBtnHoverOut($(this))}),$("#ff14_exchange_vip").on("click",function(){if(!PageData.user.is_login)return _.Module.use("common/component/LoginDialog",["","userBar"]),void 0;var e=['<div class="ff14_exchange_dialog">','<div class="ff14_exchange_input_row">','<input type="text" class="j_ff14_exchange_vip_ipt ff14_exchange_vip_ipt ui_textfield" maxlength="16" placeholder="\u8BF7\u8F93\u5165\u672C\u5427\u7279\u6743\u4F53\u9A8C\u7801">','<a href="javascript:;" class="j_ff14_exchange_vip_btn ff14_exchange_vip_btn ui_btn ui_btn_m">',"<span><em>\u5151\u6362\u672C\u5427\u7279\u6743</em></span>","</a>","</div>",'<div class="j_ff14_exchange_errtips ff14_exchange_errtips"><!-- empty blank -->',"</div>",'<dl class="ff14_exchange_intro_row">',"<dt>\u7279\u6743\u4F53\u9A8C\u8BF4\u660E\uFF1A</dt>",'<dd>1.\u4F53\u9A8C\u7801\u53EF\u5151\u6362\u672C\u5427\u7279\u6743"\u7EA2\u8272\u4E3B\u9898\u3001\u7ECF\u9A8C\u52A0\u901F"1\u4E2A\u6708\u7684\u4F53\u9A8C\u6743\u3002</dd>',"<dd>2.\u5DF2\u7ECF\u62E5\u6709\u7279\u6743\uFF0C\u65E0\u6CD5\u4F7F\u7528\u4F53\u9A8C\u7801\uFF08\u5305\u62EC\u8D85\u7EA7\u4F1A\u5458\u548C\u5DF2\u5151\u6362\u7279\u6743\u5305\uFF09\u3002</dd>","<dd>3.\u4F53\u9A8C\u7801\u6BCF\u4E2A\u7528\u6237\u53EA\u80FD\u4F7F\u75281\u6B21\uFF0C\u8FC7\u671F\u540E\u53EF\u518D\u6B21\u4F7F\u7528\u3002</dd>","<dd>4.\u4F53\u9A8C\u7801\u4F7F\u7528\u6709\u6548\u671F\u81F32015\u5E742\u670828\u65E5\u3002</dd>","<dd>5.\u5982\u672A\u5173\u6CE8\u4F7F\u7528\u4F53\u9A8C\u7801\u7684\u5427\uFF0C\u4F7F\u7528\u6210\u529F\u540E\u5C06\u81EA\u52A8\u5173\u6CE8\u3002</dd>","<dd>6.\u767E\u5EA6\u8D34\u5427\u6709\u6743\u5728\u6CD5\u5F8B\u8BB8\u53EF\u7684\u8303\u56F4\u5185\u8FDB\u884C\u89E3\u91CA\u3002</dd>",'<dd>7.\u5982\u6709\u4EFB\u4F55\u7591\u95EE\uFF0C\u8BF7\u81F3 <a href="/f?ie=utf-8&kw=t%E8%B1%86%E5%95%86%E5%9F%8E" target="_blank">T\u8C46\u5546\u57CE\u5427</a> \u53CD\u9988\u3002</dd>',"</dl>","</div>"].join(""),n=new $.dialog({width:420,holderClassName:"ff14_exchange_dialog_holder",html:e,draggable:!1});t._bindExchangeDialogEvent(n)}),t._video_auto_play?t._initYYLive():e.on("click",".j_banner_video_wrapper",function(){var e=!1;return function(){e||(t._videoInit(),e=!0)}}())},_bindExchangeDialogEvent:function(e){var t=this,n=$(e.element);n.find(".j_ff14_exchange_vip_btn").on("click",function(){var a=n.find(".j_ff14_exchange_vip_ipt").val();return $.trim(a).length<16?(t._showExchangeErr(2270015,n.find(".j_ff14_exchange_errtips")),void 0):($.post("/game/giveMemberCheckCode",{tbs:PageData.tbs,member_code:a,forum_id:PageData.forum.id},function(a){var a="object"!=typeof a?$.parseJSON(a):a;0==a.no?(e.close(),t._showExchangeSucc(a.data)):t._showExchangeErr(a.no,n.find(".j_ff14_exchange_errtips"))}),void 0)})},_showExchangeSucc:function(e){var t=new Date(1e3*e.end_time),n=(t.getYear()<1900?1900+t.getYear():t.getYear())+"\u5E74"+(t.getMonth()+1)+"\u6708"+t.getDate()+"\u65E5",a=['<div class="ff14_exchange_success_row">','<div class="ff14_exchange_success_txt">',"<h4>\u60A8\u5DF2\u6210\u529F\u5151\u6362<em>\u3010"+PageData.forum.name+"\u5427\u7279\u6743\u5305\u3011</em></h4>","<p>\u6709\u6548\u671F\u81F3"+n+"</p>","</div>","</div>",'<div class="ff14_exchange_success_privilige"></div>','<div class="ff14_exchange_success_btns">','<a href="/tbmall/mall/forumMember" target="_blank" class="j_exchange_success_privil ui_btn ui_btn_m">',"<span><em>\u8BE6\u7EC6\u4E86\u89E3\u7279\u6743</em></span>","</a>",'<a href="javascript:;" class="j_exchange_success_close ui_btn ui_btn_sub_m">',"<span><em>\u77E5\u9053\u4E86</em></span>","</a>","</div>"];PageData.user.is_like||a.unshift('<div class="ff14_exchange_forum">','<p class="p1">\u606D\u559C\u4F60\u6210\u4E3A\u672C\u5427\u4F1A\u5458</p>','<p class="p2">\u5347\u7EA7\u4EAB\u7279\u6743\uFF0C<a href="/f/like/level?kw='+PageData.forum.name_url+'" target="_blank">\u67E5\u770B\u5347\u7EA7\u79D8\u7C4D</a></p>',"</div>");var i=new $.dialog({width:385,title:"\u6210\u529F\u63D0\u793A",holderClassName:"ff14_exchange_success_holder",html:a.join(""),draggable:!1});$(i.element).find(".j_exchange_success_close, .j_exchange_success_privil").on("click",function(){i.close(),$.tb.location.reload()})},_showExchangeErr:function(e,t){var n="";switch(parseInt(e)){case 2270001:n="\u60A8\u5DF2\u7ECF\u62E5\u6709\u672C\u5427\u7279\u6743\uFF0C\u65E0\u6CD5\u4F7F\u7528\u4F53\u9A8C\u7801\uFF01";break;case 2270015:n="\u60A8\u8F93\u5165\u7684\u4F53\u9A8C\u7801\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01";break;default:n="\u670D\u52A1\u5668\u62BD\u98CE\u4E86?(?_?)?"}t.html('<i class="ff14_icon_warning"></i>'+n)},_aBtnClick:function(e){return"#"==e.tbattr("href")?!1:!0},_aBtnHoverIn:function(e){var t=e.getData().bg_hover,n=e.getData().timeover_status;t&&n!=this._countdownStatus&&e.css({"background-image":"url("+t+")"})},_aBtnHoverOut:function(e){var t=e.getData().bg_hover,n=e.getData().bg,a=e.getData().timeover_status;t&&a!=this._countdownStatus&&e.css({"background-image":"url("+n+")"})},_bgHoverPreLoader:function(){for(var e=0,t=this._btns.length;t>e;e++){var n=this._btns[e].bg_hover;if(n){var a=new Image;a.src=n}}},_countdownInit:function(){var e=$("#game_countdown_head"),t=e.find(".j_game_countdown_head_counter"),n=1e3*+t.data("time"),a=this;if(n-+new Date>0)var i=setInterval(function(){var e=+new Date,t=n-e;if(1e3>=t)return clearInterval(i),a._showCountdown(0,0,0,0),a._countdownTimeover(),void 0;var o=Math.floor(t/864e5),s=Math.floor((t-864e5*o)/36e5),r=Math.floor((t-864e5*o-36e5*s)/6e4),_=Math.floor((t-864e5*o-36e5*s-6e4*r)/1e3);a._showCountdown(o,s,r,_)},1e3);else this._countdownStatus="close"},_countdownNumToSpan:function(e,t){var n="";return t=t?t:"",10>e?(n+='<span class="count_number count_0">0</span>',n+='<span class="count_number count_'+e+'">'+e+"</span>",n+="<span>"+t+"</span>"):(n+='<span class="count_number count_'+Math.floor(e/10)+'">'+Math.floor(e/10)+"</span>",n+='<span class="count_number count_'+e%10+'">'+e%10+"</span>",n+="<span>"+t+"</span>"),n},_showCountdown:function(){var e=$("#game_countdown_head"),t=e.find(".j_game_countdown_head_counter"),n=t.find(".j_days"),a=t.find(".j_hours"),i=t.find(".j_minutes"),o=t.find(".j_seconds");return function(e,t,s,r){n.html(this._countdownNumToSpan(e,this._splitLine)),a.html(this._countdownNumToSpan(t,this._splitLine)),i.html(this._countdownNumToSpan(s,this._splitLine)),o.html(this._countdownNumToSpan(r))}}(),_countdownTimeover:function(){this._countdownStatus="close",$(".game_banner_common_wapper .a_btn").each(function(){var e=$(this).getData();"open"==e.timeover_status?$(this).tbattr("href",e.link).css({"background-image":"url("+e.bg+")",cursor:"pointer"}).bindData("timeover_status","default"):"close"==e.timeover_status&&$(this).tbattr("href","#").css({"background-image":"url("+e.bg_close+")",cursor:"default"}).bindData("timeover_status","default")}),$("#game_countdown_head .game_countdown_head_counter").html("<span>\u706B\u70ED\u552E\u5356\u4E2D</span>")},_initYYLive:function(){var e,t=[{start:"15",end:"17",url:"http://webyylbs.yy.duowan.com/s/90629/2330771202/huyacoop.swf",uname:"\u82CD\u5929\u54E5"},{start:"17",end:"19",url:"http://webyylbs.yy.duowan.com/s/90000/2314237621/huyacoop.swf",uname:"\u7EB1\u7EC7\u5927\u9B54\u738B"},{start:"19",end:"21",url:"http://webyylbs.yy.duowan.com/s/10676/2355308833/huyacoop.swf",uname:"\u7A3B\u9EA6\u7EC4\u5408"}],n=new Date(this._server_time).getHours();t.forEach(function(t){return t.start<=n&&n<=t.end?(e=$.extend({},t),!0):void 0}),e&&(this._video_url=e.url,this._flashVars+="from=dtxy;"),this._videoInit()},_videoInit:function(){if(!this._video_url)return!1;var e=-1!=this._video_url.indexOf(".swf");if(e)new $.swf(this._video_url,{id:"game_banner_video",container:".j_banner_video_wrapper",width:this._video_size.width||"auto",height:this._video_size.height||"auto",params:{allowFullScreen:!0,swLiveConnect:!0,wMode:"opaque",quality:"high",allowScriptAccess:"always",menu:!1,flashVars:self._flashVars}});else{var t=$('<iframe style="border:none;" frameborder="0" marginheight="0" marginwidth="0" scrolling="no"></iframe>');t.css({width:this._video_size.width||"auto"}),t.css({height:this._video_size.height||"auto"}),t.tbattr("src",this._video_url),this.$banner.find(".j_banner_video_wrapper").append(t)}},_baiduBrowserPluginInit:function(){if(this._baidu_browser_config&&this._baidu_browser_config.show_baidu_browser_plugin){this.$baiduBrowserIframe=this.$banner.find(".baidu_browser_plugin");var e=this.$baiduBrowserIframe[0].contentWindow.document,t=["http://xapp.baidu.com/browserextension/tieba_game/detect.js"].join("");t=PageUnit.load("game_banner_common_baidu_browser")||t,t+="?timestamp="+(new Date).getTime();var n=['<script src="'+t+'"></script>','<body style="background:transparent;width:100%;height:100%;" ','onclick="',"window.parent.$.stats.track('\u4FDD\u5B58\u5230\u684C\u9762', '\u6E38\u620FBanner', '', 'click', {","'obj_name':'"+this._gameName+"',",'});"',">",'<div style="color:black;width:100%;height:100%;cursor:pointer;background:url(about:blank);"','onclick="window.BIDUBrowser_API.OnStartBtnClick(this)" ','supplyid="'+this._baidu_browser_config.supplyid+'" ','gamename="'+this._baidu_browser_config.gamename+'" ','gameurl="'+this._baidu_browser_config.gameurl+'" ','gameicon="'+this._baidu_browser_config.gameicon+'">',"","</div>"].join("");e.open().write(n),e.close()}}}});_.Module.define({path:"comforum/widget/gameBannerNest2014",requires:[],sub:{initial:function(){this.bindEvents()},bindEvents:function(){var n=$(".game_banner_nest2014"),t=this;n.on("click",".j_get_ticket",function(){return PageData.user.is_login?(t.gotoPay(),void 0):(t.requireInstanceAsync("common/component/LoginDialog",["","userBar"]),void 0)})},gotoPay:function(){var n=window.open("");$.get("/tbmall/getPayUrl?terminal=pc&pay_type=1&fr=11",function(t){t.data&&(n.location.href=t.data)})}}});_.Module.define({path:"comforum/widget/headerShenfanyi",requires:[],sub:{initial:function(){this.flashInit()},flashInit:function(){new $.swf("http://tb1.bdstatic.com/tb/flash/main.swf",{id:"flashContent",container:"#sfyFlashContent",width:"980",height:"508",vars:{serverURL:"http://tb1.bdstatic.com/tb/flash"},params:{allowscriptaccess:"always",domain:"*",wmode:"transparent"},callBacks:{}})}}});_.Module.define({path:"common/widget/duoku_xwj_vip",requires:[],sub:{initial:function(){var a=this;a.bindEvents(),a.checkUpgrade(),a.getMissMedals(),a.showConditionMsgAndBtns()},bindEvents:function(){var a=this,e=$(".duoku-xwj-vip");$(document).on("click",".duoku-xwj-vip-dialog .see-detail-btn",function(){var a=parseInt(e.data("medal-id"),10);$.stats.track("p0023","star_playerba","frs","click",{obj_name:"\u53BB\u770B\u770B",obj_ref:1000602,loc_param:"button",obj_medal_level:a>0?a-1230034+1:0})}),$(".duoku-xwj-vip").on("click",".view-detail-btn",function(){var a=parseInt(e.data("medal-id"),10);$.stats.track("p0020","star_playerba","frs","click",{obj_name:"\u67E5\u770B\u8BE6\u60C5",obj_ref:1000602,loc_param:"button",obj_medal_level:a>0?a-1230034+1:0})}),$(".duoku-xwj-vip").on("click",".get-achieve-btn,.get-up-achieve-btn",function(t){var i=$(this),s=parseInt(e.data("medal-id"),10);if(!i.hasClass("disabled")){i.addClass("disabled"),t.preventDefault(),$.stats.track("p0020","star_playerba","frs","click",{obj_id:0,obj_name:"\u9886\u53D6\u6210\u5C31",obj_ref:1000602,loc_param:"button",obj_medal_level:s>0?s-1230034+1:0});var d=s>0?s+1:1230034;d>1230039&&(d=1230039),$.getJSON("/game/duoku/claimStarPlayerMedal",{t:(new Date).getTime(),medal_id:d,tbs:PageData.tbs||""},function(t){if(i.removeClass("disabled"),0==t.no){var s=t.data.medal_id,d=["\u9752\u94DC\u661F\u73A9\u5BB6","\u767D\u94F6\u661F\u73A9\u5BB6","\u9EC4\u91D1\u661F\u73A9\u5BB6","\u767D\u91D1\u661F\u73A9\u5BB6","\u91D1\u94BB\u661F\u73A9\u5BB6","\u81F3\u5C0A\u661F\u73A9\u5BB6"],o=d[s-1230034];a.showDialog(a.htmlTpl.success,{medalName:o,achievementUrl:e.data("achievement-url")}),e.data("medal-id",s),a.showConditionMsgAndBtns(),$.stats.track("p0020","star_playerba","frs","click",{obj_id:1,obj_name:"\u9886\u53D6\u6210\u5C31",obj_ref:1000602,loc_param:"button",obj_medal_level:s-1230034+1})}else{var l="";if(1==t.no)l="\u60A8\u73B0\u5728\u8FD8\u4E0D\u662F\u767E\u5EA6\u661F\u73A9\u5BB6\uFF0C\u8BF7\u4E0B\u8F7D\u6E38\u620F\u5E76\u7528\u767E\u5EA6\u8D26\u53F7\u767B\u5F55";else if(2==t.no)l="\u9886\u53D6\u5347\u7EA7\u6210\u5C31\u5931\u8D25\uFF0C\u8BF7\u7EE7\u7EED\u52AA\u529B\u8FBE\u6210\u6761\u4EF6\u5427";else if(3==t.no)l="\u670D\u52A1\u7E41\u5FD9\uFF0C\u8BF7\u5C1D\u8BD5\u518D\u6B21\u9886\u53D6";else if(4==t.no)l="\u60A8\u5DF2\u7533\u8BF7\u8FC7\u8BE5\u52CB\u7AE0";else{if(5==t.no)return a.requireInstanceAsync("common/component/LoginDialog",[""]),void 0;l="\u672A\u77E5\u9519\u8BEF"}a.showDialog(a.htmlTpl.fail,{failMsg:l})}}),setTimeout(function(){i.removeClass("disabled")},5e3)}})},showConditionMsgAndBtns:function(){var a,e=parseInt($(".duoku-xwj-vip").data("medal-id"),10),t=$(".duoku-xwj-vip").data("detail-url"),i='<a href="#" class="get-up-achieve-btn">\u9886\u53D6\u6210\u957F\u6210\u5C31</a><a href="'+t+'" target="_blank" class="view-detail-btn">\u67E5\u770B\u8BE6\u60C5</a>';switch(e){case 0:i='<a href="#" class="get-achieve-btn">\u9886\u53D6\u6210\u5C31</a><a href="'+t+'" target="_blank" class="view-detail-btn">\u67E5\u770B\u8BE6\u60C5</a>',a="\u9886\u53D6\u6761\u4EF6\uFF1A\u767E\u5EA6\u79FB\u52A8\u6E38\u620F\u73A9\u5BB6\u5747\u53EF\u9886\u53D6\uFF08\u9650\u767E\u5EA6\u8D26\u53F7\uFF09";break;case 1230034:a="\u9886\u53D6\u6761\u4EF6\uFF1A\u9700\u8FBE\u5230\u767D\u94F6\u661F\u73A9\u5BB6\u7B49\u7EA7";break;case 1230035:a="\u9886\u53D6\u6761\u4EF6\uFF1A\u9700\u8FBE\u5230\u9EC4\u91D1\u661F\u73A9\u5BB6\u7B49\u7EA7";break;case 1230036:a="\u9886\u53D6\u6761\u4EF6\uFF1A\u9700\u8FBE\u5230\u767D\u91D1\u661F\u73A9\u5BB6\u7B49\u7EA7";break;case 1230037:a="\u9886\u53D6\u6761\u4EF6\uFF1A\u9700\u8FBE\u5230\u91D1\u94BB\u661F\u73A9\u5BB6\u7B49\u7EA7";break;case 1230038:a="\u9886\u53D6\u6761\u4EF6\uFF1A\u9700\u8FBE\u5230\u81F3\u5C0A\u661F\u73A9\u5BB6\u7B49\u7EA7";break;case 1230039:i='<a href="'+t+'" target="_blank" class="view-detail-btn" id="view-detail-btn">\u67E5\u770B\u8BE6\u60C5</a>',a="";break;default:i="",a=""}$(".duoku-xwj-vip").find(".duoku-xwj-vip-btns").html(i),$(".duoku-xwj-vip").find(".condition-msg").text(a)},showDialog:function(a,e){var t=this;new $.dialog({html:$.tb.format(a,e),title:"\u63D0\u793A",width:435,height:250,draggable:!1,closeable:!0}),t.getRecGames(function(){t.getQrcode()})},getQrcode:function(){var a=!!window.ActiveXObject,e=a&&!!document.documentMode;$.JsLoadManager.use("http://tb1.bdstatic.com/tb/static-comforum/qrcode_f84ab06.js",function(){$(".duoku-xwj-vip-dialog .qrcode-box .qrcode-img-wrapper").each(function(){new window.QRCode($(this).get(0),{text:$(this).data("uri"),width:"106",height:"106"})}),e&&$(".duoku-xwj-vip-dialog .qrcode-box .qrcode-img-wrapper table").css("margin","15px")})},getMissMedals:function(){var a=$(".duoku-xwj-vip").data("miss-medal-ids");if(a)for(var e=a.split(","),t=0,i=e.length;i>t;t++)$.get("/game/duoku/claimStarPlayerMedal",{t:(new Date).getTime(),medal_id:e[t],tbs:PageData.tbs||""})},checkUpgrade:function(){var a=this;$.getJSON("/game/duoku/isStarPlayerLevelUp",{t:(new Date).getTime()},function(e){if(0==e.no&&e.data&&1==e.data.level_up){var t=["\u9752\u94DC\u661F\u73A9\u5BB6","\u767D\u94F6\u661F\u73A9\u5BB6","\u9EC4\u91D1\u661F\u73A9\u5BB6","\u767D\u91D1\u661F\u73A9\u5BB6","\u91D1\u94BB\u661F\u73A9\u5BB6","\u81F3\u5C0A\u661F\u73A9\u5BB6"],i=$(".duoku-xwj-vip");a.showDialog(a.htmlTpl.success,{medalName:t[parseInt(i.data("medal-id"),10)-1230034],achievementUrl:i.data("achievement-url")})}})},ajaxLoader:function(){var a=this;return a.recGames||(a.recGames=$.getJSON("/game/duoku/getStarPlayerRecommendGames?t="+(new Date).getTime())),{recGames:a.recGames}},getRecGames:function(a){var e=this;e.ajaxLoader().recGames.success(function(e){for(var t=e.data,i="<h5>\u63A8\u8350\u6E38\u620F</h5>",s=0,d=t.length;s<Math.min(d,2);s++)i+=['<div class="item">','<img src="'+t[s].icon_url+'" alt="'+t[s].game_name+'"/>','<div class="des">',"<h4>"+t[s].game_name+"</h4>","<p>"+(t[s].game_type||"\u52A8\u4F5C")+"/"+Math.round(10*t[s].app_size)/10+"M</p>",'<a href="http://tieba.baidu.com/game/redirect?loc_param=button&location=p0024&task=star_playerba&type=download&page=frs&obj_ref=1000602&obj_id='+t[s].game_id+"&obj_name="+encodeURIComponent(t[s].game_name)+"&tbjump="+encodeURIComponent(t[s].redirect_url)+'" class="download-apk-btn">\u5B89\u5353\u4E0B\u8F7D</a>',"</div>",'<div class="qrcode-box">',"<i></i>","<h4>\u626B\u4E00\u626B\u4E0B\u8F7D\u81F3\u624B\u673A</h4>",'<div class="qrcode-img-wrapper" data-uri="'+t[s].download_url+'">',"</div>","</div>","</div>"].join(""),$.stats.track("p0024","star_playerba","frs","view",{obj_id:t[s].game_id,obj_name:t[s].game_name,obj_ref:1000602,loc_param:"pic"});$(".duoku-xwj-vip-dialog .rec-games").html(i),a&&a()})},htmlTpl:{success:['<div class="duoku-xwj-vip-dialog">','<div class="main-content">','<img class="tip-img" src=http://tb2.bdstatic.com/tb/static-comforum/widget/duoku_xwj_vip/img/tip-img-success_47afbf9.jpg alt=""/>','<div class="des">',"<p>\u60A8\u5DF2\u6210\u529F\u83B7\u5F97#{medalName}\u4E13\u5C5E\u6210\u5C31\u8FDB\u5165\u6211\u7684\u8D34\u5427\u4E2D\u7684\u6210\u5C31\u9875\u9762\u770B\u770B\u5427</p>",'<a href="#{achievementUrl}" target="_blank" class="see-detail-btn">\u53BB\u770B\u770B</a>',"</div>","</div>",'<div class="rec-games clearfix">',"</div>","</div>"].join(""),fail:['<div class="duoku-xwj-vip-dialog">','<div class="main-content">','<img class="tip-img" src=http://tb2.bdstatic.com/tb/static-comforum/widget/duoku_xwj_vip/img/tip-img-fail_0b51fc5.jpg alt=""/>','<div class="des">',"<p>#{failMsg}</p>","</div>","</div>",'<div class="rec-games clearfix">',"</div>","</div>"].join("")}}});_.Module.define({path:"common/widget/wca_head",requires:[],sub:{$schoolRank:$(".j_school_rank"),initial:function(){var n=this;$.post("/game/wca/getSchoolRank?limit=5",function(a){if(0==a.no){var s=a.data.rank_list;if(s.length>0){n.$schoolRank.show();var i=n.$schoolRank.find("ul");i.empty();var o=[];o.push("<li class='rank_head'><span class='rank_num'>\u6392\u540D</span><span class='rank_name'>\u5B66\u6821</span><span class='rank_point'>\u79EF\u5206</span></li>"),$.each(s,function(n,a){o.push("<li><span class='j_rank_num rank_num'>"+parseInt(n+1).toString()+"</span><span class='j_rank_name rank_name'>"+a.member+"</span><span class='j_rank_point rank_point'>"+a.score+"</span></li>")}),i.html(o.join(""))}}}),$(".j_join_btn").on("click",function(){$.stats.track("\u62A5\u540D\u6309\u94AE\u70B9\u51FB","wca2015","","click")})}}});_.Module.define({path:"comforum/widget/gameLiveHead",requires:["common/widget/barrage"],sub:{talkItemTpl:['<div class="game_live_talk_item">','<div class="glh_ico"><img src="http://tb.himg.baidu.com/sys/portrait/item/#{user_portrait}" alt="ico"></div>','<div class="glh_title clearfix">','<div class="glh_time">#{time}</div>','<div class="glh_uname"><a href="/home/main/?un=#{user_name}&ie=utf-8&fr=frs" target="_blank">#{user_name}</a></div>',"</div>",'<div class="glh_cnt">#{contents}</div>',"</div>"].join(""),initial:function(e){this.fid=e.fid,this.fname=e.fname,this.tid=e.tid,this.conf=e.conf,this.is_living=parseInt(this.conf.is_living,10),this.show_postor=parseInt(this.conf.show_postor,10),this.show_live_list=parseInt(this.conf.show_live_list,10),this.show_live_thread=parseInt(this.conf.show_live_thread,10),this.live_topic=this.conf.live_topic,this.live_url=decodeURIComponent(this.conf.live_url),this.live_url_type=this.conf.live_url_type,this.live_video_height=this.conf.live_video_height,this.has_like=parseInt(this.conf.has_like,10),this.like_forum_name=this.conf.like_forum_name,this.like_forum_id=this.conf.like_forum_id,this.is_login=$.getPageData("user.is_login"),this.$wrapper=$("#game_live_widget"),this.$barrageContainer=this.$wrapper.find(".game_live_barrage_area"),this.$barrageInput=this.$wrapper.find(".game_live_postor_input"),this.$talkList=this.$wrapper.find(".game_live_talk_list_wrap"),this.$videoArea=this.$wrapper.find(".game_live_barrage_video"),this.$scoreImageArea=this.$wrapper.find(".game_live_score_image"),this.$queues=this.$wrapper.find(".game_live_queues"),this.barrageWidth=this.$videoArea.width(),this.liveStream=[],this.initBarrage(),this.initQueueList(),this.initPostService(),this.bindEvents(),this.postTrack("\u6A21\u5757\u5C55\u73B0","view")},initPostService:function(){var e=this;this.postService=this.requireInstance("common/widget/PostService",[{}]),this.postService.success(function(){var i=e.textSending.length>30?e.textSending.substring(0,30)+"...":e.textSending;e.liveBarrage.update([{text:$.tb.escapeHTML(i),classname:"my_new_barrage"}]),e.updateTalkList([{content:$.tb.escapeHTML(e.getLiveGameNameTag()+i),time:+new Date/1e3,author:{user_name:PageData.user.user_name,portrait:PageData.user.portrait}}])})},postBarrage:function(){if(!this.is_login)return this.requireInstanceAsync("common/widget/LoginDialog",["","userBar"]),void 0;if(!this.postService.isPosting()){var e=this.$barrageInput.val();""!=e&&(this.textSending=e,this.postService.post("reply",{content:$.tb.escapeHTML(this.getLiveGameNameTag()+e),fid:this.fid,fname:this.fname,kw:this.fname,tid:this.tid},PosterContext.getContext()),this.$barrageInput.val(""))}},getData:function(){var e=Array.prototype.slice.call(arguments,1)||[];this.updateData(e),this.liveStream=this.liveStream.concat(e)},freshData:function(){var e=Array.prototype.slice.call(arguments,1)||[];this.updateData(e),this.liveStream=this.liveStream.concat(e)},updateData:function(e,i){var t=[],a=[],s=this,r=s.getLiveGameNameTag();$.each(e,function(e,i){var n=s.getText(i);n!=r+s.textSending&&0==n.indexOf(r)&&(a.push(i),t.push(n.replace(r,"")))}),this.liveBarrage.update(t),this.updateTalkList(a,i)},getText:function(e){var i=e.content;return/1/.test(e.rtype)?i="":(i=i.replace(/(\[+f+a+c+e+\]).*(\[+\/+f+a+c+e+\])/gi,""),i=i.replace(/[\u3000\s]+/gi," "),i=i.length>30?i.substring(0,30)+"...":i),i},updateTalkList:function(e,i){for(var t="",a=this.getLiveGameNameTag(),s=0;s<e.length;s++){var r=e[s],n=r.content||"";n=n.replace(/(\[+f+a+c+e+\])+/gi,'<img width="20" height="20" src="'),n=n.replace(/(\[+\/+f+a+c+e+\])+/gi,'" class="BDE_Smiley" pic_type="">'),0==n.indexOf(a)&&(t+=$.tb.format(this.talkItemTpl,{contents:n.replace(a,""),user_name:r.author&&r.author.user_name||"",user_portrait:r.author&&r.author.portrait||"",time:this.getTime(1e3*r.time),tid:this.tid,pid:r.id}))}i&&this.$talkList.html(""),this.$talkList.append(t),this.$talkList.scrollTop(99999999)},getTime:function(e){var i=new Date(e),t=i.getHours(),a=i.getMinutes();return[(10>t?"0":"")+t,":",(10>a?"0":"")+a].join("")},initBarrage:function(){this.barrageInited||(this.liveBarrage=this.requireInstance("common/widget/barrage",[{is_login:this.isLogin,container:this.$barrageContainer,commetHeight:60,color:["#0e9ad5","#eca806","#986aff","#ff477b","#ff2f2f","#a6a6a6","#6afcaf","#35c751"],fontsize:this.smallFontSize,winWidth:this.barrageWidth,winHeight:this.live_video_height,speedList:[1.5,2.5,3.5,4.5],list:[]}]),"1"!=this.show_live_thread&&$("#threadListGroupCnt").hide(),this.observe("barrage_head_get_data",$.proxy(this.getData,this)),this.observe("barrage_head_update_data",$.proxy(this.freshData,this)),this.$wrapper.find(".opui-barrage-mask").remove(),this.barrageInited=!0)},initQueueList:function(e){var i=this;$.get("/show/livevideo/getStreamConf",{ie:"utf-8",forum_name:i.conf.forum_name},function(t){i.queues=t.data||[],i.is_living&&i.queues.length>0&&(i.initVideo(e),i.updateQueueDisplay(),void 0==e?i.toggleBarrage():(i.barrageOn&&i.toggleBarrage(),i.liveBarrage.replaceList([]),i.updateData(i.liveStream,!0),i.barrageOn||i.toggleBarrage()))})},updateQueueDisplay:function(){var e="";if(5==this.queues.length)for(var i=0,t=this.queues.length;t>i;i++){var a=this.queues[i];e+=['<a href="javascript:" class="game_live_queue j_game_live_queue" data-index="',i,'">',this.queueIndex==i?'<span class="game_live_queue_selected"></span>':'<span class="game_live_queue_mask"></span>','<img src="',a.img_url,'" alt>','<span class="game_live_queue_game_name">',a.game_name,"</span>",'<span class="game_live_queue_live_title">',a.stream_title,"</span>","</a>",""].join("")}this.$queues.html(e).show()},getLiveGameNameTag:function(){var e=this.queues[this.queueIndex],i="";return e&&(i=e.game_name),"\u3010"+i+"\u3011"},getLiveUrl:function(e){var i=$.tb.location.getSearchValue("gloc");void 0==e&&(e=void 0!=i?i:0),this.queueIndex=e||0;var t=this.queues[this.queueIndex],a="";return t&&(a=t.stream_url),a},initVideo:function(e){this.live_url=this.getLiveUrl(e),this.$videoArea.html("").append('<iframe src="'+this.live_url+'" style="width:100%;margin:0 auto;height:'+this.live_video_height+'px;display:block;vertical-align:top;" frameborder="0" scrolling="no" allowTransparency="true"></iframe>'),this.live_title=this.queues[this.queueIndex]&&this.queues[this.queueIndex].stream_title,this.$wrapper.find(".game_live_title").text(this.live_title||this.live_topic)},bindEvents:function(){var e=this;this.$wrapper.on("click",".game_live_barrage_switch",$.proxy(this.toggleBarrage,this)),this.$wrapper.on("click",".j_game_live_score_banner_image",$.proxy(this.toggleScoreImage,this)),this.$wrapper.on("click",".j_game_live_score_image_close",$.proxy(this.toggleScoreImage,this)),this.$wrapper.on("click",".j_game_live_join_btn",$.proxy(this.onJoinBtnClick,this)),this.$wrapper.on("click",".game_live_postor_btn",$.proxy(this.onBarrageInputClick,this)),this.$barrageInput.on("keydown",function(i){"13"==i.keyCode&&e.onBarrageInputClick()}),this.$wrapper.on("click",".j_game_live_join_like_check",$.proxy(this.onLikeCheckClick,this)),this.$wrapper.on("click",".j_game_live_queue",$.proxy(this.onQueueBtnClick,this))},toggleBarrage:function(){"1"==this.show_live_list&&(this.barrageOn?(this.$barrageContainer.hide(),this.liveBarrage.stop(),this.$wrapper.find(".game_live_barrage_switch").removeClass("game_live_barrage_switch_on"),this.barrageOn=!1,this.postTrack("\u5173\u95ED\u5F39\u5E55")):(this.$barrageContainer.show(),this.liveBarrage.start(),this.$wrapper.find(".game_live_barrage_switch").addClass("game_live_barrage_switch_on"),this.barrageOn=!0,this.postTrack("\u5C55\u5F00\u5F39\u5E55")))},toggleScoreImage:function(){this.is_living&&(this.scoreImageOn?(this.$videoArea.css("left",""),this.$scoreImageArea.hide(),this.scoreImageOn=!1,this.postTrack("\u5173\u95ED\u8D5B\u4E8B\u8D5B\u7A0B")):(this.barrageOn&&this.toggleBarrage(),this.$videoArea.css("left","-99em"),this.$scoreImageArea.show(),this.scoreImageOn=!0,this.postTrack("\u70B9\u51FB\u8D5B\u4E8B\u8D5B\u7A0B")))},onBarrageInputClick:function(){this.postBarrage();var e=this.$wrapper.find(".j_game_live_join_like_check").tbattr("checked");e&&this.doLike(1),this.postTrack("\u53D1\u9001\u5410\u69FD")},onJoinBtnClick:function(){var e=this.$wrapper.find(".j_game_live_join_like_check").tbattr("checked");e&&this.doLike(2),this.postTrack("\u53C2\u4E0E\u76F4\u64AD\u8BA8\u8BBA")},onLikeCheckClick:function(){var e=this.$wrapper.find(".j_game_live_join_like_check").tbattr("checked"),i=e?"\u6DFB\u52A0\u5173\u6CE8\u9009\u6846":"\u53D6\u6D88\u5173\u6CE8\u9009\u6846";this.postTrack(i)},onQueueBtnClick:function(e){var i=$(e.currentTarget),t=i.tbattr("data-index");t!=this.queueIndex&&(this.textSending=null,this.initQueueList(t),this.postTrack("\u5207\u6362\u961F\u5217"+(t+1)))},doLike:function(e){var i=this,t={1:"\u901A\u8FC7\u53D1\u8868\u5173\u6CE8\u5427",2:"\u901A\u8FC7\u53C2\u4E0E\u76F4\u64AD\u8BA8\u8BBA\u5173\u6CE8\u5427"},a=t[e];!i.like_added&&PageData.user.is_login&&i.like_forum_id&&i.like_forum_name&&$.ajax({url:"/f/like/commit/add",type:"post",data:{fid:i.like_forum_id,fname:i.like_forum_name,uid:PageData.user.id,ie:"utf-8",tbs:PageData.tbs},dataType:"json"}).done(function(e){e&&(0==e.no||221==e.no)&&(i.like_added=!0,i.postTrack(a))})},postTrack:function(e,i,t){"undefined"==typeof e&&(e=""),"undefined"==typeof i&&(i="click"),t=t||{},$.stats.track(e,"\u6E38\u620F\u76F4\u64ADmis","",i,t)}}});_.Module.define({path:"comforum/widget/gamePlayerAuth",requires:[],sub:{initial:function(){var e=this;e.bindEvents(),e.levelSlide(),e.getConfigInfo(function(){e.getUserInfo(function(){e.showServiceSpeedInfo(),e.showHotForums()}),e.showNotLoginStatus()}),e.getRecGameList(),e.getPlayerRank()},bindEvents:function(){var e=this;$(".player-rank").on("mouseenter","ol li",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).on("click",".FAQ-dialog-content ul li",function(){var e=$(this).index();$(this).addClass("on").siblings().removeClass("on"),$(".FAQ-dialog-content .answer-content").find("p").eq(e).removeClass("hidden").siblings().addClass("hidden")}),$(".play-auth-container").on("click",".FAQ ul li",function(){var n=$(this).index();e.showFAQDialog(n)})},getIconAbsUrl:function(e){var n;switch(e){case 0:n="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth/img/24/0_353fcb4.png";break;case 1:n="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth/img/24/1_21d5ce9.png";break;case 2:n="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth/img/24/2_e118c3d.png";break;case 3:n="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth/img/24/3_941afc4.png";break;case 4:n="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth/img/24/4_bb5f1c5.png";break;case 5:n="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth/img/24/5_6b9de23.png";break;default:n="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth/img/24/0_353fcb4.png"}return n},ajax:function(){return window.playerDetailAjax=window.playerDetailAjax||$.getJSON("/gameplayer/app/playerDetail"),{playerDetail:window.playerDetailAjax}},getUserInfo:function(e){var n=this;n.ajax().playerDetail.success(function(t){if(0==t.no){var a=t.data,i=a.user_level,o=a.total_score,s=a.today_score,l=a.star_level,r=a.game_play.items,d={pc:a.pc_sign.items,app:a.app_sign.items},c=a.game_play.score,m=a.pc_sign.score,p=a.app_sign.score,g=$(".play-auth-header .user-info"),f=$(".task-speed");i>=0&&g.find(".yinji").html('<img src="'+n.getIconAbsUrl(i)+'" alt="'+n.yinjiInfo[i].name+'">'+n.yinjiInfo[i].name),g.find(".jingyan").text("\u6210\u957F\u503C\uFF1A"+o);var u="";u=r.length>0?"\u5728"+r.join("\u3001").replace(/\u3001$/g,"")+"\u6E38\u620F\u4E2D\u6D3B\u8DC3<strong>+"+c||"0</strong>":"\u6BCF\u5929\u5728\u6BCF\u4E2A\u6307\u5B9A\u6E38\u620F\u6D3B\u8DC3&nbsp;\u6210\u957F\u503C<strong>+"+n.configInfo.game_play_score||"0</strong>",f.find(".active-detail").html(u);var h=$(".base-speed"),_=d.pc.length,b=d.app.length;h.find(".pc-sigh").html(_+"\u4E2A\u6307\u5B9A\u6E38\u620F\u5427<strong>+"+m||"0</strong>"),h.find(".m-sigh").html(b+"\u4E2A\u6307\u5B9A\u6E38\u620F\u5427<strong>+"+p||"0</strong>"),n.configInfo.pc_sign_forums=d.pc,n.configInfo.app_sign_forums=d.app,n.configInfo.star_level=l,n.configInfo.level=i;var v=m+p,y=n.configInfo.max_day_score||0;g.find(".progress-bar .today-score").text(s||0),g.find(".progress-bar .today-max-score").text(y),y>0&&g.find(".progress-bar span").css({width:100*(s/y>1?1:s/y)+"%"});var I;I=0==s?"\u7F8E\u597D\u7684\u4E00\u5929\uFF0C\u4ECE\u83B7\u53D6\u7ECF\u9A8C\u503C\u5F00\u59CB~":s==y?"\u4ECA\u5929\u7684\u8868\u73B0\u597D\u68D2\u5440\uFF0C\u7ECF\u9A8C\u503C\u6EE1\u6EE1\u7684\uFF01":"\u4ECA\u5929\u8868\u73B0\u4E0D\u9519\uFF0C\u7EE7\u7EED\u52A0\u6CB9\u54E6\uFF01",g.find(".tips").text(I),n.configInfo.yesterdayScore=o-s,n.configInfo.baseSpeedScore=v,-1==i?g.replaceWith('<div class="not-login"></div>'):g.removeClass("hidden"),e&&e()}})},getConfigInfo:function(e){var n=this;$.getJSON("/gameplayer/app/levelConf",{},function(t){if(0==t.no){var a=t.data,i=a.pc_sign_score,o=a.app_sign_score,s=a.game_play_score,l=a.max_day_score,r=a.boost_factors,d=a.hot_forums,c=$(".base-speed"),m=$(".task-speed");c.find(".tips .pc strong").text("+"+i),c.find(".tips .mobile strong").text("+"+o),m.find(".tips .pop strong").text("+"+s),n.configInfo.boost_factors=r,n.configInfo.game_play_score=s,n.configInfo.hot_forums=d,n.configInfo.pc_sign_score=i,n.configInfo.app_sign_score=o,n.configInfo.max_day_score=l,e&&e()}})},showServiceSpeedInfo:function(){var e,n=this,t=n.configInfo.star_level,a=n.configInfo.level,i=n.configInfo.baseSpeedScore,o=$(".server-speed");0==t?(e=o.find(".multiple-status-0"),e.find(".progress-bar .on1 .grow-num").text(Math.round(1*i*100)/100),e.find(".progress-bar .on2 .grow-num").text(Math.round(i*n.medalInfo[0].multiple*100)/100||""),e.find(".progress-bar .on2 .multiple").text(n.medalInfo[0].multiple+"\u500D")):6==t?(e=o.find(".multiple-status-2"),e.find(".progress-bar .on .grow-num").text(Math.round(i*n.medalInfo[t-1].multiple*100)/100),e.find(".progress-bar .on .multiple").text(n.medalInfo[t-1].multiple+"\u500D"),e.find(".medal-name").text(n.medalInfo[t-1].name),e.find(".multiple-num").text(n.medalInfo[t-1].multiple),e.find(".des p").prepend('<img src="'+n.getIconAbsUrl(a)+'">')):(e=o.find(".multiple-status-1"),e.find(".progress-bar .on1 .grow-num").text(Math.round(i*n.medalInfo[t-1].multiple*100)/100),e.find(".progress-bar .on1 .multiple").text(n.medalInfo[t-1].multiple+"\u500D"),e.find(".progress-bar .on2 .grow-num").text(Math.round(i*n.medalInfo[t-1+1].multiple*100)/100||""),e.find(".progress-bar .on2 .multiple").text(n.medalInfo[t-1+1].multiple+"\u500D"),e.find(".medal-name").text(n.medalInfo[t-1].name),e.find(".multiple-num").text(n.medalInfo[t-1].multiple),e.find(".des p").prepend('<img src="'+n.getIconAbsUrl(a)+'">')),e.removeClass("hidden").siblings().addClass("hidden")},showHotForums:function(){for(var e,n=this,t=$(".base-speed"),a="",i=n.configInfo.hot_forums||[],o=n.configInfo.pc_sign_forums||[],s=n.configInfo.app_sign_forums||[],l=o.concat(s),r=0,d=i.length;r<Math.min(d,10);r++){var c=l.length;for(e=!1;c--;)if(i[r].forum_id==l[c]){e=!0;break}a+='<li class="'+(e?"signed":"")+'"><a data-id="'+i[r].forum_id+'" href="'+i[r].forum_url+'" target="_blank">'+i[r].forum_name+"</a></li>"}t.find("ul").html(a)},getRecGameList:function(){var e=this;$.getJSON("/gameplayer/app/hotGames",{},function(n){if(0==n.no){var t=n.data,a=t.games;if(void 0!==a){for(var i=$(".task-speed"),o="",s=0,l=a.length;s<Math.min(l,6);s++)o+='<dl data-id="'+a[s].game_id+'"><dt><img src="'+a[s].icon_url+'" alt="'+a[s].game_name+'"></dt><dd><h4>'+a[s].game_name+'</h4><p><span class="player-num">'+a[s].player_num+'</span>\u5728\u73A9</p><div class="btns-qrcode"><a href="'+a[s].download_url+'" class="download-btn">\u4E0B\u8F7D</a><a href="'+a[s].forum_url+'" target="_blank" class="enter-ba">\u8FDB\u5427</a><div class="qrcode-wrapper"><div class="qrcode" data-download-url="'+a[s].download_url+'"></div><p>\u626B\u4E00\u626B\u4E0B\u8F7D\u81F3\u624B\u673A</p></div></div></dd></dl>';i.find(".games").html(o),e.getQrcode()}}})},getQrcode:function(){var e=!!window.ActiveXObject,n=e&&!!document.documentMode;$.JsLoadManager.use("http://tb1.bdstatic.com/tb/static-comforum/qrcode_f84ab06.js",function(){$(".task-speed .games dl .qrcode").each(function(){new window.QRCode($(this).get(0),{text:$(this).data("download-url"),width:"135",height:"135"})}),n&&$(".task-speed .games dl table").css({margin:0,width:130,height:130})})},getPlayerRank:function(){$.getJSON("/gameplayer/app/playerRank",{},function(e){if(0==e.no){var n=e.data,t=n.players,a=n.my_rank,i=$(".player-rank"),o=$(".my-rank");o.find("p").text(a||0);for(var s="",l=0,r=t.length;r>l;l++){var d=l%2==0?!1:!0;s+='<li class="'+(d?"even":"")+'"><span class="num">'+(1+l)+'</span><span class="avatar"><img src="http://tb.himg.baidu.com/sys/portrait/item/'+t[l].portrait+'" alt=""></span><span class="username">'+t[l].user_name+'</span><span class="grow-level">'+t[l].score+"</span></li>"}i.find("ol").html(s),i.find("ol li").first().addClass("on")}})},showFAQDialog:function(e){var n=this;new $.dialog({html:$.tb.format(n.htmlTpl.FAQ,{}),holderClassName:"game_player_auth_FAQ",title:"FAQ",width:698,height:"auto",draggable:!1,closeable:!0});var t=$(".FAQ-dialog-content");t.find("ul li").eq(e).addClass("on").siblings().removeClass("on"),t.find("p").eq(e).removeClass("hidden").siblings().addClass("hidden")},htmlTpl:{FAQ:['<div class="FAQ-dialog-content clearfix">',"<ul>",'<li class="on">\u4EC0\u4E48\u662F\u73A9\u5BB6\u8BA4\u8BC1\u4F53\u7CFB\uFF1F</li>',"<li>\u73A9\u5BB6\u5982\u4F55\u83B7\u53D6\u6210\u957F\u503C\uFF1F</li>","<li>\u8BA4\u8BC1\u73A9\u5BB6\u6709\u54EA\u4E9B\u798F\u5229\uFF1F</li>","<li>\u5FC5\u987B\u5728\u6307\u5B9A\u624B\u6E38\u7684\u5427\u5185\u7B7E\u5230\u624D\u80FD\u83B7\u53D6\u57FA\u7840\u6210\u957F\u503C\u5417\uFF1F</li>","<li>\u5982\u4F55\u83B7\u53D6\u66F4\u9AD8\u7684\u670D\u52A1\u52A0\u901F\u500D\u6570\uFF1F</li>","</ul>",'<div class="answer-content">',"<p>","\u73A9\u5BB6\u8BA4\u8BC1\u4F53\u7CFB\u662F\u8D34\u5427\u624B\u673A\u6E38\u620F\u7528\u6237\u7684\u6210\u957F\u4F53\u7CFB\uFF0C\u65E8\u5728\u4E3A\u624B\u6E38\u73A9\u5BB6\u63D0\u4F9B\u66F4\u597D\u7684\u670D\u52A1\u3002\u6210\u957F\u503C\u662F\u8861\u91CF\u7528\u6237\u8BA4\u8BC1\u7B49\u7EA7\u7684\u6807\u51C6\uFF0C\u6210\u957F\u503C\u8D8A\u9AD8\uFF0C\u7528\u6237\u6210\u957F\u7B49\u7EA7\u8D8A\u9AD8\uFF0C\u53EF\u4EE5\u4EAB\u53D7\u7684\u7B49\u7EA7\u7279\u6743\u8D8A\u591A\u3002","</p>",'<p class="hidden">',"\u6210\u957F\u503C\u662F\u8861\u91CF\u7528\u6237\u8BA4\u8BC1\u7B49\u7EA7\u7684\u6807\u51C6\uFF0C\u7528\u6237\u6210\u957F\u503C\u7684\u8BA1\u7B97\u65B9\u6CD5\u4E3A\uFF1A\u73A9\u5BB6\u6210\u957F\u503C=\u57FA\u7840\u6210\u957F\u503C*\u670D\u52A1\u52A0\u901F\u500D\u6570+\u4EFB\u52A1\u52A0\u901F\u6210\u957F\u503C\u3002\u57FA\u7840\u6210\u957F\u503C\u662F\u6307\u73A9\u5BB6\u901A\u8FC7\u7535\u8111\u6216\u8005\u624B\u673A\u5728\u6307\u5B9A\u5427\u5185\u7B7E\u5230\u83B7\u53D6\u7684\u6210\u957F\u5956\u52B1\uFF1B\u670D\u52A1\u52A0\u901F\u500D\u6570\u662F\u6307\u5BF9\u4E8E\u767E\u5EA6\u79FB\u52A8\u6E38\u620F\u661F\u73A9\u5BB6\u7528\u6237\u7ED9\u4E88\u7684\u6210\u957F\u5956\u52B1\uFF0C\u661F\u73A9\u5BB6\u7B49\u7EA7\u8D8A\u9AD8\uFF0C\u5956\u52B1\u500D\u6570\u8D8A\u9AD8\uFF1B\u4EFB\u52A1\u52A0\u901F\u6210\u957F\u503C\u662F\u5BF9\u4E8E\u5728\u767E\u5EA6\u79FB\u52A8\u6E38\u620F\u6D3B\u8DC3\u7684\u7528\u6237\u7ED9\u4E88\u7684\u6210\u957F\u5956\u52B1\u3002","</p>",'<p class="hidden">',"\u8BA4\u8BC1\u73A9\u5BB6\u7684\u7B49\u7EA7\u798F\u5229\u6682\u65F6\u5305\u542B\u4E24\u4E2A\u65B9\u5411\uFF1A\u8D34\u5427\u624B\u6E38\u73A9\u5BB6\u4E13\u5C5E\u5370\u8BB0\u548C\u767E\u5EA6\u79FB\u52A8\u6E38\u620F\u7B49\u7EA7\u7279\u6743\u3002\u624B\u6E38\u73A9\u5BB6\u5370\u8BB0\u662F\u9488\u5BF9\u624B\u6E38\u8BA4\u8BC1\u7528\u6237\u5B9A\u5236\u7684\u4E13\u5C5E\u5370\u8BB0\uFF0C\u6BCF\u4E2A\u7B49\u7EA7\u5BF9\u5E94\u7740\u4E0D\u540C\u7684\u5370\u8BB0\uFF0C\u4EE3\u8868\u4E86\u73A9\u5BB6\u5728\u8D34\u5427\u7684\u4E13\u5C5E\u624B\u6E38\u8BA4\u8BC1\u7B49\u7EA7\uFF1B\u767E\u5EA6\u79FB\u52A8\u6E38\u620F\u7B49\u7EA7\u7279\u6743\u5305\u542B\u4E13\u5C5E\u6E38\u620F\u793C\u5305\u3001\u4E13\u5C5E\u7B49\u7EA7\u6D3B\u52A8\u7B49\u3002","</p>",'<p class="hidden">',"\u73A9\u5BB6\u53EA\u8981\u5728\u624B\u6E38\u7C7B\u76EE\u7684\u5427\u5185\u7B7E\u5230\u5373\u53EF\u83B7\u53D6\u57FA\u7840\u6210\u957F\u503C\uFF0C\u4E0D\u4E00\u5B9A\u662F\u6307\u5B9A\u7684\u624B\u6E38\u5427\u3002\u4F46\u662F\u7B7E\u5230\u5956\u52B1\u4EC5\u9650\u4E8E\u624B\u6E38\u7C7B\u76EE10\u4E2A\u5427\u4EE5\u5185\uFF0C10\u4E2A\u5427\u4E4B\u5916\u7684\u5427\u5F53\u65E5\u4E0D\u4F1A\u7ED9\u4E88\u6210\u957F\u503C\u5956\u52B1\u3002","</p>",'<p class="hidden">',"\u670D\u52A1\u52A0\u901F\u500D\u6570\u662F\u548C\u7528\u6237\u7684\u661F\u73A9\u5BB6\u7B49\u7EA7\u76F4\u63A5\u76F8\u5173\uFF0C\u661F\u73A9\u5BB6\u7B49\u7EA7\u8D8A\u9AD8\uFF0C\u670D\u52A1\u52A0\u901F\u500D\u6570\u8D8A\u9AD8\u3002\u661F\u73A9\u5BB6\u7B49\u7EA7\u5BF9\u5E94\u7684\u8BA4\u8BC1\u6761\u4EF6\u5982\u4E0B\uFF1A",'<img src="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth/img/faq_830c923.jpg">',"</p>","</div>","</div>"].join("")},levelSlide:function(){var e,n=$(".pops").find("li"),t=n.length,a=5e3,i=n.eq(0),o=function(s,l){s.removeClass("hidden").stop().animate({opacity:1},600).siblings().stop().animate({opacity:0},600),i=s.index()==t-1?n.eq(0):s.next(),l?clearInterval(e):e=setTimeout(function(){o(i,!1)},a)};o(i,!1),$(".play-auth-header .star-level").on("mouseenter",".level",function(){var e=$(this).index();o(n.eq(e),!0)}),$(".play-auth-header .star-level").on("mouseleave",".level",function(){var e=$(this).index();o(n.eq(e),!1)})},showNotLoginStatus:function(){var e=this;if($(".play-auth-header").find(".not-login").length>0){$(".server-speed").find(".multiple-status-0").removeClass("hidden");var n=$(".base-speed"),t=$(".task-speed");n.find(".pc-sigh").html("\u6BCF\u7B7E\u5230\u4E00\u4E2A\u5427&nbsp;\u6210\u957F\u503C<strong>+"+e.configInfo.pc_sign_score||"0</strong>"),n.find(".m-sigh").html("\u6BCF\u7B7E\u5230\u4E00\u4E2A\u6307\u5B9A\u5427&nbsp;\u6210\u957F\u503C<strong>+"+e.configInfo.app_sign_score||"0</strong>"),t.find(".active-detail").html("\u6BCF\u5929\u5728\u6BCF\u4E2A\u6307\u5B9A\u6E38\u620F\u6D3B\u8DC3&nbsp;\u6210\u957F\u503C<strong>+"+e.configInfo.game_play_score||"0</strong>"),$(".my-rank").addClass("hidden")}e.showHotForums()},configInfo:{},yinjiInfo:[{name:"\u624B\u6E380\u661F\u8FBE\u4EBA",icon:"0.png"},{name:"\u624B\u6E381\u661F\u8FBE\u4EBA",icon:"1.png"},{name:"\u624B\u6E382\u661F\u8FBE\u4EBA",icon:"2.png"},{name:"\u624B\u6E383\u661F\u8FBE\u4EBA",icon:"3.png"},{name:"\u624B\u6E384\u661F\u8FBE\u4EBA",icon:"4.png"},{name:"\u624B\u6E385\u661F\u8FBE\u4EBA",icon:"5.png"}],medalInfo:[{name:"\u9752\u94DC",multiple:1.4},{name:"\u767D\u94F6",multiple:1.5},{name:"\u9EC4\u91D1",multiple:1.6},{name:"\u767D\u91D1",multiple:1.7},{name:"\u91D1\u94BB",multiple:1.8},{name:"\u81F3\u5C0A",multiple:1.9}]}});_.Module.define({path:"comforum/widget/gamePlayerAuthDialog",requires:[],sub:{initial:function(a){var e=this;e.bindEvents(),"game_ba"==a.flag?e.showDialogInGameBa(a):"sy_ba"==a.flag&&e.showDialogInSyBa(a)},bindEvents:function(){},ajax:function(){return window.playerDetailAjax=window.playerDetailAjax||$.getJSON("/gameplayer/app/playerDetail"),{playerDetail:window.playerDetailAjax}},showDialogInGameBa:function(a){var e=this;e.ajax().playerDetail.success(function(t){if(0==t.no){var i=t.data.user_level;a.medalName=e.yinjiInfo[i].name,a.iconUrl=e.getIconAbsUrl(i),$.getJSON("/gameplayer/app/actHistory",function(t){if(0==t.no){var i=t.data.forums,l=t.data.games,n="",s=i.join("\uFF0C"),o=l.join("\uFF0C");i.length>0&&l.length>0?(i.length>2&&(s=i[0]+"\uFF0C"+i[1]+"\u7B49"),l.length>2&&(o=l[0]+"\uFF0C"+l[1]+"\u7B49"),n+='\u7531\u4E8E\u60A8\u5728<strong class="ba-name">'+s+'</strong>\u5427\u548C<strong class="game-name">'+o+"\u6E38\u620F</strong>\u7684\u6D3B\u8DC3\uFF0C"):i.length>0&&0==l.length?(i.length>2&&(s=i[0]+"\uFF0C"+i[1]+"\u7B49"),n+='\u7531\u4E8E\u60A8\u5728<strong class="ba-name">'+s+"</strong>\u5427\u7684\u6D3B\u8DC3\uFF0C"):0==i.length&&l.length>0?(l.length>2&&(o=l[0]+"\uFF0C"+l[1]+"\u7B49"),n+='\u7531\u4E8E\u60A8\u5728<strong class="game-name">'+o+"\u6E38\u620F</strong>\u7684\u6D3B\u8DC3\uFF0C"):n+="\u7531\u4E8E\u60A8\u7684\u6D3B\u8DC3\uFF0C",new $.dialog({html:$.tb.format(e.htmlTpl.dialog_game_ba,{avatarUrl:"http://tb.himg.baidu.com/sys/portrait/item/"+a.portrait,username:a.username,medalName:a.medalName,iconUrl:a.iconUrl,detailHtml:n}),holderClassName:"game_player_auth_dialog",title:"\u63D0\u793A",width:463,height:"auto",draggable:!1,closeable:!0}),$.get("/gameplayer/app/resetLevel")}})}})},showDialogInSyBa:function(a){var e=this;e.ajax().playerDetail.success(function(t){if(0==t.no){var i=t.data.user_level;a.score=t.data.total_score,a.medalName=e.yinjiInfo[i].name,a.iconUrl=e.getIconAbsUrl(i);var l=new $.dialog({html:$.tb.format(e.htmlTpl.dialog_sy_ba,{avatarUrl:"http://tb.himg.baidu.com/sys/portrait/item/"+a.portrait,username:a.username,medalName:a.medalName,iconUrl:a.iconUrl,score:a.score}),holderClassName:"game_player_auth_dialog",title:"\u63D0\u793A",width:463,height:360,draggable:!1,closeable:!0});l.element.on("click",".confirm-btn .sure",function(a){a.preventDefault(),l.close()}),$.get("/gameplayer/app/resetLevel")}})},htmlTpl:{dialog_sy_ba:['<div class="player-auth-dialog-content">','<p class="avatar"><img src="#{avatarUrl}" alt="#{username}"></p>','<p class="detail">\u60A8\u7684\u73A9\u5BB6\u7ECF\u9A8C\u503C\u4E3A<strong class="ex-num">#{score}</strong>\uFF0C\u5DF2\u6210\u529F\u8BA4\u8BC1\u4E3A<strong class="medal-name">#{medalName}</strong></p>','<p class="line"></p>','<p class="tieba-special"><i></i><img class="yinji-icon" src="#{iconUrl}">#{medalName}</p>','<p class="duoku-special"><i><span>\u624B\u6E38\u7279\u6743</span></i>\u5BF9\u5E94\u6E38\u620F\u793C\u5305\u3001\u7B49\u7EA7\u5185\u6D3B\u52A8\u4E13\u5C5E\u6743\u76CA</p>','<p class="confirm-btn"><a href="#" class="sure">\u6211\u77E5\u9053\u4E86</a></p>',"</div>"].join(""),dialog_game_ba:['<div class="player-auth-dialog-content">','<p class="avatar"><img src="#{avatarUrl}" alt="#{username}"></p>','<p class="detail">#{detailHtml}\u5DF2\u6210\u529F\u8BA4\u8BC1\u4E3A<strong class="medal-name">#{medalName}</strong></p>','<p class="line"></p>','<p class="tieba-special"><i></i><img class="yinji-icon" src="#{iconUrl}">#{medalName}</p>','<p class="duoku-special"><i><span>\u624B\u6E38\u7279\u6743</span></i>\u5BF9\u5E94\u6E38\u620F\u793C\u5305\u3001\u7B49\u7EA7\u5185\u6D3B\u52A8\u4E13\u5C5E\u6743\u76CA</p>','<p class="confirm-btn"><a href="#" target="_blank">\u53BB\u770B\u770B</a></p>',"</div>"].join("")},getIconAbsUrl:function(a){var e;switch(a){case 0:e="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth_dialog/img/24/0_353fcb4.png";break;case 1:e="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth_dialog/img/24/1_21d5ce9.png";break;case 2:e="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth_dialog/img/24/2_e118c3d.png";break;case 3:e="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth_dialog/img/24/3_941afc4.png";break;case 4:e="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth_dialog/img/24/4_bb5f1c5.png";break;case 5:e="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth_dialog/img/24/5_6b9de23.png";break;default:e="http://tb2.bdstatic.com/tb/static-comforum/widget/game_player_auth_dialog/img/24/0_353fcb4.png"}return e},yinjiInfo:[{name:"\u624B\u6E380\u661F\u8FBE\u4EBA",icon:"0.png"},{name:"\u624B\u6E381\u661F\u8FBE\u4EBA",icon:"1.png"},{name:"\u624B\u6E382\u661F\u8FBE\u4EBA",icon:"2.png"},{name:"\u624B\u6E383\u661F\u8FBE\u4EBA",icon:"3.png"},{name:"\u624B\u6E384\u661F\u8FBE\u4EBA",icon:"4.png"},{name:"\u624B\u6E385\u661F\u8FBE\u4EBA",icon:"5.png"}]}});_.Module.define({path:"common/widget/lcbpContentTop",requires:[],sub:{initial:function(){var t=this;t.bindEvents(),t.getRollAdText(function(){t.rollVertical($(".lcbp-top-box-ad").find("ul"),0,5e3)}),t.getKeyProducts(function(){t.initialGame()}),t.getTodayRecGames(function(){t.getHistoryGames()}),t.getAllGames(),t.getRankByFid(1574656)},bindEvents:function(){$(".lcbp-content-top-wrapper").on("click",".box-nav-bar th",function(){var t=$(this),e=t.index();t.addClass("active").siblings(".active").removeClass("active"),$(".box-recommend .box-item").find(".category_"+e).removeClass("hidden"),$(".box-recommend .box-item > :not(.category_"+e+")").addClass("hidden");var a=e+1,i=t.text();$.stats.track("\u5206\u7C7B\u63A8\u8350\u533A_tab","ba_game_pc","frs","click",{obj_name:i,obj_id:a,loc_param:"head"})}).on("click",".box-thumb a",function(t){t.preventDefault();var e,a=$(this),i=a.tbattr("class"),n=a.siblings(".active-thumb");if(!(i.indexOf("active-thumb")>-1)){i.indexOf("left-thumb")>-1?(e=a.siblings(".right-thumb"),e.animate({left:"15px"},{duration:300,complete:function(){e.removeClass("right-thumb").addClass("left-thumb")}}),a.removeClass("free").animate({left:"115px",bottom:0,width:"90px",height:"90px"},{duration:300,complete:function(){a.removeClass(i).addClass("active-thumb"),a.addClass("free")}}),n.animate({left:"236px",bottom:"10px",width:"69px",height:"69px"},{duration:300,complete:function(){n.removeClass("active-thumb").addClass("right-thumb")}})):(e=a.siblings(".left-thumb"),e.animate({left:"+236px"},{duration:300,complete:function(){e.removeClass("left-thumb").addClass("right-thumb")}}),a.removeClass("free").animate({left:"115px",bottom:0,width:"90px",height:"90px"},{duration:300,complete:function(){a.removeClass(i).addClass("active-thumb"),a.addClass("free")}}),n.animate({left:"15px",bottom:"10px",width:"69px",height:"69px"},{duration:300,complete:function(){n.removeClass("active-thumb").addClass("left-thumb")}}));var o=a.data("link"),r=a.data("name"),c=a.data("thread_id");$(".lcbp-content-top-wrapper .box-main").find("iframe").tbattr("src",o).end().find(".box-chat a").data("name",r).data("thread_id",c)}}).on("click",".box-chat a",function(){var t=$(this),e=t.data("name"),a=t.data("thread_id");$.stats.track("\u8FB9\u804A\u8FB9\u73A9","ba_game_pc","frs","click",{obj_name:e,obj_id:a,loc_param:"button"})}).on("click",".lcbp-top-box-ad a",function(){var t=$(this).text();$.stats.track("\u63A8\u8350\u6D3B\u52A8\u6587\u5B57\u533A","ba_game_pc","frs","click",{obj_name:t,obj_id:"",loc_param:"head"})}).on("click",".box-history a",function(){var t,e,a=$(this);a.find(".star").length>0?(t="\u63A8\u8350",e=2):(t="\u73A9\u8FC7",e=1),$.stats.track("\u6211\u73A9\u8FC7\u7684\u6E38\u620F","ba_game_pc","frs","click",{obj_name:t,obj_id:e,loc_param:"pic"})}).on("click",".box-recommend-left a",function(){var t=$(".box-recommend .box-nav-bar").find(".active"),e=t.index()+1,a=t.text();$.stats.track("\u5206\u7C7B\u63A8\u8350\u533A_\u6E38\u620F","ba_game_pc","frs","click",{obj_name:a,obj_id:e,loc_param:"pic"})}).on("click",".box-recommend-right li a",function(){var t=$(this).parents("li").index()+1,e="\u4F4D\u7F6E"+t;$.stats.track("\u4ECA\u65E5\u63A8\u8350","ba_game_pc","frs","click",{obj_name:e,obj_id:t,loc_param:"head"})})},initialGame:function(){var t=$(".box-main .box-thumb").find(".active-thumb"),e=t.data("link"),a=t.data("thread_id"),i=t.data("name");$(".box-main-left").find("iframe").tbattr("src",e);var n=$(".box-main").find(".box-chat a");n.tbattr("href","http://tieba.baidu.com/p/"+a),n.data("name",i),n.data("thread_id",a)},replace:function(t,e,a){function i(t){var e;return 0==t.length?"":(e=t.replace(/&/g,"&gt;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/ /g,"&nbsp;"),e=e.replace(/'/g,"&#39;"),e=e.replace(/"/g,"&quot;"))}var n,o,r=t;for(var c in e)n=e[c],o=typeof n,n="object"==o?"":"undefined"==o?"":"boolean"==o?n?"true":"false":"string"==o?i(n):n.toString(),void 0!==a&&(n=n.length>a?n.substr(0,a)+"...":n),r=r.replace(new RegExp("@!"+c+"!@","g"),n);return r},getHistoryGames:function(){var t,e,a=this,i=$(".lcbp-content-top-wrapper").find(".box-history"),n=i.find("ul"),o=i.find(".scroll"),r=n.find("script").html(),c="";$.getJSON("/game/getHistoryGameList",{forum_name:"\u4E50\u6B64\u4E0D\u75B2",timestamp:+new Date},function(l){if(0==l.no){if(t=l.data.list,e=t.length,!e)return i.hide(),void 0;for(var s in t)t[s].star="hidden",c+=a.replace(r,t[s]);if(9>e&&o.hide(),5>e){t=a.todayRecGames.splice(0,3);for(var s in t)t[s].star="star",c+=a.replace(r,t[s])}n.prepend(c).find("script").remove(),a.scroll()}})},getAllGames:function(){var t=this;$.getJSON("/game/lcbph/getAllClassifGame4Front",{},function(e){if(0==e.errno){for(var a,i,n=e.data,o=$(".box-recommend-left"),r=o.find(".box-nav-bar tr"),c=o.find(".box-item"),l=r.find("script").html(),s=c.find("script").html(),d="",m="",p=Math.min(n.length,8),f=0;f<Math.min(p,8);f++){n[f]["class"]=f?"":"active",d+=t.replace(l,n[f]),a=n[f].gamelist,i=Math.min(a.length,9);for(var h=0;i>h;h++)a[h]["class"]="category_"+f,a[h].hidden=f>0?"hidden":"",m+=t.replace(s,a[h])}r.append(d).find("script").remove(),c.append(m).find("script").remove()}})},getRollAdText:function(t){var e=this;$.getJSON("/game/lcbph/getRecommendWords4Front",{},function(a){if(0==a.errno){for(var i=a.data,n=$(".lcbp-top-box-ad").find("ul"),o=n.find("script").html(),r="",c=Math.min(i.length,5),l=0;c>l;l++)r+=e.replace(o,i[l]);n.prepend(r).find("script").remove(),t&&t()}})},getKeyProducts:function(t){var e=this;$.getJSON("/game/lcbph/getKeyProducts4Front",{},function(a){if(0==a.errno){for(var i=a.data,n=$(".box-thumb"),o=n.find("script").html(),r="",c=Math.min(3,i.length),l=0;c>l;l++)i[l]["class"]=l?1==l?"active-thumb":"right-thumb":"left-thumb",r+=e.replace(o,i[l]);n.append(r).find("script").remove(),t&&t()}})},getTodayRecGames:function(t){var e=this;$.getJSON("/game/lcbph/getTodayRecommend4Front",{},function(a){if(0==a.errno){var i=a.data,n=$(".box-recommend-right").find("ul"),o=n.find("script").html(),r=Math.min(5,i.length),c="";e.todayRecGames=i;for(var l=0;r>l;l++)c+=e.replace(o,i[l]);n.append(c).find("script").remove(),t&&t()}})},getRankByFid:function(t){var e=this;$.post("/game/lcbph/getUserRankByFid",{fid:t},function(t){if(0==t.no){for(var a=t.data,i=$(".box-rank").find("tbody"),n=i.find("script").html(),o=Math.min(10,a.length),r="",c=0;o>c;c++)1==a[c].status?(a[c]["class"]="up",a[c].status="&arrowup;"):2==a[c].status?(a[c]["class"]="down",a[c].status="&arrowdown;"):a[c].status="-",r+=e.replace(n,a[c]);i.prepend(r).find("script").remove()}},"json")},rollVertical:function(t,e,a){function i(){e>r-1&&(e=0),n=t.children().eq(e),n.show().siblings().hide(),t.mouseenter(function(){s&&clearTimeout(s)}).mouseleave(function(){c||(o.rollVertical(l[0],e,l[2]),c=!0)}),n.css({position:"relative",top:n.height()+"px"}),n.animate({top:0},1e3),e++;var s=setTimeout(function(){i()},a)}var n,o=this,r=t.children().length,c=!1,l=Array.prototype.slice.call(arguments);i()},scroll:function(){!function(t){"use strict";t.fn.scroll=function(e){var a,i=this,n=t.extend({isAuto:!1,isLoop:!0,autoScrollDirection:"right",autoScrollTime:5e3,itemList:"ul.item-list",item:"ul.item-list>li",showItemsNum:4,prev:".prev",next:".next",speed:800,step:1,prevCallback:"",nextCallback:""},e||{}),o=i.find(n.prev),r=i.find(n.next),c=i.find(n.itemList),l=i.find(n.item),s=0,d=-(l.length-n.showItemsNum)*l.outerWidth();c.parent().css("position","relative"),c.css({position:"absolute",width:l.length*l.outerWidth()+"px"}),o.on("click",function(t){t.preventDefault(),c.is(":animated")||(n.isLoop&&0==c.position().left?a=d:(a=c.position().left+n.step*l.outerWidth(),a=a>s?s:a),c.stop().animate({left:a},n.speed,function(){n.prevCallback&&n.prevCallback()}))}),r.on("click",function(t){if(t.preventDefault(),!c.is(":animated")){if(l.length<=n.showItemsNum)return;n.isLoop&&c.position().left==d?a=s:(a=c.position().left-n.step*l.outerWidth(),a=d>a?d:a),c.stop().animate({left:a},n.speed,function(){n.nextCallback&&n.nextCallback()})}}),n.isAuto&&n.isLoop&&setInterval(function(){"left"==n.autoScrollDirection?o.click():r.click()},n.autoScrollTime)}}(jQuery),$(".lcbp-content-top-wrapper").find(".box-history .box-item").scroll({itemList:"ul",prev:".left",next:".right",item:"ul > li"})},gameCategory:["\u7F51\u7EDC\u6E38\u620F","\u4F11\u95F2\u76CA\u667A","\u4F53\u80B2\u7ADE\u901F","\u98DE\u884C\u5C04\u51FB","\u7B56\u7565\u7ECF\u8425","\u52A8\u4F5C\u5192\u9669","\u89D2\u8272\u626E\u6F14","\u5361\u7247\u68CB\u724C"]}});_.Module.define({path:"comforum/widget/GameRankInHead",requires:["common/widget/ScrollPanel"],sub:{curTab:null,initial:function(){var t=this;this.openBtn=$(".j_game_rank_open"),this.wrapper=$(".game_list_and_rank"),this.openBtn.on("click",function(){t.wrapper.slideDown(),$(this).hide(),t.wrapper.data("open")||(t.initailContent(),t.initialBlock(),t.wrapper.data("open",1))})},initailContent:function(){var t=this,i=$("#gameRankArea").html()+$("#gameListArea").html();this.wrapper.find(".game_rank_loading").remove(),this.listTab=$(".list_tab"),this.gameWrapper=$(".game_wrapper"),this.closeBtn=this.wrapper.find(".j_game_head_rank_close"),this.rankScroll=t.use("common/widget/ScrollPanel",{container:t.gameWrapper,height:140,content:i}),this.gameList=this.gameWrapper.find(".list_block"),this.tabList=this.listTab.find("li"),this.gameWrapper.append('<div class="dot_split"></div>'),this.bindEvents()},initialBlock:function(){this.tabList.first().trigger("click"),this.loopStart()},bindEvents:function(){var t=this;this.wrapper.on("click","a",function(){$.stats.track($(this).tbattr("title"),"FRS\u5934\u90E8\u6E38\u620F\u6392\u884C\u699C\u70B9\u51FB\u7EDF\u8BA1","frs")}),this.listTab.on("click","li",function(){t.slideGames($(this)),t.curTab=$(this)}),this.wrapper.bind("mouseenter",function(){t.loopEnd()}).bind("mouseleave",function(){t.loopStart()}),this.closeBtn.on("click",function(){t.wrapper.slideUp(),t.openBtn.show()})},slideGames:function(t){var i=t.data("cataid");this.tabList.removeClass("tab_sel"),t.addClass("tab_sel"),this.gameList.addClass("block_unsel"),this.gameWrapper.find("."+i).removeClass("block_unsel"),this.rankScroll.scrollTopTo()},loopStart:function(){var t=this;this.time=setInterval(function(){var i=t.curTab.next();0==i.length&&(i=t.tabList.first()),i.trigger("click")},5e3)},loopEnd:function(){clearInterval(this.time),this.time=null}}});_.Module.define({path:"comforum/widget/GameFrsHead",_container:null,_isLogin:null,sub:{_cookieName:"FRS_GH",initial:function(e,i){this._isLogin=e,this._container=$("#game_frs_head"),this._cookieFids=$.cookie(this._cookieName)||"",this._bindEvents(i),this._stats(),this._initSlider()},_bindEvents:function(e){var i=this,t=i._container.find(".j_game_frs_open"),a=i._container.find(".j_game_frs_close1"),n=i._container.find(".j_game_frs_close2"),o=(i._container.find(".j_game_frs_title2"),i._container.find(".j_game_frs_step1")),r=i._container.find(".j_game_frs_step2"),s=i._container.find(".j_game_frs_item");"none"!==t.css("display")&&i._gameGuideTip(),t.on("click",function(){$("#game_guide_tip").remove(),i.gameGuideTip=null,$(this).fadeOut(),o.slideDown(function(){i._initSlider()}),e||$.cookie(i._cookieName,null)}),a.on("click",function(){o.slideUp(),t.fadeIn(function(){i._gameGuideTip()}),e||$.cookie(i._cookieName,1,{expires:i._getCookieDate(),path:"/"})}),n.on("click",function(){var e=i._container.find("#game_frs_iframe");r.slideUp(),o.show(),setTimeout(function(){e[0].src="about:blank"},800),$("html, body").animate({scrollTop:0})}),s.on("click",function(){if(!i._isLogin)return TbCom.process("User","buildLoginFrame"),void 0;var e=$(this).data("url"),t=$(this).data("name"),a=!!$(this).data("scroll"),n=i._container.offset().top,s=i._container.find("#game_frs_iframe"),_=i._container.find(".j_game_frs_cur"),d="SD\u9AD8\u8FBE"==t?590:620,c=$(this).data("download");if(1==c)window.open(e);else{if(o.hide(),r.show(),_.text(t),0===s.length){var f=$('<iframe id="game_frs_iframe" src="'+e+'" '+(a?"":'scrolling="no"')+' frameborder="0" width="978" height="'+d+'" />').appendTo(r);f[0].src=e}else s[0].src=e,s[0].height=d,a?s.tbattr("scrolling","auto"):s.tbattr("scrolling","no");$("html, body").animate({scrollTop:n-40})}}),$("body").delegate(".game_guide_tip_close","click",function(){return $("#game_guide_tip").remove(),i.gameGuideTip=null,$.cookie("game_guide_tip","1",{expires:365}),!1})},_stats:function(){var e=this;e._container.on("click",function(e){var i=e.target||e.srcElement,t=$(i).data("log"),a=$(i).data("loc");if(t&&($.stats.track(a,"FRS\u9875\u6E38\u620F\u7EDF\u8BA1","frs",t),"\u6536\u8D77"!=t)){var n=$(i).parents(".game_frs_item").find(".game_frs_item_name").text();$.stats.track("frs\u9875_\u5934\u90E8\u6E38\u620F_\u5185\u5D4C","PC\u7AEF\u5546\u4E1A\u5316\u6E38\u620F\u7EDF\u8BA1",PageData.product||"",t,{obj_url:$(i).parents(".game_frs_item").find("img").tbattr("src"),obj_name:n,obj_type:"\u6E38\u620F"})}});var i=$(".j_game_frs_item"),t=[];i.length>0&&(i.each(function(){t.push($(this).tbattr("title"))}),$.stats.track("frs\u9875_\u5934\u90E8\u6E38\u620F_\u5185\u5D4C","PC\u7AEF\u5546\u4E1A\u5316\u6E38\u620F\u7EDF\u8BA1",PageData.product||"","\u5C55\u73B0",{obj_name:t.join(","),obj_type:"\u6E38\u620F"}))},_getCookieDate:function(){return parseFloat(((24-(new Date).getHours())/24).toFixed(4))},_gameGuideTip:function(){if("1"!=$.cookie("game_guide_tip")){var e=this,i=this._container.find(".game_frs_open"),t=['<div class="game_guide_tip">',"\u70B9\u51FB\u8FD9\u91CC\u6709\u6E38\u620F\u5662\uFF01",'<a href="#" target="_blank" class="game_guide_tip_close"></a>',"</div>"].join("");e.gameGuideTip&&(e.gameGuideTip.closeCard(),e.gameGuideTip=null),_.Module.use("common/widget/Card",{content:t,card_css:{top:i.offset().top-30,left:i.offset().left-28,width:145,zIndex:100},arrow_pos:{left:72},card_leave_display:!0,attr:"id = 'game_guide_tip'"},function(i){e.gameGuideTip=i,i.showCard()})}},_initSlider:function(){var e=this;return $(".frs-head-slider").is(":hidden")?void 0:(e._container.find(".frs-head-slider").jCarouselLite({visible:4,speed:200,btnNext:".j_frs_game_next",btnPrev:".j_frs_game_prev",circular:!1}),e._container.find("#frs-head-slider li").length<=4&&(e._container.find(".frs-head-slider .next").fadeOut(),e._container.find(".frs-head-slider .prev").fadeOut()),void 0)}}});_.Module.define({path:"comforum/widget/u9Head",requires:[],sub:{u9ItemTemplate:["<li>",'<p><a href="#{gameLink}" target="_blank" data-code="#{summary}">','<img src="#{img}"/>',"</a></p>",'<p class="summary"><a href="#{gameLink}" target="_blank">#{summary}</a></p>','<p class="clearfix">#{terminal}','<a class="code_type #{codeType}" href="#{codeLink}" target="_blank" data-code="#{summary}"></a>',"</p>","</li>"].join(""),gameItemTemplate:['<li rank-index="#{index}">','<p><a class="game_info" href="#{gameLink}" target="_blank" data-code="#{summary}">','<img src="#{img}" />','<span class="game_rank_mark game_rank_mark_#{index}"></span>','<span class="game_name">#{summary}</span>',"</a></p>",'<p class="summary"><a href="#{gameLink}" target="_blank">#{online}\u4E07\u4EBA\u5728\u73A9</a></p>','<p class="clearfix">','<a class="game_start" href="#{gameLink}" target="_blank" data-code="#{summary}">\u5F00\u59CB\u6E38\u620F</a>',"</p>","</li>"].join(""),terminalTemplate:['<span class="terminal_type_ios #{hasIos}"></span>','<span class="terminal_type_android #{hasAndroid}"></span>'].join(""),initial:function(a){this.gameName=a.game_name||"",this.gameType=a.game_type||"",this.slideData=a.slide_data||[],this.slider=3==this.gameType?$(".u9_head .u9_left .rank_content"):$(".u9_head .u9_left"),this.$wrapper=$("#com_u9_head"),this.rendeSlider(this.slideData),this.bindEvents()},bindEvents:function(){if(this.gameType){var a=this,e=0,t=this.slideData.length,i=[],n=1==this.gameType?"U9\u5B9A\u5236\u7248":"U9\u901A\u7528\u7248";if(t>0)if(3==this.gameType)for(a.gameName=this.slideData[0].gift_name,e;t>e;e++)i.push(this.slideData[e].gift_name);else for(a.gameName=this.slideData[0].summary,e;t>e;e++)i.push(this.slideData[e].summary);$.stats.track("\u5934\u90E8",n,"","view",{obj_type:"U9",obj_name:a.gameName,obj_game:i}),$(".u9_head").on("click",".u9_left a",function(){3!=a.gameType&&$.stats.track("\u793C\u5305","U9\u901A\u7528\u7248","","click",{obj_type:"U9",obj_name:$(this).data("code")})}).on("click",".u9_middle a",function(){$.stats.track("\u8D44\u8BAF","U9\u901A\u7528\u7248","","click",{obj_type:"U9"})}).on("click",".u9_right a",function(){$.stats.track("\u6D3B\u52A8","U9\u901A\u7528\u7248","","click",{obj_type:"U9"})});var r=this.$wrapper.find(".rank_wrapper h3").html();this.$wrapper.on("click",".rank_content li",function(){var a=$(this).find(".game_name").html(),e=parseInt($(this).tbattr("rank-index"));$.stats.track("\u6E38\u620F\u6392\u884C\u699C","U9\u901A\u7528\u7248","","click",{obj_rank_index:e+1,obj_game_name:a,obj_rank_name:r})})}},rendeSlider:function(a){if(a&&0!==a.length){var e=0,t=null,i=a.length,n="";for(e;i>e;e++)t=a[e],n+=this.rendeItem(t,e);this.slider.html("<ul>"+n+"</ul>"),i>5&&this.slider.jCarouselLite({visible:5,scroll:5,circular:!1,speed:500,btnNext:".game_rank_next",btnPrev:".game_rank_prev",afterEnd:$.proxy(this.pageChange,this)})}},pageChange:function(a){var e=10,t=5,i=a.eq(-1);curr=parseInt(i.tbattr("rank-index"));var n=parseInt(curr%e/t);this.$wrapper.find(".game_rank_page_wrapper .cur").removeClass("cur"),this.$wrapper.find(".game_rank_page_wrapper .game_rank_pn").eq(n).addClass("cur")},rendeItem:function(a,e){if(2==this.gameType){var t={img:a.img_url,gameLink:a.game_link,codeLink:a.code_link,summary:a.summary,codeType:1==a.get_type?"type_1":"type_2",terminal:this.getTerminal(a.terminal_type)};return $.tb.format(this.u9ItemTemplate,t)}if(3==this.gameType){var i=(a.srcimg.type_75_75,this.getOnlinePeople(a.online)),n={img:a.srcimg.type_75_75,gameLink:"/game/adtask/link?tbjump="+encodeURIComponent(a.jump_url),summary:a.name,online:i,index:e||0};return $.tb.format(this.gameItemTemplate,n)}},getOnlinePeople:function(a){var e=a+"",t=e.length,i={4:"\u5343",5:"\u4E07"};if(!i[t])return a;var n=e[0],r=e[1];return 0!=r&&(n+="."+r),n+=i[t]},getTerminal:function(a){if(-1!==$.inArray("3",a))return"";var e={hasIos:-1!==$.inArray("1",a)?"has_ios":"",hasAndroid:-1!==$.inArray("2",a)?"has_android":""};return $.tb.format(this.terminalTemplate,e)},addFrParam:function(a,e,t){var i=-1===a.indexOf("?")?"?":"&";return a+i+e+"="+t}}});_.Module.define({path:"comforum/widget/head2144",requires:["common/widget/messenger"],sub:{initial:function(e){this.$wrapper=$("#game_head_2144"),this.link=e.link||"",this.gameIframe=this.$wrapper.find("iframe"),this.initMessenger(),this.initIframe(),this.bindEvents()},initIframe:function(){this.gameIframe.tbattr("src",this.link),$.stats.track("iframe\u52A0\u8F7D","head2144_"+PageData.forum.name,"frs","show")},initMessenger:function(){var e=this.gameIframe[0].contentWindow,t=this.requireInstance("common/widget/messenger",["tiebaIframe","tieba2144Head"]);t.addTarget(e,"gameIframe");var i=this.getMessengerWhitelist();t.registerOrigin(i),this.messenger=t,this.messenger.registerCommand({comforum_load_error:$.proxy(this.errorHandle,this)})},getMessengerWhitelist:function(){var e=0,t=[],i=PageUnit.load("head2144_whitelist"),r=i.length;for(e;r>e;e++)t.push(i[e][0]);return t=t.length?t:["http://lol.5sha.com"]},errorHandle:function(){var e=this;e.$wrapper.hide(),$.stats.track("iframe\u52A0\u8F7D_\u5931\u8D25","head2144_"+PageData.forum.name,"frs","show",{obj_url:e.link})},bindEvents:function(){}}});_.Module.define({path:"comforum/widget/LotteryTrends",require:[],sub:{initial:function(t){this.$wrapper=$("#lottery_trends_wrapper"),this.$detailWrapper=this.$wrapper.find(".trends_detail_wrapper"),this.matchId=t.matchId||!1,this._initIframe(),this._bindEvent(),$.stats.track("\u5C55\u793A","\u767E\u5EA6\u9884\u6D4B\u5F69\u7968_\u5427\u5934\u90E8","","view",{})},_initIframe:function(){var t=this.$detailWrapper.find("iframe"),i=this.matchId;i&&setTimeout(function(){t.tbattr("src","http://trends.baidu.com/football/matchInfo?matchId="+i)},1)},_bindEvent:function(){var t=this;this.$wrapper.on("click",".trends_analytic",function(){t._detailToggle()}).on("click",".bet_now",function(){$.stats.track("\u9A6C\u4E0A\u4E0B\u6CE8","\u767E\u5EA6\u9884\u6D4B\u5F69\u7968_\u5427\u5934\u90E8","","click",{})})},_detailShow:function(){this.$detailWrapper.slideDown()},_detailHide:function(){this.$detailWrapper.slideUp()},_detailToggle:function(){"none"==this.$detailWrapper.css("display")?(this.$detailWrapper.slideDown(),$.stats.track("\u9884\u6D4B\u89E3\u6790_\u6253\u5F00","\u767E\u5EA6\u9884\u6D4B\u5F69\u7968_\u5427\u5934\u90E8","","click",{})):(this.$detailWrapper.slideUp(),$.stats.track("\u9884\u6D4B\u89E3\u6790_\u5173\u95ED","\u767E\u5EA6\u9884\u6D4B\u5F69\u7968_\u5427\u5934\u90E8","","click",{})),this.$wrapper.find(".up_icon").toggle(),this.$wrapper.find(".down_icon").toggle()}}});_.Module.define({path:"comforum/widget/duokuServersHead",requires:["common/widget/tbcopy","comforum/widget/duokuServersDialog","comforum/widget/duokuServersSlider"],sub:{locateMap:{running:"p0115",testing:"p0116"},initial:function(t){this.serverTime=1e3*t.serverTime,this.redirectUrl=t.redirectUrl,this.$wrapper=$("#duoku_servers_head");var e=this;this._loader().done(function(t){e._render(t.data),e._bindEvents(),e.dialog=e.requireInstance("comforum/widget/duokuServersDialog"),e.slider=e.requireInstance("comforum/widget/duokuServersSlider",{data:$.getPageData("data",{},t)})}).fail(function(){e.$wrapper.hide()})},_formatRedirectUrl:function(t,e){for(var a=t.split("?"),r=a[0],i=a[1].split("&"),n={},d=[],o=0,s=i.length;s>o;o++){var _=i[o],h=_.split("=")[0],c=_.split("=")[1];n[h]=c}n._t=+new Date,e&&(delete n.client_type,delete n.refer,delete n.url,delete n.url,delete n.fid,delete n.fname,delete n.page,delete n.type,delete n.ie);for(var l in n)n.hasOwnProperty(l)&&n[l]&&d.push(l+"="+n[l]);return["http://",$.tb.location.getHost(),r,"?",d.join("&")].join("")},_loader:function(){var t="/game/duoku/getForumTopGames?timestamp="+(new Date).getTime(),e=$.getJSON(t);return e},_render:function(t){this.data=t,this._renderWrap(t),this.data.testing&&0!=this.data.testing.length||!this.data.running?this._showTabC("testing"):this._showTabC("running")},_getTpl:function(t){return $("#duoku_servers_head_"+t).html()},_renderWrap:function(t){if(t=t||{},t.hasOwnProperty("running")&&t.hasOwnProperty("testing")){var e="";e+=this._renderTabC(t,"running"),e+=this._renderTabC(t,"testing"),this.$wrapper.find(".j_dsh_tabCs").html(e),$("body").append(this._getTpl("game_qrcode"))}else this.$wrapper.hide()},_renderTabC:function(t,e){t=t||{};var a="",r=t[e],i=!0;for(var n in r)r.hasOwnProperty(n)&&(i=!1);return a=i?$.tb.format(this._getTpl("tabC_blank"),{tab_name:e,cnt:this._getTpl("tabC_blank_cnt")}):$.tb.format(this._getTpl("tabC"),{tab_name:e,time_list:this._renderTimeList(r,e),game_list:this._renderGameList(r,e)})},_renderTimeList:function(t,e){var a="",r=this._getTodayString();for(var i in t)t.hasOwnProperty(i)&&(a+=$.tb.format(this._getTpl("time"),{game_date_label:i==r?"\u4ECA\u5929":this._formatDateString(i),time:i,tab_name:e}));return a},_renderGameList:function(t,e){var a="",r=this._getTodayString();for(var i in t)t.hasOwnProperty(i)&&(a+=$.tb.format(this._getTpl("game_list"),{game_date_label:i==r?"\u4ECA\u5929":this._formatDateString(i),time:i,tab_name:e,games:this._renderGames(t[i],e)}));return a},_renderGames:function(t,e){var a="",r=t.length;if(0==r)a=this._getTpl("tabC_blank_cnt");else for(var i=0;r>i;i++){var n=t[i];n.url||(n.url="javascript:"),"testing"==e&&(n.kaifu_name=n.test_type),n.qrcode_url=this.getRedirectUrl(n.redirect_url,"qr_code","download",n.game_name,n.game_id,!0),n.button_url=this.getRedirectUrl(n.redirect_url,"button","download",n.game_name,n.game_id);var d="-1"==n.download_url;a+=$.tb.format(this._getTpl("game"),$.extend(n,{button_url:d?n.thread_url:n.download_url,download_text:d?"\u4E86\u89E3\u8BE6\u60C5":"\u7ACB\u5373\u4E0B\u8F7D",app_size_formated:(n.app_size/1024/1024).toFixed(2)+"MB",dsh_opt_status:n.check_code||n.gift_code?"":"standard",apply_text:n.applied?"\u5DF2\u9886\u53D6":n.not_available?"\u5E93\u5B58\u544A\u6025":n.check_code?"\u83B7\u53D6\u8D44\u683C":n.gift_code?"\u9886\u53D6\u793C\u5305":"\u7ACB\u5373\u4E0B\u8F7D",index:i}))}return a},getRedirectUrl:function(t,e,a,r,i,n){var d=[this._formatRedirectUrl(this.redirectUrl,n),"location=p0012","obj_ref=3000601","obj_id="+i,"obj_name="+encodeURIComponent(r),"type="+a,"tbjump="+encodeURIComponent(t),"loc_param="+e].join("&");return d},_formatDateString:function(t){var e=t;return t=t.split("-"),3==t.length&&(e="",e+=t[1]+"\u6708"+t[2]+"\u65E5"),e},_getTodayString:function(){var t=new Date(this.serverTime),e=t.getFullYear(),a=t.getMonth()+1,r=t.getDate();return a=(10>a?"0":"")+a,r=(10>r?"0":"")+r,[e,a,r].join("-")},_showTabC:function(t,e){this.currentTabName=t,this.$wrapper.find(".dsh_tabT").removeClass("act"),this.$wrapper.find('.dsh_tabT[data-to="'+t+'"]').addClass("act"),this.$wrapper.find(".dsh_tabC").hide(),$("#dsh_tabC_"+t).show(),this._showDateTabC(t,e)},_showDateTabC:function(t,e){var a=this._getTodayString();e||(e=a);var r=this.data[t];if(r){if(!r.hasOwnProperty(e)){var i=[];for(var n in r)r.hasOwnProperty(n)&&i.push(n);for(var d,o=i.length,s=o;s>0&&i[s-1]>a;s--)d=i[s-1];e=void 0!==d?d:i[o-1]}this.currentDate=e,$("#dsh_tabC_"+t).find(".dsh_time").removeClass("act"),$("#dsh_tabC_"+t).find('.dsh_time[data-to="'+e+'"]').addClass("act"),this._showGameList(t,e)}},_showGameList:function(t,e){$("#dsh_tabC_"+t).find(".dsh_game_list").hide(),$("#dsh_game_list_"+t+"_"+e).show(),this._initSlider(t,e)},_initSlider:function(t,e){var a=$("#dsh_game_list_"+t+"_"+e),r="true"==a.tbattr("data-slider-init"),i=a.find(".dsh_game").length;if(i>5){var n,d;r?(n=a.find(".j_dsh_timeline_cnt_wrap").data("start"),d=a.find(".j_dsh_timeline_cnt_wrap").data("end"),this._slideTrack(n,d)):(a.find(".j_dsh_timeline_cnt_wrap").jCarouselLite({btnPrev:"#dsh_game_list_"+t+"_"+e+" .j_dsh_timeline_cnt_btn_prev",btnNext:"#dsh_game_list_"+t+"_"+e+" .j_dsh_timeline_cnt_btn_next",circular:!1,visible:5,afterEnd:$.proxy(this._pageChange,this)}),$("#dsh_game_list_"+t+"_"+e+" .j_dsh_timeline_cnt_btn_prev").hide(),$("#dsh_game_list_"+t+"_"+e+" .dsh_timeline_cnt_btns").show(),a.tbattr("data-slider-init","true"),n=0,d=4,a.find(".j_dsh_timeline_cnt_wrap").tbattr("data-start",n),a.find(".j_dsh_timeline_cnt_wrap").tbattr("data-end",d),this._slideTrack(n,d))}else this._slideTrack(0,i-1)},_pageChange:function(t){var e=Array.prototype.slice.call(t),a=e.length,r=$(e[0]).data("index"),i=$(e[a-1]).data("index"),n=this.data[this.currentTabName][this.currentDate].length-1,d=$(t.context).next(),o=d.find(".j_dsh_timeline_cnt_btn_prev"),s=d.find(".j_dsh_timeline_cnt_btn_next");$(t.context).tbattr("data-start",r),$(t.context).tbattr("data-end",i),0==r?o.hide():o.show(),i==n?s.hide():s.show(),this._slideTrack(r,i)},_slideTrack:function(t,e){var a=this._getGameListSlice(t,e);this._postTrack("","",{obj_id:a.ids.join(","),obj_name:a.names.join(",")},"view")},_getGameListSlice:function(t,e){var a={ids:[],names:[]},r=this.data[this.currentTabName][this.currentDate];t=void 0==t?0:t,e=void 0==e?r.length:e;for(var i=t,n=e;n>=i;i++){var d=r[i];a.ids.push(d.game_id),a.names.push(d.game_name)}return a},_getQrcode:function(t,e,a,r){$.JsLoadManager.use("http://tb1.bdstatic.com/tb/static-comforum/qrcode_f84ab06.js",function(){new window.QRCode(t,{text:e,width:a||80,height:r||80})})},_bindEvents:function(){var t=this;t.$wrapper.on("click",".dsh_tabT",function(){var e=$(this).data("to");return t._showTabC(e),!1}),t.$wrapper.on("click",".dsh_time",function(){var e=$(this).data("to");return t._showDateTabC(t.currentTabName,e),!1}),t.$wrapper.on("mouseenter",".j_dsh_btn_download",function(){clearTimeout(t.qrcodeCloseTimeout)}),$(".j_dsh_game_qrcode").on("mouseenter",function(){clearTimeout(t.qrcodeCloseTimeout)}),t.$wrapper.on("mouseleave",".j_dsh_btn_download",$.proxy(t._timeoutCloseQrcode,t)),$(".j_dsh_game_qrcode").on("mouseleave",$.proxy(t._timeoutCloseQrcode,t)),t.$wrapper.on("mouseenter",".j_dsh_btn_download",$.proxy(t._showQrcode,t)),t.$wrapper.on("click",".j_dsh_btn_apply",$.proxy(t._getGameCode,t)),t.$wrapper.on("click",".j_dsh_btn_download",$.proxy(t._onDownloadBtnClick,t))},_onDownloadBtnClick:function(t){var e=this,a=$(t.currentTarget).closest(".dsh_game").tbattr("data-index"),r=e.data[e.currentTabName][e.currentDate][a];e._postTrack("",r,"","download")},_getGameCode:function(t){var e=this,a=$(t.currentTarget).closest(".dsh_game").tbattr("data-index"),r=e.data[e.currentTabName][e.currentDate][a];e.dialog.showDialog({tbs:PageData.tbs,game:r,postTrack:$.proxy(e._postTrack,e),src:"head"})},_showQrcode:function(t){var e=this,a=$(t.currentTarget),r=a.offset(),i=a.width(),n=$(t.currentTarget).closest(".dsh_game").tbattr("data-index"),d=e.data[e.currentTabName][e.currentDate][n],o=d.download_url;"-1"!=o&&($(".j_dsh_game_qrcode").css({left:r.left+i/2,top:r.top}).show(),$(".j_dsh_game_qrcode").find(".j_dsh_game_qrcode_img").html(""),e._getQrcode($(".j_dsh_game_qrcode").find(".j_dsh_game_qrcode_img")[0],o,150,150))},_timeoutCloseQrcode:function(){var t=this;t.qrcodeCloseTimeout=setTimeout(function(){$(".j_dsh_game_qrcode").hide()},100)},_postTrack:function(t,e,a,r){t||(t=this.locateMap[this.currentTabName]),"undefined"==typeof r&&(r="click"),a=a||{},a=$.extend({obj_ref:3000601},a),e&&(a=$.extend({obj_name:e.game_name,obj_id:e.game_id},a)),$.stats.track(t,"mg_pioneerba","",r,a)}}});_.Module.define({path:"comforum/widget/duoku_servers_card",requires:[],sub:{initial:function(){}}});_.Module.define({path:"adsense/widget/tpl_4",requires:[],sub:{initial:function(e){var t=this;this.requireInstanceAsync("adsense/widget/loader",[],function(n){n.loadAD(e,t.extraParam,$.proxy(t.customFn,t))})},customFn:function(e){var t=e.nextAll(".j_thread_list").eq(0).find(".j_reply_data").html()||"";e.find(".j_reply_data").html(t)}}});_.Module.define({path:"adsense/widget/tpl_3",requires:[],sub:{initial:function(e){var t=this;this.requireInstanceAsync("adsense/widget/loader",[],function(n){n.loadAD(e,t.extraParam,$.proxy(t.customFn,t))})},customFn:function(e){var t=e.nextAll(".j_thread_list").eq(0).find(".j_reply_data").html()||"";e.find(".j_reply_data").html(t)}}});_.Module.define({path:"adsense/widget/tpl_9",requires:[],sub:{initial:function(t){var a=this;this.opt=t,this.requireInstanceAsync("adsense/widget/loader",[],function(e){e.loadAD(t,a.extraParam,$.proxy(a.customFn,a))}),this.adid=$.getPageData("adData.id","",t)},customFn:function(t){var a=this,e=t.find(".hover_btn"),s=t.find(".close_btn"),i=$.tb.unescapeHTML(e.tbattr("src")),n=e.data("hover");e.mouseover(function(){$(this).tbattr("src",n)}).mouseout(function(){$(this).tbattr("src",i)}),s.click(function(){$.post("/adsense/addUserMask",{user_id:$.getPageData("user.user_id","")||$.getPageData("user.id",""),advertid:a.adid||""},function(t){0===t.errno},"json"),$(this).parent().hide()}),this.closeAdTrack(a.opt,t)},closeAdTrack:function(t,a){var e=this,s=t.adData||{},i=a.find(".j_click_close");i.on("click",function(){var t=$(this);e.requireInstanceAsync("adsense/widget/loader",[],function(a){var e=a._getStatsParams(s),i=t.data("locate")?"_"+t.data("locate"):"",n=s.pos_name+i;a._track($.extend({},e,{locate:n,da_locate:n,type:"click",da_type:"click"}))})})}}});_.Module.define({path:"adsense/widget/tpl_11",requires:[],sub:{initial:function(e){var n=this;this.requireInstanceAsync("adsense/widget/loader",[],function(s){s.loadAD(e,n.extraParam,$.proxy(n.customFn,n))})},customFn:function(){"pass"}}});
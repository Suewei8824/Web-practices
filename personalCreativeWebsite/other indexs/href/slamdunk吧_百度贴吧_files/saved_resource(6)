_.Module.define({path:"encourage/widget/globalNotice",requires:["encourage/widget/globalMessage/barrage"],sub:{intervalId:null,waitToRollList:[],showedFireworkMap:{},pkgIds:[],viewTotalNum:0,fireworkOptions:{},messageTplMap:{1e4:['<div class="global_notice_unit">','<a  href="#{href}" target="_blank">','#{user_name}\u6B63\u5728<span class="forum_name">[#{forum_name}\u5427]</span>\u653E#{item}\uFF0C','  \u6389\u843D<span class="tdou_num">#{scores}</span><i class="global_message_tdou_icon"></i>','<span class="get_firework_icon"></span></a>',"</div>"].join(""),10001:['<div class="global_notice_unit">','<a  href="#{href}" target="_blank">','#{user_name}\u5728<span class="forum_name">[#{forum_name}\u5427]</span>','\u6361\u5230<span class="tdou_num">#{scores}</span><i class="global_message_tdou_icon"></i>',"</a>","</div>"].join(""),10002:['<div class="global_notice_unit">','<a  href="/f?kw=t%E8%B1%86%E5%A8%B1%E4%B9%90%E5%9F%8E&ie=utf-8" target="_blank">','#{user_name}\u5728<span class="forum_name">[#{game_name}]</span>\u6E38\u620F\u4E2D\u5927\u80DC\uFF0C','\u8D62\u53D6\u4E86<span class="tdou_num">#{scores}</span><i class="global_message_tdou_icon"></i>',"</a>","</div>"].join(""),10003:['<div class="global_notice_unit">','<a  href="/f?kw=#{forum_name}&ie=utf-8" target="_blank">','#{user_name}\u5728<span class="forum_name">[#{forum_name}\u5427]</span>','\u53D1\u5E03<span class="tdou_num">#{scores}</span><i class="global_message_tdou_icon"></i>',"\u7684\u3010#{bonus_name}\u3011\u7EA2\u5305#{bonus_num}\u4E2A","</a>","</div>"].join(""),10004:['<div class="global_notice_unit">','<a  href="http://spread.xiu8.com/spreed!baiduGo.jspa?pid=1072&sid=104&t=2&roomId=#{live_id}" target="_blank">','<span class="forum_name">#{user_name}</span>\u699C\u4E0A\u6709\u540D\uFF0C\u4E00\u63B7\u5343\u91D1\u5E7F\u53D1T\u8C46\u3001\u798F\u888B\uFF01','<span class="get_firework_icon"></span></a>',"</a>","</div>"].join(""),10005:['<div class="global_notice_unit">','<a href="/f?kw=#{forum_name}&ie=utf-8" target="_blank">','<span class="forum_name">[#{forum_name}\u5427]</span>','\u53D1\u5E03<span class="tdou_num">#{bonus_num}</span>\u4E2A',"\u73B0\u91D1\u7EA2\u5305","</a>","</div>"].join("")},statusTplMap:['<div id="firework_status" class="firework_status_wrap">','<div class="user_info">','<div class="photo">','<img src="http://tb.himg.baidu.com/sys/portrait/item/#{portrait}" width="72" height="72" />',"</div>",'<div class="name_and_tdou">','<p class="name">#{user_name}</p>','<p class="tdou">','<i class="icon_tdou"></i>','<span class="j_user_scores">#{user_scores}</span>','<a href="javascript:;" class="j_buy_tdou"> [\u83B7\u53D6]</a>',"</p>","</div>","</div>",'<div class="firework_info">','<p>\u60A8\u7684#{item}\u5DF2\u88AB<span class="orange_text j_view_num">0</span>\u4EBA\u770B\u5230 \u5171\u6709<span class="orange_text j_user_num">0</span>\u4EBA\u5230\u8FBE\u672C\u5427</p>','<p>\u60A8\u4F4D\u4E8E#{item}\u8FBE\u4EBA\u699C\u7B2C<span class="orange_text">#{rank}</span>\u4F4D</p>',"</div>",'<div class="firework_operate">','<a href="javascript:;" class="btn_repeat j_btn_repeat"></a>',"</div>",'<a href="javascript:;" class="btn_close j_close"></a>',"</div>"].join(""),initial:function(){var e=this,a=PageUnit.load("firework_dialog_options"),t=a.split("|");this.fireworkOptions={width:t[0],height:t[1],item:t[2]},this.$notice=$("#global_notice_wrap"),this.barrage=this.requireInstance("encourage/widget/globalMessage/barrage"),this.barrage.init(this.$notice,{speed:2,foldSpeed:15,unfoldSpeed:10,rowCount:1,rowHeight:50,scrollElementMaxLength:100,elementMarginLeft:20,containerWidth:988,containerMarginLeft:-498}),this.startPolling(),window.jsonpGlobalMessageHandler=function(e){return function(a){e.globalMessageHandler(a)}}(this),this.observe("firework.global_notice",function(a,t){var s=e.buildMessage(t);s&&e.showMessageBar($(s)),e.showFireworkStatus(t)}),this.$notice.on("click",function(){var e=$(this).data("type");$.stats.track("\u5168\u5C40\u516C\u544A\u533A\u57DF\u70B9\u51FB\u91CF_"+e,"firework_activity")}),this.observe("firework.global_preview",function(){e.previewFireworkStatus()}),this.observe("firework.global_preview_close",function(){e.previewFireworkStatusClose()})},startPolling:function(){var e=this;$(document).idleTimer(6e4),$(document).on("idle.idleTimer",function(){e.pausePolling()}),$(document).on("active.idleTimer",function(){e.polling()}),e.$notice.on("mouseenter",function(){e.barrage.pause()}).on("mouseleave",function(){e.barrage.resume()}),e.polling()},polling:function(){this.intervalId&&clearInterval(this.intervalId),this.intervalId=setInterval(function(){$.getScript("http://tbmsg.baidu.com/gmessage/get?mtype=1")},1e4)},pausePolling:function(){this.intervalId&&clearInterval(this.intervalId)},globalMessageHandler:function(e){var a=$.tb.Storage.get("global_message_cid"),t=0,s=this;if($.isArray(e)){for(var i=0,n=e.length;n>i;i++)e[i].msg_id=+e[i].msg_id,a<e[i].msg_id&&(t=t>e[i].msg_id?t:e[i].msg_id,s.handleSingleMessage(e[i]));t>a&&$.tb.Storage.set("global_message_cid",t,+new Date+31536e6)}},handleSingleMessage:function(e){var a=+new Date;1e3*e.end_time>a&&this.buildMessage(e.msg_body)},buildMessage:function(e){function a(e){var a="";return a="undefined"==typeof e.location_type?"javascript:void(0);":0==e.location_type?"/f?kw="+encodeURIComponent(e.forum_name):"/p/"+e.location_id}function t(e){if(e>9999){var a=e%1e4!==0?(e/1e4).toFixed(1):e/1e4;return a+"\u4E07"}return e}var s=+new Date,i=this,n=this.messageTplMap[e.msg_type];if(e.scores=t(e.scores),n){if(e.end_time&&1e3*e.end_time<s)return;if(1e4==e.msg_type){if(i.showedFireworkMap[e.package_id])return;i.showedFireworkMap[e.package_id]=1,this.fire("play.firework",e)}else if(10001==e.msg_type)this.fire("get.firework",e);else if(10002==e.msg_type&&1!=PageUnit.load("global_notice_game_switch"))return;this.$notice.data("type",e.msg_type),this.showMessageBar($($.tb.format(n,$.extend(e,{href:a(e)},this.fireworkOptions))))}},showMessageBar:function(e){this.barrage.addMessage(e)},previewFireworkStatus:function(){var e=$("#firework_status");if(0==e.length){var a=$.tb.format(this.statusTplMap,$.extend({portrait:PageData.user.portrait,user_name:PageData.user.user_name,user_scores:PageData.user.Parr_scores&&PageData.user.Parr_scores.scores_total||0,rank:1},this.fireworkOptions));e=$(a).insertAfter(this.$notice)}e.find(".j_view_num").text(9321332),e.find(".j_user_num").text(2321301),e.animate({bottom:0});var t={forum_name:PageData.forum.forum_name,location_id:"frs"===PageData.product?PageData.forum.forum_id:PageData.thread.thread_id,location_type:"frs"===PageData.product?0:1,scores:"5\u4E07",user_name:PageData.user.user_name,portrait:PageData.user.portrait,msg_type:1e4},s=this.messageTplMap[t.msg_type];this.showMessageBar($($.tb.format(s,$.extend(t,this.fireworkOptions))))},previewFireworkStatusClose:function(){var e=$("#firework_status");e.length>0&&e.remove()},showFireworkStatus:function(e){this.pkgIds.push(e.package_id);var a=this,t=$("#firework_status");if(0==t.length){var s=$.tb.format(this.statusTplMap,$.extend(e,this.fireworkOptions));t=$(s).insertAfter(this.$notice),t.find(".j_close").on("click",function(){t.animate({height:0},300,function(){t.remove(),a.pkgIds.length=0})}),t.find(".j_btn_repeat").on("click",function(){a.fire("buy.firework")}),t.find(".j_buy_tdou").on("click",function(){a.requireInstanceAsync("common/widget/tcharge_dialog")})}else t.find(".j_user_scores").text(e.user_scores);t.animate({bottom:0}),this.increaseViewNum(t.find(".j_view_num"),this.viewTotalNum,this.viewTotalNum+=e.view),this.pollingVisitNum(t.find(".j_user_num"),this.pkgIds.length)},pollingVisitNum:function(e,a){var t=this,s=0,i=function(){s>30||t.pkgIds.length>a||setTimeout(function(){$.post("/tbmall/submit/giftpkg/getView",{pids:t.pkgIds.toString()},function(a){0==a.no&&e.text(a.data.uv)}),s++,i()},1e3)};i()},increaseViewNum:function(e,a,t){var s=this,i=function(a,i){var n=s.easeOutQuint(a,i,t,3e4);e.text(parseInt(n,10))},n=0,o=function(){n>30||s.viewTotalNum>t||setTimeout(function(){n++,i(1e3*n,a),o()},1e3)};o()},easeOutQuint:function(e,a,t,s){return e/=s,e--,t*(e*e*e*e*e+1)+a}}});
;!function(e){e.idleTimer=function(i,t){var n,r=function(){var e,i=function(e,i){return""!==e?e+i.slice(0,1).toUpperCase()+i.slice(1):i},t=function(){var t=!1;return"number"==typeof window.screenX&&["webkit","moz","ms","o",""].forEach(function(n){0==t&&void 0!=document[i(n,"hidden")]&&(e=n,t=!0)}),t}(),n=function(){return t?document[i(e,"hidden")]:void 0},r=function(){return t?document[i(e,"visibilityState")]:void 0};return{hidden:n(),visibilityState:r(),visibilitychange:function(i,d){return d=!1,t&&"function"==typeof i?document.addEventListener(e+"visibilitychange",function(e){this.hidden=n(),this.visibilityState=r(),i.call(this,e)}.bind(this),d):void 0}}}(void 0);"object"==typeof i?(n=i,i=null):"number"==typeof i&&(n={timeout:i},i=null),t=t||document,n=e.extend({idle:!1,timeout:3e4,events:"mousemove keydown wheel DOMMouseScroll mousewheel mousedown touchstart touchmove MSPointerDown MSPointerMove"},n);var d=e(t),u=d.data("idleTimerObj")||{},a=function(i){var n=e.data(t,"idleTimerObj")||{};n.idle=!n.idle,n.olddate=+new Date;var r=e.Event((n.idle?"idle":"active")+".idleTimer");e(t).trigger(r,[t,e.extend({},n),i])},l=function(i){var n=e.data(t,"idleTimerObj")||{};if(null==n.remaining){if("mousemove"===i.type){if(i.pageX===n.pageX&&i.pageY===n.pageY)return;if("undefined"==typeof i.pageX&&"undefined"==typeof i.pageY)return;var r=+new Date-n.olddate;if(200>r)return}clearTimeout(n.tId),n.idle&&a(i),n.lastActive=+new Date,n.pageX=i.pageX,n.pageY=i.pageY,n.tId=setTimeout(a,n.timeout)}},o=function(){var i=e.data(t,"idleTimerObj")||{};i.idle=i.idleBackup,i.olddate=+new Date,i.lastActive=i.olddate,i.remaining=null,clearTimeout(i.tId),i.idle||(i.tId=setTimeout(a,i.timeout))},m=function(){var i=e.data(t,"idleTimerObj")||{};null==i.remaining&&(i.remaining=i.timeout-(+new Date-i.olddate),clearTimeout(i.tId))},f=function(){var i=e.data(t,"idleTimerObj")||{};null!=i.remaining&&(i.idle||(i.tId=setTimeout(a,i.remaining)),i.remaining=null)},c=function(){var i=e.data(t,"idleTimerObj")||{};clearTimeout(i.tId),d.removeData("idleTimerObj"),d.off("._idleTimer")},s=function(){var i=e.data(t,"idleTimerObj")||{};if(i.idle)return 0;if(null!=i.remaining)return i.remaining;var n=i.timeout-(+new Date-i.lastActive);return 0>n&&(n=0),n};if(null===i&&"undefined"!=typeof u.idle)return o(),d;if(null===i);else{if(null!==i&&"undefined"==typeof u.idle)return!1;if("destroy"===i)return c(),d;if("pause"===i)return m(),d;if("resume"===i)return f(),d;if("reset"===i)return o(),d;if("getRemainingTime"===i)return s();if("getElapsedTime"===i)return+new Date-u.olddate;if("getLastActiveTime"===i)return u.lastActive;if("isIdle"===i)return u.idle}return"undefined"!=typeof r.hidden?r.visibilitychange(function(){a()}):(d.on(e.trim((n.events+" ").split(" ").join("._idleTimer ")),function(e){l(e)}),u.idle||(u.tId=setTimeout(a,u.timeout))),u=e.extend({},{olddate:+new Date,lastActive:+new Date,idle:n.idle,idleBackup:n.idle,timeout:n.timeout,remaining:null,tId:null,pageX:null,pageY:null}),e.data(t,"idleTimerObj",u),d},e.fn.idleTimer=function(i){return this[0]?e.idleTimer(i,this[0]):this}}(jQuery);
;_.Module.define({path:"encourage/widget/globalMessage/barrage",requires:[],sub:{isInit:!1,initial:function(){if(!this.isInit){window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)},window.cancelAnimationFrame=window.cancelAnimationFrame||window.clearTimeout,this.isInit=!0;var t=function(){function t(t,i){t&&(p=$.extend(p,i),c=t,w=0==c.width(),c.html(""),m=[],f=[],u=0)}function i(){for(var t=0;t<p.rowCount;t++){var i=new l;f.push(i),c.append(i.$row)}}function e(){f=[],c.html("")}function n(t){m.push(t),d||h()}function r(){g=!0}function s(){g=!1,d||h()}function o(){if(c.width()>=p.containerWidth)w=!1,i();else{var t=c.width(),e=parseFloat(c.css("marginLeft"));t+=p.unfoldSpeed||p.speed,e-=p.unfoldSpeed||p.speed,c.css({width:t,marginLeft:e})}}function a(){w=!0,e(),c.fadeOut("normal",function(){var t=parseFloat(c.css("marginLeft"))+c.width();c.css({display:"block",width:0,marginLeft:t})})}function h(){if(g)return cancelAnimationFrame(d),d=null,void 0;var t=m.length;if(!u&&!t){if(w)return cancelAnimationFrame(d),d=null,void 0;a()}if((u||t)&&w)o();else{if(u<=p.scrollElementMaxLength&&t){var i=m.shift(),e=Math.round(Math.random()*(p.rowCount-1));f[e].add(i),u+=1}$.each(f,function(t,i){i.scroll()})}d=requestAnimationFrame(h)}function l(){this.$row=$("<div></div>"),this.scrollElementArr=[],this.containerWidth=c.width(),this.marginLeft=this.width=this.containerWidth,this.$row.css({"margin-left":this.marginLeft,height:p.rowHeight,width:this.width,position:"relative"})}var d,c,m=[],f=[],u=0,w=!0,g=!1,p={speed:5,rowCount:1,rowHeight:20,scrollElementMaxLength:30,elementMarginLeft:20,containerWidth:988,containerMarginLeft:-498};return l.prototype={add:function(t){var i=this.scrollElementArr[this.scrollElementArr.length-1],e=p.elementMarginLeft,n=this.containerWidth-this.marginLeft+e;if(i){var r=i.position(),s=i.outerWidth(!0),o=this.containerWidth-r.left-s-this.marginLeft;n=o>e?o:e}t.css({display:"inline-block","margin-left":n}),this.$row.append(t),this.width+=t.outerWidth(!0),this.$row.css({width:this.width}),this.scrollElementArr.push(t)},shift:function(){if(this.scrollElementArr.length){var t=this.scrollElementArr.shift(),i=t.outerWidth(!0);t.remove(),t=null,u-=1,this.scrollElementArr.length?(this.width-=i,this.marginLeft+=i):(this.width=this.containerWidth,this.marginLeft=0),this.$row.css({width:this.width,"margin-left":this.marginLeft})}},scroll:function(){this.scrollElementArr.length&&(this.checkElementScrollEdge(),this.marginLeft-=p.speed,this.$row.css({"margin-left":this.marginLeft}))},checkElementScrollEdge:function(){if(this.marginLeft<0){var t=this.scrollElementArr[0],i=t.outerWidth(!0);i+this.marginLeft<=0&&this.shift()}}},{init:t,addMessage:n,pause:r,resume:s}}();$.extend(this,t)}}}});_.Module.define({path:"liveshow/widget/xiu8FollowWarn",requires:["frs/widget/forum_card/focus_btn"],sub:{initial:function(e){var t=this;t.forum_name=e.forum_name||"\u79C0",this.$el=$("#xiu8_follow_warn"),this.bindEvents()},bindEvents:function(){var e=this;this.$el.on("click",".j_xiu8_follow_warn_close",function(t){t.preventDefault(),e.$el.remove(),$.stats.track("\u5173\u95ED\u6309\u94AE",e.forum_name+"\u5427\u573A\u666F\u8499\u7248")}).on("click",".j_xiu8_follow_btn",function(t){t.preventDefault(),e.requireInstance("frs/widget/forum_card/focus_btn",[{tbs:PageData.user.tbs,uid:PageData.user.user_id}])._dolike(),$.stats.track("\u5173\u6CE8\u6309\u94AE",e.forum_name+"\u5427\u573A\u666F\u8499\u7248"),e.$el.remove()})}}});_.Module.define({path:"frs/widget/forum_card/focus_btn",requires:["comforum/widget/attentionCategoryGame"],sub:{initial:function(t){try{this.isOfficial=t.isOfficial,this.tbs=t.tbs,this.uid=t.uid,this.is_forum_fourth_manager=t.is_forum_fourth_manager,this.avatar=t.avatar,this.userForumList=t.userForumList||"",this.forum_name="",t.fr&&"bawu"==t.fr&&(this.forum_name=$.tb.unescapeHTML(t.forum_name));var e=this,a=$("#j_head_focus_btn"),o=null;e.config={},e.config.url={closetip:"/f/like/commit/notice/delete",dolike:"/f/like/commit/add",undolike:"/f/like/commit/delete"},o=parseInt(t.islike)?function(){if(PageData.user.power&&PageData.user.power.bawu)return e._showAlert('<p style="text-align: center;">\u60A8\u8FD8\u662F\u672C\u5427\u7684\u5427\u52A1\uFF0C\u8F9E\u804C\u540E\u624D\u80FD\u53D6\u6D88\u5173\u6CE8\u54E6~</p>'),!1;var t=PageData.forum_name||PageData.forum.forum_name;t=$.tb.subByte(t,10,"...");var a=['<div style="width:190px;text-align:center;top:18px;left:10px;position:absolute;">\u786E\u5B9A\u4E0D\u518D\u5173\u6CE8 <span style="color:red">'+t+"</span> \u5427\uFF1F</div>",'<a href="#" id="cancel_focus_yes" class=" ui_btn ui_btn_s" style="position:absolute;top:50px;left:55px;">',"<span><em>\u786E\u8BA4</em></span>","</a>",'<a href="#" onclick="return false;" id="cancel_focus_no" class="ui_btn ui_btn_sub_s" style="position:absolute;top:50px;left:105px;">',"<span><em>\u53D6\u6D88</em></span>","</a>"].join(""),o=new $.dialog({html:a,showTitle:!1,fixed:!1,show:!0,draggable:!1,autoCenter:!1,modal:!1,top:$("#j_head_focus_btn").offset().top-$(this).height()/2-90,left:$("#j_head_focus_btn").offset().left-$(this).width()/2+15,width:210,height:70});$("#cancel_focus_yes").on("click",function(){try{e._undolike(),o.close()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:82}),t}}),$("#cancel_focus_no").on("click",function(){try{o.close()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:85}),t}})}:function(){e._dolike()},a.on("click",o),$(".j_search_post ").click(function(){try{$.stats.track("FRS\u5168\u5427\u641C\u7D22","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:95}),t}}),$(".search_internal_btn").click(function(){try{$.stats.track("FRS\u5427\u5185\u641C\u7D22","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:98}),t}}),$(".sign_title_text_bright").click(function(){try{$.stats.track("FRS\u7B7E\u5230\u5E7F\u544A","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:101}),t}}),$(".j_nav_list > li:eq(2) a").click(function(){try{$.stats.track("FRS\u7B7E\u5230\u5E7F\u544A","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:104}),t}})}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:105}),i}},_showAlert:function(t){var e='<div style="padding:20px 20px; text-align:cente; line-height:20px;font-size:13px;">'+t+"</div>";$.dialog.open(e,{title:"\u64CD\u4F5C\u5931\u8D25",width:380})},_dolike:function(){var t=this;if(!PageData.user.is_login)return TbCom.process("User","buildLoginFrame"),!1;if(PageData.user.is_login&&PageData.user.no_un)return TbCom.process("User","buildUnameFrame","\u586B\u5199\u7528\u6237\u540D","\u6709\u7528\u6237\u540D\u624D\u80FD\u70B9\u4EAE\u201C\u6211\u559C\u6B22\u201D\uFF0C\u8D76\u5FEB\u7ED9\u81EA\u5DF1\u8D77\u4E00\u4E2A\u5427~"),!1;var e={};1==$.tb.location.getSearchValue("fromadlike")&&$.stats.track("\u95F4\u63A5\u52A0\u5173\u6CE8","\u5206\u53D1\u5173\u6CE8\u5427\u63A8\u8350","","click"),PageData.forum&&(e={fid:PageData.forum.id||PageData.forum.forum_id,fname:t.forum_name||PageData.forum.forum_name||PageData.forum_name,uid:PageData.user.name_url,ie:"gbk",tbs:PageData.tbs},e.fname=$.tb.escapeHTML(e.fname)),$.post(t.config.url.dolike,e,function(e){var a=!1;try{var o=e}catch(i){a=!0}if(!a)if(o&&0==o.no)Stats.sendRequest("fr=tb0_foruStatm&st_mod=frs&st_type=balvlikesucc&bduid="+PageData.user.bduid),t.isOfficial?_.Module.use("frs/widget/platform_attention_recommend",[{tbs:t.tbs,uid:t.uid,is_forum_fourth_manager:t.is_forum_fourth_manager,avatar:t.avatar}]):"\u6E38\u620F"==PageData.forum.first_class?_.Module.use("comforum/widget/attentionCategoryGame",["",!1,{index:o.data.ret.index,like_no:o.like_no}]):_.Module.use("ucenter/widget/LikeTip",["",!1,{index:o.data.ret.index,like_no:o.like_no},t.userForumList]),$.stats.sendRequest("fr=tb0_forum&st_page=frs&st_mod=like&st_type=auto");else{Stats.sendRequest("fr=tb0_foruStatm&st_mod=frs&st_type=balvlikefail&errorno="+o.no);var s="";s=8==o.no||9==o.no?"\u4F60\u5728\u672C\u5427\u88AB\u5C01\u7981\uFF0C\u6682\u65F6\u4E0D\u80FD\u8FDB\u884C\u64CD\u4F5C":220==o.no?"\u4F60\u88AB\u5427\u4E3B\u52A0\u5165\u9ED1\u540D\u5355\uFF0C\u6682\u65F6\u4E0D\u80FD\u8FDB\u884C\u64CD\u4F5C":221==o.no?"\u4F60\u5DF2like\u4E86\u672C\u5427,\u8BF7\u4E0D\u8981\u91CD\u590D\u64CD\u4F5C":"\u62B1\u6B49\uFF0C\u5F02\u5E38\u9519\u8BEF\uFF0C\u5EFA\u8BAE\u5237\u65B0\u9875\u9762\u91CD\u8BD5\u4E00\u4E0B",t._showAlert(s)}},"json")},_undolike:function(){var t=this,e=null;PageData.forum&&(e={fid:PageData.forum.forum_id,fname:t.forum_name||PageData.forum.forum_name||PageData.forum_name,uid:PageData.user.name_url,ie:"utf-8",tbs:PageData.tbs},e.fname=$.tb.escapeHTML(e.fname)),$.tb.post(t.config.url.undolike,e,function(t){var e=!1;try{var a=t}catch(o){e=!0}e||a&&0==a.no&&$.tb.location.reload(!0)})}}});_.Module.define({path:"encourage/widget/dialogFollowHotBa",requires:["common/widget/tbshare/tbshare_all"],sub:{_tpl:['<div id="follow-hot-box"></div>','<a href="#" class="follow-hot-box-close j-close-dialog"></a>','<a href="#" class="follow-hot-box-share j-share-activity"></a>','<a href="#" class="follow-hot-box-get j-get-icon"></a>','<a href="#" class="follow-hot-box-login j-login-btn"></a>'].join(""),initial:function(){var o=this;o.checkTimes()&&(o.initDialog(),o.initFlash(),o.bindEvents()),o.setGlobalEvent()},initDialog:function(){var o=this,t={html:o._tpl,modal:!0,draggable:!1,width:825,height:596,showTitle:!1},l=new $.dialog(t);l.element.addClass("follow-hot-ba"),o.dialog=l},initFlash:function(){var o=this,t=new $.swf("http://tb2.bdstatic.com/tb/static-encourage/widget/dialog_follow_hot_ba/images/follow_hot_7d7bbfe.swf",{id:"follow-hot-swf",container:"#follow-hot-box",width:825,height:596,params:{wmode:"transparent",allowScriptAccess:"always"},vars:{},callBacks:{}});o.swf=t},checkTimes:function(){var o=Number($.tb.Storage.get("followHot"))||0;return o=++o,o>2?!1:($.tb.Storage.set("followHot",o),!0)},sendFollow:function(){$.stats.track("follow","app_dialog_follow_hot");var o=this;$.post("/tbapp/center/oneKeyLikeForum",{tbs:PageData.tbs}).success(function(t){0===t.no||2270006===t.no?$.tb.Storage.set("followHot",2):o.setErrorFollow(t.no)}).error(function(){o.setErrorFollow()})},setErrorFollow:function(o){var t=this;switch($.tb.Storage.set("followHot",1),$(".follow-hot-box-get").hide(),o){case 2150010:t.requireInstanceAsync("common/widget/LoginDialog"),$(".follow-hot-box-login").show();break;case 110003:}},setGlobalEvent:function(){var o=this,t={sendFollow:function(){PageData.user.is_login?(o.sendFollow(),$(".j-get-icon").show()):($.tb.Storage.set("followHot",1),o.requireInstanceAsync("common/widget/LoginDialog"),o.setLoginBox())},getIcon:function(){o.closeDialog(),$.stats.track("get","app_dialog_follow_hot"),window.open("/home/achievement?un="+encodeURIComponent(PageData.user.name)+"&ie=utf-8&fr=followHot")}};window.followHotCallBack=t},setLoginBox:function(){$(".j-login-btn").show()},getShareBox:function(){var o=this,t=o.requireInstance("common/widget/tbshare/tbshare_all",[{$container:$("body"),show:!0}]);t.setShareContent({text:"#\u3010\u5E94\u7528\u4E2D\u5FC3\u3011\u6652\u6652\u6211\u7684\u5E94\u7528\u8FBE\u4EBA\u52CB\u7AE0\uFF0C\u5411\u5927\u795E\u8FDB\u9636\uFF01#",desc:"\u8D34\u5427\u5E94\u7528\u4E2D\u5FC3\u6696\u5FC3\u56DE\u9988\uFF0C\u5373\u65E5\u8D777\u5929\u5185\uFF0C\u767B\u9646\u5E94\u7528\u4E2D\u5FC3\uFF0C\u6309\u7167\u6B65\u9AA4\u64CD\u4F5C\uFF0C\u5373\u53EF\u83B7\u5F97\u70AB\u9177\u94F6\u8272\u8FBE\u4EBA\u52CB\u7AE0\uFF01\u8FC7\u4E86\u8FD9\u4E2A\u65F6\u95F4\uFF0C\u4F60\u53EF\u5C31\u6CA1\u90A3\u4E48\u5BB9\u6613\u62FF\u52CB\u7AE0\u4E86\u54E6\uFF01\u5FEB\u6765\u8D34\u5427\u3010\u5E94\u7528\u4E2D\u5FC3\u3011\u62A2\u5C5E\u4E8E\u4F60\u7684\u52CB\u7AE0\u5427\uFF01"})},closeDialog:function(){this.unbindEvent(),this.dialog.close()},bindEvents:function(){var o=this;o.dialog.element.on("click.followHot",".j-close-dialog",function(){o.closeDialog()}).on("click.followHot",".j-share-activity",function(){o.getShareBox()}).on("click.followHot",".j-get-icon",function(){window.followHotCallBack.getIcon()}).on("click.followHot",".j-login-btn",function(){o.requireInstanceAsync("common/widget/LoginDialog")})},unbindEvent:function(){var o=this;o.dialog.element.off("click.followHot"),window.followHotCallBack=null}}});_.Module.define({path:"common/widget/tbshare/tbshare_all",requires:["common/widget/tbshare/tbshare_share"],sub:{_tmp:['<div class="tbshare_all_wrapper">',"<h5>\u5206\u4EAB\u5230",'<p class="j_tbshare_all_close"></p>',"</h5>",'<div class="tbshare_all_main"></div>','<div class="tbshare_all_footer"></div>',"</div>"].join(""),_args:{targets:[["qqzone","QQ\u7A7A\u95F4"],["tieba","\u767E\u5EA6\u8D34\u5427"],["renren","\u4EBA\u4EBA\u7F51"],["tsina","\u65B0\u6D6A\u5FAE\u535A"],["weixin","\u5FAE\u4FE1"],["douban","\u8C46\u74E3"],["tsohu","\u641C\u72D0\u5FAE\u535A"],["copy","\u590D\u5236"]]},initial:function(t){t=t||{},this.args=$.extend({show:!1,$container:$("body")},t),this.$container=this.args.$container,this._createElement(),this._bindEvents(),this._addToContainer()},_createElement:function(){this.$dom=$(this._tmp),this.$share_all_main=this.$dom.find(".tbshare_all_main"),this.share=this.requireInstance("common/widget/tbshare/tbshare_share",[this._args]),this.share.$dom.appendTo(this.$share_all_main)},_bindEvents:function(){var t=this;this.$dom.on("click",".j_tbshare_all_close",function(){t.hideAll()})},_addToContainer:function(){this.$container&&this.$container.append(this.$dom),this.args.show&&this.showAll()},setShareContent:function(t){return this.share.setShareContent(t),this},showAll:function(){return this.$dom.show(),this},hideAll:function(){return this.$dom.hide(),this}}});_.Module.define({path:"common/widget/tbcopy/ZeroClipboard",sub:{get:function(){return this.ZeroClipboard},getClient:function(e){return new this.ZeroClipboard(e)},initial:function(){var e=this;!function(t,n){"use strict";var r,a=t,i=a.document,o=a.navigator,l=a.setTimeout,s=a.Number.parseInt||a.parseInt,u=a.Number.parseFloat||a.parseFloat,c=a.Number.isNaN||a.isNaN,f=a.encodeURIComponent,p=a.Math,d=a.Date,h=a.ActiveXObject,y=a.Array.prototype.slice,v=a.Object.keys,g=a.Object.prototype.hasOwnProperty,m=function(){return"function"==typeof a.Object.defineProperty&&function(){try{var e={};return a.Object.defineProperty(e,"y",{value:"z"}),"z"===e.y}catch(t){return!1}}()?a.Object.defineProperty:void 0}(),b=function(e){return y.call(e,0)},w=function(e,t,n){if("function"==typeof t.indexOf)return t.indexOf(e,n);var r,a=t.length;for("undefined"==typeof n?n=0:0>n&&(n=a+n),r=n;a>r;r++)if(g.call(t,r)&&t[r]===e)return r;return-1},C=function(){var e,t,r,a,i,o,l=b(arguments),s=l[0]||{};for(e=1,t=l.length;t>e;e++)if(null!=(r=l[e]))for(a in r)if(g.call(r,a)){if(i=s[a],o=r[a],s===o)continue;o!==n&&(s[a]=o)}return s},x=function(e){var t,n,r,a;if("object"!=typeof e||null==e)t=e;else if("number"==typeof e.length)for(t=[],n=0,r=e.length;r>n;n++)g.call(e,n)&&(t[n]=x(e[n]));else{t={};for(a in e)g.call(e,a)&&(t[a]=x(e[a]))}return t},E=function(e,t){for(var n={},r=0,a=t.length;a>r;r++)t[r]in e&&(n[t[r]]=e[t[r]]);return n},T=function(e,t){var n={};for(var r in e)-1===w(r,t)&&(n[r]=e[r]);return n},j=function(e){if(null==e)return[];if(v)return v(e);var t=[];for(var n in e)g.call(e,n)&&t.push(n);return t},D=function(e){if(e)for(var t in e)g.call(e,t)&&delete e[t];return e},I=function(e,t){t in e&&"function"==typeof m&&m(e,t,{value:e[t],writable:!1,configurable:!0,enumerable:!0})},k=function(e){return function(){var t;return t=e.now?e.now():(new e).getTime()}}(d),O={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,unavailable:null,deactivated:null,overdue:null,ready:null},N="11.0.0",L={},z={},_=null,S={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate","flash-overdue":"Flash communication was established but NOT within the acceptable time limit"}},F=(function(){var e,t,n,r,a="ZeroClipboard.swf";if(!i.currentScript||!(r=i.currentScript.src)){var o=i.getElementsByTagName("script");if("readyState"in o[0])for(e=o.length;e--&&("interactive"!==o[e].readyState||!(r=o[e].src)););else if("loading"===i.readyState)r=o[o.length-1].src;else{for(e=o.length;e--;){if(n=o[e].src,!n){t=null;break}if(n=n.split("#")[0].split("?")[0],n=n.slice(0,n.lastIndexOf("/")+1),null==t)t=n;else if(t!==n){t=null;break}}null!==t&&(r=t)}}return r&&(r=r.split("#")[0].split("?")[0],a=r.slice(0,r.lastIndexOf("/")+1)+a),a}(),{swfPath:"http://tb2.bdstatic.com/tb/static-common/widget/tbcopy/ZCB_8fd7d9f.swf",trustedDomains:t.location.host?[t.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999}),X=function(e){if("object"==typeof e&&null!==e)for(var t in e)if(g.call(e,t))if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(t))F[t]=e[t];else if(null==O.bridge)if("containerId"===t||"swfObjectId"===t){if(!G(e[t]))throw new Error("The specified `"+t+"` value is not valid as an HTML4 Element ID");F[t]=e[t]}else F[t]=e[t];{if("string"!=typeof e||!e)return x(F);if(g.call(F,e))return F[e]}},A=function(){return{browser:E(o,["userAgent","platform","appName"]),flash:T(O,["bridge"]),zeroclipboard:{version:jt.version,config:jt.config()}}},Y=function(){return!!(O.disabled||O.outdated||O.unavailable||O.deactivated)},$=function(e,t){var n,r,a,i={};if("string"==typeof e&&e)a=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)g.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&jt.on(n,e[n]);if(a&&a.length){for(n=0,r=a.length;r>n;n++)e=a[n].replace(/^on/,""),i[e]=!0,L[e]||(L[e]=[]),L[e].push(t);if(i.ready&&O.ready&&jt.emit({type:"ready"}),i.error){var o=["disabled","outdated","unavailable","deactivated","overdue"];for(n=0,r=o.length;r>n;n++)if(O[o[n]]===!0){jt.emit({type:"error",name:"flash-"+o[n]});break}}}return jt},B=function(e,t){var n,r,a,i,o;if(0===arguments.length)i=j(L);else if("string"==typeof e&&e)i=e.split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)g.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&jt.off(n,e[n]);if(i&&i.length)for(n=0,r=i.length;r>n;n++)if(e=i[n].toLowerCase().replace(/^on/,""),o=L[e],o&&o.length)if(t)for(a=w(t,o);-1!==a;)o.splice(a,1),a=w(t,o,a);else o.length=0;return jt},M=function(e){var t;return t="string"==typeof e&&e?x(L[e])||null:x(L)},H=function(e){var t,n,r;return e=J(e),e&&!nt(e)?"ready"===e.type&&O.overdue===!0?jt.emit({type:"error",name:"flash-overdue"}):(t=C({},e),tt.call(this,t),"copy"===e.type&&(r=st(z),n=r.data,_=r.formatMap),n):void 0},P=function(){if("boolean"!=typeof O.ready&&(O.ready=!1),!jt.isFlashUnusable()&&null===O.bridge){var e=F.flashLoadTimeout;"number"==typeof e&&e>=0&&l(function(){"boolean"!=typeof O.deactivated&&(O.deactivated=!0),O.deactivated===!0&&jt.emit({type:"error",name:"flash-deactivated"})},e),O.overdue=!1,ot()}},Z=function(){jt.clearData(),jt.deactivate(),jt.emit("destroy"),lt(),jt.off()},R=function(e,t){var n;if("object"==typeof e&&e&&"undefined"==typeof t)n=e,jt.clearData();else{if("string"!=typeof e||!e)return;n={},n[e]=t}for(var r in n)"string"==typeof r&&r&&g.call(n,r)&&"string"==typeof n[r]&&n[r]&&(z[r]=n[r])},V=function(e){"undefined"==typeof e?(D(z),_=null):"string"==typeof e&&g.call(z,e)&&delete z[e]},K=function(e){if(e&&1===e.nodeType){r&&(vt(r,F.activeClass),r!==e&&vt(r,F.hoverClass)),r=e,yt(e,F.hoverClass);var t=e.getAttribute("title")||F.title;if("string"==typeof t&&t){var n=it(O.bridge);n&&n.setAttribute("title",t)}var a=F.forceHandCursor===!0||"pointer"===mt(e,"cursor");xt(a),Ct()}},U=function(){var e=it(O.bridge);e&&(e.removeAttribute("title"),e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.top="1px"),r&&(vt(r,F.hoverClass),vt(r,F.activeClass),r=null)},G=function(e){return"string"==typeof e&&e&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(e)},J=function(e){var t;if("string"==typeof e&&e?(t=e,e={}):"object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(t=e.type),t){C(e,{type:t.toLowerCase(),target:e.target||r||null,relatedTarget:e.relatedTarget||null,currentTarget:O&&O.bridge||null,timeStamp:e.timeStamp||k()||null});var n=S[e.type];return"error"===e.type&&e.name&&n&&(n=n[e.name]),n&&(e.message=n),"ready"===e.type&&C(e,{target:null,version:O.version}),"error"===e.type&&(/^flash-(disabled|outdated|unavailable|deactivated|overdue)$/.test(e.name)&&C(e,{target:null,minimumVersion:N}),/^flash-(outdated|unavailable|deactivated|overdue)$/.test(e.name)&&C(e,{version:O.version})),"copy"===e.type&&(e.clipboardData={setData:jt.setData,clearData:jt.clearData}),"aftercopy"===e.type&&(e=ut(e,_)),e.target&&!e.relatedTarget&&(e.relatedTarget=W(e.target)),e=q(e)}},W=function(e){var t=e&&e.getAttribute&&e.getAttribute("data-clipboard-target");return t?i.getElementById(t):null},q=function(e){if(e&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)){var t=e.target,r="_mouseover"===e.type&&e.relatedTarget?e.relatedTarget:n,o="_mouseout"===e.type&&e.relatedTarget?e.relatedTarget:n,l=wt(t),s=a.screenLeft||a.screenX||0,u=a.screenTop||a.screenY||0,c=i.body.scrollLeft+i.documentElement.scrollLeft,f=i.body.scrollTop+i.documentElement.scrollTop,p=l.left+("number"==typeof e._stageX?e._stageX:0),d=l.top+("number"==typeof e._stageY?e._stageY:0),h=p-c,y=d-f,v=s+h,g=u+y,m="number"==typeof e.movementX?e.movementX:0,b="number"==typeof e.movementY?e.movementY:0;delete e._stageX,delete e._stageY,C(e,{srcElement:t,fromElement:r,toElement:o,screenX:v,screenY:g,pageX:p,pageY:d,clientX:h,clientY:y,x:h,y:y,movementX:m,movementY:b,offsetX:0,offsetY:0,layerX:0,layerY:0})}return e},Q=function(e){var t=e&&"string"==typeof e.type&&e.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(t)},et=function(e,t,n,r){r?l(function(){e.apply(t,n)},0):e.apply(t,n)},tt=function(e){if("object"==typeof e&&e&&e.type){var t=Q(e),n=L["*"]||[],r=L[e.type]||[],i=n.concat(r);if(i&&i.length){var o,l,s,u,c,f=this;for(o=0,l=i.length;l>o;o++)s=i[o],u=f,"string"==typeof s&&"function"==typeof a[s]&&(s=a[s]),"object"==typeof s&&s&&"function"==typeof s.handleEvent&&(u=s,s=s.handleEvent),"function"==typeof s&&(c=C({},e),et(s,u,[c],t))}return this}},nt=function(e){var t=e.target||r||null,n="swf"===e._source;switch(delete e._source,e.type){case"error":w(e.name,["flash-disabled","flash-outdated","flash-deactivated","flash-overdue"])&&C(O,{disabled:"flash-disabled"===e.name,outdated:"flash-outdated"===e.name,unavailable:"flash-unavailable"===e.name,deactivated:"flash-deactivated"===e.name,overdue:"flash-overdue"===e.name,ready:!1});break;case"ready":var a=O.deactivated===!0;C(O,{disabled:!1,outdated:!1,unavailable:!1,deactivated:!1,overdue:a,ready:!a});break;case"copy":var i,o,l=e.relatedTarget;!z["text/html"]&&!z["text/plain"]&&l&&(o=l.value||l.outerHTML||l.innerHTML)&&(i=l.value||l.textContent||l.innerText)?(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",i),o!==i&&e.clipboardData.setData("text/html",o)):!z["text/plain"]&&e.target&&(i=e.target.getAttribute("data-clipboard-text"))&&(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",i));break;case"aftercopy":jt.clearData(),t&&t!==ht()&&t.focus&&t.focus();break;case"_mouseover":jt.activate(t),F.bubbleEvents===!0&&n&&(rt(C({},e,{type:"mouseover"})),rt(C({},e,{type:"mouseenter",bubbles:!1})));break;case"_mouseout":jt.deactivate(),F.bubbleEvents===!0&&n&&(rt(C({},e,{type:"mouseout"})),rt(C({},e,{type:"mouseleave",bubbles:!1})));break;case"_mousedown":yt(t,F.activeClass),F.bubbleEvents===!0&&n&&rt(C({},e,{type:e.type.slice(1)}));break;case"_mouseup":vt(t,F.activeClass),F.bubbleEvents===!0&&n&&rt(C({},e,{type:e.type.slice(1)}));break;case"_click":case"_mousemove":F.bubbleEvents===!0&&n&&rt(C({},e,{type:e.type.slice(1)}))}return/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)?!0:void 0},rt=function(e){if(e&&"string"==typeof e.type&&e){var t,n=e.target||e.srcElement||null,r=n&&n.ownerDocument||i,o={view:r.defaultView||a,canBubble:!0,cancelable:!0,detail:"click"===e.type?1:0,button:"number"==typeof e.which?e.which-1:"number"==typeof e.button?e.button:r.createEvent?0:1},l=C(o,e);n&&(r.createEvent&&n.dispatchEvent?(l=[l.type,l.canBubble,l.cancelable,l.view,l.detail,l.screenX,l.screenY,l.clientX,l.clientY,l.ctrlKey,l.altKey,l.shiftKey,l.metaKey,l.button,l.relatedTarget],t=r.createEvent("MouseEvents"),t.initMouseEvent&&(t.initMouseEvent.apply(t,l),n.dispatchEvent(t))):r.createEventObject&&n.fireEvent&&(t=r.createEventObject(l),n.fireEvent("on"+l.type,t)))}},at=function(){var e=i.createElement("div");return e.id=F.containerId,e.className=F.containerClass,e.style.position="absolute",e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px",e.style.zIndex=""+Et(F.zIndex),e},it=function(e){for(var t=e&&e.parentNode;t&&"OBJECT"===t.nodeName&&t.parentNode;)t=t.parentNode;return t||null},ot=function(){var e,t=O.bridge,n=it(t);if(!t){var r=dt(a.location.host,F),o="never"===r?"none":"all",l=ft(F),s=F.swfPath+ct(F.swfPath,F);n=at();var u=i.createElement("div");n.appendChild(u),i.body.appendChild(n);var c=i.createElement("div"),f="activex"===O.pluginType;c.innerHTML='<object id="'+F.swfObjectId+'" name="'+F.swfObjectId+'" width="100%" height="100%" '+(f?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+s+'"')+">"+(f?'<param name="movie" value="'+s+'"/>':"")+'<param name="allowScriptAccess" value="'+r+'"/><param name="allowNetworking" value="'+o+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+l+'"/></object>',t=c.firstChild,c=null,t.ZeroClipboard=jt,n.replaceChild(t,u)}return t||(t=i[F.swfObjectId],t&&(e=t.length)&&(t=t[e-1]),!t&&n&&(t=n.firstChild)),O.bridge=t||null,t},lt=function(){var e=O.bridge;if(e){var t=it(e);t&&("activex"===O.pluginType&&"readyState"in e?(e.style.display="none",function n(){if(4===e.readyState){for(var r in e)"function"==typeof e[r]&&(e[r]=null);e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t)}else l(n,10)}()):(e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t))),O.ready=null,O.bridge=null,O.deactivated=null}},st=function(e){var t={},n={};if("object"==typeof e&&e){for(var r in e)if(r&&g.call(e,r)&&"string"==typeof e[r]&&e[r])switch(r.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":t.text=e[r],n.text=r;break;case"text/html":case"html":case"air:html":case"flash:html":t.html=e[r],n.html=r;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":t.rtf=e[r],n.rtf=r}return{data:t,formatMap:n}}},ut=function(e,t){if("object"!=typeof e||!e||"object"!=typeof t||!t)return e;var n={};for(var r in e)if(g.call(e,r)){if("success"!==r&&"data"!==r){n[r]=e[r];continue}n[r]={};var a=e[r];for(var i in a)i&&g.call(a,i)&&g.call(t,i)&&(n[r][t[i]]=a[i])}return n},ct=function(e,t){var n=null==t||t&&t.cacheBust===!0;return n?(-1===e.indexOf("?")?"?":"&")+"noCache="+k():""},ft=function(e){var t,n,r,i,o="",l=[];if(e.trustedDomains&&("string"==typeof e.trustedDomains?i=[e.trustedDomains]:"object"==typeof e.trustedDomains&&"length"in e.trustedDomains&&(i=e.trustedDomains)),i&&i.length)for(t=0,n=i.length;n>t;t++)if(g.call(i,t)&&i[t]&&"string"==typeof i[t]){if(r=pt(i[t]),!r)continue;if("*"===r){l=[r];break}l.push.apply(l,[r,"//"+r,a.location.protocol+"//"+r])}return l.length&&(o+="trustedOrigins="+f(l.join(","))),e.forceEnhancedClipboard===!0&&(o+=(o?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof e.swfObjectId&&e.swfObjectId&&(o+=(o?"&":"")+"swfObjectId="+f(e.swfObjectId)),o},pt=function(e){if(null==e||""===e)return null;if(e=e.replace(/^\s+|\s+$/g,""),""===e)return null;var t=e.indexOf("//");e=-1===t?e:e.slice(t+2);var n=e.indexOf("/");return e=-1===n?e:-1===t||0===n?null:e.slice(0,n),e&&".swf"===e.slice(-4).toLowerCase()?null:e||null},dt=function(){var e=function(e,t){var n,r,a;if(null!=e&&"*"!==t[0]&&("string"==typeof e&&(e=[e]),"object"==typeof e&&"number"==typeof e.length))for(n=0,r=e.length;r>n;n++)if(g.call(e,n)&&(a=pt(e[n]))){if("*"===a){t.length=0,t.push("*");break}-1===w(a,t)&&t.push(a)}};return function(t,n){var r=pt(n.swfPath);null===r&&(r=t);var a=[];e(n.trustedOrigins,a),e(n.trustedDomains,a);var i=a.length;if(i>0){if(1===i&&"*"===a[0])return"always";if(-1!==w(t,a))return 1===i&&t===r?"sameDomain":"always"}return"never"}}(),ht=function(){try{return i.activeElement}catch(e){return null}},yt=function(e,t){if(!e||1!==e.nodeType)return e;if(e.classList)return e.classList.contains(t)||e.classList.add(t),e;if(t&&"string"==typeof t){var n=(t||"").split(/\s+/);if(1===e.nodeType)if(e.className){for(var r=" "+e.className+" ",a=e.className,i=0,o=n.length;o>i;i++)r.indexOf(" "+n[i]+" ")<0&&(a+=" "+n[i]);e.className=a.replace(/^\s+|\s+$/g,"")}else e.className=t}return e},vt=function(e,t){if(!e||1!==e.nodeType)return e;if(e.classList)return e.classList.contains(t)&&e.classList.remove(t),e;if("string"==typeof t&&t){var n=t.split(/\s+/);if(1===e.nodeType&&e.className){for(var r=(" "+e.className+" ").replace(/[\n\t]/g," "),a=0,i=n.length;i>a;a++)r=r.replace(" "+n[a]+" "," ");e.className=r.replace(/^\s+|\s+$/g,"")}}return e},gt=function(){var e=/\-([a-z])/g,t=function(e,t){return t.toUpperCase()};return function(n){return n.replace(e,t)}}(),mt=function(e,t){var n,r,i;return a.getComputedStyle?n=a.getComputedStyle(e,null).getPropertyValue(t):(r=gt(t),n=e.currentStyle?e.currentStyle[r]:e.style[r]),"cursor"!==t||n&&"auto"!==n||(i=e.tagName.toLowerCase(),"a"!==i)?n:"pointer"},bt=function(){var e,t,n,r=1;return"function"==typeof i.body.getBoundingClientRect&&(e=i.body.getBoundingClientRect(),t=e.right-e.left,n=i.body.offsetWidth,r=p.round(t/n*100)/100),r},wt=function(e){var t={left:0,top:0,width:0,height:0};if(e.getBoundingClientRect){var n,r,o,l=e.getBoundingClientRect();"pageXOffset"in a&&"pageYOffset"in a?(n=a.pageXOffset,r=a.pageYOffset):(o=bt(),n=p.round(i.documentElement.scrollLeft/o),r=p.round(i.documentElement.scrollTop/o));var s=i.documentElement.clientLeft||0,u=i.documentElement.clientTop||0;t.left=l.left+n-s,t.top=l.top+r-u,t.width="width"in l?l.width:l.right-l.left,t.height="height"in l?l.height:l.bottom-l.top}return t},Ct=function(){var e;if(r&&(e=it(O.bridge))){var t=wt(r);C(e.style,{width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px",zIndex:""+Et(F.zIndex)})}},xt=function(e){O.ready===!0&&(O.bridge&&"function"==typeof O.bridge.setHandCursor?O.bridge.setHandCursor(e):O.ready=!1)},Et=function(e){if(/^(?:auto|inherit)$/.test(e))return e;var t;return"number"!=typeof e||c(e)?"string"==typeof e&&(t=Et(s(e,10))):t=e,"number"==typeof t?t:"auto"},Tt=function(e){function t(e){var t=e.match(/[\d]+/g);return t.length=3,t.join(".")}function n(e){return!!e&&(e=e.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(e)||"chrome.plugin"===e.slice(-13))}function r(e){e&&(s=!0,e.version&&(p=t(e.version)),!p&&e.description&&(p=t(e.description)),e.filename&&(f=n(e.filename)))}var a,i,l,s=!1,c=!1,f=!1,p="";if(o.plugins&&o.plugins.length)a=o.plugins["Shockwave Flash"],r(a),o.plugins["Shockwave Flash 2.0"]&&(s=!0,p="2.0.0.11");else if(o.mimeTypes&&o.mimeTypes.length)l=o.mimeTypes["application/x-shockwave-flash"],a=l&&l.enabledPlugin,r(a);else if("undefined"!=typeof e){c=!0;try{i=new e("ShockwaveFlash.ShockwaveFlash.7"),s=!0,p=t(i.GetVariable("$version"))}catch(d){try{i=new e("ShockwaveFlash.ShockwaveFlash.6"),s=!0,p="6.0.21"}catch(h){try{i=new e("ShockwaveFlash.ShockwaveFlash"),s=!0,p=t(i.GetVariable("$version"))}catch(y){c=!1}}}}O.disabled=s!==!0,O.outdated=p&&u(p)<u(N),O.version=p||"0.0.0",O.pluginType=f?"pepper":c?"activex":s?"netscape":"unknown"};Tt(h);var jt=function(){return this instanceof jt?("function"==typeof jt._createClient&&jt._createClient.apply(this,b(arguments)),void 0):new jt};jt.version="2.0.0",I(jt,"version"),jt.config=function(){return X.apply(this,b(arguments))},jt.state=function(){return A.apply(this,b(arguments))},jt.isFlashUnusable=function(){return Y.apply(this,b(arguments))},jt.on=function(){return $.apply(this,b(arguments))},jt.off=function(){return B.apply(this,b(arguments))},jt.handlers=function(){return M.apply(this,b(arguments))},jt.emit=function(){return H.apply(this,b(arguments))},jt.create=function(){return P.apply(this,b(arguments))},jt.destroy=function(){return Z.apply(this,b(arguments))},jt.setData=function(){return R.apply(this,b(arguments))},jt.clearData=function(){return V.apply(this,b(arguments))},jt.activate=function(){return K.apply(this,b(arguments))},jt.deactivate=function(){return U.apply(this,b(arguments))};var Dt=0,It={},kt=0,Ot={},Nt={};C(F,{autoActivate:!0});var Lt=function(e){var t=this;t.id=""+Dt++,It[t.id]={instance:t,elements:[],handlers:{}},e&&t.clip(e),jt.on("*",function(e){return t.emit(e)}),jt.on("destroy",function(){t.destroy()}),jt.create()},zt=function(e,t){var n,r,a,i={},o=It[this.id]&&It[this.id].handlers;if("string"==typeof e&&e)a=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)g.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.on(n,e[n]);if(a&&a.length){for(n=0,r=a.length;r>n;n++)e=a[n].replace(/^on/,""),i[e]=!0,o[e]||(o[e]=[]),o[e].push(t);if(i.ready&&O.ready&&this.emit({type:"ready",client:this}),i.error){var l=["disabled","outdated","unavailable","deactivated","overdue"];for(n=0,r=l.length;r>n;n++)if(O[l[n]]){this.emit({type:"error",name:"flash-"+l[n],client:this});break}}}return this},_t=function(e,t){var n,r,a,i,o,l=It[this.id]&&It[this.id].handlers;if(0===arguments.length)i=j(l);else if("string"==typeof e&&e)i=e.split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)g.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.off(n,e[n]);if(i&&i.length)for(n=0,r=i.length;r>n;n++)if(e=i[n].toLowerCase().replace(/^on/,""),o=l[e],o&&o.length)if(t)for(a=w(t,o);-1!==a;)o.splice(a,1),a=w(t,o,a);else o.length=0;return this},St=function(e){var t=null,n=It[this.id]&&It[this.id].handlers;return n&&(t="string"==typeof e&&e?n[e]?n[e].slice(0):[]:x(n)),t},Ft=function(e){if(Bt.call(this,e)){"object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(e=C({},e));var t=C({},J(e),{client:this});Mt.call(this,t)}return this},Xt=function(e){e=Ht(e);for(var t=0;t<e.length;t++)if(g.call(e,t)&&e[t]&&1===e[t].nodeType){e[t].zcClippingId?-1===w(this.id,Ot[e[t].zcClippingId])&&Ot[e[t].zcClippingId].push(this.id):(e[t].zcClippingId="zcClippingId_"+kt++,Ot[e[t].zcClippingId]=[this.id],F.autoActivate===!0&&Rt(e[t]));var n=It[this.id]&&It[this.id].elements;-1===w(e[t],n)&&n.push(e[t])}return this},At=function(e){var t=It[this.id];if(!t)return this;var n,r=t.elements;e="undefined"==typeof e?r.slice(0):Ht(e);for(var a=e.length;a--;)if(g.call(e,a)&&e[a]&&1===e[a].nodeType){for(n=0;-1!==(n=w(e[a],r,n));)r.splice(n,1);var i=Ot[e[a].zcClippingId];if(i){for(n=0;-1!==(n=w(this.id,i,n));)i.splice(n,1);0===i.length&&(F.autoActivate===!0&&Vt(e[a]),delete e[a].zcClippingId)}}return this},Yt=function(){var e=It[this.id];return e&&e.elements?e.elements.slice(0):[]},$t=function(){this.unclip(),this.off(),delete It[this.id]},Bt=function(e){if(!e||!e.type)return!1;if(e.client&&e.client!==this)return!1;var t=It[this.id]&&It[this.id].elements,n=!!t&&t.length>0,r=!e.target||n&&-1!==w(e.target,t),a=e.relatedTarget&&n&&-1!==w(e.relatedTarget,t),i=e.client&&e.client===this;return r||a||i?!0:!1},Mt=function(e){if("object"==typeof e&&e&&e.type){var t=Q(e),n=It[this.id]&&It[this.id].handlers["*"]||[],r=It[this.id]&&It[this.id].handlers[e.type]||[],i=n.concat(r);if(i&&i.length){var o,l,s,u,c,f=this;for(o=0,l=i.length;l>o;o++)s=i[o],u=f,"string"==typeof s&&"function"==typeof a[s]&&(s=a[s]),"object"==typeof s&&s&&"function"==typeof s.handleEvent&&(u=s,s=s.handleEvent),"function"==typeof s&&(c=C({},e),et(s,u,[c],t))}return this}},Ht=function(e){return"string"==typeof e&&(e=[]),"number"!=typeof e.length?[e]:e},Pt=function(e,t,n){return e&&1===e.nodeType?(e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n),e):e},Zt=function(e,t,n){return e&&1===e.nodeType?(e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n),e):e},Rt=function(e){if(e&&1===e.nodeType){var t=function(t){(t||a.event)&&jt.activate(e)};Pt(e,"mouseover",t),Nt[e.zcClippingId]={mouseover:t}}},Vt=function(e){if(e&&1===e.nodeType){var t=Nt[e.zcClippingId];"object"==typeof t&&t&&("function"==typeof t.mouseover&&Zt(e,"mouseover",t.mouseover),delete Nt[e.zcClippingId])}};jt._createClient=function(){Lt.apply(this,b(arguments))},jt.prototype.on=function(){return zt.apply(this,b(arguments))},jt.prototype.off=function(){return _t.apply(this,b(arguments))},jt.prototype.handlers=function(){return St.apply(this,b(arguments))},jt.prototype.emit=function(){return Ft.apply(this,b(arguments))},jt.prototype.clip=function(){return Xt.apply(this,b(arguments))},jt.prototype.unclip=function(){return At.apply(this,b(arguments))},jt.prototype.elements=function(){return Yt.apply(this,b(arguments))},jt.prototype.destroy=function(){return $t.apply(this,b(arguments))},jt.prototype.setText=function(e){return jt.setData("text/plain",e),this},jt.prototype.setHtml=function(e){return jt.setData("text/html",e),this},jt.prototype.setRichText=function(e){return jt.setData("application/rtf",e),this},jt.prototype.setData=function(){return jt.setData.apply(this,b(arguments)),this},jt.prototype.clearData=function(){return jt.clearData.apply(this,b(arguments)),this},jt.prototype.getFlashState=function(){return O},"function"==typeof define&&define.amd?define(function(){return jt}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?module.exports=jt:e.ZeroClipboard=jt}(function(){return this}())}}});
;_.Module.define({path:"common/widget/tbcopy",requires:["common/widget/tbcopy/ZeroClipboard"],sub:{text:"",initial:function(t){var e=$(t.ele),i=t.text,n=this.requireInstance("common/widget/tbcopy/ZeroClipboard"),c=n.get();this.clip=new c(e),this.setText(i)},add:function(t){var e=$(t);return e.length?(this.clip.clip(e),this):!1},remove:function(t){var e=$(t);return"undefined"==typeof t||e.length?(this.clip.unclip(t),this):!1},elements:function(){return $(this.clip.elements())},setText:function(t){var e=this;return this.clip.off("copy"),this.clip.on("copy",function(i){if("function"==typeof t)e.text=t(i);else{if("string"!=typeof t)return!1;e.text=t}i.clipboardData.setData("text/plain",e.text),e.successCallback?e.successCallback():$.dialog.alert("\u590D\u5236\u6210\u529F\uFF01")}),!0},getText:function(){return this.text},getFlashElement:function(){var t=this.clip.getFlashState();return t.bridge},setSuccessCallback:function(t){return this.successCallback=t,!0}}});_.Module.define({path:"comforum/widget/duokuServersDialog",requires:["common/widget/tbcopy"],sub:{_dialog_tmp:{fail_html:['<div class="comforum_duoku_servers_dialog">','<!--div class="fail_img"></div-->','<div class="duoku_servers_qrcode_wrapper">','<div class="qrcode_content"></div>',"<p>\u626B\u63CF\u4E8C\u7EF4\u7801\u4E0B\u8F7D\u6E38\u620F</p>","</div>",'<div class="qrcode_right_area">',"<p>\u5DF2\u88AB#{code_label}\u5149\u4E86\uFF0C\u4F46\u53EF\u4EE5\u7EE7\u7EED\u4E0B\u8F7D\u54E6~</p>",'<div class="btns">','<a href="#{button_url}" class="j_duoku_download ui_btn ui_btn_m" target="_blank">',"<span><em>\u7ACB\u5373\u4E0B\u8F7D</em></span>","</a>","</div>","</div>","</div>"].join(""),cong_html:['<div class="comforum_duoku_servers_dialog">','<div class="duoku_servers_qrcode_wrapper">','<div class="qrcode_content"></div>',"<p>\u626B\u63CF\u4E8C\u7EF4\u7801\u4E0B\u8F7D\u6E38\u620F</p>","</div>",'<div class="qrcode_right_area">',"<p>\u60A8\u5DF2\u7ECF#{code_label}\uFF0C\u8D76\u7D27\u4E0B\u8F7D\u6E38\u620F\u5F00\u59CB\u5427</p>",'<p class="duoku_code j_duoku_code">#{code_title}\uFF1A<span class="j_duoku_code_value duoku_code_value">#{game_code}</span></p>','<div class="btns">','<button class="j_duoku_copy duoku_copy ui_btn ui_btn_m"><span><em>\u590D\u5236#{code_title}</em></span></button>','<a href="#{button_url}" class="j_duoku_download ui_btn ui_btn_m" target="_blank">',"<span><em>\u7ACB\u5373\u4E0B\u8F7D</em></span>","</a>","</div>","</div>","</div>"].join(""),hadcode_html:['<div class="comforum_duoku_servers_dialog">','<div class="duoku_servers_qrcode_wrapper">','<div class="qrcode_content"></div>',"<p>\u626B\u63CF\u4E8C\u7EF4\u7801\u4E0B\u8F7D\u6E38\u620F</p>","</div>",'<div class="qrcode_right_area">',"<p>\u60A8\u5DF2\u7ECF#{code_label}\uFF0C\u8D76\u5FEB\u4E0B\u8F7D\u5427\u3002</p>",'<p class="duoku_code j_duoku_code">#{code_title}\uFF1A<span class="j_duoku_code_value duoku_code_value">#{game_code}</span></p>','<div class="btns">','<button class="j_duoku_copy duoku_copy ui_btn ui_btn_m"><span><em>\u590D\u5236#{code_title}</em></span></button>','<a href="#{button_url}" class="j_duoku_download ui_btn ui_btn_m" target="_blank">',"<span><em>\u7ACB\u5373\u4E0B\u8F7D</em></span>","</a>","</div>","</div>","</div>"].join("")},initial:function(){},showDialog:function(o){this.game=o.game,this.postTrack=o.postTrack,this.src=o.src,this.tbs=o.tbs,this._getCode()},_getCode:function(){var o=this,e="/game/duoku/applyToPlay",d=this.game,t=d.game_id,a=d.game_name,_=d.kaifu_id;this.postTrack("\u83B7\u53D6\u8D44\u683C",d),d&&$.post(e,{game_id:t,kaifu_id:_,game_name:a,tbs:this.tbs,src:this.src},function(e){var t=e.data&&(e.data.game_code||e.data.gift_code),a=e.no;d.applied&&(a=2),d.code_title=d.check_code?"\u6D4B\u8BD5\u7801":d.gift_code?"\u793C\u5305\u7801":"\u6D4B\u8BD5\u7801",d.code_label=d.check_code?"\u62A2\u5230\u4E86\u6D4B\u8BD5\u8D44\u683C":d.gift_code?"\u9886\u53D6\u4E86\u6E38\u620F\u793C\u5305":"\u62A2\u5230\u4E86\u6D4B\u8BD5\u8D44\u683C",0==a?(o.postTrack("\u62A2\u53F7\u6210\u529F\u6D6E\u5C42\u5C55\u793A",d,{},"view"),o._showDialog("cong_html","\u606D\u559C\u60A8",d,t)):1==a?(d.code_label=d.gift_code?"\u9886":"\u62A2",o.postTrack("\u5931\u8D25\u6D6E\u5C42\u5C55\u793A",d,{},"view"),o._showDialog("fail_html","\u5F88\u9057\u61BE... ...",d,t)):2==a?(o.postTrack("\u5DF2\u62A2\u8FC7\u53F7\u6D6E\u5C42\u5C55\u793A",d,{},"view"),o._showDialog("hadcode_html","\u60A8\u5DF2\u7ECF\u62A2\u8FC7\u55BD~",d,t)):4==a?o.requireInstanceAsync("common/widget/LoginDialog",["","userBar"]):alert("\u670D\u52A1\u5668\u62BD\u98CE")})},_showDialog:function(o,e,d,t){var a=new $.dialog({html:$.tb.format(this._dialog_tmp[o],{button_url:d.button_url,game_name:d.game_name,game_code:t,code_label:d.code_label,code_title:d.code_title}),title:e,width:436,height:156,draggable:!1,closeable:!0});$.JsLoadManager.use("http://tb1.bdstatic.com/tb/static-comforum/qrcode_f84ab06.js",function(){new window.QRCode($(".comforum_duoku_servers_dialog .qrcode_content")[0],{text:d.download_url,width:128,height:128})}),t&&(a.element.find(".j_duoku_copy, .j_duoku_code").show(),this.tbcopy?this.tbcopy.add(a.element.find(".j_duoku_copy")):this.tbcopy=this.requireInstance("common/widget/tbcopy",{ele:a.element.find(".j_duoku_copy")}),this.tbcopy.setText($(".comforum_duoku_servers_dialog .j_duoku_code_value").text()));var _=this;a.element.on("click",".j_duoku_download",function(){_.postTrack("",d,"","download")}),a.element.on("click",".j_duoku_copy",function(){_.postTrack("\u590D\u5236\u6309\u94AE",d)})}}});_.Module.define({path:"common/widget/duoku_servers_list",requires:["common/widget/tbcopy","comforum/widget/duokuServersDialog"],sub:{_btn_list_tmp:{get_code:['<li class="j_dsh_game" data-index="#{index}">','<a href="#{thread_url}" target="_blank"><img src="#{icon_url}"></a>','<span class="game_title"><a href="#{thread_url}" target="_blank">#{game_name}</a></span>','<a href="#{get_code_action}" target="_blank" class="get_code_btn">','<div class="#{platform_class} get_code_icon"></div>',"<span>#{apply_text}</span>","</a>","</li>"].join("")},locateMap:{frs:"p0117",pb:"p0118"},initial:function(e){this.redirectUrl=e.redirectUrl,this.$wrapper=$("#duoku_servers_list");var t=this;this._loader().done(function(e){t._render(e.data),t.dialog=t.requireInstance("comforum/widget/duokuServersDialog")}),this._bindEvents()},_loader:function(){var e="/game/duoku/getHotGames?timestamp="+(new Date).getTime(),t=$.getJSON(e);return t},_formatRedirectUrl:function(e,t){for(var a=e.split("?"),r=a[0],o=a[1].split("&"),i={},n=[],d=0,_=o.length;_>d;d++){var l=o[d],s=l.split("=")[0],c=l.split("=")[1];i[s]=c}i._t=+new Date,t&&(delete i.client_type,delete i.refer,delete i.url,delete i.url,delete i.fid,delete i.fname,delete i.page,delete i.type,delete i.ie);for(var p in i)i.hasOwnProperty(p)&&i[p]&&n.push(p+"="+i[p]);return["http://",$.tb.location.getHost(),r,"?",n.join("&")].join("")},getRedirectUrl:function(e,t,a,r,o,i){var n=[this._formatRedirectUrl(this.redirectUrl,i),"location=p0012","obj_ref=3000601","obj_id="+o,"obj_name="+encodeURIComponent(r),"type="+a,"tbjump="+encodeURIComponent(e),"loc_param="+t].join("&");return n},_render:function(e){e=e||[],this.games=e,0==this.games.length&&this.$wrapper.hide();var t=this.$wrapper.find(".servers_list_wrapper"),a="",r=e.length;r=r>7?7:r;for(var o,i=0;r>i;i++){var n=e[i];n.qrcode_url=this.getRedirectUrl(n.redirect_url,"qr_code","download",n.game_name,n.game_id,!0),n.button_url=this.getRedirectUrl(n.redirect_url,"button","click",n.game_name,n.game_id),o="android"==n.supported_os.toLowerCase()?"get_code_android":"get_code_iphone",a+=$.tb.format(this._btn_list_tmp.get_code,{game_name:n.game_name,thread_url:n.thread_url,icon_url:n.icon_url,platform_class:o,apply_text:n.applied?"\u5DF2\u9886\u53D6":n.not_available?"\u5E93\u5B58\u544A\u6025":n.check_code?"\u83B7\u53D6\u8D44\u683C":n.gift_code?"\u9886\u53D6\u793C\u5305":"-1"==n.download_url?"\u4E86\u89E3\u8BE6\u60C5":"\u7ACB\u5373\u4E0B\u8F7D",get_code_action:n.applied||n.not_available||n.check_code||n.gift_code?"javascript:;":"-1"==n.download_url?n.thread_url:n.download_url,index:i})}t.html(a)},_bindEvents:function(){var e=this;this.$wrapper.on("click",".get_code_btn",function(t){if("javascript:;"==$(t.currentTarget).tbattr("href"))e._getGameCode(t);else{var a=$(t.currentTarget).closest(".j_dsh_game").tbattr("data-index"),r=e.games[a];e._postTrack("",r,"","download")}}),this.$wrapper.on("click",".servers_detail_link",function(){e._postTrack("\u66F4\u591A\u94FE\u63A5")})},_getGameCode:function(e){var t=this,a=$(e.currentTarget).closest(".j_dsh_game").tbattr("data-index"),r=this.games[a];return t.dialog.showDialog({tbs:PageData.tbs,game:r,postTrack:$.proxy(t._postTrack,t),src:"list"}),!1},_postTrack:function(e,t,a,r){e||(e=this.locateMap[PageData.product]),"undefined"==typeof r&&(r="click"),a=a||{},a=$.extend({obj_ref:3000603},a),t&&(a=$.extend({obj_name:t.game_name,obj_game_id:t.game_id},a)),$.stats.track(e,"mg_pioneerba","",r,a)}}});_.Module.define({path:"common/widget/informManagerVerifyPhone",requires:["common/widget/verifyManagerPhone"],sub:{initial:function(e,n,i){var o=this;o._forceMode=i,e&&(n?o._commitRemindTime(function(){o._informManager()},null):o._informManager())},_commitRemindTime:function(e,n){$.ajax({url:"/bawu2/checkphone/commitRemindTime",dataType:"json",success:function(i){0===i.errno?"function"==typeof e&&e():"function"==typeof n&&n()},error:n})},_informManager:function(){var e=this;this.requireInstance("common/widget/verifyManagerPhone",[e._forceMode])}}});_.Module.define({path:"pcommon/widget/ParamsXssHandler",requires:[],sub:{_escapeKeyArray:["title","prefix","kw","word"],initial:function(e){e&&e.escapeKeyArray&&e.escapeKeyArray.length>0&&(this._escapeKeyArray=e.escapeKeyArray)},xssFilter:function(e){var r=$.extend({},e),a=$.tb.escapeHTML,s=this._escapeKeyArray;return $.each(s,function(i){var t=s[i],n=e[t];void 0!==n&&(r[t]=a(n))}),r}}});_.Module.define({path:"common/widget/PostService/PostResultHandlerManager",requires:[],sub:{initial:function(){this.isBlock=PageData&&PageData.user&&PageData.user.is_block,this.isBlockBySys=this.isBlock&&PageData.user.balv&&PageData.user.balv.is_by_pm,this._initHandlerMap()},_initHandlerMap:function(){function t(t,e){var r=this;_.Module.use("common/component/CaptchaDialog",{message:t.data.vcode.str_reason,vCode:t.data.vcode.captcha_vcode_str,vCodeType:t.data.vcode.captcha_code_type,exceptionalAccount:1==t.data.vcode.userstatevcode,forumName:e.kw,forumId:e.fid,postType:e.__type__,paramsCallback:function(){return{content:e.content,title:e.title,tid:e.tid}}},function(t){t.bind("onclose",function(){return t.hide(),r.trigger("complete"),!1}),t.bind("onaccept",function(){e.vcode=t.getInputValue(),e.vcode_md5=t.getVCode(),r.trigger("retry",e)}),t.show()})}function e(){var t=this,e=l.messageMap[224010];null==e&&(e="\u672A\u77E5\u9519\u8BEF");$.tb.alert({title:"\u53D1\u8D34\u5931\u8D25",message:e,buttons:[{text:"\u7ED1\u5B9A\u624B\u673A",callback:function(){var e=$.tb.location,r=e.getHost()+e.getPathname()+e.getSearch(),a="http://passport.baidu.com/v2/?accountbindphone&tpl=tb&u="+encodeURIComponent(r+"#sub");t.trigger("complete"),$.tb.location.setHref(a)}}]});this.trigger("error")}function r(t){var e=this,r=l.auditMessageMap[t.bdauditreason];null==r&&(r=l.auditMessageMap["default"]);$.tb.alert({iconSrc:"http://static.tieba.baidu.com/tb/img/messageFace.gif",title:"\u7B49\u5F85\u5BA1\u6838",heading:"\u7B49\u5F85\u5BA1\u6838...",message:r,buttons:{text:"\u786E\u5B9A",callback:function(){e.trigger("complete"),$.tb.location.reload()}}});this.trigger("error")}function a(){{var t=this;$.tb.alert({iconSrc:"http://static.tieba.baidu.com/tb/img/errorFace.gif",title:"\u53D1\u8D34\u5931\u8D25",heading:"\u53D1\u8D34\u5931\u8D25",message:c,buttons:{text:"\u786E\u5B9A",callback:function(){t.trigger("complete")}}})}this.trigger("error")}function i(t,e){{var r=this,a=function(){$.tb.alert({title:"T\u8C46\u5145\u503C",message:"\u6211\u5DF2\u6210\u529F\u5145\u503CT\u8C46",holderClassName:"tdou_notenough_dialog",buttons:{text:"\u91CD\u65B0\u53D1\u8868",callback:function(){r.trigger("retry",e)}}})};$.tb.alert({title:"T\u8C46\u4F59\u989D\u4E0D\u8DB3",message:"\u60A8\u7684T\u8C46\u4F59\u989D\u4E0D\u8DB3\uFF0C\u53D1\u8868\u8D34\u5B50\u5931\u8D25\uFF0C\u8BF7\u5145\u503C\u540E\u91CD\u8BD5",holderClassName:"tdou_notenough_dialog",onclose:function(){r.trigger("complete")},buttons:{text:"\u5145\u503CT\u8C46",callback:function(){_.Module.use("common/widget/tcharge_dialog"),r.trigger("complete"),a()}}})}}function s(){{var t=this;$.tb.alert({title:"\u63D0\u793A\u4FE1\u606F",message:"<p>\u4EB2\uFF0C\u60A8\u53CD\u9988\u7684\u95EE\u9898\u53EF\u80FD\u4E0E\u5220\u5E16\u6216\u5C01\u7981\u6709\u5173\u3002</p>\u8BF7\u786E\u8BA4\u53CD\u9988\u5185\u5BB9\u4E2D\u5305\u542B<strong>\u88AB\u5C01\u8D26\u53F7</strong>\u3001<strong>\u88AB\u5220\u5E16\u94FE\u63A5</strong>\u3001<strong>\u9875\u9762\u622A\u56FE</strong>\uFF0C\u4EE5\u4FBF\u4E8E\u6211\u4EEC\u66F4\u5FEB\u5E2E\u60A8\u89E3\u51B3\u95EE\u9898\u54E6~",holderClassName:"ueg_confirm_note_dialog",onclose:function(){t.trigger("complete")},buttons:[{text:"\u786E\u8BA4\u53D1\u8868",callback:function(){t.trigger("complete"),t.trigger("retryPost")}},{text:"\u6211\u518D\u6539\u6539",callback:function(){t.trigger("complete")}}]})}t.trigger("uegPostParameter")}function n(){{var t=this;$.tb.alert({title:"\u63D0\u793A\u4FE1\u606F",message:"<p>\u7EBF\u8DEF\u5347\u7EA7\u6539\u9020\uFF0C\u6682\u65F6\u65E0\u6CD5\u53D1\u8D34\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5F85\uFF0C\u7ED9\u60A8\u5E26\u6765\u4E0D\u4FBF\u8868\u793A\u62B1\u6B49~</p>",holderClassName:"ueg_confirm_note_dialog",onclose:function(){t.trigger("complete")},buttons:[{text:"\u5173\u95ED",callback:function(){t.trigger("complete")}}]})}}function o(t,e){{var r=this;r.use("tbmall/widget/TbeanSafe",{json:t,sucCallback:function(t){var a=$.extend(e,t);r.trigger("retry",a)},errCallback:function(){r.trigger("complete")},content:r})}}var c,l=this;_.Module.use("ueglibs/widget/Ban",[],function(t){c=t.render("richPoster")}),this.registerHandler(0,function(t,e){var r=this;"thread"==e.__type__&&t.data.balv&&t.data.balv.member_status?($.stats.sendRequest("fr=tb0_forum&st_page=frs&st_mod=like&st_type=thread"),r.use("ucenter/widget/LikeTip","\u53D1\u8D34\u6210\u529F",!1,{index:t.data.balv.member_index})):e.file_id?$.tb.alert({iconSrc:"http://tb1.bdstatic.com/tb/img/messageFace.gif",title:"\u53D1\u8868\u8D34\u5B50",heading:"\u89C6\u9891\u8F6C\u7801\u4E2D",message:"\u7A0D\u540E\u8F6C\u7801\u5B8C\u6210\u540E\u8D34\u5B50\u5C06\u81EA\u52A8\u53D1\u8868\u3002\u8BF7\u8010\u5FC3\u7B49\u5F85\uFF0C\u8C22\u8C22",buttons:[{text:"\u786E\u5B9A",callback:function(){r.trigger("complete"),r.trigger("success")}}]}):r.trigger("success",t)}),this.registerHandler(224011,t),this.registerHandler(40,t),this.registerHandler(224010,e),this.registerHandler(4010,e),this.registerHandler(220009,r),this.registerHandler(9,r),this.registerHandler(12,a),this.registerHandler(220012,a),this.registerHandler(2270005,i),this.registerHandler(220902,s),this.registerHandler(220903,n),this.registerHandler(360007,o),this.registerHandler(2150040,o),this.registerHandler(2270018,o),this.registerHandler(1990005,o),this.registerHandler(2190005,o),this.registerHandler(2270043,o),this.registerHandler(2270040,o),this.registerHandler(2270041,o),this.registerHandler(2270042,o)},registerHandler:function(t,e){this.handlerMap[t]=e},getHandler:function(t){var e=this,r=e.handlerMap[t];if(null==r){var a=e.messageMap[t];null==a&&(a="\u672A\u77E5\u9519\u8BEF\uFF0C\u9519\u8BEF\u53F7\uFF1A"+t),r=function(){{var t=this;$.tb.alert({iconSrc:"http://static.tieba.baidu.com/tb/img/errorFace.gif",title:"\u53D1\u8D34\u5931\u8D25",heading:"\u53D1\u8D34\u5931\u8D25",message:a,buttons:{text:"\u786E\u5B9A",callback:function(){t.trigger("complete")}}})}this.trigger("error")}}return r},messageMap:{220001:"\u53C2\u6570\u9519\u8BEF",220008:"\u5148\u53D1\u540E\u5BA1",220009:"",220011:"\u8D34\u5B50\u6807\u9898\u548C\u5185\u5BB9\u592A\u957F",220013:"\u64CD\u4F5C\u5931\u8D25\uFF0C\u60A8\u7684\u7F51\u7EDC\u5730\u5740\u7531\u4E8E\u975E\u6CD5\u64CD\u4F5C\u88AB\u5C01<br/><a href='/upc/userinfo?fid=fid' target=\"_blank\">\u67E5\u770B\u5C01\u7981\u4FE1\u606F</a>",220015:"\u8BF7\u4E0D\u8981\u53D1\u8868\u542B\u6709\u4E0D\u9002\u5F53\u5185\u5BB9\u7684\u7559\u8A00<br>\u8BF7\u4E0D\u8981\u53D1\u8868\u5E7F\u544A\u8D34",220034:"\u60A8\u8BF4\u8BDD\u592A\u5FEB\u4E86:) \u8BF7\u5148\u505C\u4E0B\u6765\u559D\u676F\u8336\u5427\uFF0C\u6216\u8005\u53EF\u4EE5\u53BB\u522B\u7684\u5427\u770B\u770B\u54E6\uFF0C\u4E00\u5B9A\u4F1A\u53D1\u73B0\u8FD8\u6709\u60A8\u611F\u5174\u8DA3\u7684\u8BDD\u9898",220035:"\u4EB2\uFF0C\u5DF2@\u4E0D\u5C11\u4EBA\u4E86\uFF0C\u4EE5\u514D\u6253\u6405\u66F4\u591A\u4EBA\uFF0C\u6B47\u4E00\u4F1A\u5427~",220037:"\u60A8\u5DF2\u5C1D\u8BD5\u63D0\u4EA4\u591A\u6B21\u4E86\uFF0C\u8BF7\u8FD4\u56DE\u540E\u5237\u65B0\u9875\u9762\uFF0C\u65B9\u53EF\u91CD\u65B0\u53D1\u8D34",220038:"\u9A8C\u8BC1\u7801\u8D85\u65F6\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165",220040:"\u9A8C\u8BC1\u7801\u8F93\u5165\u9519\u8BEF\uFF0C\u8BF7\u60A8\u8FD4\u56DE\u540E\u91CD\u65B0\u8F93\u5165",220119:"\u5BF9\u4E0D\u8D77\uFF0C\u672C\u4E3B\u9898\u7684\u56DE\u590D\u6570\u5DF2\u7ECF\u8FBE\u5230\u4E0A\u9650\uFF0C\u611F\u8C22\u60A8\u7684\u53C2\u4E0E\uFF0C\u6B22\u8FCE\u60A8\u6D4F\u89C8\u672C\u5427\u7684\u5176\u5B83\u4E3B\u9898",220901:"",224009:"\u8D34\u5B50\u5DF2\u88AB\u9501\u5B9A\uFF0C\u65E0\u6CD5\u8FDB\u884C\u8BE5\u64CD\u4F5C",224010:"\u60A8\u7684\u8D26\u53F7\u5B58\u5728\u5B89\u5168\u98CE\u9669\u6682\u4E0D\u80FD\u53D1\u8D34\uFF0C\u8BF7\u5148\u8FDB\u884C\u624B\u673A\u7ED1\u5B9A\u540E\u518D\u53D1\u8D34\u5427\u3002",230004:"\u60A8\u672A\u767B\u5F55\u6216\u5DF2\u9000\u51FA\u767B\u5F55\u72B6\u6001\uFF0C\u8BF7\u5148\u767B\u5F55\u518D\u8FDB\u884C\u64CD\u4F5C\u3002",230008:"\u60A8\u7684\u5185\u5BB9\u5DF2\u63D0\u4EA4\u6210\u529F\uFF0C\u6B63\u5728\u8FDB\u884C\u5BA1\u6838\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5F85\u3002",230013:"\u64CD\u4F5C\u5931\u8D25\uFF0C\u60A8\u7684\u5E10\u53F7\u56E0\u8FDD\u89C4\u64CD\u4F5C\u800C\u88AB\u5C01\u7981",230020:"\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u7684\u6807\u9898\u6216\u6B63\u6587\u5305\u542B\u592A\u5C11\u7684\u6587\u5B57\uFF0C\u8BF7\u4FEE\u6539\u540E\u518D\u53D1\u8868",230044:"\u5EFA\u5427\u5931\u8D25\uFF0C\u8BF7\u91CD\u65B0\u5C1D\u8BD5",230045:"\u62B1\u6B49\uFF0C\u60A8\u63D0\u4EA4\u7684\u8D34\u5427\u540D\u79F0\u542B\u7279\u6B8A\u5B57\u7B26\uFF0C\u76EE\u524D\u65E0\u6CD5\u521B\u5EFA\uFF0C\u63A8\u8350\u60A8\u4F7F\u7528\u6C49\u5B57\u3001\u5B57\u6BCD\u6216\u6570\u5B57\u4F5C\u4E3A\u8D34\u5427\u540D\u79F0",230046:"\u62B1\u6B49\uFF0C\u60A8\u7684\u8D34\u5B50\u8FC7\u957F\uFF0C\u65E0\u6CD5\u6B63\u5E38\u63D0\u4EA4\u3002\u5EFA\u8BAE\u60A8\u7CBE\u7B80\u6216\u5206\u6BB5\u540E\u91CD\u65B0\u63D0\u4EA4\uFF0C\u8C22\u8C22!",230265:"\u60A8\u672A\u767B\u5F55\u6216\u5DF2\u9000\u51FA\u767B\u5F55\u72B6\u6001\uFF0C\u8BF7\u5148\u767B\u5F55\u518D\u8FDB\u884C\u64CD\u4F5C\u3002",230273:"\u64CD\u4F5C\u5931\u8D25\uFF0C\u8BE5\u5E16\u5B50\u5DF2\u4E0D\u5B58\u5728",230308:"\u62B1\u6B49\uFF0C\u60A8\u6CA1\u6709\u6743\u9650\u8FDB\u884C\u8BE5\u9879\u64CD\u4F5C\u3002",230705:"\u672C\u5427\u5F53\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u53D1\u8D34\uFF01",230808:"\u62B1\u6B49\uFF0C\u6BCF\u5C42\u697C\u63D2\u5165\u7684\u89C6\u9891\u4E0D\u80FD\u8D85\u8FC71\u4E2A\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4",230809:"\u62B1\u6B49\uFF0C\u6BCF\u5C42\u697C\u63D2\u5165\u7684\u56FE\u7247\u4E0D\u80FD\u8D85\u8FC710\u5F20\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4",230814:"\u62B1\u6B49\uFF0C\u6BCF\u5C42\u697C\u63D2\u5165\u7684\u8868\u60C5\u4E0D\u80FD\u8D85\u8FC710\u5F20\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4",230815:"\u62B1\u6B49\uFF0C\u6BCF\u5C42\u697C\u63D2\u5165\u7684\u97F3\u4E50\u4E0D\u80FD\u8D85\u8FC710\u4E2A\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4",230850:"\u5427\u540D\u5DF2\u5B58\u5728\uFF0C\u8BF7\u52FF\u91CD\u590D\u521B\u5EFA",230870:"\u672C\u5E16\u5B50\u56DE\u590D\u8F83\u591A\uFF0C\u4E0D\u652F\u6301\u5220\u9664",230871:"\u53D1\u8D34\u592A\u9891\u7E41\uFF0C\u505C\u4E0B\u6765\u559D\u676F\u8336\u4F11\u606F\u4E0B\u5427",230887:"\u53D1\u8868\u5931\u8D25\u4E86\uFF0C\u8BF7\u91CD\u65B0\u5C1D\u8BD5",230889:"\u60A8\u5DF2\u88AB\u52A0\u5165\u5C0F\u9ED1\u5C4B\uFF0C\u65E0\u6CD5\u8FDB\u884C\u8BE5\u64CD\u4F5C\u3002",230900:"\u4E3A\u62B5\u5FA1\u6316\u575F\u5371\u5BB3\uFF0C\u672C\u5427\u5427\u4E3B\u5DF2\u653E\u51FA\u8D34\u5427\u795E\u517D--\u8D85\u7EA7\u9759\u6B62\u86D9\uFF0C\u672C\u8D34\u6682\u65F6\u65E0\u6CD5\u56DE\u590D\u3002",230901:"\u8BE5\u697C\u56DE\u590D\u5DF2\u8FBE\u4E0A\u9650\uFF0C\u8BF7\u5230\u522B\u7684\u697C\u5C42\u53C2\u4E0E\u4E92\u52A8\u5427",230902:"\u60A8\u8F93\u5165\u7684\u5185\u5BB9\u8FC7\u957F\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4\u3002",230903:"\u60A8\u8F93\u5165\u7684\u5185\u5BB9\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4\u3002",230961:"\u53D1\u8D34\u5931\u8D25\uFF0C\u60A8\u8F93\u5165\u7684\u56FE\u7247\u5730\u5740\u6709\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u66F4\u6B63\u540E\u518D\u6B21\u53D1\u5E03\uFF1A\uFF09",230962:"\u60A8\u8F93\u5165\u7684\u5185\u5BB9\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4\u3002",230963:"\u60A8\u8F93\u5165\u7684\u5185\u5BB9\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4\u3002",231120:"\u62B1\u6B49\uFF0C\u60A8\u8F93\u5165\u7684\u56FE\u7247\u3001\u89C6\u9891\u94FE\u63A5\u5730\u5740\u9519\u8BEF\uFF0C\u60A8\u53EF\u4EE5\u70B9\u51FB<a href='http://www.baidu.com/search/post_img.html' target='_blank'>\u67E5\u770B\u76F8\u5173\u5E2E\u52A9</a>\u6216\u8FD4\u56DE\u4FEE\u6539",232e3:"\u60A8\u8F93\u5165\u7684\u5185\u5BB9\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4\u3002",232001:"\u60A8\u8F93\u5165\u7684\u5185\u5BB9\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4\u3002",232007:"\u60A8\u8F93\u5165\u7684\u5185\u5BB9\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4\u3002",232101:"\u60A8\u8F93\u5165\u7684\u5185\u5BB9\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4\u3002",233001:"\u53D1\u8868\u5931\u8D25\u4E86\uFF0C\u8BF7\u91CD\u65B0\u518D\u8BD5\u3002",233003:"\u53D1\u8868\u5931\u8D25\u4E86\uFF0C\u8BF7\u91CD\u65B0\u518D\u8BD5\u3002",233004:"\u53D1\u8868\u5931\u8D25\u4E86\uFF0C\u8BF7\u91CD\u65B0\u518D\u8BD5\u3002",233005:"\u53D1\u8868\u5931\u8D25\u4E86\uFF0C\u8BF7\u91CD\u65B0\u518D\u8BD5\u3002",233006:"\u53D1\u8868\u5931\u8D25\u4E86\uFF0C\u8BF7\u91CD\u65B0\u518D\u8BD5\u3002",233007:"\u53D1\u8868\u5931\u8D25\u4E86\uFF0C\u8BF7\u91CD\u65B0\u518D\u8BD5\u3002",233010:"\u672C\u5427\u4EC5\u5141\u8BB8\u5B98\u65B9\u7C89\u4E1D\u56E2\u6210\u5458\u56DE\u590D\u54E6\uFF0C\u8D76\u5FEB\u52A0\u5165\u5427\uFF01",220903:"\u7EBF\u8DEF\u5347\u7EA7\u6539\u9020\uFF0C\u6682\u65F6\u65E0\u6CD5\u53D1\u8D34\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5F85\uFF0C\u7ED9\u60A8\u5E26\u6765\u4E0D\u4FBF\u8868\u793A\u62B1\u6B49~",234031:"\u4E0A\u4F20\u6587\u4EF6\u5931\u8D25\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\u3002",235004:"\u4F7F\u7528\u9053\u5177\u9519\u8BEF\uFF0C\u8BE5\u9053\u5177\u8981\u8D2D\u4E70\u540E\u624D\u80FD\u4F7F\u7528\u3002",235005:"\u65E0\u6743\u9650\u4F7F\u7528\u8BE5\u9053\u5177\uFF0C\u8BF7\u53BB\u8D2D\u4E70\u3002",239e3:"\u60A8\u8FD8\u6CA1\u6709\u7528\u6237\u540D\uFF0C\u4E0D\u80FD\u5728\u672C\u5427\u53D1\u8D34\u3002\u8BF7\u5148\u586B\u5199\u7528\u6237\u540D\u3002",239001:"\u7531\u4E8E\u533F\u540D\u72B6\u6001\u6216\u672C\u5427\u8BBE\u7F6E\uFF0C\u65E0\u6CD5\u53D1\u8868\u5E26\u6709\u56FE\u7247\u7684\u4E3B\u9898\u3002",2270028:"\u9644\u52A0\u5956\u54C1\u7684\u989D\u5EA6\u4E0D\u80FD\u5C11\u4E8E10000T\u8C46",2270029:"\u4E3B\u9898\u53D1\u9001\u6210\u529F\uFF0C\u5956\u52B1\u6DFB\u52A0\u5931\u8D25",2270018:"\u62B1\u6B49\uFF0C\u60A8\u6CA1\u6709\u6743\u9650\u53D1\u5956\u52B1\u8D34",2270027:"\u611F\u8A00\u8BF7\u63A7\u5236\u5728140\u4E2A\u5B57\u4E4B\u5185",10:"\u8D34\u5B50\u5185\u5BB9\u5305\u542B\u592A\u5C11\u7684\u6587\u5B57",11:"\u8D34\u5B50\u6807\u9898\u548C\u5185\u5BB9\u592A\u957F",13:"\u64CD\u4F5C\u5931\u8D25\uFF0C\u60A8\u7684\u7F51\u7EDC\u5730\u5740\u7531\u4E8E\u975E\u6CD5\u64CD\u4F5C\u88AB\u5C01<br/><a href='/upc/userinfo?fid=fid' target=\"_blank\">\u67E5\u770B\u5C01\u7981\u4FE1\u606F</a>",14:"\u60A8\u53D1\u5E03\u7684\u8D34\u5B50\u5DF2\u7ECF\u5B58\u5728",15:"\u8BF7\u4E0D\u8981\u53D1\u8868\u542B\u6709\u4E0D\u9002\u5F53\u5185\u5BB9\u7684\u7559\u8A00<br>\u8BF7\u4E0D\u8981\u53D1\u8868\u5E7F\u544A\u8D34",501:"\u8BF7\u4E0D\u8981\u53D1\u8868\u542B\u6709\u4E0D\u9002\u5F53\u5185\u5BB9\u7684\u7559\u8A00<br>\u8BF7\u4E0D\u8981\u53D1\u8868\u5E7F\u544A\u8D34",16:"\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u6240\u8F93\u5165\u7684\u8D34\u5427\u4E0D\u5B58\u5728\u3002\u7531\u4E8E\u7CFB\u7EDF\u5347\u7EA7\u7EF4\u62A4\uFF0C\u65B0\u5EFA\u8D34\u5427\u529F\u80FD\u6682\u505C\uFF0C\u5E0C\u671B\u5F97\u5230\u60A8\u7684\u8C05\u89E3\uFF01",17:"\u672C\u5427\u5F53\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u53D1\u8D34\uFF01",19:"\u60A8\u7684\u7528\u6237\u540D\u6216\u8005\u5BC6\u7801\u586B\u5199\u6709\u8BEF\uFF0C\u8BF7\u786E\u8BA4\u540E\u518D\u53D1\u8868",200:"\u60A8\u7684\u7528\u6237\u540D\u6216\u8005\u5BC6\u7801\u586B\u5199\u6709\u8BEF\uFF0C\u8BF7\u786E\u8BA4\u540E\u518D\u53D1\u8868",201:"\u60A8\u7684\u7528\u6237\u540D\u6216\u8005\u5BC6\u7801\u586B\u5199\u6709\u8BEF\uFF0C\u8BF7\u786E\u8BA4\u540E\u518D\u53D1\u8868",202:"\u60A8\u7684\u7528\u6237\u540D\u6216\u8005\u5BC6\u7801\u586B\u5199\u6709\u8BEF\uFF0C\u8BF7\u786E\u8BA4\u540E\u518D\u53D1\u8868",20:"\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u7684\u6807\u9898\u6216\u6B63\u6587\u5305\u542B\u592A\u5C11\u7684\u6587\u5B57\uFF0C\u8BF7\u4FEE\u6539\u540E\u518D\u53D1\u8868",22:"\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u7531\u4E8E\u7279\u6B8A\u539F\u56E0\u6211\u4EEC\u9700\u8981\u6838\u5B9E\u8BE5\u8D34\u5185\u5BB9\u662F\u5426\u542B\u6709\u4E0D\u826F\u4FE1\u606F\uFF0C\u6211\u4EEC\u4F1A\u572810\u5206\u949F\u5185\u786E\u8BA4\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85\uFF01",23:"\u60A8\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u9700\u8981\u7CFB\u7EDF\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u5EFA\u7ACB\u8D34\u5427",33:"\u60A8\u53D1\u8D34\u592A\u5FEB\u4E86:) \u8BF7\u7A0D\u540E\u518D\u53D1",34:"\u60A8\u8BF4\u8BDD\u592A\u5FEB\u4E86:) \u8BF7\u5148\u505C\u4E0B\u6765\u559D\u676F\u8336\u5427\uFF0C\u6216\u8005\u53EF\u4EE5\u53BB\u522B\u7684\u5427\u770B\u770B\u54E6\uFF0C\u4E00\u5B9A\u4F1A\u53D1\u73B0\u8FD8\u6709\u60A8\u611F\u5174\u8DA3\u7684\u8BDD\u9898",35:"\u4EB2\uFF0C\u5DF2@\u4E0D\u5C11\u4EBA\u4E86\uFF0C\u4EE5\u514D\u6253\u6405\u66F4\u591A\u4EBA\uFF0C\u6B47\u4E00\u4F1A\u5427~",36:"\u8BF7\u4E0D\u8981\u53D1\u5E7F\u544A\u8D34\uFF01",37:"\u60A8\u5DF2\u5C1D\u8BD5\u63D0\u4EA4\u591A\u6B21\u4E86\uFF0C\u8BF7\u8FD4\u56DE\u540E\u5237\u65B0\u9875\u9762\uFF0C\u65B9\u53EF\u91CD\u65B0\u53D1\u8D34",38:"\u9A8C\u8BC1\u7801\u8D85\u65F6\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165",39:"\u7531\u4E8E\u60A8\u591A\u6B21\u8F93\u9519\u9A8C\u8BC1\u7801\uFF0C\u8BF7\u60A8\u8FD4\u56DE\u540E\u5237\u65B0\u9875\u9762\uFF0C\u65B9\u53EF\u91CD\u65B0\u53D1\u8D34",40:"\u9A8C\u8BC1\u7801\u8F93\u5165\u9519\u8BEF\uFF0C\u8BF7\u60A8\u8FD4\u56DE\u540E\u91CD\u65B0\u8F93\u5165",41:"\u60A8\u7684\u8D34\u5B50\u53EF\u80FD\u5305\u542B\u4E0D\u5408\u9002\u7684\u5185\u5BB9\uFF0C\u8BF7\u60A8\u786E\u5B9A\u540E\u518D\u63D0\u4EA4",42:"\u60A8\u7684\u53D1\u8D34\u884C\u4E3A\u88AB\u7CFB\u7EDF\u8BA4\u4E3A\u6709\u53D1\u5E7F\u544A\u5ACC\u7591\uFF0C\u8BF7\u60A8\u7A0D\u540E\u518D\u53D1",43:"\u60A8\u7684\u53D1\u8D34\u884C\u4E3A\u6216\u8D34\u5B50\u5185\u5BB9\u6709\u5E7F\u544A\u6216\u4E0D\u5408\u9002\u7684\u7279\u5F81\uFF0C\u8BF7\u60A8\u786E\u5B9A\u540E\u518D\u53D1\u9001",44:"\u5BF9\u4E0D\u8D77\uFF0C\u672C\u5427\u6682\u65F6\u9650\u5236\u90E8\u5206\u7528\u6237\u53D1\u8868\u4E3B\u9898\u8D34\u5B50\uFF0C\u60A8\u53EF\u4EE5\u6D4F\u89C8\u6216\u56DE\u590D\u672C\u5427\u5176\u5B83\u5185\u5BB9\uFF0C\u7ED9\u60A8\u5E26\u6765\u4E0D\u4FBF\u5E0C\u671B\u5F97\u5230\u60A8\u7684\u8C05\u89E3\u3002",119:"\u5BF9\u4E0D\u8D77\uFF0C\u672C\u4E3B\u9898\u7684\u56DE\u590D\u6570\u5DF2\u7ECF\u8FBE\u5230\u4E0A\u9650\uFF0C\u611F\u8C22\u60A8\u7684\u53C2\u4E0E\uFF0C\u6B22\u8FCE\u60A8\u6D4F\u89C8\u672C\u5427\u7684\u5176\u5B83\u4E3B\u9898",1120:"\u62B1\u6B49\uFF0C\u60A8\u8F93\u5165\u7684\u56FE\u7247\u3001\u89C6\u9891\u94FE\u63A5\u5730\u5740\u9519\u8BEF\uFF0C\u60A8\u53EF\u4EE5\u70B9\u51FB<a href='http://www.baidu.com/search/post_img.html' target='_blank'>\u67E5\u770B\u76F8\u5173\u5E2E\u52A9</a>\u6216\u8FD4\u56DE\u4FEE\u6539",1121:"\u62B1\u6B49\uFF0C\u89C6\u9891\u670D\u52A1\u5347\u7EA7\u4E2D\uFF0C\u60A8\u6682\u65F6\u65E0\u6CD5\u53D1\u8868\u5E26\u6709\u89C6\u9891\u7684\u8D34\u5B50\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u8BF7\u539F\u8C05",100:"\u5BF9\u4E0D\u8D77\uFF0C\u672C\u5427\u6682\u65F6\u9650\u5236\u90E8\u5206\u7528\u6237\u4F7F\u7528\u5B8C\u6574\u7684\u8D34\u5427\u529F\u80FD\uFF0C\u60A8\u53EF\u4EE5\u6D4F\u89C8\u672C\u5427\u5176\u5B83\u5185\u5BB9\uFF0C\u7ED9\u60A8\u5E26\u6765\u4E0D\u4FBF\u5E0C\u671B\u5F97\u5230\u60A8\u7684\u8C05\u89E3\u3002",701:"\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u4E0D\u5141\u8BB8\u672A\u767B\u5F55\u7528\u6237\u53D1\u8D34\uFF0C\u767B\u5F55\u7528\u6237\u4E0D\u53D7\u5F71\u54CD\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F",702:"\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u9650\u5236\u90E8\u5206\u7528\u6237\u53D1\u8D34\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F",703:"\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u88AB\u8BBE\u7F6E\u4E3A\u4EC5\u672C\u5427\u4F1A\u5458\u624D\u80FD\u53D1\u8D34\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F\u3002<a href='/f?kw=this.bdQueryWordEnc#1' target=_blank>\u70B9\u6B64\u7533\u8BF7\u52A0\u5165</a>\u672C\u5427\u4F1A\u5458",704:"\u4E3A\u4E86\u51CF\u5C11\u6076\u610F\u704C\u6C34\u548C\u5E7F\u544A\u5E16\uFF0C\u672C\u5427\u88AB\u8BBE\u7F6E\u4E3A\u4EC5\u672C\u5427\u7BA1\u7406\u56E2\u961F\u624D\u80FD\u53D1\u8D34\uFF0C\u7ED9\u60A8\u5E26\u6765\u7684\u4E0D\u4FBF\u6DF1\u8868\u6B49\u610F",705:"\u672C\u5427\u5F53\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u53D1\u8D34\uFF01",706:"\u62B1\u6B49\uFF0C\u672C\u8D34\u6682\u65F6\u65E0\u6CD5\u56DE\u590D\u3002",45:"\u62B1\u6B49\uFF0C\u60A8\u63D0\u4EA4\u7684\u8D34\u5427\u540D\u79F0\u542B\u7279\u6B8A\u5B57\u7B26\uFF0C\u76EE\u524D\u65E0\u6CD5\u521B\u5EFA\uFF0C\u63A8\u8350\u60A8\u4F7F\u7528\u6C49\u5B57\u3001\u5B57\u6BCD\u6216\u6570\u5B57\u4F5C\u4E3A\u8D34\u5427\u540D\u79F0",46:"\u62B1\u6B49\uFF0C\u60A8\u7684\u8D34\u5B50\u8FC7\u957F\uFF0C\u65E0\u6CD5\u6B63\u5E38\u63D0\u4EA4\u3002\u5EFA\u8BAE\u60A8\u7CBE\u7B80\u6216\u5206\u6BB5\u540E\u91CD\u65B0\u63D0\u4EA4\uFF0C\u8C22\u8C22!",815:"\u62B1\u6B49\uFF0C\u60A8\u5DF2\u9000\u51FA\u767B\u5F55\u6216\u672A\u8D2D\u4E70\u97F3\u4E50\u9053\u5177\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\u91CD\u8BD5",900:"\u4E3A\u62B5\u5FA1\u6316\u575F\u5371\u5BB3\uFF0C\u672C\u5427\u5427\u4E3B\u5DF2\u653E\u51FA\u8D34\u5427\u795E\u517D--\u8D85\u7EA7\u9759\u6B62\u86D9\uFF0C\u672C\u8D34\u6682\u65F6\u65E0\u6CD5\u56DE\u590D\u3002",961:"\u53D1\u8D34\u5931\u8D25\uFF0C\u60A8\u8F93\u5165\u7684\u56FE\u7247\u5730\u5740\u6709\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u66F4\u6B63\u540E\u518D\u6B21\u53D1\u5E03\uFF1A\uFF09",9001:"\u7531\u4E8E\u533F\u540D\u72B6\u6001\u6216\u672C\u5427\u8BBE\u7F6E\uFF0C\u65E0\u6CD5\u53D1\u8868\u5E26\u6709\u56FE\u7247\u7684\u4E3B\u9898\u3002",2100:"\u5185\u5BB9\u542B\u6709\u9AD8\u7EA7\u5B57\u4F53\u6548\u679C\uFF0C\u4FDD\u6301\u8FDE\u7EED\u7B7E\u5230\u5C31\u80FD\u4F7F\u7528\u54E6~~",4010:"\u60A8\u7684\u8D26\u53F7\u5B58\u5728\u5B89\u5168\u98CE\u9669\u6682\u4E0D\u80FD\u53D1\u8D34\uFF0C\u8BF7\u5148\u8FDB\u884C\u624B\u673A\u7ED1\u5B9A\u540E\u518D\u53D1\u8D34\u5427\u3002",9e3:"\u60A8\u8FD8\u6CA1\u6709\u7528\u6237\u540D\uFF0C\u4E0D\u80FD\u5728\u672C\u5427\u53D1\u8D34\u3002\u8BF7\u5148\u586B\u5199\u7528\u6237\u540D\u3002",402011:"\u56FE\u7247\u5BBD\u5EA6\u8D85\u51FA\u9650\u5236",402012:"\u56FE\u7247\u9AD8\u5EA6\u8D85\u51FA\u9650\u5236",402013:"\u56FE\u7247\u6807\u7B7E\u65E0\u6548",220900:"\u7981\u6B62\u6316\u575F"},auditMessageMap:{"-61":"\u60A8\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u4E3A\u4E86\u4FDD\u8BC1\u8D34\u5B50\u8D28\u91CF\uFF0C\u672C\u5427\u6240\u53D1\u7684\u8D34\u5B50\u5F85\u7CFB\u7EDF\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85","-62":"\u60A8\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u4E3A\u4E86\u4FDD\u8BC1\u8D34\u5B50\u8D28\u91CF\uFF0C\u672C\u5427\u8D34\u56FE\u7684\u8D34\u5B50\u9700\u8981\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85","-74":"\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u7CFB\u7EDF\u9700\u8981\u6838\u5B9E\u8BE5\u8D34\u5B50\u5185\u5BB9\u662F\u5426\u542B\u6709\u4E0D\u826F\u4FE1\u606F\uFF0C\u8D34\u5B50\u5728\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85","-75":"\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u7CFB\u7EDF\u9700\u8981\u6838\u5B9E\u8BE5\u8D34\u5B50\u5185\u5BB9\u662F\u5426\u542B\u6709\u4E0D\u826F\u4FE1\u606F\uFF0C\u8D34\u5B50\u5728\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85","-60":"\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u7CFB\u7EDF\u9700\u8981\u6838\u5B9E\u8BE5\u8D34\u5B50\u5185\u5BB9\u662F\u5426\u542B\u6709\u4E0D\u826F\u4FE1\u606F\uFF0C\u8D34\u5B50\u5728\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85","-70":"\u60A8\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u4E3A\u4E86\u63A7\u5236\u5E7F\u544A\u8D34\uFF0C\u9700\u8981\u901A\u8FC7\u5BA1\u6838\u540E\u624D\u80FD\u53D1\u5E03\u3002\u767B\u9646\u7F72\u540D\u53D1\u8D34\u4E0D\u53D7\u6B64\u9650\u5236\u3002","-71":"\u60A8\u53D1\u8868\u7684\u5E16\u5B50\u592A\u957F\u4E86\u3002\u4E3A\u4E86\u9632\u6B62\u704C\u6C34\uFF0C\u9700\u7CFB\u7EDF\u5BA1\u6838\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u7A0D\u540E\u67E5\u770B","default":"\u60A8\u53D1\u8868\u7684\u8D34\u5B50\u5DF2\u7ECF\u6210\u529F\u63D0\u4EA4\uFF0C\u4F46\u7CFB\u7EDF\u9700\u8981\u6838\u5B9E\u8BE5\u8D34\u5B50\u5185\u5BB9\u662F\u5426\u542B\u6709\u4E0D\u826F\u4FE1\u606F\uFF0C\u8D34\u5B50\u5728\u5BA1\u6838\u901A\u8FC7\u540E\u624D\u80FD\u663E\u793A\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85"},handlerMap:{}}});
;_.Module.define({path:"common/widget/PostService",requires:["PostResultHandlerManager","ucenter/widget/LikeTip","tbmall/widget/TbeanSafe","pcommon/widget/ParamsXssHandler"],sub:{_defaultData:{ie:"utf-8",kw:"",fid:"",tid:"",vcode_md5:"",floor_num:0,rich_text:1,tbs:0,content:""},posting:!1,submitUrl:{thread:"/f/commit/thread/add",reply:"/f/commit/post/add",vpostThread:"/vpost/addthread",vpostReply:"/vpost/addpost",timeaxisThread:"/frsstar/commit/agency/addTimeline",timeaxisVpostThread:"",repost:"/relay/commit",guessingThreadNew:"/tbmall/guess/add",repostNew:"/relay/commitNew"},initial:function(){var t=this;this.resultHandlerManager=this.use("PostResultHandlerManager"),this.paramsXssHandler=this.requireInstance("pcommon/widget/ParamsXssHandler"),this.bind("retry",function(e,s){t._retryHandler(s)}),this.bind("retryPost",function(e,s){t.retryPost(s)}),this.bind("uegPostParameter",function(){t.uegPostParameter()})},isPosting:function(){return this.posting},post:function(t,e,s){this.postDataCache=e,this.postContextCache=s,this.postTypeCache=t;var r=this;if(this.posting)return this;this.posting=!0;var i=$.extend({},this._defaultData);s&&$.extend(i,this._extractDataFromContext(s)),$.extend(i,e),i.__type__=t;var a=this.submitUrl[t];return $.ajax({type:"post",url:a,data:this.paramsXssHandler.xssFilter(i),success:function(t){var e=r.resultHandlerManager.getHandler(t.err_code||t.no);e.call(r,t,i)},error:function(){$.tb.alert({title:"\u53D1\u8D34\u5931\u8D25",message:"\u7F51\u901F\u6709\u70B9\u4E0D\u7ED9\u529B\u54E6~\u8BF7\u5C1D\u8BD5\u91CD\u65B0\u63D0\u4EA4\u4E00\u4E0B\u5427\uFF01",buttons:[{text:"\u786E\u5B9A",callback:function(){r.trigger("complete")}}]})},complete:function(){r.posting=!1},dataType:"json"}),this},_extractDataFromContext:function(t){return{kw:t.forum.name,fid:t.forum.id,tid:t.thread?t.thread.id:0,tbs:t.tbs,floor_num:t.floor}},_retryHandler:function(t){this.post(t.__type__,t)},success:function(t){return this.bind("success",t),this},error:function(t){return this.bind("error",t),this},complete:function(t){return this.bind("complete",t),this},uegPostParameter:function(){$.extend(this._defaultData,{ueg_complain_flag:1})},retryPost:function(){this.post(this.postTypeCache,this.postDataCache,this.postContextCache)},retry:function(t){return this._retryHandler=t,this}}});_.Module.define({path:"common/widget/WordLimit",requires:[],sub:{checkTimer:null,isShow:!1,exceed:!1,initial:function(i){var t={container:$("body"),inputObj:null,checkDelay:50,showLimit:10,maxNum:120,isLimitInput:!1,autoPos:!0,numStyle:{},limitStyle:{}},e=$.extend(!0,t,i);this.container=$(e.container),this.inputObj=$(e.inputObj),this.showLimit=e.showLimit,this.option=e,this.holder=$('<div class="w_limit_wrapper "></div>'),this.container.append(this.holder)},init:function(){var i=this.option,t=this;if(null!=i.inputObj){var e=$(i.inputObj);e.keydown(function(i){return t.handlerEvent(i),!0}),e.focus(function(i){return t.handlerEvent(i),!0}),e.bind("input",function(i){return t.handlerEvent(i),!0}),e.bind("propertychange",function(i){return t.handlerEvent(i),!0})}},setLimitStyle:function(i){this.holder.css(i)},hideWordLimit:function(){this.trigger("wlhiding"),this.holder.hide(),this.isShow=!1,clearTimeout(this.checkTimer)},autoPosition:function(){var i=this.inputObj.offset(),t=this.inputObj.width(),e=$(document).width();this.holder.css({top:i.top-this.holder.height()-5,right:e-t-i.left-9})},handlerEvent:function(){clearTimeout(this.checkTimer);var i=this.option,t=this;t.blur=!1,this.checkTimer=setTimeout(function(){t.check()},i.checkDelay)},check:function(){var i=this.option,t=this.inputObj,e=t.val(),h=$.tb.getByteLength(e),n=i.maxNum-h;if(i.isLimitInput&&0>n&&t.val($.tb.subByte(e,i.maxNum+(0>n&&n>-2?n:0),"")),n=i.maxNum-$.tb.getByteLength(t.val()),n<=this.showLimit){i.autoPos?this.autoPosition():this.trigger("onSetPosition"),this.holder.show(),this.isShow=!0;var s=Math.ceil(n/2);0>n?(s=Math.floor(n/2),this.exceed||(this.trigger("overflow"),this.exceed=!0),this.trigger("wlshowing"),this.holder.html('\u5DF2\u7ECF\u8D85\u51FA<span class="w_limit_num" style="color:#f00;">'+-s+"</span>\u4E2A\u5B57")):(this.exceed&&(this.trigger("unoverflow"),this.exceed=!1),this.trigger("wlshowing"),0==n?this.holder.html('\u8FD8\u53EF\u8F93\u5165<span class="w_limit_num" style="color:#ff0000;">'+s+"</span>\u4E2A\u5B57"):this.holder.html('\u8FD8\u53EF\u8F93\u5165<span class="w_limit_num" style="color:#929292;">'+s+"</span>\u4E2A\u5B57"))}else this.isShow&&(this.trigger("wlhiding"),this.holder.hide(),this.isShow=!1,this.exceed&&(this.trigger("unoverflow"),this.exceed=!1))}}});_.Module.define({path:"common/widget/PostPrefix",requires:[],sub:{initial:function(e){this.$titleWrap=$(".j_title_wrap"),this.$target=e.$target,this.prefix=e.prefix,this.prefix.value&&(this.prefix.value=this.prefix.value.replace("&amp;","&")),this.$target.val(this.prefix.value),this.$target.data("prefix",this.prefix.value),this.feedbackBarId="898666",this.appendPrefixToBody(),this.prefix.need_sug&&(this.pickPrefix(this.$target,this.prefix.sug_html),this.autoResponse(this.$target,this.prefix.sug_html))},appendPrefixToBody:function(){this.$wrapper=$('<a class="pprefix-list"></a>'),this.$wrapper.appendTo("body").css({display:"none","box-sizing":"border-box"}),PageData.forum.forum_id==this.feedbackBarId&&(this.$autoRes_wrapper=$('<a class="auto-pprefix-list"></a>'),this.$autoRes_wrapper.appendTo("body").css({display:"none","box-sizing":"border-box"})),this.unsetAutoRespPrefix()},setAutoRespPrefix:function(){var e=this;e.$titleWrap.find(".j_title").removeClass("normal-prefix").addClass("auto-resp-prefix")},unsetAutoRespPrefix:function(){var e=this;e.$titleWrap.find(".j_title").removeClass("auto-resp-prefix").addClass("normal-prefix")},showNormalPrefix:function(e){var i=this;i.$wrapper.css({width:e.outerWidth()+"px",left:e.offset().left+"px",top:e.offset().top+e.outerHeight()-1+"px"}).show(),PageData.forum.forum_id==this.feedbackBarId&&i.$autoRes_wrapper.hide()},autoResponse:function(e){function i(e,i){"up"==e?0>o-1?o=s.length-1:o--:"down"==e?o+1==s.length?o=0:o++:"mouse"==e&&(o=i),p.$autoRes_wrapper.is(":visible")||(f.showPPrefix(),o=0),s&&s.removeClass("pprefix-item-shine").eq(o).addClass("pprefix-item-shine")}function t(i){var t=e.data("prefix");e.val(t+i),p.$autoRes_wrapper.hide(),setTimeout(function(){e.trigger("focus")},100)}function r(e){$.post("/hermes/suggestion",{kw:e,ie:"utf-8"},function(e){e.errno||a(e.query_match)},"json")}function a(e){if(0==e.length)return f.hidePPrefix(),!1;for(var i="",t=0,r=e.length;r>t;t++)i+='<div class="pprefix-item" data-id="'+e[t].id+'">'+e[t].title+"</div>";""!=i?p.$autoRes_wrapper.html(i):"",f.showPPrefix(),s=p.$autoRes_wrapper.children()}if(PageData.forum.forum_id!=this.feedbackBarId)return!1;var s="",o=-1,p=this,f={showPPrefix:function(){p.$autoRes_wrapper.css({width:e.outerWidth()-138+"px",left:e.offset().left+138+"px",top:e.offset().top+e.outerHeight()-1+"px"}).show(),p.$wrapper.hide()},hidePPrefix:function(){o=-1,""!=s?s.removeClass("pprefix-item-shine"):"",p.$autoRes_wrapper.hide(),p.setAutoRespPrefix()},autoResItemClickStat:function(e){$.post("/hermes/commit/sughit",{id:e},function(){},"json")}};p.$titleWrap.on("click.showPPrefix",".auto-resp-prefix",function(){p.showNormalPrefix(e),p.unsetAutoRespPrefix()}).on("blur.hidePPrefix",".auto-resp-prefix",function(){f.hidePPrefix()}).on("keyup",".auto-resp-prefix",function(a){switch(a.keyCode){case 40:a.preventDefault(),i("down");break;case 38:a.preventDefault(),i("up");break;case 13:a.preventDefault(),-1!=o&&(p.$autoRes_wrapper.find(".pprefix-item-shine").html()?t(p.$autoRes_wrapper.find(".pprefix-item-shine").html()):"",f.hidePPrefix(),p.setAutoRespPrefix());break;case 27:p.$autoRes_wrapper.is(":visible()")&&(a.preventDefault(),f.hidePPrefix());case 8:default:var s=e.val(),n="";if(PageData.forum.forum_id!=p.feedbackBarId||-1==s.indexOf("\u3010\u6C42\u52A9\u54A8\u8BE2\u3011"))return o=-1,f.hidePPrefix(),!1;var u=-1==s.indexOf("\u4E28")?s.indexOf("|"):s.indexOf("\u4E28");-1==u?u=s.indexOf("\uFF5C"):"",n=s.substring(u+1,s.length),""!=n?r(n):f.hidePPrefix(),p.setAutoRespPrefix()}}),p.$autoRes_wrapper.on("mousedown.pick",".pprefix-item",function(){f.autoResItemClickStat($(this).data("id")),t($(this).html())}).on("mouseover",".pprefix-item",function(){i("mouse",$(this).index())})},pickPrefix:function(e,i){function t(){f.$wrapper.css({width:e.outerWidth()+"px",left:e.offset().left+"px",top:e.offset().top+e.outerHeight()-1+"px"}).show(),PageData.forum.forum_id==f.feedbackBarId&&f.$autoRes_wrapper.hide()}function r(){p=-1,o.removeClass("pprefix-item-shine"),f.$wrapper.hide(),PageData.forum.forum_id==f.feedbackBarId&&e.val().indexOf("\u3010\u6C42\u52A9\u54A8\u8BE2\u3011")>-1&&f.setAutoRespPrefix()}function a(i){var t,r=e.val(),a=e.data("prefix");t=a&&r.indexOf(a)>-1?r.replace(a,i):i,e.val(t).data("prefix",i),-1==e.val().indexOf("\u3010\u6C42\u52A9\u54A8\u8BE2\u3011")&&f.unsetAutoRespPrefix(),setTimeout(function(){e.trigger("focus")},100)}function s(e,i){"up"==e?0>p-1?p=o.length-1:p--:"down"==e?p+1==o.length?p=0:p++:"mouse"==e&&(p=i),f.$wrapper.is(":visible")||(t(),p=0),o.removeClass("pprefix-item-shine").eq(p).addClass("pprefix-item-shine")}var o,p=-1,f=this;f.$wrapper.html(i),o=f.$wrapper.children(),f.$titleWrap.on("click.showPPrefix",".normal-prefix",function(){f.showNormalPrefix(e),f.unsetAutoRespPrefix()}).on("blur.hidePPrefix",".normal-prefix",function(){r()}).on("keydown",".normal-prefix",function(i){switch(i.keyCode){case 8:t();break;case 40:i.preventDefault(),s("down");break;case 38:i.preventDefault(),s("up");break;case 13:i.preventDefault(),-1!=p&&($(".pprefix-item-shine").html()?a($(".pprefix-item-shine").html()):"",r(),PageData.forum.forum_id==f.feedbackBarId&&e.val().index("\u3010\u6C42\u52A9\u54A8\u8BE2\u3011")>-1&&f.setAutoRespPrefix());break;case 27:f.$wrapper.is(":visible")&&(i.preventDefault(),r());default:p=-1,r()}}),f.$wrapper.on("mousedown.pick",".pprefix-item",function(){a($(this).html())}).on("mouseover",".pprefix-item",function(){s("mouse",$(this).index())})}}});_.Module.define({path:"common/widget/PostSignature",requires:[],sub:{_template:['<option value="#{id}" #{isSelected}>#{name}</option>'].join(""),url:"/f/user/sign_list?t="+ +new Date,hasRequested:!1,isUsed:0,data:null,initial:function(e){this.$root=e.$container,this.gameSignature=e.gameSignature},init:function(){var e=this;this.hasRequested||(this.hasRequested=!0,null==this.data&&this.requestSignature()),this.$root.on("change",".j_use_signature",function(){e.isUsed=this.checked?1:0,e.toggleList(),$.post("/f/user/cm/sign_setneed",{need:e.isUsed,tbs:PosterContext.getContext().tbs})})},requestSignature:function(){var e=this;$.get(this.url,function(t){t=$.json.decode(t),t&&0==t.no&&(e.data=t.data,e.isUsed=e.data.need,e.$root.find(".j_use_signature").tbattr("checked",1==e.isUsed),e.buildList(t.data),e.toggleList())})},toggleList:function(){var e=this.$root.find(".j_signature_wrapper");1==this.isUsed?e.show():e.hide()},buildList:function(e){var t="",i=this.$root.find(".j_signature_wrapper"),s=i.find("select"),n=!1;if(e&&e.signs.length>0){for(var a=0,r=e.signs.length;r>a;a++)t+=$.tb.format(this._template,{id:e.signs[a].id,isSelected:e.signs[a].id==e.used_id?"selected=selected":"",name:e.signs[a].name});s.html(t),n=!0}this.gameSignature&&!$.isEmptyObject(this.gameSignature.signature_info)&&(this.rebuildList(this.gameSignature),n=!0),n||(i.empty(),i.html('\uFF08\u60A8\u76EE\u524D\u6CA1\u6709\u53EF\u4F7F\u7528\u7684\u7B7E\u540D\u6863\uFF0C&nbsp;<a style="color:#0449BE" target="_blank" href="/i/sys/jump?type=signsetting">\u67E5\u770B\u5168\u90E8</a>\uFF09'))},rebuildList:function(e){var t=this,i="",s="",n=t.$root.find(".j_use_signature"),a=this.$root.find(".j_signature_wrapper select");1==e.is_open&&(s="selected=selected",a.find(":selected").tbprop("selected",!1),0==n.tbprop("checked")&&n.trigger("click")),i+=$.tb.format(this._template,{id:12345678,isSelected:s,name:"\u6E38\u620F\u7B7E\u540D\u6863"}),a.prepend(i)}}});_.Module.define({path:"common/widget/MousePwd",requires:[],sub:{initial:function(){function t(t){if(!t)var t=window.event;var e=0,n=0;return t.pageX||t.pageY?(e=t.pageX,n=t.pageY):(t.clientX||t.clientY)&&(e=t.clientX+document.body.scrollLeft,n=t.clientY+document.body.scrollTop),[e,n]}function e(t){return t.offsetParent?t.offsetLeft+e(t.offsetParent):t.offsetLeft}function n(t){return t.offsetParent?t.offsetTop+n(t.offsetParent):t.offsetTop}function o(o){o.stopPropagation();var i=t(o),r=h[this.id];if(r)r.hover||(r.hover=!0,r.count++);else{var s=e(this),u=n(this),f=s+this.offsetWidth,a=u+this.offsetHeight;r=h[this.id]={hover:!0,count:1,left:s,top:u,right:f,buttom:a}}r["mouse"+r.count]||(r["mouse"+r.count]=[],r["time"+r.count]={start:(new Date).getTime()},h.ma.push(r["mouse"+r.count])),r["mouse"+r.count].push(i),p.push("1")}function i(e){e.stopPropagation();var n=t(e),o=h[this.className];if(o&&o.hover){if(n[0]&&n[0]>o.left&&n[0]<o.right&&n[1]&&n[1]>o.top&&n[1]<o.buttom)return;o["time"+o.count].end=(new Date).getTime(),o.hover=!1}p.push("0")}function r(){var t=h.ma.length;if(t>0){var e=h.ma[t-1];return e[e.length-1]}}function s(){var t="",e=p.length;return e>10&&(p=p.slice(e-10)),t=p.join(",")}function u(){if(m)return c;var t=[r(),s(),(new Date).getTime()-this.UTSTART,[screen.width,screen.height].join(",")].join("	");return c.c=f(t)+","+g+this.MOUSEPWD_CLICK,m=!0,c}function f(t){for(var e=[],n={},o=g%100,i=0,r=t.length;r>i;i++){var s=t.charCodeAt(i)^o;e.push(s),n[s]||(n[s]=[]),n[s].push(i)}return e}function a(t){this.elements=t,$.each(t,function(t,e){$("."+e.toString()).bind("mouseover",o),$("."+e.toString()).bind("mouseout",i),l[e.toString()]=t}),$("body").bind("click",function(){this.MOUSEPWD_CLICK=1})}this.UTSTART=(new Date).getTime(),this.MOUSEPWD_CLICK=0;var h={ea:[],ma:[]},c={},m=!1,g=(new Date).getTime(),l={},p=[];this.start=a,this.report=u,this.time=g}}});_.Module.define({path:"encourage/widget/PostGuessingNew/Dialog",require:["common/widget/PostService","common/widget/PostService/PostResultHandlerManager"],sub:{$dom:null,_options:{},initial:function(){},buildDialog:function(e){var i=new $.dialog({html:e.html,width:e.width,height:e.height,showTitle:!1,showShadow:!1,draggable:!1,holderClassName:"guessing_dialog "+e.holderClassName});return i.element.find(".j_guessing_close").on("click",function(){i.close()}),i}}});
;_.Module.define({path:"encourage/widget/PostGuessingNew/Item",sub:{_tpl:['<li class="guessing_item_wrapper <%=isLast ? "last": ""%>">','<a href="javascript:;" class="icon_up j_icon_up">',"</a>",'<div class="guessing_icon_list_wrapper">','<ul class="guessing_icon_list">','<li data-val="1"><i class="icon_shitou"></i></li>','<li data-val="2"><i class="icon_jiandao"></i></li>','<li data-val="3"><i class="icon_bu"></i></li>',"</ul>","</div>",'<a href="javascript:;" class="icon_down j_icon_down">',"</a>",'<a href="javascript:;" class="icon_remove j_icon_remove" title="\u79FB\u9664"></a>','<div class="guessing_no">',"<%=matchNo%>","</div>","</li>"].join(""),$dom:null,_options:{},curPos:0,initial:function(i){this._options=i,this._generateDom()},_generateDom:function(){var i=baidu.template,t=i(this._tpl,{matchNo:this._options.matchNo,isLast:this._options.isLast});this.$dom=$(t),this._options.$insertBefore?this.$dom.insertBefore(this._options.$insertBefore):this._options.$container&&this._options.$container.append(this.$dom),this._bindEvents()},_bindEvents:function(){var i=this,t=this.$dom.find(".j_icon_up"),s=this.$dom.find(".j_icon_down"),o=Math.round(2*Math.random());$.JsLoadManager.use("http://tb1.bdstatic.com/tb/cms/tbmall/guessing/jcarousellite_1.0.1.js",function(){i.$dom.data("curPos",o+1).find(".guessing_icon_list_wrapper").jCarouselLite({btnNext:s,btnPrev:t,visible:1,vertical:!0,circular:!0,start:o,afterEnd:function(t){var s=t.data("val");i.$dom.data("curPos",s)}})}),this.$dom.find(".j_icon_remove").on("click",function(){i.$dom.remove(),i.trigger("guessing:itemremove")}),this.$dom.on("mouseenter",function(){$(this).addClass("hover")}).on("mouseleave",function(){$(this).removeClass("hover")})},bindRemove:function(i){return this.bind("guessing:itemremove",i),this},getItemData:function(){var i=this.$dom.data("curPos");return i},setLastClass:function(){return this.$dom.addClass("last"),this},unsetLastClass:function(){return this.$dom.removeClass("last"),this},refresh:function(){var i,t=this.$dom.find(".j_icon_down"),s=10+Math.floor(3*Math.random()+1),o=100,n=function(){s>0?(s--,t.trigger("click"),i=setTimeout(n,o)):clearTimeout(i)};i=setTimeout(n,o)}}});
;_.Module.define({path:"encourage/widget/PostGuessingNew/Add",sub:{_tpl:['<li class="guessing_add_wrapper">','<a href="javascript:;" class="guessing_add j_guessing_add"></a>','<div class="guessing_no" id="add_guessing_no">',"<%=matchNo%>","</div>","</li>"].join(""),$dom:null,_options:{},initial:function(i){this._options=i,this._generateDom()},add:function(i){var n=this;this.bind("guessing:add",function(){n.$dom.find("#add_guessing_no").text(++n._options.matchNo),i()})},setMatchNo:function(i){this._options.matchNo=i,this.$dom.find("#add_guessing_no").text(i)},_generateDom:function(){var i=baidu.template,n=i(this._tpl,{matchNo:this._options.matchNo});this.$dom=$(n),this._options.$container.append(this.$dom),this._bindEvents()},_bindEvents:function(){var i=this;this.$dom.find(".j_guessing_add").on("click",function(){i.trigger("guessing:add")})}}});
;_.Module.define({path:"encourage/widget/PostGuessingNew",require:["common/widget/PostService","common/widget/PostService/PostResultHandlerManager","Item","Add","Dialog"],sub:{_tpl:['<div id="guessing_wrapper" class="guessing_wrapper guessing_wrapper_new guessing_wrapper_cid<%=cid%>">','<ul class="guessing_tab">','<li><i class="icon_guessing_tab"></i><a href="javascript:;">\u7ADE\u731C\u6E38\u620F</a></li>',"</ul>","<% if (login) { %>",'<div class="guessing_main">','<div class="guess_type">',"\u731C\u62F3\u7C7B\u578B\uFF1A",'<input type="radio" id="guess_streak_radio" class="j_guess_type" name="cid" value="1" <% if (cid == 1) { %> checked <% } %> />','<label id="guessing_label_cid1" for="guess_streak_radio" class="guess_radio_streak">\u8FDE\u80DC\u573A</label>','<input type="radio" id="guess_competitive_radio" class="j_guess_type" name="cid" value="0" <% if (cid == 0) { %> checked <% } %> />','<label id="guessing_label_cid0" for="guess_competitive_radio" class="guess_radio_competitive">\u7ADE\u6280\u573A</label>',"</div>",'<div class="guess_rule_tip">',"\u6BD4\u8D5B\u8BF4\u660E\uFF1A","<span>\u5BF9\u65B9\u9700\u89813\u5C40\u5168\u80DC\uFF0C\u624D\u53EF\u8D62\u8D70\u4F60\u7684T\u8C46\u3002\u5982\u679C\u7D2F\u8BA1\u6218\u80DC10\u4E2A\u5BF9\u624B\uFF0C\u53EF\u56DE\u6536\u672C\u91D1\u3002</span>","</div>",'<div class="guess_round_scores j_round_scores">',"\u53C2\u4E0E T \u8C46\uFF1A",'<a href="javascript:;" data-scores="100" <% if (roundScores == 100) { %> class="cur" <% } %>>\u666E\u901A\u5C40<b>(\u6BCF\u5C40100T\u8C46)</b></a>','<a href="javascript:;" data-scores="1000" <% if (roundScores == 1000) { %> class="cur" <% } %>>\u9AD8\u7AEF\u5C40<b>(\u6BCF\u5C401000T\u8C46)</b></a>','<a href="javascript:;" data-scores="3000" <% if (roundScores == 3000) { %> class="cur" <% } %>>\u571F\u8C6A\u5C40<b>(\u6BCF\u5C403000T\u8C46)</b></a>',"</div>",'<div class="guess_match_no">','<div class="guess_match_input_cid0 guess_match_input">',"\u53D1\u5E03\u5C40\u6570\uFF1A",'<input type="text" class="j_round_num" maxlength="2" value="3" />\u5C40','<a href="javascript:;" class="ui_btn ui_btn_s j_guessing_refresh">',"<span><em>\u5B8C\u5168\u968F\u673A</em></span>","</a>","</div>","</div>",'<div id="guessing_detail" class="guessing_detail">','<div class="guessing_detail_wrapper clearfix">',"<ul>","</ul>","</div>","</div>",'<a href="javascript:;" class="gueesing_prev j_gueesing_prev"></a>','<a href="javascript:;" class="gueesing_next j_gueesing_next"></a>','<div class="guessing_intro">','<div class="info">','<div class="info_title">T \u8C46\u652F\u51FA\uFF1A</div>','<div class="info_item"><span class="bold_text">\u731C\u62F3\u603B\u989D\uFF1A<i class="icon_tdou"></i><ins class="guesisng_fee j_guessing_fee">3000</ins></span></div>','<div class="info_item"><span class="bold_text">\u624B\u7EED\u8D39\uFF1A<i class="icon_tdou"></i><ins class="guesisng_fee j_sys_fee">300</ins></span></div>','<div class="info_item last"><a href="javascript:;" class="j_btn_charge ui_btn ui_btn_s">',"<span><em>\u5145\u503C</em></span>","</a></div>","</div>","</div>","</div>","<% } else { %>",'<div class="guessing_main unlogin">',"<div class=\"guessing_unlogin\"><div class=\"tb_poster_info poster_warning\">\u672C\u5427\u53D1\u8D34\uFF0C\u8BF7\u5148 <a href=\"#\" onclick=\"_.Module.use('common/widget/LoginDialog', ['', 'editor']);return false;\">\u767B\u5F55</a> | <a href=\"#\" onclick=\"TbCom.process('User','buildRegisterFrame',null,null,null,'editor');return false;\">\u6CE8\u518C</a>&nbsp;</div></div>","</div>","<% } %>","</div>",'<div class="guess_safe_tips2">','<i class="guess_safe_icon"></i><a href="http://tieba.baidu.com/tbmall/pass/set" target="_blank">\u7ACB\u5373\u8BBE\u7F6E\u652F\u4ED8\u5BC6\u7801</a>\uFF0C\u964D\u4F4ET\u8C46\u88AB\u76D7\u98CE\u9669\uFF01',"</div>",'<div class="post_guessing_btn">','<a href="#" class="<% if (login) { %>ui_btn ui_btn_m<% } else { %>ui_btn_disable ui_btn_m_disable<% } %> j_guessing_post">',"<span><em>\u53D1\u8868\u731C\u62F3</em></span>","</a>",'<a href="/tbmall/guess/center" class="post_guessing_link" target="_blank">\u53C2\u52A0\u8D34\u5427\u201C\u62F3\u738B\u201D\u4E89\u9738\u8D5B>></a>',"</div>"].join(""),_dialog:null,_root:null,_defaultAttr:{width:630,height:512,visible:3,container:$("body"),modal:!1,autoCenter:!1,fixed:!1,holderClassName:"guessing_holder",page:"frs",cid:1,roundScores:1e3},_attr:{},_items:[],_scroll:{step:130,pos:0},_round_scores:0,initial:function(s){this._mergeAttr(s),this._round_scores=this._attr.roundScores,this._render(),this._initPostService(),this._bindEvents()},_initPostService:function(){var s=this;this.postService=this.use("common/widget/PostService"),this.postService.success(function(){$('<div class="tb_poster_info poster_success poster_guessing_success"><p><strong>\u53D1\u8868\u731C\u62F3\u8D34\u6210\u529F\uFF01</strong></div>').appendTo(s._root),setTimeout(function(){$.tb.location.reload()},500)}).complete(function(){s._toggleSubmitButton(!1)})},_bindEvents:function(){var s=this;this._root.on("click",".j_btn_charge",function(){_.Module.use("common/widget/tcharge_dialog")}),this._root.on("click",".j_gueesing_prev",function(){0!=s._scroll.pos&&s._scrollToPos(s._scroll.pos-1)}),this._root.on("click",".j_gueesing_next",function(){s._scroll.pos!=s._items.length-s._attr.visible&&s._scrollToPos(s._scroll.pos+1)}),this._root.find(".j_guessing_refresh").on("click",function(){var e=Number(s._root.find(".j_round_num").val());s._items=[],$("#guessing_detail>div>ul").html(""),s._renderCompetitive(e),e-s._attr.visible>0?s._scrollToPos(e-s._attr.visible):s._scrollToPos(0)}),this._root.find(".j_round_scores a").on("click",function(){s._root.find(".j_round_scores a.cur").removeClass("cur"),$(this).addClass("cur"),s._round_scores=parseInt($(this).data("scores")),s._calcFee()}),this._root.find(".j_guess_type").on("change",function(){var e=s._root.find("input[name='cid']:checked").val();s._attr.cid=e,s._items=[],$("#guessing_detail>div>ul").html(""),s._root.find(".j_gueesing_next, .j_gueesing_prev").hide(),0==e?s._renderCompetitive():s._renderStreak(),s._root.find("#guessing_wrapper").tbattr("class","guessing_wrapper guessing_wrapper_new guessing_wrapper_cid"+e)}),this._root.find(".j_round_num, .j_back_num").on("keydown",function(s){var e=s.which,t=!1;return s.shiftKey&&(9==e&&(t=!0),t=!1),(57>=e&&e>=48||37==e||39==e||8==e||9==e||46==e||105>=e&&e>=96||229==e)&&(t=!0),t}).on("keyup change paste",function(){var s=$.trim($(this).val());s&&(s=s.replace(/\D/g,""),$(this).val(s)),0===parseInt(s,10)&&$(this).val(1)}),$(window).on("resize",function(){s._adjustDialog()})},_render:function(){var s=this,e=baidu.template,t=this._attr,i={};i.parr_score_total=0,i.cid=this._attr.cid,i.roundScores=this._attr.roundScores,i.login=PageData.user&&PageData.user.is_login,PageData.user&&PageData.user.Parr_scores&&(i.parr_score_total=PageData.user.Parr_scores.scores_total),html=e(this._tpl,i);var a=t.container,n={html:html,width:t.width,height:t.height,modal:t.modal,fixed:t.fixed,autoCenter:t.autoCenter,showShadow:!1,draggable:!1,closeable:!0,holderClassName:t.holderClassName};if(!t.autoCenter){var o=a.offset();n.left=o.left,n.top=o.top}this._dialog=new $.dialog(n),this._root=this._dialog.element,0==i.cid?this._renderCompetitive():this._renderStreak(),this._root.find(".j_guessing_post").on("click",function(e){e.preventDefault(),$(this).is(".ui_btn_disable")||s.post()})},_renderStreak:function(){var s=1,e=$("#guessing_detail>div>ul");for(this._root.find(".j_round_num").val(3),$("#guessing_detail").scrollLeft(0);3>=s;s++){var t=this.use("Item",{$container:e,matchNo:s});this._items.push(t)}e.removeClass("guessing_competitive_detail_list").addClass("guessing_streak_detail_list"),this._calcFee()},_renderCompetitive:function(s){for(var e=this,t=1,i=s||this._attr.visible,a=$("#guessing_detail>div>ul");i>=t;t++){var n=this.use("Item",{$container:a,matchNo:t,isLast:t==i});n.bindRemove(function(s){return function(){e._items.pop(),e._items.length>1&&e._items[e._items.length-1].setLastClass(),o.setMatchNo(s),e._scroll.pos-=1,e._items.length>=e._attr.visible&&e._scrollToPos(e._items.length-e._attr.visible),e._root.find(".j_round_num").val(e._items.length),e._calcFee()}}(t)),this._items.push(n)}a.removeClass("guessing_streak_detail_list").addClass("guessing_competitive_detail_list");var o=this.use("Add",{$container:$("#guessing_detail>div>ul"),matchNo:i+1});o.add(function(){e._items[e._items.length-1].unsetLastClass();var s=e.use("Item",{$insertBefore:$("#guessing_detail>div>ul>li.guessing_add_wrapper"),matchNo:e._items.length+1}).bindRemove(function(){e._items.pop(),e._items.length>1&&e._items[e._items.length-1].setLastClass(),o.setMatchNo(e._items.length+1),e._items.length>=e._attr.visible&&e._scrollToPos(e._items.length-e._attr.visible),e._root.find(".j_round_num").val(e._items.length),e._calcFee()}).setLastClass();e._items.push(s),e._items.length>e._attr.visible&&e._scrollToPos(e._items.length-e._attr.visible),e._root.find(".j_round_num").val(e._items.length),e._calcFee()}),e._calcFee()},_calcFee:function(){var s=this._round_scores,e=this._items.length,t=this._attr.cid,i=this._root.find(".j_guessing_fee"),a=this._root.find(".j_sys_fee"),n=0;n=0==t?s*e:10*s;var o=.1*n;i.text(n),a.text(o)},post:function(){var s=this._validateContent();!this.postService.isPosting()&&s&&(this.postService.post("guessingThreadNew",this._getPostData(),PosterContext.getContext()),this._toggleSubmitButton(!0))},_getGuessing:function(){for(var s={},e=0,t=this._items.length;t>e;e++)s["guessing["+e+"]"]=this._items[e].getItemData();return s},_getBackNum:function(){return 10},_getPostData:function(){var s=$.tb.location.getSearchValue(),e={content:"",fid:"12583317",kw:"\u8D34\u5427\u5609\u5E74\u534E"};return s&&s.kw&&s.fid&&(e.kw=decodeURIComponent(s.kw),e.fid=s.fid),$.isEmptyObject(PageData.forum)||(e.fid=PageData.forum.id,e.kw=PageData.forum.name),e.cid=this._attr.cid,e.back_num=this._getBackNum(),e.round_scores=this._round_scores,$.extend(e,this._getGuessing()),e},_adjustDialog:function(){if("frs"==PosterContext.context.product){var s=this._attr.container,e=s.offset();this._dialog.element.css({left:e.left,top:e.top})}},_scrollToPos:function(s){this._scroll.pos=s;var e=s*this._scroll.step;"frs"==this._attr.page&&(e=s*(this._scroll.step+2)),this._root.find("#guessing_detail").animate({scrollLeft:e});var t=s!=this._items.length-this._attr.visible;this._root.find(".j_gueesing_next").toggle(t);var i=0!=s;this._root.find(".j_gueesing_prev").toggle(i)},_toggleSubmitButton:function(s){this._root.find(".j_guessing_post").toggleClass("ui_btn ui_btn_m",!s),this._root.find(".j_guessing_post").toggleClass("ui_btn_disable ui_btn_m_disable",s)},_validateContent:function(){return!0},_mergeAttr:function(s){this._attr=$.extend(!0,{},this._defaultAttr);for(var e in s)this._defaultAttr.hasOwnProperty(e)&&(this._attr[e]=s[e])}}});F.module("props/widget/propsData",function(t,e){function n(){this._api={getProps:"/tbmall/get/userProps"}}var o=null,a={};n.prototype={getProps:function(t,e,n){if(arguments.length<2)throw"At least 2 arguments needed";"undefined"==typeof n?(n=e,e=!0):e=!!e,e&&a[t]?n(a[t]):$.get(this._api.getProps,{category:t,t:(new Date).getTime()},function(e){a[t]=e.data[t]||{},n(a[t])})}},n.getInstance=function(){return null===o&&(o=new n),o},e.getInstance=n.getInstance});_.Module.define({require:["props/widget/propsData"],path:"common/component/BubbleFactory",sub:{_curPropId:0,_bubbleDefaultProp:null,_list:[{id:0,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/nobubble.png",name:"\u4E0D\u4F7F\u7528\u6C14\u6CE1",type:0},{id:1010020,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/xionghaizhi.jpg",name:"\u5C0F\u718A\u5F00\u5B66",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/xionghaizhi_01.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/xionghaizhi_02.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/xionghaizhi_03.png",topHeight:"11",bottomHeight:"108"}},{id:1010019,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/piaoliupings.jpg",name:"\u6F02\u6D41\u74F6",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/piaoliuping_1.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/piaoliuping_2.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/piaoliuping_3.png",topHeight:"110",bottomHeight:"34"}},{id:1010016,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/panpasis.jpg",name:"\u6F58\u5E15\u65AF\u4E4B\u9E70",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/panpasi_1.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/panpasi_2.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/panpasi_3.png",topHeight:"54",bottomHeight:"91"}},{id:1010015,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/riermans.jpg",name:"\u65E5\u8033\u66FC\u6218\u8F66",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/rierman_1.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/rierman_2.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/rierman_3.png",topHeight:"50",bottomHeight:"65"}},{id:1010014,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/caoshangyingfeis.jpg",name:"\u8349\u957F\u83BA\u98DE",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/caoshangyingfei_1.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/caoshangyingfei_2.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/caoshangyingfei_3.png",topHeight:"61",bottomHeight:"58"}},{id:1010012,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/xingnis.jpg",name:"\u6765\u81EA\u661F\u661F\u7684\u4F60",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/xingni_1.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/xingni_02.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/xingni_3.png",topHeight:"35",bottomHeight:"67"}},{id:1010011,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/qingrens.jpg",name:"\u4E18\u6BD4\u7279",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/qingren_1.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/qingren_02.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/qingren_3.png",topHeight:"60",bottomHeight:"66"}},{id:1010010,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/chunjies.jpg",name:"\u6B22\u5EA6\u6625\u8282",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/chunjie_1.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/chunjie_2.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/chunjie_3.png",topHeight:"35",bottomHeight:"68"}},{id:1010007,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/yuandans.jpg",name:"\u559C\u5E86\u5143\u65E6",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/yuandan_01.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/yuandan_02.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/yuandan_03.png",topHeight:"24",bottomHeight:"56"}},{id:1010006,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/shengdans.jpg",name:"\u5FEB\u4E50\u5723\u8BDE",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/shengdian_1.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/shengdan_2.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/shengdan_3.png",topHeight:"26",bottomHeight:"72"}},{id:1010005,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/zhangyus.jpg",name:"\u6CE1\u6FA1\u7AE0\u9C7C",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/zhangyu_1.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/zhangyu_2.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/zhangyu_3.png",topHeight:"66",bottomHeight:"70"}},{id:1010004,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/tuhaos.jpg",name:"\u94BB\u77F3\u571F\u8C6A\u91D1",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/tuhao_1.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/tuhao_2.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/tuhao_3.png",topHeight:"37",bottomHeight:"42"}},{id:1010003,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/dashus.jpg",name:"\u5FAE\u7B11\u5927\u53D4",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/shushu_1.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/shushu_2.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/shushu_3.png",topHeight:"31",bottomHeight:"55"}},{id:1010002,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/dazuiguais.jpg",name:"\u5927\u5634\u602A",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/dazuiguai_1.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/dazuiguai_2.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/dazuiguai_3.png",topHeight:"78",bottomHeight:"34"}},{id:1010001,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/xiaolus.jpg",name:"\u773A\u671B\u5C0F\u9E7F",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/xiaolu_1.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/xiaolu_2.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/xiaolu_3.png",topHeight:"45",bottomHeight:"55"}}],_npcPropsList:[{id:1010101,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/lufei.jpg",name:"\u8DEF\u98DE",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/lufei_01.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/lufei_02.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/lufei_03.png",topHeight:"19",bottomHeight:"101"}},{id:1010102,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/mingren.jpg",name:"\u9E23\u4EBA",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/mingren_01.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/mingren_02.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/mingren_03.png",topHeight:"42",bottomHeight:"117"}},{id:1010103,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/nazi.jpg",name:"\u7EB3\u5179",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/nazi_01.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/nazi_02.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/nazi_03.png",topHeight:"18",bottomHeight:"124"}},{id:1010104,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/huangyuge.jpg",name:"\u9EC4\u9C7C\u54E5",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/huangyuge_01.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/huangyuge_02.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/huangyuge_03.png",topHeight:"111",bottomHeight:"27"}},{id:1010105,smallPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/shouwangzhe.jpg",name:"\u6212\u8272\u5B88\u671B\u8005",type:1,background:{topPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/shouwangzhe_01.png",middlePic:"http://tb1.bdstatic.com/tb/cms/post/bubble/shouwangzhe_02.png",bottomPic:"http://tb1.bdstatic.com/tb/cms/post/bubble/shouwangzhe_03.png",topHeight:"25",bottomHeight:"60"}}],initial:function(){PageData.user&&PageData.user.mParr_props&&PageData.user.mParr_props.default_bubble&&PageData.user.mParr_props.default_bubble.client&&PageData.user.mParr_props.default_bubble.client.props_id&&(this._bubbleDefaultProp=PageData.user.mParr_props.default_bubble.client,this._curPropId=this._bubbleDefaultProp.props_id)},loadUserPropsData:function(t){var b=this,i=this.require("props/widget/propsData"),o=i.getInstance();o.getProps(101,function(i){b._userPropList=i,b._list=$.map(b._list,function(t){return t.background=t.background||{},t.background.id=t.id,t.isBuy=t.background.isBuy=b.hasUserPower(t.id),t.loseTime=t.isBuy?b.hasNearLosePower(t.id):0,t}),b._list=b._list.concat($.map(b._npcPropsList,function(t){var i=b.hasUserPower(t.id);if(i)return t.background=t.background||{},t.background.id=t.id,t.isBuy=t.background.isBuy=i,t.loseTime=t.isBuy?b.hasNearLosePower(t.id):0,t})),b._npcPropsList=[],t()})},hasUserPower:function(t){if(0==t)return!0;var b=this.get(t),i=this._userPropList[b.id]||{},o=1*new Date,s=(parseInt(1e3*i.end_time)-o)/864e5;return 0==b.type?!0:i&&s>0?!0:!1},hasNearLosePower:function(t){var b=this._userPropList[t||0]||{},i=1*new Date,o=(parseInt(1e3*b.end_time)-i)/864e5;return b&&o>0&&2>o?parseInt(o+1):0},get:function(t){return _.filter(this._list.concat(this._npcPropsList),function(b){return b.id==t})[0]},getRandom:function(){var t=parseInt(Math.random()*this._list.length);return 0==this._list[t].id||this._list[t].id==this._curPropId?this.getRandom():this._list[t].id},getAll:function(){return this._list},setPropId:function(t){this._curPropId=this.get(t)?t:this._curPropId,PageData.user.bubble_id=this._curPropId},getPropId:function(){return this._curPropId},getCurrent:function(){if(this._bubbleDefaultProp.props_id===this._curPropId){var t=$.extend(this.get(this._curPropId),this._bubbleDefaultProp);t.background=t.background||{},t.background.id=t.id,t.isBuy=t.background.isBuy=1e3*t.end_time>new Date;var b=(parseInt(1e3*t.end_time)-1e3*new Date)/864e5;return t.loseTime=t.isBuy?b>0&&2>b?b+1:0:0,t}return this.get(this._curPropId)}}});_.Module.define({path:"bawu/widget/complaintBarOwner",requires:["bawu/widget/complaintBarOwner/complaintBarOwnerTemplate"],sub:{isAddDialogTop:!1,initial:function(t){this.options=$.extend({uname:""},t),this.template=this.getInstance("bawu/widget/complaintBarOwner/complaintBarOwnerTemplate"),this.complaintWrapperTemplate=baidu.template(this.template.wrapper,this.options),this.complaintFailTemplate=this.template.fail,this.complaintSuccessTemplate=this.template.success,this.barItemTemplate=this.template.barItem,this.defaultFormData={manager_uid:"",manager_uname:"",forum_id:"",forum_name:"",complaint_type:"",reason:""},this.initDialog(),this._bindEvent()},initDialog:function(){if(this.$dialog)this.$dialog.setContent(this.complaintWrapperTemplate);else{this.$dialog=new $.dialog({html:this.complaintWrapperTemplate,title:"\u6295\u8BC9\u5427\u4E3B",show:!1,width:500,holderClassName:"complaint_bar_owner_dialog"});var t=this;this.$dialog.bind("onclose",function(e){return e.stopImmediatePropagation(),t.$dialog.hide(),!1});var e=this.$dialog.hide;this.$dialogElement=this.$dialog.element,this.$dialogElement.css("z-index",51e3),this.$dialog.hide=function(){t.isAddDialogTop&&(t.$dialogElement.css("top",parseInt(t.$dialogElement.css("top"),10)+70),t.isAddDialogTop=!1),e.call(t.$dialog)}}this.$submitBtn=this.$dialogElement.find(".submit_btn"),this.$barTypeList=this.$dialogElement.find(".j_bar_type"),this.$complaintReasonLayer=this.$dialogElement.find(".j_complaint_reason"),this.formData=$.extend({},this.defaultFormData)},_bindEvent:function(){var t=this,e=t.$dialogElement;e.on("blur",".j_bar_owner_id",function(e){var a=$(e.currentTarget),i=$.trim(a.val());t.checkBarOwnerName(i)}).on("keyup",".j_complaint_reason .textarea",function(e){var a=$(e.currentTarget);t.formData.reason=window.encodeURI($.trim(a.val())),t.checkCanSubmit()}).delegate(".radio","click",function(a){var i=$(a.currentTarget);"type"===i.tbattr("name")?(t.formData.forum_id=i.val(),t.formData.forum_name=window.encodeURI(i.data("name"))):(t.$complaintReasonLayer.show(),t.formData.complaint_type=i.val(),t.isAddDialogTop||(e.css("top",parseInt(e.css("top"),10)-70),t.isAddDialogTop=!0)),t.checkCanSubmit()}).delegate(".j_submit_btn","click",function(){if(t.checkCanSubmit()){var e=t.formData;$.post("/pmc/tousu/commitTousu",e,function(e){var a;a=0===e.errno?t.complaintSuccessTemplate:t.complaintFailTemplate,t.$resultDialog?t.$resultDialog.setContent(a):(t.$resultDialog=new $.dialog({html:a,title:"\u6295\u8BC9\u5427\u4E3B",show:!1,width:500}),t.$resultDialog.element.delegate(".j_back_btn","click",function(){t.$dialog.show(),t.$resultDialog.hide()}).delegate(".j_close_btn","click",function(){t.$dialog.hide(),t.$resultDialog.hide(),t.formData=$.extend({},this.defaultFormData)}).bind("onclose",function(e){return e.stopImmediatePropagation(),t.$resultDialog.hide(),!1})),202===e.errno&&t.$resultDialog.element.find(".j_error_remind").html("\u60A8\u5DF2\u7ECF\u6295\u8BC9\u8FC7\u8BE5\u5427\u4E3B"),t.$resultDialog.show(),t.$dialog.hide()},"json")}})},checkBarOwnerName:function(t){var e=this;return t?(t=window.encodeURI(t),$.get("/pmc/tousu/getRole",{manager_uname:t},function(a){var i=$.extend({},e.defaultFormData),o=a.data,n=a.errno;if(0===n)i={manager_uid:o.manager_uid,manager_uname:t},e.$barTypeList.html(baidu.template(e.barItemTemplate,o)),e.$dialogElement.removeClass("check_error"),1===o.roles.length&&(i.forum_id=o.roles[0].forum_id,i.forum_name=window.encodeURI($("<span>"+o.roles[0].forum_name+"</span>").text()));else{var l={207:"\u8BE5\u5427\u4E3B\u4E3A\u5B98\u65B9\u6307\u5B9A\u5427\u4E3B\uFF0C\u6709\u4E13\u95E8\u4EBA\u5458\u8FDB\u884C\u76D1\u7763\uFF0C\u76EE\u524D\u4E0D\u63A5\u53D7\u7528\u6237</br>\u6295\u8BC9\u54E6~",204:"\u6B64\u4EBA\u4E0D\u662F\u5427\u4E3B\u54E6~"},r=e.$dialogElement.find(".id_remind");e.$dialogElement.addClass("check_error"),l[n]&&r.html(l[n]),e.$barTypeList.html("")}i.tbs=a.tbs,$.extend(e.formData,i),e.checkCanSubmit()},"json"),void 0):(e.formData.manager_uname="",e.$barTypeList.html(""),e.checkCanSubmit(),void 0)},checkCanSubmit:function(){var t=this;for(var e in t.formData)if(t.formData.hasOwnProperty(e)){var a=t.formData[e];if(void 0!==a&&""===a)return t.$submitBtn.removeClass("j_submit_btn").addClass("disable"),!1}return t.$submitBtn.removeClass("disable").addClass("j_submit_btn"),!0},showDialog:function(){this.initDialog(),this.$dialog.show(),this.options&&this.options.uname&&this.checkBarOwnerName(this.options.uname)}}});F.module("common/widget/paypost_data",function(n,t){var e={},o=null,u=function(){};u.prototype={set:function(n,t){return e[n]=t,!0},get:function(n){return e[n]?e[n]:null}},u.getInstance=function(){return o||(o=new u),o},t.getInstance=u.getInstance},[]);_.Module.define({path:"encourage/widget/paypost_agree_dialog",require:["common/widget/paypost_data"],sub:{dialog:null,nextFnStack:[],tpl:["<div>","<h3>\u8D34\u5427\u201C\u4ED8\u8D39\u53EF\u89C1\u201D\u529F\u80FD\u7528\u6237\u4F7F\u7528\u534F\u8BAE</h3>",'<div class="scroll_section">',"<ul>","<li><b>\u3010\u9996\u90E8\u53CA\u5BFC\u9009\u3011</b></li>","<li>\u4EFB\u4F55\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u7684\u53D1\u8D34\u548C\u6D4F\u89C8\u7528\u6237\uFF08\u4EE5\u4E0B\u7EDF\u79F0\u4E3A\u201C\u60A8\u201D\uFF09\u5747\u5E94\u4ED4\u7EC6\u9605\u8BFB\u987B\u77E5\uFF0C\u7528\u6237\u53D1\u8D34\u548C\u6D4F\u89C8\u7684\u884C\u4E3A\u5C06\u88AB\u89C6\u4E3A\u5BF9\u672C\u987B\u77E5\u5168\u90E8\u5185\u5BB9\u7684\u8BA4\u53EF\u3002\u672C\u987B\u77E5\u89C6\u4E3A\u300A\u767E\u5EA6\u514D\u8D23\u58F0\u660E\u300B\u3001\u300A\u8D34\u5427\u534F\u8BAE\u300B\u3001\u300A\u5427\u4E3B\u5236\u5EA6\u300B\u3001\u300AT\u8C46\u4F7F\u7528\u987B\u77E5\u300B\u7684\u8865\u5145\u89C4\u5B9A\uFF0C\u662F\u5176\u4E0D\u53EF\u5206\u5272\u7684\u7EC4\u6210\u90E8\u5206\uFF0C\u4E0E\u5176\u6784\u6210\u7EDF\u4E00\u6574\u4F53\u3002\u672C\u987B\u77E5\u4E0E\u4E0A\u8FF0\u5185\u5BB9\u5B58\u5728\u51B2\u7A81\u7684\uFF0C\u4EE5\u672C\u89C4\u5219\u4E3A\u51C6\u3002\u672C\u987B\u77E5\u5185\u5BB9\u540C\u65F6\u5305\u62EC\u767E\u5EA6\u53EF\u80FD\u4E0D\u65AD\u53D1\u8868\u7684\u5173\u4E8E\u672C\u987B\u77E5\u7684\u76F8\u5173\u89C4\u5219\u3001\u4E1A\u52A1\u89C4\u5219\u7B49\u5185\u5BB9\u3002\u4E0A\u8FF0\u5185\u5BB9\u4E00\u7ECF\u6B63\u5F0F\u53D1\u8868\uFF0C\u5373\u4E3A\u672C\u987B\u77E5\u4E0D\u53EF\u5206\u5272\u7684\u7EC4\u6210\u90E8\u5206\uFF0C\u60A8\u540C\u6837\u5E94\u5F53\u9075\u5B88\u3002</li>","<li><b>\u7B2C\u4E00\u7AE0 \u4EC0\u4E48\u662F\u8D34\u5B50\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u4EE5\u53CA\u5982\u4F55\u4F7F\u7528\u8D34\u5B50\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD</b></li>","<li>\u7528\u6237\u4E3A\u6D4F\u89C8\u4F18\u8D28\u5185\u5BB9\u800C\u5411\u8D34\u5427\u53D1\u8D34\u7528\u6237\u4ED8\u8D39\u7684\u529F\u80FD\u3002<br />\u60A8\u5728\u5427\u5185\u5347\u81F36\u7EA7\u5373\u53EF\u5F00\u542F\u8BE5\u529F\u80FD\uFF0C\u5728\u53D1\u8D34\u6846\u70B9\u51FB\u201C\u4ED8\u8D39\u53EF\u89C1\u201D\u6309\u94AE\u6253\u5F00\u4ED8\u8D39\u5185\u5BB9\u7F16\u8F91\u533A\uFF0C\u7F16\u8F91\u533A\u4E0A\u65B9\u6587\u672C\u6846\u8F93\u5165\u552E\u4EF7\uFF08\u5373\u51FA\u552E\u7684T\u8C46\u6570\uFF09\uFF0C\u7136\u540E\u5728\u4ED8\u8D39\u533A\u57DF\u548C\u6B63\u5E38\u533A\u57DF\u5206\u522B\u7F16\u8F91\u5B8C\u6210\u540E\u70B9\u51FB\u201C\u53D1\u8868\u201D\u5373\u53EF\u3002</li>","<li><b>\u7B2C\u4E8C\u7AE0 \u8D23\u4EFB\u6761\u6B3E</b></li>","<li>\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u8FC7\u7A0B\u4E2D\u6240\u521B\u9020\u7684\u5185\u5BB9\uFF0C\u5747\u6765\u81EA\u70ED\u5FC3\u7528\u6237\u7684\u79EF\u6781\u53D1\u8868\u3002\u767E\u5EA6\u81EA\u8EAB\u4E0D\u7F16\u8F91\u6216\u4FEE\u6539\u7528\u6237\u53D1\u8868\u7684\u5185\u5BB9\u3002\u5BF9\u4E8E\u7528\u6237\u5728\u4F7F\u7528\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u8FC7\u7A0B\u4E2D\u6240\u53D1\u8868\u5185\u5BB9\u7684\u771F\u5B9E\u6027\u5F15\u53D1\u7684\u5168\u90E8\u8D23\u4EFB\uFF0C\u7531\u7528\u6237\u81EA\u884C\u627F\u62C5\u3002\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u7684\u7528\u6237\u4E0D\u80FD\u4FB5\u72AF\u5305\u62EC\u4ED6\u4EBA\u7684\u8457\u4F5C\u6743\u5728\u5185\u7684\u77E5\u8BC6\u4EA7\u6743\u4EE5\u53CA\u5176\u4ED6\u6743\u5229\u3002\u4E00\u65E6\u7531\u4E8E\u7528\u6237\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u8FC7\u7A0B\u4E2D\u53D1\u8868\u7684\u5185\u5BB9\u53D1\u751F\u6743\u5229\u7EA0\u7EB7\u6216\u4FB5\u72AF\u4E86\u4EFB\u4F55\u7B2C\u4E09\u65B9\u7684\u5408\u6CD5\u6743\u76CA\uFF0C\u5176\u8D23\u4EFB\u7531\u7528\u6237\u672C\u4EBA\u627F\u62C5\uFF0C\u56E0\u6B64\u7ED9\u767E\u5EA6\u6216\u4EFB\u4F55\u7B2C\u4E09\u65B9\u9020\u6210\u635F\u5931\u7684\uFF0C\u7528\u6237\u5E94\u8D1F\u8D23\u5168\u989D\u8D54\u507F\u3002</li>","<li>\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u7684\u7528\u6237\u53EF\u4EE5\u4E3A\u4ECB\u7ECD\u3001\u8BC4\u8BBA\u3001\u7814\u7A76\u7B49\u76EE\u7684\uFF0C\u5728\u5408\u7406\u7684\u8303\u56F4\u5185\u9002\u5F53\u5F15\u7528\u4ED6\u4EBA\u5DF2\u7ECF\u53D1\u8868\u7684\u4F5C\u54C1\uFF0C\u4F46\u5E94\u5F53\u6CE8\u660E\u4F5C\u8005\u59D3\u540D\u3001\u4F5C\u54C1\u540D\u79F0\uFF0C\u5E76\u4E0D\u5F97\u4FB5\u72AF\u8457\u4F5C\u6743\u4EBA\u53CA\u5176\u4ED6\u6743\u5229\u4EBA\u7684\u5408\u6CD5\u6743\u76CA\u3002</li>","<li>\u7528\u6237\u627F\u8BFA\uFF1A\u5176\u5728\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u8FC7\u7A0B\u4E2D\u6240\u53D1\u8868\u7684\u6240\u6709\u5185\u5BB9\u7B26\u5408\u4E2D\u56FD\u6CD5\u5F8B\u6CD5\u89C4\u548C\u89C4\u8303\u6027\u6587\u4EF6\u7684\u76F8\u5173\u89C4\u5B9A\uFF0C\u4E0D\u4FB5\u72AF\u4EFB\u4F55\u7B2C\u4E09\u65B9\u7684\u5408\u6CD5\u6743\u76CA\u3002\u5982\u7528\u6237\u8FDD\u53CD\u524D\u8FF0\u4FDD\u8BC1\uFF0C\u767E\u5EA6\u8D34\u5427\u6709\u6743\u5220\u9664\u76F8\u5173\u6587\u672C\u548C\u9644\u4EF6\u5185\u5BB9\uFF0C\u5E76\u53EF\u4EE5\u6682\u505C\u6216\u7EC8\u6B62\u5411\u8BE5\u7528\u6237\u63D0\u4F9B\u670D\u52A1\u3002\u5982\u56E0\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u7684\u7528\u6237\u53D1\u8868\u7684\u5185\u5BB9\u4FB5\u72AF\u4E86\u7B2C\u4E09\u65B9\u7684\u5408\u6CD5\u6743\u5229\uFF0C\u7B2C\u4E09\u65B9\u5411\u767E\u5EA6\u63D0\u51FA\u5F02\u8BAE\uFF0C\u767E\u5EA6\u8D34\u5427\u6709\u6743\u5220\u9664\u76F8\u5173\u7684\u5185\u5BB9\u3002\u63D0\u51FA\u5F02\u8BAE\u8005\u548C\u5185\u5BB9\u53D1\u8868\u8005\u4E4B\u95F4\u7684\u76F8\u5173\u6CD5\u5F8B\u95EE\u9898\u5F97\u5230\u89E3\u51B3\u540E\uFF0C\u4EE5\u6B64\u4E3A\u4F9D\u636E\uFF0C\u5411\u767E\u5EA6\u8D34\u5427\u63D0\u51FA\u7533\u8BF7\uFF0C\u767E\u5EA6\u8D34\u5427\u53EF\u4EE5\u6062\u590D\u88AB\u5220\u9664\u7684\u5185\u5BB9\u3002\u5BF9\u4E8E\u7528\u6237\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u8FC7\u7A0B\u4E2D\u53D1\u8868\u7684\u4EFB\u4F55\u5185\u5BB9\uFF0C\u7528\u6237\u540C\u610F\u767E\u5EA6\u5728\u5168\u4E16\u754C\u8303\u56F4\u5185\u4EAB\u6709\u514D\u8D39\u7684\u3001\u6C38\u4E45\u7684\u3001\u4E0D\u53EF\u64A4\u9500\u7684\u3001\u975E\u6392\u4ED6\u6027\u7684\u4F7F\u7528\u548C\u518D\u8BB8\u53EF\u7684\u6743\u5229\u3002\u767E\u5EA6\u4EAB\u6709\u4FEE\u6539\u3001\u590D\u5236\u3001\u53D1\u884C\u3001\u8868\u6F14\u3001\u5C55\u89C8\u3001\u4FE1\u606F\u7F51\u7EDC\u4F20\u64AD\u3001\u6539\u7F16\u3001\u7FFB\u8BD1\u3001\u6C47\u7F16\u7B49\u6743\u5229\u3002\u540C\u65F6\uFF0C\u5BF9\u4E8E\u7528\u6237\u4F7F\u7528\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u8FC7\u7A0B\u4E2D\u53D1\u8868\u5185\u5BB9\u7684\u4FB5\u6743\u884C\u4E3A\uFF0C\u7528\u6237\u6388\u6743\u767E\u5EA6\u5728\u5168\u4E16\u754C\u8303\u56F4\u5185\u8FDB\u884C\u7EF4\u6743\u3002</li>","<li><b>\u7B2C\u4E09\u7AE0 \u672C\u987B\u77E5\u9879\u4E0B\u670D\u52A1\u7684\u53D8\u66F4\u3001\u4E2D\u6B62\u6216\u7EC8\u6B62</b></li>","<li>\u60A8\u5145\u5206\u4E86\u89E3\u5E76\u540C\u610F\uFF0C\u7531\u4E8E\u4E92\u8054\u7F51\u670D\u52A1\u7684\u7279\u6B8A\u6027\uFF0C\u767E\u5EA6\u53EF\u80FD\u4F1A\u6309\u7167\u76F8\u5173\u6CD5\u89C4\u3001\u53CC\u65B9\u7EA6\u5B9A\u6216\u5728\u5176\u4ED6\u5FC5\u8981\u65F6\uFF0C\u4E2D\u6B62\u6216\u7EC8\u6B62\u5411\u60A8\u63D0\u4F9B\u76F8\u5E94\u670D\u52A1\uFF0C\u5C4A\u65F6\uFF0C\u767E\u5EA6\u4F1A\u4F9D\u6CD5\u4FDD\u62A4\u60A8\u7684\u5408\u6CD5\u6743\u76CA\u3002</li>","<li><b>\u7B2C\u56DB\u7AE0 \u9644\u5219</b></li>","<li>\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u53EF\u89C1\u529F\u80FD\u5982\u56E0\u7CFB\u7EDF\u7EF4\u62A4\u6216\u5347\u7EA7\u7B49\u800C\u9700\u6682\u505C\u670D\u52A1\u65F6\uFF0C\u5C06\u4E8B\u5148\u516C\u544A\u3002\u82E5\u56E0\u786C\u4EF6\u6545\u969C\u6216\u5176\u5B83\u4E0D\u53EF\u6297\u529B\u800C\u5BFC\u81F4\u6682\u505C\u670D\u52A1\uFF0C\u4E8E\u6682\u505C\u670D\u52A1\u671F\u95F4\u9020\u6210\u7684\u4E00\u5207\u4E0D\u4FBF\u4E0E\u635F\u5931\uFF0C\u767E\u5EA6\u8D34\u5427\u4E0D\u8D1F\u4EFB\u4F55\u8D23\u4EFB\u3002 \u7531\u4E8E\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u8D34\u7684\u8C03\u6574\u5BFC\u81F4\u4FE1\u606F\u4E22\u5931\u548C/\u6216\u5176\u4ED6\u7ED3\u679C\u7684\uFF0C\u767E\u5EA6\u516C\u53F8\u4E0D\u627F\u62C5\u4EFB\u4F55\u8D23\u4EFB\u3002</li>","<li>\u767E\u5EA6\u6709\u6743\u6839\u636E\u4E2D\u534E\u4EBA\u6C11\u5171\u548C\u56FD\u6CD5\u5F8B\u3001\u6CD5\u89C4\u53CA\u89C4\u8303\u6027\u6587\u4EF6\u7684\u53D8\u5316\u4EE5\u53CA\u4E92\u8054\u7F51\u53CA\u81EA\u8EAB\u4E1A\u52A1\u7684\u53D1\u5C55\u60C5\u51B5\uFF0C\u4E0D\u65AD\u4FEE\u6539\u548C\u5B8C\u5584\u5305\u62EC\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u8D34\u534F\u8BAE\u5728\u5185\u7684\u767E\u5EA6\u8D34\u5427\u5E2E\u52A9\u7684\u76F8\u5173\u6761\u6B3E\u3002\u767E\u5EA6\u4FDD\u7559\u968F\u65F6\u4FEE\u6539\u767E\u5EA6\u8D34\u5427\u4ED8\u8D39\u8D34\u534F\u8BAE\u5728\u5185\u7684\u767E\u5EA6\u8D34\u5427\u5E2E\u52A9\u6761\u6B3E\u7684\u6743\u5229\u3002\u672C\u534F\u8BAE\u672A\u6D89\u53CA\u7684\u95EE\u9898\u53C2\u89C1\u56FD\u5BB6\u6709\u5173\u6CD5\u5F8B\u6CD5\u89C4\uFF0C\u5F53\u672C\u534F\u8BAE\u4E0E\u56FD\u5BB6\u6CD5\u5F8B\u6CD5\u89C4\u51B2\u7A81\u65F6\uFF0C\u4EE5\u56FD\u5BB6\u6CD5\u5F8B\u6CD5\u89C4\u4E3A\u51C6\u3002</li>","</ul>","</div>",'<div class="btn_group">','<a href="javascript:;" class="ui_btn ui_btn_m j_agree">',"<span><em>\u540C \u610F</em></span>","</a>",'<a href="javascript:;" class="ui_btn ui_btn_sub_m j_refuse">',"<span><em>\u62D2 \u7EDD</em></span>","</a>","</div>","</div>"],initial:function(){},registNextFn:function(i,t){this.nextFnStack.push({fn:i,context:t})},show:function(){this.dialog=new $.dialog({holderClassName:"paypostAgreeDialog",html:this.tpl.join(""),title:"\u4F7F\u7528\u987B\u77E5",width:550,height:270,draggable:!1}),this._bindDialogEvents()},_bindDialogEvents:function(){var i=this;this.dialog.element.find(".j_agree").one("click",function(){$.post("/diamond/submit/paypost/agree",{tbs:PageData.tbs});var t=i.require("common/widget/paypost_data").getInstance();t.set("hasAgree",1),i._fireNextFn(),i.dialog.close()}),this.dialog.element.find(".j_refuse").one("click",function(){i.dialog.close()})},_fireNextFn:function(){_.forEach(this.nextFnStack,function(i){i.fn.call(i.context)})}}});_.Module.define({requires:["user/widget/userApi"],path:"common/component/quick_reply_data_handler",sub:{initial:function(){var e=this.requireInstance("user/widget/userApi",[]);this.uid=$.getPageData("user.id"),this.isSuperMember=e.checkSuperMemberShipOf(PageData.user),this.Storage.initData({isSuperMember:this.isSuperMember})},Storage:function(){var e=null,t=$.Deferred(),a=!1,r=!1,n=function(n){if(r=n.isSuperMember||!1,!a){var o=s(),u=i();u.done(function(a){e={localData:o||{},serverData:a},t.resolve()}),a=!0}},s=function(){var e=$.tb.Storage.get("user_quick_reply_data")||"";return e=$.json.decode(e)||{}},i=function(){var e="/member/submit/getQuickPost",t={tbs:PageData.tbs,ie:"utf-8",_t:1*new Date},a=$.Deferred();return r?$.getJSON(e,t,function(e){if(0==e.no){for(var t=[],r=e.data||[],n=0,s=r.length;s>n;n++)t.push(r[n].content);a.resolve(t)}else a.resolve([])}):a.resolve([]),a},o=function(){return e};return{getData:o,$deferred:t,initData:n}}(),getLocalData:function(){var e=$.getPageData("localData."+this.uid,[],this.Storage.getData());return e.slice(0)},getServerData:function(){var e=$.getPageData("serverData",[],this.Storage.getData());return e.slice(0)},getData:function(){var e=$.Deferred(),t=this;return this.Storage.$deferred.done(function(){t.isSuperMember?e.resolve(t.getServerData()):e.resolve(t.getLocalData())}),e},saveLocalToServer:function(e){e||(e=this.getServerData());var t=this.getLocalData(),a=10;if(t=this._unescapeData(t),e=e.concat(t),e.length>a){var r=$.Deferred();return r.resolve({no:952701,data:{overflow:e.length-a}}),r}var n=this.saveData(e),s=this;return n.done(function(e){0==e.no&&s.saveInLocalStorage([])}),n},saveData:function(e){var t=$.Deferred();return this.isSuperMember?this.saveInServer(e,t):t.resolve(this.saveInLocalStorage(e)),t},errMap:{TOO_MUCH:{no:952701},CONTENT_LENGTH_REACH_LIMIT:{no:952702},SUCCESS:{no:0}},_escapeData:function(e){e=e.slice(0);for(var t in e)e[t]=$.tb.escapeHTML(e[t]);return e},_unescapeData:function(e){e=e.slice(0);for(var t in e)e[t]=$.tb.unescapeHTML(e[t]);return e},saveInLocalStorage:function(e){if(e.length>2)return this.errMap.TOO_MUCH;for(var t=0,a=e.length;a>t;t++)if(e[t].length>140)return this.errMap.CONTENT_LENGTH_REACH_LIMIT;var r=this.Storage.getData();e=this._escapeData(e),r.localData[this.uid]=e;var n=$.json.encode(r.localData);return $.tb.Storage.set("user_quick_reply_data",n),this.errMap.SUCCESS},saveInServer:function(e,t){var a=this.Storage.getData(),r="/member/submit/resetQuickPost",n=this;$.post(r,{tbs:PageData.tbs,contents:e},function(r){0==r.no?(a.serverData=n._escapeData(e),t.resolve({no:0,data:e})):t.resolve(r)},"json")}}});_.Module.define({requires:["user/widget/userApi","common/component/quick_reply_data_handler","common/component/ScrollPanel"],path:"common/component/quick_reply_edit",sub:{WRAPPER_TMP:'<div id="quick-reply-edit-wrapper"><div class="quick-reply-container"></div><div class="quick-reply-add-btn">\u6DFB\u52A0\u5FEB\u901F\u56DE\u8D34</div><div class="quick-reply-hint quick-reply-desc">#{descContent}</div><div class="quick-reply-footer"><button class="btn-default btn-middle submit-btn">\u5B8C\u6210</button><button class="btn-sub btn-middle j-cancel-btn">\u53D6\u6D88</button></div></div>',QUICK_REPLY_TMP:'<div class="quick-reply-item"><div class="quick-reply-delete-btn" data-index="#{index}"></div><div class="quick-reply-edit-container"  id="quick-reply-item-#{index}">#{content}</div></div>',DESC_CONTENT_FOR_NORMAL:'<i class="icon-vip2-16"></i><span class="red-text">\u8D85\u7EA7\u4F1A\u5458</span>\u53EF\u6DFB\u52A010\u6761\u5FEB\u901F\u56DE\u590D\u5E76\u4E14\u4E91\u7AEF\u540C\u6B65\uFF01<a href="#" onclick="return false;" class="j-open-super-member">\u5F00\u901A\u8D85\u7EA7\u4F1A\u5458</a>',defaultOpts:{additionalContent:null},initial:function(t){$.extend(this.defaultOpts,t),this.additionalContent=$.tb.escapeHTML(this.defaultOpts.additionalContent)||null;var e=this.requireInstance("user/widget/userApi",[]);this.isSuperMember=e.checkSuperMemberShipOf(PageData.user),this.replyDataHandler=this.requireInstance("common/component/quick_reply_data_handler"),this._initReply()},dialog_config:{html:"",title:"\u7F16\u8F91\u5FEB\u901F\u56DE\u8D34",width:"auto",escable:!1},_initReply:function(){var t=this;t.$wrapper=$($.tb.format(t.WRAPPER_TMP,{descContent:t.isSuperMember?t.DESC_CONTENT_FOR_VIP:t.DESC_CONTENT_FOR_NORMAL})),$.extend(t.dialog_config,{html:t.$wrapper}),t._showLocalToServerEnter(),t.dialog=new $.dialog(t.dialog_config),t.dialog.bind("onclose",function(){t._destroyEditorAll()}),t.scrollPanel=t.requireInstance("common/component/ScrollPanel",{container:t.$wrapper.find(".quick-reply-container"),height:200}),t._fillReplyContent(),t._bindEvents()},_showLocalToServerEnter:function(){var t='\u60A8\u6709<span class="red-text">#{num}</span>\u6761\u672C\u5730\u6570\u636E\u662F\u5426&nbsp;<a href="#" onclick="return false;" class="j-local-to-server">\u7ACB\u5373\u540C\u6B65</a>',e=this.replyDataHandler.getLocalData();if(this.isSuperMember&&e&&e.length>0){var n=$.tb.format(t,{num:e.length});this.$wrapper.find(".quick-reply-desc").html(n)}},_resizeScroll:function(t){var e={toBottom:!0};e=$.extend(e,t),this.scrollPanel._resizeHeight(),this.scrollPanel._resizeScroll(),e.toBottom?this.scrollPanel.scrollTopTo(2e4):this.scrollPanel.scrollTopTo(this.scrollPanel._scrollTop-30)},editorMaxId:0,_fillReplyContent:function(){var t=this;t._destroyEditorAll(),this.replyDataHandler.getData().done(function(e){var n="",i=!1;t.additionalContent&&(e.push(t.additionalContent),i=!0);for(var o=0,l=e.length;l>o;o++)n+=$.tb.format(t.QUICK_REPLY_TMP,{content:e[o],index:o}),t.editorMaxId++;for(t.scrollPanel.setContent(n),o=0,l=e.length;l>o;o++)t._initEditorById("quick-reply-item-"+o);t.additionalContent&&(t._focusEditorById("quick-reply-item-"+(o-1)),t.additionalContent=null),t._resizeScroll({toBottom:i}),t.dialog.setPosition()})},editorList:{},_initEditorById:function(t){var e={initialFrameHeight:45,initialFrameWidth:562,maxHeight:90,maxWordNum:140,maxWordNumType:"NormalAsciiCodeLen",focusChangeColor:1,toolbar:[],noToolbar:1,excludePlugins:["draft","at","tb_image","baiduinput","emotion_transform","setting"]},n=UE.getEditor(t,e);this.editorList[t]=n},_focusEditorById:function(t){var e=this.editorList[t];e.focus()},_collectReplyData:function(t){var e={filterEmpty:!0};e=$.extend(e,t);var n=[],i=this.$wrapper.find(".quick-reply-edit-container"),o=this;return i.each(function(t,i){var l=$(i).tbattr("id"),r=o.editorList[l].getContentTxt();(r||!e.filterEmpty)&&n.push(r)}),n},_showErrorMsg:function(t){952702==t?$.dialog.alert("\u5B57\u6570\u8D85\u8FC7\u9650\u5236\uFF0C\u8BF7\u91CD\u65B0\u586B\u5199"):952701==t&&(this.isSuperMember?$.dialog.alert("\u8D85\u8FC7\u4E0A\u4F20\u6761\u6570\u9650\u5236\uFF0C\u8BF7\u5220\u9664\u591A\u4F59\u7684\u5185\u5BB9"):this._dialogAlert("\u8D85\u8FC7\u4E0A\u4F20\u6761\u6570\u9650\u5236\uFF0C\u8BF7\u5220\u9664\u591A\u4F59\u7684\u5185\u5BB9"))},_submitQuickReply:function(){var t=this._collectReplyData(),e=this;this.replyDataHandler.saveData(t).done(function(t){0==t.no?(e._destroyEditorAll(),e.dialog.close()):e._showErrorMsg(t.no)})},_destroyEditorById:function(t,e){var n=this;e?$("#"+t).parents(".quick-reply-item").fadeOut(function(){UE.delEditor(t),delete n.editorList[t],$("#"+t).remove(),n._resizeScroll({toBottom:!1})}):(UE.delEditor(t),delete this.editorList[t],$("#"+t).remove())},_destroyEditorAll:function(){for(var t in this.editorList)this._destroyEditorById(t)},_dialogConfirm:function(t){var e='<div id="quick-reply-confirm-dialog"><p class="confirm-text">#{content}</p><p><button class="btn-default btn-middle confirm-submit-btn">\u786E\u5B9A</button><button class="btn-sub btn-middle j-confirm-cancel-btn">\u53D6\u6D88</button></p></div>',n={title:"\u63D0\u793A",content:"\u8BF7\u9009\u62E9\u786E\u5B9A\u6216\u8005\u53D6\u6D88",onaccept:null,oncancel:null};n=$.extend(n,t);var i={html:$.tb.format(e,{content:n.content}),title:n.title,width:400,height:90},o=new $.dialog(i);o.element.on("click",".confirm-submit-btn",function(){o.close(),$.isFunction(n.onaccept)&&n.onaccept()}).on("click",".j-confirm-cancel-btn",function(){o.close(),$.isFunction(n.oncancel)&&n.oncancel()})},_dialogAlert:function(t){var e=this,n='<div id="quick-reply-confirm-dialog"><p class="confirm-text">#{content}</p><p><button class="btn-default btn-middle confirm-submit-btn">\u5F00\u901A\u4F1A\u5458</button><button class="btn-sub btn-middle j-confirm-cancel-btn">\u53D6\u6D88</button></p></div>',i={title:"\u63D0\u793A",content:'<p>\u8BBE\u7F6E\u8D85\u8FC7\u4E0A\u9650</p><p><i class="icon-vip2-16"></i>&nbsp;<span class="red-text">\u8D85\u7EA7\u4F1A\u5458</span>\u53EF\u6DFB\u52A010\u6761\u5FEB\u901F\u56DE\u590D\u5E76\u4E14\u4E91\u7AEF\u540C\u6B65\uFF01</p>',onaccept:null,oncancel:null};i=$.extend(i,t);var o={html:$.tb.format(n,{content:i.content}),title:i.title,width:400,height:120},l=new $.dialog(o);l.element.on("click",".confirm-submit-btn",function(){e.requireInstanceAsync("common/widget/JoinVipDialog",[],function(t){t.getMemberDialog("quick_reply",1007001e3)}),$.isFunction(i.onaccept)&&i.onaccept()}).on("click",".j-confirm-cancel-btn",function(){l.close(),$.isFunction(i.oncancel)&&i.oncancel()})},_showLocalToServerResult:function(t,e){var n={0:"\u540C\u6B65\u6210\u529F",952702:"\u672C\u5730\u6570\u636E\u5B57\u6570\u8D85\u8FC7\u9650\u5236",952701:'\u4E91\u7AEF\u6570\u636E\u5DF2\u6EE1\uFF0C\u9700\u5148\u5220\u9664<span class="red-text">#{num}</span>\u6761\u540E&nbsp;<a href="#" onclick="return false;" class="j-local-to-server">\u518D\u6B21\u540C\u6B65</a>'},i=$.tb.format(n[t]||"",{num:e.overflow});this.$wrapper.find(".quick-reply-desc").html(i)},_bindEvents:function(){var t=this;this.$wrapper.on("click",".quick-reply-delete-btn",function(){var e=$(this),n=e.data("index"),i="quick-reply-item-"+n;t._destroyEditorById(i,!0),t.scrollPanel,t._postTrack("\u5220\u9664")}).on("click",".quick-reply-add-btn",function(){var e=t._collectReplyData({filterEmpty:!1});if(!t.isSuperMember&&e.length>=2)return t._dialogAlert("\u666E\u901A\u7528\u6237\u53EA\u80FD\u6DFB\u52A0\u4E24\u6761"),void 0;if(e.length>=10)return $.dialog.alert("\u6700\u591A\u53EA\u80FD\u6DFB\u52A0\u5341\u6761"),void 0;var n=$.tb.format(t.QUICK_REPLY_TMP,{content:"",index:t.editorMaxId}),i=$(n);t.scrollPanel.appendContent(i),t._initEditorById("quick-reply-item-"+t.editorMaxId),t._focusEditorById("quick-reply-item-"+t.editorMaxId),t._resizeScroll(),t.dialog.setPosition(),t.editorMaxId++,t._postTrack("\u6DFB\u52A0")}).on("click",".submit-btn",function(){t._submitQuickReply(),t._postTrack("\u4FEE\u6539\u63D0\u4EA4")}).on("click",".j-cancel-btn",function(){t._destroyEditorAll(),t.dialog.close(),t._postTrack("\u53D6\u6D88\u63D0\u4EA4")}).on("click",".j-local-to-server",function(){t.$wrapper.find(".quick-reply-desc").html("\u540C\u6B65\u4E2D\uFF0C\u8BF7\u7A0D\u5019..."),t.replyDataHandler.saveLocalToServer(t._collectReplyData()).done(function(e){0==e.no&&(t._fillReplyContent(),t.scrollPanel.scrollTopTo(2e4)),t._showLocalToServerResult(e.no,e.data)})}).on("click",".j-open-super-member",function(){t.requireInstanceAsync("common/widget/JoinVipDialog",[],function(t){t.getMemberDialog("quick_reply",1007001e3)})}).on("keydown",function(){t._resizeScroll()})},_postTrack:function(t){"undefined"==typeof t&&(t=""),$.stats.track(t,"\u5FEB\u901F\u56DE\u8D34","","click")}}});!function(e){var t;_.Module.use("ueglibs/widget/Ban",[],function(e){t=e}),$(".j_richPosterAppealLink").live("click",function(){$.stats.track("posterAppealLink","uegCount","bawuAppeal","click")});var r={POST_AUTHORIZED:"authorized",POST_LOGIN_NEEDED:"\u672C\u5427\u53D1\u8D34\uFF0C\u8BF7\u5148 <a href=\"#\" onclick=\"_.Module.use('common/widget/LoginDialog', ['', 'editor']);return false;\">\u767B\u5F55</a> | <a href=\"#\" onclick=\"TbCom.process('User','buildRegisterFrame',null,null,null,'editor');return false;\">\u6CE8\u518C</a>&nbsp;",POST_USERNAME_NEEDED:"\u60A8\u8FD8\u6CA1\u6709\u7528\u6237\u540D\uFF0C\u4E0D\u80FD\u5728\u672C\u5427\u53D1\u8D34\u3002\u8BF7\u5148<a href=\"#\" onclick=\"TbCom.process('User','buildUnameFrame','\u586B\u5199\u7528\u6237\u540D',' ');return false;\">\u586B\u5199\u7528\u6237\u540D</a>",POST_BLOCKED:t.render("richPoster"),POST_LEVEL_LIMITED:'\u62B1\u6B49\uFF0C\u6839\u636E\u76F8\u5173\u6CD5\u5F8B\u6CD5\u89C4\u548C\u653F\u7B56\uFF0C\u672C\u5427\u76EE\u524D\u4EC5\u5141\u8BB8<a href="http://tieba.baidu.com/f/like/level?kw=#{forum_name}&ie=utf-8" target="_blank">4\u7EA7\u5934\u8854</a><br />\u4EE5\u4E0A\u4F1A\u5458\u53D1\u8D34',POST_BAWU_LIMITED:"\u62B1\u6B49\uFF0C\u672C\u5427\u76EE\u524D\u4EC5\u9650\u5427\u52A1\u56E2\u961F\u53D1\u8D34",POST_LAW_LIMITED:"\u62B1\u6B49\uFF0C\u6839\u636E\u76F8\u5173\u6CD5\u5F8B\u6CD5\u89C4\u548C\u653F\u7B56\uFF0C\u672C\u5427\u76EE\u524D\u53EA\u80FD\u6D4F\u89C8\uFF0C\u4E0D\u80FD\u53D1\u8D34",POST_QUALIFICATIONS_LIMITED:"\u62B1\u6B49\uFF0C\u672C\u5427\u76EE\u524D\u4EC5\u9650\u5427\u52A1\u56E2\u961F\u53CA\u6CE8\u518C\u6EE1\u4E00\u5B9A\u65F6\u95F4\u7684\u8001\u7528\u6237\u53D1\u8D34",POST_THREAD_ONLY:"\u62B1\u6B49\uFF0C\u6839\u636E\u76F8\u5173\u6CD5\u5F8B\u6CD5\u89C4\u548C\u653F\u7B56\uFF0C\u672C\u5427\u76EE\u524D\u53EA\u80FD\u53D1\u4E3B\u9898\u8D34",POST_REPLY_ONLY:"\u62B1\u6B49\uFF0C\u6839\u636E\u76F8\u5173\u6CD5\u5F8B\u6CD5\u89C4\u548C\u653F\u7B56\uFF0C\u672C\u5427\u76EE\u524D\u53EA\u80FD\u53D1\u56DE\u590D\u8D34",POST_THREAD_LEVEL_LIMITED:"\u62B1\u6B49\uFF0C\u6839\u636E\u76F8\u5173\u6CD5\u5F8B\u6CD5\u89C4\u548C\u653F\u7B56\uFF0C\u672C\u5427\u76EE\u524D\u4EC5\u5141\u8BB8\u4E00\u5B9A\u7EA7\u522B\u4EE5\u4E0A\u4F1A\u5458\u53D1\u4E3B\u9898\u8D34",POST_REPLY_LEVEL_LIMITED:"\u62B1\u6B49\uFF0C\u6839\u636E\u76F8\u5173\u6CD5\u5F8B\u6CD5\u89C4\u548C\u653F\u7B56\uFF0C\u672C\u5427\u76EE\u524D\u4EC5\u5141\u8BB8\u4E00\u5B9A\u7EA7\u522B\u4EE5\u4E0A\u4F1A\u5458\u53D1\u56DE\u590D\u8D34",POST_PAD_LIMITED:"\u5207\u6362\u6210pad\u7248\u8D34\u5427\uFF0C\u7545\u4EAB\u66F4\u987A\u7545\u7684\u53D1\u8D34\u4F53\u9A8C\uFF01",POST_ONLY_LOUZHU_CAN_REPLY:"\u4E0D\u597D\u610F\u601D\u54E6\uFF0C\u672C\u697C\u76EE\u524D\u53EA\u5141\u8BB8\u697C\u4E3B\u56DE\u590D\u54E6~<br/>\u5982\u679C\u4F60\u6709\u76F8\u540C\u6216\u5176\u4ED6\u7684\u95EE\u9898\uFF0C\u8BF7\u5728\u672C\u5427\u53D1\u8D34\u53CD\u9988\u54E6~",context:null,authorities:null,loadContext:function(e){this.context=e},loadContextFromPageData:function(e){var t="frs"==e.product,r="pb"==e.product;this.context={forum:{id:e.forum.forum_id,name:e.forum.forum_name,nameEncoded:e.forum.name_url},user:{id:e.user.user_id,name:e.user.user_name,level:e.user.level_id?e.user.level_id:e.user.balv.level_id,isFavorForum:t?e.user.balv.is_like:PageData.user.is_like,isLogin:!!e.user.is_login,isBlocked:t?!!e.user.is_block:!!PageData.user.forbidden.isForbid,isBlack:t?!!e.user.balv.is_black:!!e.user.is_black,noUsername:!!e.user.no_un,canPost:t?e.user.power.post:PageData.power.can_post,canVote:t?e.user.power.vote_creater:!1,forbidFlag:e.forum.forbid_flag,signNumber:e.user.is_login?e.forum.sign_in_info&&e.forum.sign_in_info.user_info?e.forum.sign_in_info.user_info.c_sign_num:0:0,superboy:e.user.superboy,props:e.user.Parr_props,gameSignature:e.user.game_attr},product:e.product,floor:0,tbs:e.tbs,isPad:e.is_ipad,page:e.page},r&&(this.context.thread={id:e.thread.thread_id,thread_type:PageData.thread.thread_type},this.context.floor=e.thread.reply_num)},loadAuthorities:function(e){$.browser.msie&&$.browser.version<8&&(e.long_editor=!1,e.float_editor=!1),this.authorities=e},getContext:function(){return this.context},getAuthorities:function(){return this.authorities},isPostAllowed:function(){return this._validatePostAuthority()==this.POST_AUTHORIZED},getPostRejectedMessage:function(){var e=this._validatePostAuthority();return e!=this.POST_AUTHORIZED?$.tb.format(e,$.extend({forum_name:this.context.forum.name},this.context)):null},_validatePostAuthority:function(){var e=this.context.user;return e.isLogin?e.noUsername?this.POST_USERNAME_NEEDED:e.isBlocked?this.POST_BLOCKED:e.canPost?"pb"==PageData.product&&PageData.feedback&&0!=PageData.feedback&&PageData.user.user_name!=PageData.thread.author?this.FORBID_FLAG_MAP[11]:this.context.isPad?this.POST_PAD_LIMITED:this.POST_AUTHORIZED:this.FORBID_FLAG_MAP[e.forbidFlag]:this.POST_LOGIN_NEEDED}};r.FORBID_FLAG_MAP={1:r.POST_LOGIN_NEEDED,2:r.POST_QUALIFICATIONS_LIMITED,3:r.POST_LEVEL_LIMITED,4:r.POST_BAWU_LIMITED,5:r.POST_LAW_LIMITED,7:r.POST_REPLY_ONLY,8:r.POST_THREAD_ONLY,9:r.POST_REPLY_LEVEL_LIMITED,10:r.POST_THREAD_LEVEL_LIMITED,11:r.POST_ONLY_LOUZHU_CAN_REPLY},e.PosterContext=r}(window);_.Module.define({path:"encourage/widget/paypost_guide",sub:{_options:{},initial:function(i){this._guideClassName="paypost_guide_"+i.position,this._guideStorageName="pg-"+i.position,this._payType=i.payType,this._options=i,this._render(),"link"==i.position?this._linkGuide():this._showGuide()},_render:function(){$.tb.Storage.get(this._guideStorageName)||this._options.$root.addClass(this._guideClassName)},_showGuide:function(){$.tb.Storage.set(this._guideStorageName,1)},_linkGuide:function(){var i=this;this._options.$root.on("click",function(){$.tb.Storage.set(i._guideStorageName,1),window.open("http://tieba.baidu.com/p/3702205481")})}}});_.Module.define({require:["common/widget/paypost_data"],path:"common/widget/RichPoster",requires:["common/widget/PostService","common/widget/WordLimit","common/widget/PostPrefix","common/widget/PostSignature","common/widget/MousePwd","encourage/widget/PostGuessingNew","common/component/BubbleFactory","bawu/widget/complaintBarOwner","encourage/widget/paypost_agree_dialog","common/component/quick_reply_edit"],sub:{_options:{},_widnowScrollTimer:"",_windowHeight:0,initial:function(t){this._options=t,this._windowHeight=screen.height,this.bindWannaPost(),this.bindTousuEvent(),this.bindScrollEvent()},bindTousuEvent:function(){var t=this;$("#frs_footer_tieba_report").on("click",function(e){if(PageData.user.is_login){var i=t.getInstance("bawu/widget/complaintBarOwner");i.showDialog()}else e.preventDefault(),_.Module.use("common/widget/LoginDialog")})},bindScrollEvent:function(){var t=this;$("body").height()<=2*t._windowHeight?t.init():$(window).bind("scroll",[t],t.scrollHandler)},unbindScrollEvent:function(){var t=this;$(window).unbind("scroll",t.scrollHandler)},scrollHandler:function(t){var e=t.data[0];e._widnowScrollTimer&&clearTimeout(e._widnowScrollTimer),e._widnowScrollTimer=setTimeout(function(){$(window).scrollTop()+2*e._windowHeight>=$("body").height()&&(e.init(),e.unbindScrollEvent())},200)},bindWannaPost:function(){var t=this;this.observe("wanna_post",function(){PosterContext.getAuthorities().float_editor?t.enableFloatingPoster():$(window).scrollTop($("body").height()),setTimeout(function(){t.focus()},600)})},init:function(){var t=$("#tb_rich_poster_container"),e=this._options;this.$container=t,this.$root=t.find("#rich_ueditor_tpl"),this.$window=$(window),this.$editorContainer=this.$root.find(".ueditor_container"),this.prefix=e.prefix,this.isFrs="frs"===PosterContext.getContext().product,this.isPb="pb"===PosterContext.getContext().product,this.isQinglang=e.isQinglang,this.redirectAfterPost=e.redirectAfterPost||!1,this.QinglangData=e.QinglangData,this.hideHolder=0,this.initPostService(),this.isFrs&&(this.$title=this.$root.find(".j_title"),this.initTitle());var i=PosterContext.getContext().page;if(this.isPb&&"pb_bright"!==i&&this.$root.addClass("compat_rich_poster"),this.initDraft(),this.initEditor(),this.initAntiSpamming(),this.initEvent(),this.initPlaceholder(),this.initSaveToQuickReply(),PosterContext.getAuthorities().long_editor&&this.initFloatingToolbar(),this.initMousePwd(),this.initSignature(),PosterContext.context.user.isLogin&&!PosterContext.isPostAllowed())$.browser.msie&&6==$.browser.version||this.editor.ready(function(){this.disable()}),this.showWarning(PosterContext.getPostRejectedMessage()),this.toggleSubmitButton(!0),this.$title&&this.$title.tbprop("disabled",!0);else{if(this.isFrs){var o="",s=window.PageData.user;if(this.QinglangData&&this.QinglangData.title)o=this.QinglangData.title;else{var n=s.mParr_props&&s.mParr_props.level&&this.isBeMember()?"\u4EB2\u7231\u7684\u4F1A\u5458\uFF0C\u8BF7\u8F93\u5165\u60A8\u7684\u6807\u9898":"\u8BF7\u586B\u5199\u6807\u9898";o=n}_.Module.use("common/widget/Placeholder",[this.$title,o,{color:"#bfbfbf"}])}this.editor.ready(function(){this.restoreDraft()})}PageUnit.load("rich_poster_show_music_recommend"),this.isFrs&&PosterContext.getContext().user.isLogin&&this.showOfflineCard()},initSaveToQuickReply:function(){var t=this;this.$container.on("click",".save-to-quick-reply-btn",function(){if(!PageData.user.is_login)return t.requireInstanceAsync("common/widget/LoginDialog"),void 0;var e=t.editor.getContentTxt();t.requireInstance("common/component/quick_reply_edit",[{additionalContent:e}])})},showOfflineCard:function(){var t=this,e=1*new Date;e>1408032e6||$.tb.Storage.get("balv_tdou_update")>e||(this.offline_card=this.use("common/widget/Card",{content:'<span style="cursor:pointer;position: absolute;width: 10px; height: 10px; right: 5px; top: 6px;" class="j_close"></span><a target="_blank" class="j_link" href="/p/3199708402"><img style="margin: 4px 4px 0;" src="http://tb1.bdstatic.com/tb/static-ucenter/img/offline1.png"></a>',clazz:"doupiao_offline",arrow_dir:"up",card_css:{width:172,"z-index":0,left:34,top:122},arrow_pos:{left:25},wrap:$("#tb_rich_poster"),card_leave_display:!0}),this.offline_card._j_card.on("click",".j_close",function(){$.tb.Storage.set("poster_doupiao_offline",e+864e5),t.offline_card._j_card.remove()}).on("click",".j_link",function(){$.tb.Storage.set("poster_doupiao_offline",e+864e5),t.offline_card._j_card.remove()}),this.offline_card.showCard())},initPostService:function(){var t=this,e="",i=!(!window.history||!window.history.pushState);this.postService=this.use("common/widget/PostService"),this.postService.success(function(){t.editor.setContent(""),t.editor.clearDraft(),t.showPostSuccess(),PosterContext.getContext().isBlessForum&&t.setBlessCookie();var o=t.require("common/widget/paypost_data").getInstance();o.get("isPaypost")&&(t.feeEditor.setContent(""),t.feeEditor.clearDraft());var s=Math.ceil(10*Math.random());s>8&&($.stats.track("pb-list\u6700\u4E0B_F90","PC\u7AEF\u5F69\u7968pb\u53D1\u5E16\u8BD5\u9A8C","pb","view",{obj_url:"http://tb1.bdstatic.com/tb/cms/com/icon/F90_icon.gif"}),$.tb.Storage.set("pb_show_ad_f90","Y",(new Date).getTime()+8e3)),"pb"===PageData.product?PageData.pager.total_page===PageData.pager.cur_page&&setTimeout(function(){e=$.tb.location.getHref().replace($.tb.location.getProtocol()+"//"+$.tb.location.getHost(),""),-1!==e.indexOf("#")&&(e=e.slice(0,e.indexOf("#"))),-1===e.search(/pn=(\d+)/)&&(e+=-1===e.search(/\?/)?"?pn=1":"&pn=1"),i?window.refreshPage(e):window.refreshPage("",+e.match(/pn=(\d+)/)[1])},500):setTimeout(function(){t.redirectAfterPost?$.tb.location.setHref(t.redirectAfterPost):t.refresh()},1e3),setTimeout(function(){$(".tb_poster_info").remove(),t.togglePostState(!1);var e=$(window).scrollTop();e>0&&(window.scrollTo(0,1),setTimeout(function(){window.scrollTo(0,0)},0))},2e3)}).complete(function(){t.togglePostState(!1)})},initEvent:function(){var t=this;this.$submit=this.$root.find(".j_submit").click(function(e){e.preventDefault(),t.$submit.is(".ui_btn_disable")||t.post()}),this.$root.on("keyup",function(e){e.ctrlKey&&13==e.keyCode&&t.post()}),this.$root.find(".add_vote_btn").click(function(){if(!PosterContext.getContext().user.canVote){var t=PosterContext.getContext().forum.nameEncoded;return $.tb.alert({title:"\u53D1\u8D77\u6295\u7968",message:'\u83B7\u5F97<a target="_blank" href="/f/like/level?kw='+t+'">3\u7EA7\u5934\u8854</a>\u624D\u53EF\u53D1\u8D77\u6295\u7968\u54E6~~<br />\u7533\u8BF7\u52A0\u5165\u4F1A\u5458\uFF0C\u9A6C\u4E0A\u53D1\u8D77\u6295\u7968\uFF01\uFF08\u66F4\u591A\u4F1A\u5458\u7279\u6743<a target="_blank" href="/f/like/level?kw= '+t+'">\u70B9\u6B64\u67E5\u770B</a>',buttons:{text:"\u786E\u5B9A"}}),!1}}),this.$root.find(".j_disable_float").click(function(){t.disableFloatingPoster()}),this.observe("insertimage",function(e,i){t.editor.execCommand("insertimage",[i])}),this.observe("file_added.attachment",function(){t.togglePostState(!0)}),this.observe("upload_complete.attachment",function(){t.togglePostState(!1)});var e=this.$root.find(".add_guessing_btn").on("click",function(){t.guessingDialog?t.guessingDialog._dialog.show():(t.guessingDialog=t.use("encourage/widget/PostGuessingNew",{container:$("#tb_rich_poster .poster_body")}),$(".guessing_holder").css("width","720"),$("#guessing_wrapper").css({paddingLeft:60})),$(this).addClass("cur"),i.removeClass("cur"),$("#tb_rich_poster_container").height(512)}),i=this.$root.find(".add_thread_btn").on("click",function(){t.guessingDialog&&t.guessingDialog._dialog.hide(),$(this).addClass("cur"),e.removeClass("cur"),$("#tb_rich_poster_container").height("auto")})},initTitle:function(){this.initTitleWordLimit(),this.initTitlePrefix()},initFloatingToolbar:function(){function t(){s.removeClass("poster_floating_toolbar").removeClass("poster_locked_toolbar"),i=!1}var e=this,i=!1,o=this.$root.find(".editor_bottom_panel"),s=this.$root.find(".j_floating");if(this.$window.scroll(function(){if(e.editor.$container.height()>e.$window.height()){var n=e._viewPortOn(e.$root);if(n.isOnScreen){var r=e._viewPortOn(o);r.bottomToBottom>=0?i&&t():n.topToBottom>400?(s.addClass("poster_floating_toolbar").removeClass("poster_locked_toolbar"),i=!0):(s.addClass("poster_locked_toolbar").removeClass("poster_floating_toolbar"),i=!0)}else i&&t()}else i&&t()}),this.bind("draft_clean",t),this.bind("poster_float",t),"1"!=$.tb.Storage.get("close_long_editor_bubble")){var n={content:"\u5DF2\u4E3A\u4F60\u5F00\u542F\u8D85\u957F\u53D1\u8D34\u6846\u529F\u80FD\uFF0C\u4E86\u89E3\u66F4\u591A\u6216\u5173\u95ED\u6B64\u529F\u80FD<a href='http://tieba.baidu.com/mo/q/topic_page/219_1' target='_blank'>\u70B9\u51FB\u8FD9\u91CC</a>",arrow_dir:"down",bubble_css:{top:80,left:100,width:179},wrap:this.$root.find(".j_bubble_container"),closeBtn:!0},r=new UiBubbleTipBase(n);r.bind("onclose",function(){$.tb.Storage.set("close_long_editor_bubble","1",(new Date).getTime()+2592e6),r.closeBubble()}),r.showBubble()}},initTitleWordLimit:function(){var t=this,e=$("#tb_rich_poster"),i={inputObj:this.$title,checkDelay:200,showLimit:10,maxNum:60,isLimitInput:!0},o=this.use("common/widget/WordLimit",i);o.init(),o.bind("wlshowing",function(){e.find(".j_surveillance").hide(),t.$root.hasClass("tb_floating_poster")&&o.holder.css("zIndex",1e4)}),o.bind("wlhiding",function(){e.find(".j_surveillance").show(),o.holder.css("zIndex","auto")})},initTitlePrefix:function(){var t={$target:this.$title,prefix:this.prefix};this.use("common/widget/PostPrefix",t)},initEditor:function(){if(PosterContext.isPostAllowed()){var t={};t.excludePlugins=["medal"],t.contentWidth=678,t.initialFrameWidth=690,PosterContext.getAuthorities().long_editor&&(t.autoFloatEnabled=!0,t.topOffset=this.isFrs?40:0,t.heightLimit=!1),PosterContext.getAuthorities().emotion_transform||t.excludePlugins.push("emotion_transform"),this.editor=UE.getEditor("ueditor_replace",t),this.initBubble()}else this.editor=UE.getEditor("ueditor_replace",{toolbar:""});window.test_editor=this.editor,window.test_poster=this},initBubble:function(){var t=this,e=this.use("common/component/BubbleFactory");return e.getPropId()&&e.getCurrent()?(t.editor.ready(function(){t.editor.execCommand("background","bubble",e.getCurrent().background),t.editor.execCommand("setmsg",e.getCurrent())}),t.hideHolder=1,void 0):(this.isBeMember()&&!$.cookie("bubguide")&&this.editor.execCommand("setmsg","MSG_USE_GUIDE"),void 0)},initDraft:function(){var t=this,e=this.$root.find(".j_draft"),i=e.children(".j_content"),o=e.children(".j_clear");this.$root.on("saved.draft",function(){i.text("\u4F60\u6B63\u5728\u8F93\u5165\u7684\u5185\u5BB9\u5DF2\u81EA\u52A8\u4FDD\u5B58, "+$.dateFormat(new Date,"HH:mm:ss")),e.show()}),this.$root.on("restored.draft",function(){i.text("\u4F60\u4E0A\u6B21\u672A\u53D1\u8868\u7684\u5185\u5BB9\u5DF2\u81EA\u52A8\u6062\u590D"),e.show()}),o.on("click",function(){t.editor.clearDraft(),t.editor.setContent("");var i=t.require("common/widget/paypost_data").getInstance();i.get("isPaypost")&&(t.feeEditor=t.feeEditor||UE.getEditor("ueditor_fee_replace"),t.feeEditor.setContent(""),t.feeEditor.clearDraft()),e.hide(),t.trigger("draft_clean")})},initPlaceholder:function(){var t=this,e=0;if(this.$placeholder=$('<div class="tb_poster_placeholder"></div>'),this.$placeholder.click(function(e){$(e.target).is("a")||(t.$placeholder.hide(),t.editor.focus())}),this.editor.ready(function(){t.$placeholder.prependTo(t.$root.find(".edui-container")),t.editor.addListener("focus",function(){t.$placeholder.hide()}),t.editor.addListener("blur",function(){e||t._showPlaceHolder()}),t._showPlaceHolder()}),this.$root.on("restored.draft",function(){t.$placeholder.hide()}),this.QinglangData&&this.QinglangData.content&&PageData.user.is_login){this.$placeholder.css({left:15,top:55});var i='<p style="width:565px;line-height:25px;">'+this.QinglangData.content+"</p>";this.$placeholder.html(i)}else this.$placeholder.html(PageUnit.load("rich_poster_placeholder")),this.bindSuperMemberExpUpTrack();this.$editorContainer.on("setbackground",function(i,o){return"default"!==o&&o?(t.hideHolder=1,t.$placeholder.hide(),void 0):(e||(t.hideHolder=0,t._showPlaceHolder()),void 0)}),this.$placeholder.find("a").on("click",function(){var t="";"frs"==PageData.product?t="frs":"pb"==PageData.product&&(t="pb"),$.stats.track("\u53D1\u8868\u56DE\u590D\u6846PlaceHolder","\u8D34\u5427PC\u9875\u9762\u4F18\u5316",t,"click")}),PosterContext.getContext().user.isLogin&&"\u8D34\u5427\u610F\u89C1\u53CD\u9988"==PosterContext.getContext().forum.name&&this.$placeholder.addClass("tb_poster_plain_placeholder").html(PageUnit.load("rich_poster_feedback"))},_showPlaceHolder:function(){var t=this.editor.getContent();0!=t.length||this.hideHolder||this.$placeholder.show()},initMousePwd:function(){this.MousePwd=this.use("common/widget/MousePwd"),this.MousePwd.start(["editor_content_wrapper"])},initSignature:function(){var t=this,e=this.$root.find(".j_poster_signature");e.hide(),PosterContext.getContext().user.isLogin&&this.$root.find("#ueditor_replace").one("click",function(){var i=t.use("common/widget/PostSignature",{$container:e,gameSignature:PosterContext.getContext().user.gameSignature});i.init(),e.show()})},initAntiSpamming:function(){var t=$.cookie("GET_TOPIC");if(PosterContext.getContext().user.isLogin&&(!t||t!=PosterContext.getContext().user.id)){$("body").append('<div id="anttongji" style="display:none"></div>');var e=$(document.createElement("script")),i="http://tongji.tieba.baidu.com/common/js/gettopic.js";e.tbattr({src:i,type:"text/javascript"}),$("body").append(e),$.cookie("GET_TOPIC",PosterContext.getContext().user.id,{expires:.5,path:"/"})}},isBeMember:function(){var t=window.PageData.user;return t.mParr_props&&t.mParr_props.level&&parseInt(t.mParr_props.level.props_id,10)>0&&1e3*t.mParr_props.level.end_time>Env.server_time?!0:!1},showPostSuccess:function(){var t="",e=window.PageData.user;e.mParr_props&&e.mParr_props.level&&this.isBeMember()&&(t="\u5C0A\u656C\u7684\u4F1A\u5458\uFF0C");var i=this.getPosterSuccessContent(t);$(i).appendTo(this.$editorContainer),this.showAddExp($(".poster_submit"))},bindSuperMemberExpUpTrack:function(){-1!=PageUnit.load("rich_poster_placeholder").indexOf("\u5F00\u901A\u8D85\u7EA7\u4F1A\u5458\u53D1\u8D346\u500D\u7ECF\u9A8C")&&this.$placeholder.on("click","a",function(){$.getPageData("product");$.stats.track("\u53D1\u5E16\u6846\u5F00\u901A\u4F1A\u5458\u70B9\u51FB\u91CF","\u4F1A\u5458\u52A0\u901F2.0")})},getPosterSuccessContent:function(t){var e=['<div class="tb_poster_info poster_success">','<div class="poster_success_content clearfix #{className}">','<div class="post_success_tip">#{headCrown}\u53D1\u8868\u6210\u529F\uFF01</div>','<div class="post_success_exp">','<span class="post_success_exp_name">\u7ECF\u9A8C</span>','<b class="post_success_exp_plus">+#{experience}</b>',"</div>","</div>","#{footTip}","</div>"].join(""),i=this.requireInstance("user/widget/userApi",[]),o=i.checkSuperMemberShipOf(PageData.user),s={className:t?"poster_success_content_mem":""},n={experience:6,footTip:"",headCrown:'<i class="middle_size_crown"></i>'},r={experience:1,footTip:'<div class="success-foot-tip"><i class="middle_size_crown"></i>\u5F00\u901A\u8D85\u7EA7\u4F1A\u5458\u53D1\u8D346\u500D\u7ECF\u9A8C</div>',headCrown:""};if(o)var a=$.extend(s,n);else var a=$.extend(s,r);var d=$.tb.format(e,a);return d},showAddExp:function(){$(".post_success_exp").fadeIn(function(){})},showWarning:function(t){void 0==this.$warning&&(this.$warning=$('<div class="tb_poster_info poster_warning"></div>').appendTo(this.$editorContainer)),this.$warning.html(t)},getTitle:function(){return this.$title?this.$title.val():""},getContent:function(){return this.editor.getContent()},getContentUbb:function(){return this.editor.getContentUbb()},getGameUser:function(){var t=PosterContext.getContext().user.gameSignature;return t&&!$.isEmptyObject(t.signature_info)},getPostType:function(){var t=this.isFrs?"thread":"reply";return this.editor.getExtendContent().hasLocalVideo&&(t="thread"==t?"vpostThread":"vpostReply"),t},getPostData:function(){var t=this.editor.getExtendContent(),e={content:this.getContentUbb()};if(this.isFrs){var i=this.getTitle(),o=this.$title.data("prefix");-1==i.indexOf(o)&&(o=""),i=i.replace(/\u2006/g,""),i=i.replace(o,""),e.title=i,e.prefix=o}t.videoNumber>0&&(e.video_url=t.videoUrl,t.hasLocalVideo&&(e.file_id=t.fileId)),t.ptype&&(e.ptype=t.ptype),t.attachments&&(e.files=t.attachments);var s=this.$root.find(".j_sign_id"),n=this.$root.find(".j_use_signature");n.tbattr("checked")&&s.size()>0&&s.val()&&(e.sign_id=s.val()),e.game_user=this.getGameUser(),e.mouse_pwd=this.MousePwd.report().c,e.mouse_pwd_t=this.MousePwd.time,e.mouse_pwd_isclick=this.MousePwd.MOUSEPWD_CLICK,PageData&&PageData.thread&&PageData.thread.is_novel&&(e.is_novel=1);var r=this.require("common/widget/paypost_data").getInstance();if(r.get("isPaypost")){var a=this.feeEditor||UE.getEditor("ueditor_fee_replace");e.is_paypost=1,e.secret=a.getContentUbb(),e.score=$(a.container).find(".j_paypost_tdou_ipt").val();var d=a.getExtendContent();if(d.attachments){var c=JSON.parse(d.attachments);e.files=JSON.stringify(JSON.parse(e.files).concat(c)),e.secret_files=JSON.stringify(_.pluck(c,"fs_id"))}}return 1===this._options.isPaypost&&(e.is_paypost=1),e},togglePostState:function(t){var e=this.$root.find(".j_posting_status");e.toggleClass("poster_posting_status_loading",t),this.toggleSubmitButton(t)},toggleSubmitButton:function(t){this.$submit.toggleClass("ui_btn ui_btn_m",!t),this.$submit.toggleClass("ui_btn_disable ui_btn_m_disable",t)},validateContent:function(){var t=this.isFrs?3e4:1e4,e=this.editor.getContentByteLength(),i=this.editor.getExtendContent(),o=this.$root.find(".ueditor_container .j_error"),s="";if(this.isFrs){var n=$.trim(this.getTitle()),r=this.$title.data("prefix");if(0===n.length)return this.$root.find(".title_container .j_error").text("\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A").show(),this.$title.focus(),this.$window.scrollTop(this.$title.offset().top-60),!1;if(0===n.replace(r,"").length)return this.$root.find(".title_container .j_error").text("\u53EA\u6709\u524D\u7F00\u662F\u4E0D\u884C\u7684\u54DF~\u8BF7\u5728\u524D\u7F00\u540E\u586B\u5199\u6B63\u5F0F\u6807\u9898\uFF01").show(),this.$title.focus(),this.$window.scrollTop(this.$title.offset().top-60),!1;var a=this.require("common/widget/paypost_data").getInstance();if(a.get("isPaypost")){this.feeEditor=UE.getEditor("ueditor_fee_replace");var d=$(this.feeEditor.container),c=d.find(".j_paypost_tdou_ipt").val();if(100>c)return o.text("\u9690\u85CF\u5185\u5BB9\u552E\u4EF7\u987B\u81F3\u5C11100T\u8C46").show(),!1;if(c>1e7)return o.text("\u9690\u85CF\u5185\u5BB9\u552E\u4EF7\u4E0D\u5F97\u9AD8\u4E8E10000000T\u8C46").show(),!1;var l=this.feeEditor.getExtendContent();if(0==$.trim(this.feeEditor.getContent()).length&&"[]"==l.attachments)return o.text("\u4ED8\u8D39\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A").show(),!1;if(this._options.needPaypostAgree&&!a.get("hasAgree")){var h=this.requireInstance("encourage/widget/paypost_agree_dialog");return h.registNextFn(this.post,this),h.show(),!1}}}return 0!==e||this.isFrs?e>t?(s="\u62B1\u6B49\uFF0C\u60A8\u7684\u8D34\u5B50\u8D85\u8FC7"+t/2+"\u5B57\uFF0C\u5EFA\u8BAE\u60A8\u7CBE\u7B80\u6216\u5206\u6BB5\u540E\u518D\u63D0\u4EA4",o.text(s).show(),!1):i.videoNumber>1?(s="\u62B1\u6B49\uFF0C\u6BCF\u5C42\u697C\u63D2\u5165\u7684\u89C6\u9891\u4E2A\u6570\u4E0D\u80FD\u8D85\u8FC71\u4E2A\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4",o.text(s).show(),!1):i.musicNumber>10?(s="\u62B1\u6B49\uFF0C\u6BCF\u5C42\u697C\u63D2\u5165\u7684\u97F3\u4E50\u4E2A\u6570\u4E0D\u80FD\u8D85\u8FC710\u4E2A\uFF0C\u8BF7\u4FEE\u6539\u540E\u91CD\u65B0\u63D0\u4EA4",o.text(s).show(),!1):i.ptype&&!i.ptypePower?(s="\u6CA1\u6709\u9053\u5177\u4F7F\u7528\u6743\u9650\u5C06\u65E0\u6CD5\u53D1\u8868\u6210\u529F",o.text(s).show(),!1):(this.$root.find(".j_error").hide(),!0):(o.text("\u56DE\u590D\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A").show(),!1)},post:function(t){var e=this.getPostData(),i=this.validateContent();"object"==typeof postObj&&"object"==typeof t&&$.extend(e,t),!this.postService.isPosting()&&i&&(PosterContext.context.user.isLogin?($.cookie("GET_TOPIC","-",{expires:-1,path:"/"}),this.postService.post(this.getPostType(),e,PosterContext.getContext()),this.togglePostState(!0),_.Module.use("frs/widget/snowflow",[e.content,PosterContext.getContext().product,"rich_poster"])):_.Module.use("common/widget/LoginDialog",["","editor",function(){$.stats.track("\u53D1\u8868\u6309\u94AE_\u767B\u5F55\u6210\u529F","\u975E\u767B\u5F55\u7528\u6237\u53D1\u5E16")}]))},refresh:function(){var t=$.tb.location.getHref();t=t.replace(/#\w*$/,""),$.tb.location.setHref(t)},focus:function(){this.isFrs?this.$title.focus():$.browser.msie&&$.browser.version<=7||this.editor.focus()},enableFloatingPoster:function(){var t=this;if(!this.$root.hasClass("tb_floating_poster")&&(this.editor.enableHeightLimit(this.$window.height()-450),this.trigger("poster_float"),this.$root.hide().addClass("tb_floating_poster"),this.position&&this.$root.css(this.position),this.$root.fadeIn(function(){t.$root.draggable({handle:t.$root.find(".poster_head"),start:function(){t.$root.css({right:"auto",bottom:"auto"})}})}),"1"!=$.tb.Storage.get("close_float_draggable_bubble"))){var e={content:"\u6D6E\u52A8\u53D1\u8D34\u6846\u53EF\u4EE5<span class='ui_text_emphasize'>\u62D6\u62FD</span>\u4E86\uFF0C\u8D76\u5FEB\u62D6\u52A8\u6807\u9898\u8BD5\u8BD5\uFF01\u66F4\u591A\u8BE6\u60C5<a href='http://tieba.baidu.com/mo/q/topic_page/219_1' target='_blank'>\u70B9\u51FB\u8FD9\u91CC</a>",arrow_dir:"down",bubble_css:{top:0,left:10,width:179},wrap:this.$root.find(".j_bubble_container"),closeBtn:!0},i=new UiBubbleTipBase(e);i.bind("onclose",function(){$.tb.Storage.set("close_float_draggable_bubble","1",(new Date).getTime()+2592e6),i.closeBubble()}),i.showBubble()}},disableFloatingPoster:function(){var t=this;t.$root.fadeOut(function(){t.position={left:t.$root.css("left"),top:t.$root.css("top")},t.$root.draggable("destroy").css({left:"auto",top:"auto"}),t.$root.removeClass("tb_floating_poster").show(),PosterContext.getAuthorities().long_editor?t.editor.disableHeightLimit():t.editor.enableHeightLimit()})},_viewPortOn:function(t){var e=this.$window.scrollTop(),i=e+this.$window.height(),o=t.offset().top,s=o+t.height();return{isOnScreen:i>o&&s>e,topToBottom:i-o,bottomToTop:s-e,topToTop:o-e,bottomToBottom:i-s}},setBlessCookie:function(){var t=PosterContext.getContext().forum.id,e=$.cookie("bless_post_"+t);null==e&&$.cookie("bless_post_"+t,1,1)}}});_.Module.define({path:"frs/widget/forum_card/focus_btn",requires:["comforum/widget/attentionCategoryGame"],sub:{initial:function(t){try{this.isOfficial=t.isOfficial,this.tbs=t.tbs,this.uid=t.uid,this.is_forum_fourth_manager=t.is_forum_fourth_manager,this.avatar=t.avatar,this.userForumList=t.userForumList||"",this.forum_name="",t.fr&&"bawu"==t.fr&&(this.forum_name=$.tb.unescapeHTML(t.forum_name));var e=this,a=$("#j_head_focus_btn"),o=null;e.config={},e.config.url={closetip:"/f/like/commit/notice/delete",dolike:"/f/like/commit/add",undolike:"/f/like/commit/delete"},o=parseInt(t.islike)?function(){if(PageData.user.power&&PageData.user.power.bawu)return e._showAlert('<p style="text-align: center;">\u60A8\u8FD8\u662F\u672C\u5427\u7684\u5427\u52A1\uFF0C\u8F9E\u804C\u540E\u624D\u80FD\u53D6\u6D88\u5173\u6CE8\u54E6~</p>'),!1;var t=PageData.forum_name||PageData.forum.forum_name;t=$.tb.subByte(t,10,"...");var a=['<div style="width:190px;text-align:center;top:18px;left:10px;position:absolute;">\u786E\u5B9A\u4E0D\u518D\u5173\u6CE8 <span style="color:red">'+t+"</span> \u5427\uFF1F</div>",'<a href="#" id="cancel_focus_yes" class=" ui_btn ui_btn_s" style="position:absolute;top:50px;left:55px;">',"<span><em>\u786E\u8BA4</em></span>","</a>",'<a href="#" onclick="return false;" id="cancel_focus_no" class="ui_btn ui_btn_sub_s" style="position:absolute;top:50px;left:105px;">',"<span><em>\u53D6\u6D88</em></span>","</a>"].join(""),o=new $.dialog({html:a,showTitle:!1,fixed:!1,show:!0,draggable:!1,autoCenter:!1,modal:!1,top:$("#j_head_focus_btn").offset().top-$(this).height()/2-90,left:$("#j_head_focus_btn").offset().left-$(this).width()/2+15,width:210,height:70});$("#cancel_focus_yes").on("click",function(){try{e._undolike(),o.close()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:82}),t}}),$("#cancel_focus_no").on("click",function(){try{o.close()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:85}),t}})}:function(){e._dolike()},a.on("click",o),$(".j_search_post ").click(function(){try{$.stats.track("FRS\u5168\u5427\u641C\u7D22","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:95}),t}}),$(".search_internal_btn").click(function(){try{$.stats.track("FRS\u5427\u5185\u641C\u7D22","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:98}),t}}),$(".sign_title_text_bright").click(function(){try{$.stats.track("FRS\u7B7E\u5230\u5E7F\u544A","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:101}),t}}),$(".j_nav_list > li:eq(2) a").click(function(){try{$.stats.track("FRS\u7B7E\u5230\u5E7F\u544A","PB\u53CAFRS\u7EDF\u8BA1\u5408\u9879","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:104}),t}})}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:105}),i}},_showAlert:function(t){var e='<div style="padding:20px 20px; text-align:cente; line-height:20px;font-size:13px;">'+t+"</div>";$.dialog.open(e,{title:"\u64CD\u4F5C\u5931\u8D25",width:380})},_dolike:function(){var t=this;if(!PageData.user.is_login)return TbCom.process("User","buildLoginFrame"),!1;if(PageData.user.is_login&&PageData.user.no_un)return TbCom.process("User","buildUnameFrame","\u586B\u5199\u7528\u6237\u540D","\u6709\u7528\u6237\u540D\u624D\u80FD\u70B9\u4EAE\u201C\u6211\u559C\u6B22\u201D\uFF0C\u8D76\u5FEB\u7ED9\u81EA\u5DF1\u8D77\u4E00\u4E2A\u5427~"),!1;var e={};1==$.tb.location.getSearchValue("fromadlike")&&$.stats.track("\u95F4\u63A5\u52A0\u5173\u6CE8","\u5206\u53D1\u5173\u6CE8\u5427\u63A8\u8350","","click"),PageData.forum&&(e={fid:PageData.forum.id||PageData.forum.forum_id,fname:t.forum_name||PageData.forum.forum_name||PageData.forum_name,uid:PageData.user.name_url,ie:"gbk",tbs:PageData.tbs},e.fname=$.tb.escapeHTML(e.fname)),$.post(t.config.url.dolike,e,function(e){var a=!1;try{var o=e}catch(i){a=!0}if(!a)if(o&&0==o.no)Stats.sendRequest("fr=tb0_foruStatm&st_mod=frs&st_type=balvlikesucc&bduid="+PageData.user.bduid),t.isOfficial?_.Module.use("frs/widget/platform_attention_recommend",[{tbs:t.tbs,uid:t.uid,is_forum_fourth_manager:t.is_forum_fourth_manager,avatar:t.avatar}]):"\u6E38\u620F"==PageData.forum.first_class?_.Module.use("comforum/widget/attentionCategoryGame",["",!1,{index:o.data.ret.index,like_no:o.like_no}]):_.Module.use("ucenter/widget/LikeTip",["",!1,{index:o.data.ret.index,like_no:o.like_no},t.userForumList]),$.stats.sendRequest("fr=tb0_forum&st_page=frs&st_mod=like&st_type=auto");else{Stats.sendRequest("fr=tb0_foruStatm&st_mod=frs&st_type=balvlikefail&errorno="+o.no);var s="";s=8==o.no||9==o.no?"\u4F60\u5728\u672C\u5427\u88AB\u5C01\u7981\uFF0C\u6682\u65F6\u4E0D\u80FD\u8FDB\u884C\u64CD\u4F5C":220==o.no?"\u4F60\u88AB\u5427\u4E3B\u52A0\u5165\u9ED1\u540D\u5355\uFF0C\u6682\u65F6\u4E0D\u80FD\u8FDB\u884C\u64CD\u4F5C":221==o.no?"\u4F60\u5DF2like\u4E86\u672C\u5427,\u8BF7\u4E0D\u8981\u91CD\u590D\u64CD\u4F5C":"\u62B1\u6B49\uFF0C\u5F02\u5E38\u9519\u8BEF\uFF0C\u5EFA\u8BAE\u5237\u65B0\u9875\u9762\u91CD\u8BD5\u4E00\u4E0B",t._showAlert(s)}},"json")},_undolike:function(){var t=this,e=null;PageData.forum&&(e={fid:PageData.forum.forum_id,fname:t.forum_name||PageData.forum.forum_name||PageData.forum_name,uid:PageData.user.name_url,ie:"utf-8",tbs:PageData.tbs},e.fname=$.tb.escapeHTML(e.fname)),$.tb.post(t.config.url.undolike,e,function(t){var e=!1;try{var a=t}catch(o){e=!0}e||a&&0==a.no&&$.tb.location.reload(!0)})}}});_.Module.define({path:"common/widget/tbshare/tbshare_all",requires:["common/widget/tbshare/tbshare_share"],sub:{_tmp:['<div class="tbshare_all_wrapper">',"<h5>\u5206\u4EAB\u5230",'<p class="j_tbshare_all_close"></p>',"</h5>",'<div class="tbshare_all_main"></div>','<div class="tbshare_all_footer"></div>',"</div>"].join(""),_args:{targets:[["qqzone","QQ\u7A7A\u95F4"],["tieba","\u767E\u5EA6\u8D34\u5427"],["renren","\u4EBA\u4EBA\u7F51"],["tsina","\u65B0\u6D6A\u5FAE\u535A"],["weixin","\u5FAE\u4FE1"],["douban","\u8C46\u74E3"],["tsohu","\u641C\u72D0\u5FAE\u535A"],["copy","\u590D\u5236"]]},initial:function(t){t=t||{},this.args=$.extend({show:!1,$container:$("body")},t),this.$container=this.args.$container,this._createElement(),this._bindEvents(),this._addToContainer()},_createElement:function(){this.$dom=$(this._tmp),this.$share_all_main=this.$dom.find(".tbshare_all_main"),this.share=this.requireInstance("common/widget/tbshare/tbshare_share",[this._args]),this.share.$dom.appendTo(this.$share_all_main)},_bindEvents:function(){var t=this;this.$dom.on("click",".j_tbshare_all_close",function(){t.hideAll()})},_addToContainer:function(){this.$container&&this.$container.append(this.$dom),this.args.show&&this.showAll()},setShareContent:function(t){return this.share.setShareContent(t),this},showAll:function(){return this.$dom.show(),this},hideAll:function(){return this.$dom.hide(),this}}});_.Module.define({path:"frs/widget/snowflow",sub:{createTimer:-1,checkTimer:-1,options:{},time1:0,time2:0,num:0,height:640,imgSrcArr:[],countCookieName:"snowflow_count",initial:function(t,e,r){try{if("frs"==e&&"rich_poster"==r)return;if($.cookie(this.countCookieName)>1e7)return;var i=$.browser.msie&&"6.0"==$.browser.version,o=PageUnit.load("snowflow_imgs");if(this.imgArray=o.trim().split("|"),this.len=this.imgArray.length,0==this.len||i)return;if(!this.isShoot(t))return;this.$root=$(".j_snowBox"),this.$root[0]||(this.$root=$('<div class="j_snowBox snowBox"></div>'),this.$root.appendTo($("body"))),this.initParentNode(),this.switchOpera(),this.loadImg(),this.setCookie()}catch(n){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message||n.description,path:"frs:widget/snowflow/snowflow.js",method:"",ln:40}),n}},setCookie:function(){var t=$.cookie(this.countCookieName);t?t++:t=1,$.cookie(this.countCookieName,t,{expires:1,path:"/"})},isShoot:function(t){var e,r,i;for(e=0;e<this.len;e++)if(r=this.imgArray[e].split("=="),r&&2==r.length&&(i=r[0],new RegExp(i).test(t)))return this.img=r[1],!0;return!1},loadImg:function(){var t=this;t.url=PageUnit.load("snowflow_url").trim();var e=new Image;e.src="http://tb1.bdstatic.com/tb/cms/snowflow/png/"+t.img+".png",t.imgSrcArr=new Array,t.imgSrcArr.push(e.src);var r=new Array,i=t.$root;e.onload=function(){t.imgSrcArr.push(e.src),t.snowStart(i,r,t.imgSrcArr)}},snowStart:function(t,e,r){var i=this;i.checkTimer=setInterval(function(){var o=0;o=parseInt(400*Math.random()),i.num<=20?i.createTimer=setTimeout(function(){i.num++,i.createSnow(t,e,r)},o):(clearInterval(i.createTimer),i.createTimer=-2)},200)},createSnow:function(t,e,r){var i=this,o=$("<i/>");i.url&&(o=$("<a/>"),o.tbattr("href",i.url),o.tbattr("target","_blank")),o.tbattr("class","snowflow_i");var n=$("<img/>"),s=Math.floor(Math.random()*r.length);n.tbattr("src",r[s]),o.append(n),o.css({left:parseInt(Math.random()*$(window).width()),top:0});parseInt(200*Math.random());e.push(o),t.append(o);var a=50,h=!0;1==Math.floor(2*Math.random())&&(h=!1),o.timer=setInterval(function(){o.stopped?(clearInterval(o.timer),o.remove()):i.fallDown(o,e,h)},a)},fallDown:function(t,e,r){var i=this;t.speed||(t.speed=Math.floor(16*Math.random())),t.speed<6&&(t.speed+=6);var o=parseInt(t.css("top")),n=parseInt(t.css("left"));if(-1==i.createTimer)return clearInterval(t.timer),void 0;var s=parseInt($(window).width())-50;if(n>=s||0>n||o>i.height)return t.css({display:"none"}),t.stopped=1,void 0;t.css("top",o+t.speed);var a=26,h=Math.sin(a);r||(h=-Math.sin(a)),o>20&&t.css("left",n+2*h)},windBlow:function(t){return parseInt(Math.random())%2==1?Math.sin(t/16):Math.cos(t/16)},switchOpera:function(){var t=this;$(".j_switch").on("click",function(){try{if(t.$root.html("").hide(),"\u5173\u95ED\u52A8\u753B"==$(this).html())$(this).html("\u6253\u5F00\u52A8\u753B"),-2!=t.checkTimer&&clearInterval(t.checkTimer),clearTimeout(t.createTimer),t.createTimer=-1,t.checkTimer=-1,t.num=0;else if("\u6253\u5F00\u52A8\u753B"==$(this).html()){$(this).html("\u5173\u95ED\u52A8\u753B");var e=t.$root,r=new Array;t.snowStart(e,r,t.imgSrcArr),e.show()}}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/snowflow/snowflow.js",method:"",ln:185}),i}})},initParentNode:function(){this.height=screen.height||this.height,this.$root.height(this.height)}}});_.Module.define({path:"common/widget/tbshare",requires:["common/widget/tbshare/tbshare_share","common/widget/tbshare/tbshare_more","common/widget/tbshare/tbshare_all"],sub:{initial:function(e,n){this._addShareComponent(e,n)},_addShareComponent:function(e,n){this.shareInstance=this.requireInstance("common/widget/tbshare/tbshare_share",[n]),this._initMoreInstance(n.moreConfig,n.shareContent);var t=n.moreConfig&&n.moreConfig.position;this._addAllInstanceToContainer(e,t)},_initMoreInstance:function(e,n){e&&(this.moreInstance=this.requireInstance("common/widget/tbshare/tbshare_more",[e]),this.moreInstance.setShareContent(n))},_addMoreInstanceToShareInstance:function(e){if(!this.moreInstance)return!1;if(e){var n=["before","after"],t=$.inArray(e,n);if(0==t)this.shareInstance.$dom.before(this.moreInstance.$dom);else{if(1!=t)throw new Error("moreInstance position error,should be in ["+n.join(",")+"]");this.shareInstance.$dom.after(this.moreInstance.$dom)}}else this.shareInstance.$dom.after(this.moreInstance.$dom)},_addAllInstanceToContainer:function(e,n){var t=$('<div class="tbshare clearfix"></div>');this.shareInstance.$dom.appendTo(t),this._addMoreInstanceToShareInstance(n),t.appendTo(e)},setShareContent:function(e){return this.shareInstance&&this.shareInstance.setShareContent(e),this.moreInstance&&this.moreInstance.setShareContent(e),this},share:function(e){return this.shareInstance?this.shareInstance.share(e):this.moreInstance&&this.moreInstance.shareInstance.share(e),this},showMore:function(){return this.moreInstance?this.moreInstance.showMore():!1},showAll:function(){return this.moreInstance?this.moreInstance.showAll():!1}}});
;var QRCode;!function(){function t(t){this.mode=u.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,r=this.data.length;r>e;e++){var o=[],n=this.data.charCodeAt(e);n>65536?(o[0]=240|(1835008&n)>>>18,o[1]=128|(258048&n)>>>12,o[2]=128|(4032&n)>>>6,o[3]=128|63&n):n>2048?(o[0]=224|(61440&n)>>>12,o[1]=128|(4032&n)>>>6,o[2]=128|63&n):n>128?(o[0]=192|(1984&n)>>>6,o[1]=128|63&n):o[0]=n,this.parsedData.push(o)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function e(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function r(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var r=0;r<t.length&&0==t[r];)r++;this.num=new Array(t.length-r+e);for(var o=0;o<t.length-r;o++)this.num[o]=t[o+r]}function o(t,e){this.totalCount=t,this.dataCount=e}function n(){this.buffer=[],this.length=0}function i(){return"undefined"!=typeof CanvasRenderingContext2D}function a(){var t=!1,e=navigator.userAgent;return/android/i.test(e)&&(t=!0,aMat=e.toString().match(/android ([0-9]\.[0-9])/i),aMat&&aMat[1]&&(t=parseFloat(aMat[1]))),t}function s(t,e){for(var r=1,o=h(t),n=0,i=p.length;i>=n;n++){var a=0;switch(e){case l.L:a=p[n][0];break;case l.M:a=p[n][1];break;case l.Q:a=p[n][2];break;case l.H:a=p[n][3]}if(a>=o)break;r++}if(r>p.length)throw new Error("Too long data");return r}function h(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)}t.prototype={getLength:function(){return this.parsedData.length},write:function(t){for(var e=0,r=this.parsedData.length;r>e;e++)t.put(this.parsedData[e],8)}},e.prototype={addData:function(e){var r=new t(e);this.dataList.push(r),this.dataCache=null},isDark:function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,r){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++){this.modules[o]=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[o][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,r),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,r)},setupPositionProbePattern:function(t,e){for(var r=-1;7>=r;r++)if(!(-1>=t+r||this.moduleCount<=t+r))for(var o=-1;7>=o;o++)-1>=e+o||this.moduleCount<=e+o||(this.modules[t+r][e+o]=r>=0&&6>=r&&(0==o||6==o)||o>=0&&6>=o&&(0==r||6==r)||r>=2&&4>=r&&o>=2&&4>=o?!0:!1)},getBestMaskPattern:function(){for(var t=0,e=0,r=0;8>r;r++){this.makeImpl(!0,r);var o=f.getLostPoint(this);(0==r||t>o)&&(t=o,e=r)}return e},createMovieClip:function(t,e,r){var o=t.createEmptyMovieClip(e,r),n=1;this.make();for(var i=0;i<this.modules.length;i++)for(var a=i*n,s=0;s<this.modules[i].length;s++){var h=s*n,u=this.modules[i][s];u&&(o.beginFill(0,100),o.moveTo(h,a),o.lineTo(h+n,a),o.lineTo(h+n,a+n),o.lineTo(h,a+n),o.endFill())}return o},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=f.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var r=0;r<t.length;r++){var o=t[e],n=t[r];if(null==this.modules[o][n])for(var i=-2;2>=i;i++)for(var a=-2;2>=a;a++)this.modules[o+i][n+a]=-2==i||2==i||-2==a||2==a||0==i&&0==a?!0:!1}},setupTypeNumber:function(t){for(var e=f.getBCHTypeNumber(this.typeNumber),r=0;18>r;r++){var o=!t&&1==(e>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=o}for(var r=0;18>r;r++){var o=!t&&1==(e>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=o}},setupTypeInfo:function(t,e){for(var r=this.errorCorrectLevel<<3|e,o=f.getBCHTypeInfo(r),n=0;15>n;n++){var i=!t&&1==(o>>n&1);6>n?this.modules[n][8]=i:8>n?this.modules[n+1][8]=i:this.modules[this.moduleCount-15+n][8]=i}for(var n=0;15>n;n++){var i=!t&&1==(o>>n&1);8>n?this.modules[8][this.moduleCount-n-1]=i:9>n?this.modules[8][15-n-1+1]=i:this.modules[8][15-n-1]=i}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var r=-1,o=this.moduleCount-1,n=7,i=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var s=0;2>s;s++)if(null==this.modules[o][a-s]){var h=!1;i<t.length&&(h=1==(t[i]>>>n&1));var u=f.getMask(e,o,a-s);u&&(h=!h),this.modules[o][a-s]=h,n--,-1==n&&(i++,n=7)}if(o+=r,0>o||this.moduleCount<=o){o-=r,r=-r;break}}}},e.PAD0=236,e.PAD1=17,e.createData=function(t,r,i){for(var a=o.getRSBlocks(t,r),s=new n,h=0;h<i.length;h++){var u=i[h];s.put(u.mode,4),s.put(u.getLength(),f.getLengthInBits(u.mode,t)),u.write(s)}for(var l=0,h=0;h<a.length;h++)l+=a[h].dataCount;if(s.getLengthInBits()>8*l)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*l+")");for(s.getLengthInBits()+4<=8*l&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;;){if(s.getLengthInBits()>=8*l)break;if(s.put(e.PAD0,8),s.getLengthInBits()>=8*l)break;s.put(e.PAD1,8)}return e.createBytes(s,a)},e.createBytes=function(t,e){for(var o=0,n=0,i=0,a=new Array(e.length),s=new Array(e.length),h=0;h<e.length;h++){var u=e[h].dataCount,l=e[h].totalCount-u;n=Math.max(n,u),i=Math.max(i,l),a[h]=new Array(u);for(var g=0;g<a[h].length;g++)a[h][g]=255&t.buffer[g+o];o+=u;var d=f.getErrorCorrectPolynomial(l),c=new r(a[h],d.getLength()-1),p=c.mod(d);s[h]=new Array(d.getLength()-1);for(var g=0;g<s[h].length;g++){var m=g+p.getLength()-s[h].length;s[h][g]=m>=0?p.get(m):0}}for(var v=0,g=0;g<e.length;g++)v+=e[g].totalCount;for(var _=new Array(v),C=0,g=0;n>g;g++)for(var h=0;h<e.length;h++)g<a[h].length&&(_[C++]=a[h][g]);for(var g=0;i>g;g++)for(var h=0;h<e.length;h++)g<s[h].length&&(_[C++]=s[h][g]);return _};for(var u={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},l={L:1,M:0,Q:3,H:2},g={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},f={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;f.getBCHDigit(e)-f.getBCHDigit(f.G15)>=0;)e^=f.G15<<f.getBCHDigit(e)-f.getBCHDigit(f.G15);return(t<<10|e)^f.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;f.getBCHDigit(e)-f.getBCHDigit(f.G18)>=0;)e^=f.G18<<f.getBCHDigit(e)-f.getBCHDigit(f.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return f.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,r){switch(t){case g.PATTERN000:return(e+r)%2==0;case g.PATTERN001:return e%2==0;case g.PATTERN010:return r%3==0;case g.PATTERN011:return(e+r)%3==0;case g.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case g.PATTERN101:return e*r%2+e*r%3==0;case g.PATTERN110:return(e*r%2+e*r%3)%2==0;case g.PATTERN111:return(e*r%3+(e+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new r([1],0),o=0;t>o;o++)e=e.multiply(new r([1,d.gexp(o)],0));return e},getLengthInBits:function(t,e){if(e>=1&&10>e)switch(t){case u.MODE_NUMBER:return 10;case u.MODE_ALPHA_NUM:return 9;case u.MODE_8BIT_BYTE:return 8;case u.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(27>e)switch(t){case u.MODE_NUMBER:return 12;case u.MODE_ALPHA_NUM:return 11;case u.MODE_8BIT_BYTE:return 16;case u.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(41>e))throw new Error("type:"+e);switch(t){case u.MODE_NUMBER:return 14;case u.MODE_ALPHA_NUM:return 13;case u.MODE_8BIT_BYTE:return 16;case u.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),r=0,o=0;e>o;o++)for(var n=0;e>n;n++){for(var i=0,a=t.isDark(o,n),s=-1;1>=s;s++)if(!(0>o+s||o+s>=e))for(var h=-1;1>=h;h++)0>n+h||n+h>=e||(0!=s||0!=h)&&a==t.isDark(o+s,n+h)&&i++;i>5&&(r+=3+i-5)}for(var o=0;e-1>o;o++)for(var n=0;e-1>n;n++){var u=0;t.isDark(o,n)&&u++,t.isDark(o+1,n)&&u++,t.isDark(o,n+1)&&u++,t.isDark(o+1,n+1)&&u++,(0==u||4==u)&&(r+=3)}for(var o=0;e>o;o++)for(var n=0;e-6>n;n++)t.isDark(o,n)&&!t.isDark(o,n+1)&&t.isDark(o,n+2)&&t.isDark(o,n+3)&&t.isDark(o,n+4)&&!t.isDark(o,n+5)&&t.isDark(o,n+6)&&(r+=40);for(var n=0;e>n;n++)for(var o=0;e-6>o;o++)t.isDark(o,n)&&!t.isDark(o+1,n)&&t.isDark(o+2,n)&&t.isDark(o+3,n)&&t.isDark(o+4,n)&&!t.isDark(o+5,n)&&t.isDark(o+6,n)&&(r+=40);for(var l=0,n=0;e>n;n++)for(var o=0;e>o;o++)t.isDark(o,n)&&l++;var g=Math.abs(100*l/e/e-50)/5;return r+=10*g}},d={glog:function(t){if(1>t)throw new Error("glog("+t+")");return d.LOG_TABLE[t]},gexp:function(t){for(;0>t;)t+=255;for(;t>=256;)t-=255;return d.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},c=0;8>c;c++)d.EXP_TABLE[c]=1<<c;for(var c=8;256>c;c++)d.EXP_TABLE[c]=d.EXP_TABLE[c-4]^d.EXP_TABLE[c-5]^d.EXP_TABLE[c-6]^d.EXP_TABLE[c-8];for(var c=0;255>c;c++)d.LOG_TABLE[d.EXP_TABLE[c]]=c;r.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),o=0;o<this.getLength();o++)for(var n=0;n<t.getLength();n++)e[o+n]^=d.gexp(d.glog(this.get(o))+d.glog(t.get(n)));return new r(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=d.glog(this.get(0))-d.glog(t.get(0)),o=new Array(this.getLength()),n=0;n<this.getLength();n++)o[n]=this.get(n);for(var n=0;n<t.getLength();n++)o[n]^=d.gexp(d.glog(t.get(n))+e);return new r(o,0).mod(t)}},o.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],o.getRSBlocks=function(t,e){var r=o.getRsBlockTable(t,e);if(void 0==r)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var n=r.length/3,i=[],a=0;n>a;a++)for(var s=r[3*a+0],h=r[3*a+1],u=r[3*a+2],l=0;s>l;l++)i.push(new o(h,u));return i},o.getRsBlockTable=function(t,e){switch(e){case l.L:return o.RS_BLOCK_TABLE[4*(t-1)+0];case l.M:return o.RS_BLOCK_TABLE[4*(t-1)+1];case l.Q:return o.RS_BLOCK_TABLE[4*(t-1)+2];case l.H:return o.RS_BLOCK_TABLE[4*(t-1)+3];default:return void 0}},n.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var r=0;e>r;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var p=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],m=function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){function e(t,e){var r=document.createElementNS("http://www.w3.org/2000/svg",t);for(var o in e)e.hasOwnProperty(o)&&r.setAttribute(o,e[o]);return r}{var r=this._htOption,o=this._el,n=t.getModuleCount();Math.floor(r.width/n),Math.floor(r.height/n)}this.clear();var i=e("svg",{viewBox:"0 0 "+String(n)+" "+String(n),width:"100%",height:"100%",fill:r.colorLight});i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),o.appendChild(i),i.appendChild(e("rect",{fill:r.colorDark,width:"1",height:"1",id:"template"}));for(var a=0;n>a;a++)for(var s=0;n>s;s++)if(t.isDark(a,s)){var h=e("use",{x:String(a),y:String(s)});h.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),i.appendChild(h)}},t.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},t}(),v="svg"===document.documentElement.tagName.toLowerCase(),_=v?m:i()?function(){function t(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function e(t,e){var r=this;if(r._fFail=e,r._fSuccess=t,null===r._bSupportDataURI){var o=document.createElement("img"),n=function(){r._bSupportDataURI=!1,r._fFail&&_fFail.call(r)},i=function(){r._bSupportDataURI=!0,r._fSuccess&&r._fSuccess.call(r)};return o.onabort=n,o.onerror=n,o.onload=i,o.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==",void 0}r._bSupportDataURI===!0&&r._fSuccess?r._fSuccess.call(r):r._bSupportDataURI===!1&&r._fFail&&r._fFail.call(r)}if(this._android&&this._android<=2.1){var r=1/window.devicePixelRatio,o=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(t,e,n,i,a,s,h,u){if("nodeName"in t&&/img/i.test(t.nodeName))for(var l=arguments.length-1;l>=1;l--)arguments[l]=arguments[l]*r;else"undefined"==typeof u&&(arguments[1]*=r,arguments[2]*=r,arguments[3]*=r,arguments[4]*=r);o.apply(this,arguments)}}var n=function(t,e){this._bIsPainted=!1,this._android=a(),this._htOption=e,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=e.width,this._elCanvas.height=e.height,t.appendChild(this._elCanvas),this._el=t,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return n.prototype.draw=function(t){var e=this._elImage,r=this._oContext,o=this._htOption,n=t.getModuleCount(),i=o.width/n,a=o.height/n,s=Math.round(i),h=Math.round(a);e.style.display="none",this.clear();for(var u=0;n>u;u++)for(var l=0;n>l;l++){var g=t.isDark(u,l),f=l*i,d=u*a;r.strokeStyle=g?o.colorDark:o.colorLight,r.lineWidth=1,r.fillStyle=g?o.colorDark:o.colorLight,r.fillRect(f,d,i,a),r.strokeRect(Math.floor(f)+.5,Math.floor(d)+.5,s,h),r.strokeRect(Math.ceil(f)-.5,Math.ceil(d)-.5,s,h)}this._bIsPainted=!0},n.prototype.makeImage=function(){this._bIsPainted&&e.call(this,t)},n.prototype.isPainted=function(){return this._bIsPainted},n.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},n.prototype.round=function(t){return t?Math.floor(1e3*t)/1e3:t},n}():function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){for(var e=this._htOption,r=this._el,o=t.getModuleCount(),n=Math.floor(e.width/o),i=Math.floor(e.height/o),a=['<table style="border:0;border-collapse:collapse;">'],s=0;o>s;s++){a.push("<tr>");for(var h=0;o>h;h++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+n+"px;height:"+i+"px;background-color:"+(t.isDark(s,h)?e.colorDark:e.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),r.innerHTML=a.join("");var u=r.childNodes[0],l=(e.width-u.offsetWidth)/2,g=(e.height-u.offsetHeight)/2;l>0&&g>0&&(u.style.margin=g+"px "+l+"px")},t.prototype.clear=function(){this._el.innerHTML=""},t}();QRCode=function(t,e){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:l.H},"string"==typeof e&&(e={text:e}),e)for(var r in e)this._htOption[r]=e[r];"string"==typeof t&&(t=document.getElementById(t)),this._android=a(),this._el=t,this._oQRCode=null,this._oDrawing=new _(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(t){this._oQRCode=new e(s(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._el.title=t,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=l}();
;_.Module.define({path:"common/widget/tbshare/tbshare_share",requires:["common/widget/tbcopy"],sub:{_baseConfig:{Parnter:{qqzone:{title:"QQ\u7A7A\u95F4",urlTmp:["http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?","url=#{url}&title=#{text}&desc=#{desc}","&summary=#{summary}&site=#{site}&pics=#{pics}"].join("")},tsina:{title:"\u65B0\u6D6A\u5FAE\u535A",urlTmp:["http://service.weibo.com/share/share.php?","url=#{url}&title=#{text}","&pic=#{pics}"].join("")},renren:{title:"\u4EBA\u4EBA\u7F51",urlTmp:["http://widget.renren.com/dialog/share?","resourceUrl=#{url}&srcUrl=#{url}&title=#{text}&description=","&pic=#{pics}"].join("")},tieba:{title:"\u767E\u5EA6\u8D34\u5427",urlTmp:["http://tieba.baidu.com/f/commit/share/openShareApi?","url=#{url}&title=#{text}&desc=#{desc}","&comment=#{summary}&pic=#{pics}"].join("")},weixin:{title:"\u5FAE\u4FE1",urlTmp:[].join("")},copy:{title:"\u590D\u5236\u94FE\u63A5",urlTmp:[].join(""),attr:'onclick="return false;"'},douban:{title:"\u8C46\u74E3",urlTmp:["http://www.douban.com/share/service?","href=#{url}&name=#{text}&text=#{desc}","&image=#{pics}"].join("")},tsohu:{title:"\u641C\u72D0\u5FAE\u535A",urlTmp:["http://t.sohu.com/third/post.jsp?","url=#{url}&title=#{text}","&pic=#{pics}"].join("")}},tmp:{base:['<ul class="">#{share_btns}</ul>'].join(""),btn:['<div class="tbshare_#{short_name} tbshare_icon" #{attr} title="#{title}" data-share="#{short_name}">',"#{text}",'<div class="tbshare_title_box">#{title}</div>',"</div>"].join(""),qrcode:['<div class="tbshare_qrcode_mask">','<div class="tbshare_qrcode_outer">','<div class="tbshare_qrcode_wrapper">',"<h6>\u626B\u4E00\u626B\u5206\u4EAB\u5230\u5FAE\u4FE1</h6>",'<div class="tbshare_qrcode_content"></div>','<div class="tbshare_qrcode_instruction">',"<p>\u6253\u5F00\u5FAE\u4FE1\uFF0C\u70B9\u51FB\u5E95\u90E8\u7684\u201C\u53D1\u73B0\u201D\uFF0C<br/>\u4F7F\u7528\u201C\u626B\u4E00\u626B\u201D\u5373\u53EF\u5C06\u7F51\u9875\u5206\u4EAB\u81F3\u670B\u53CB\u5708\u3002</p>","</div>",'<div class="tbshare_qrcode_close">&#215;</div>',"</div>","</div>",'<div class="tbshare_qrcode_triangle"></div>',"</div>"].join("")},common:{text:document.title,desc:document.title,url:$.tb.location.getHref(),pics:""}},qrcodeSize:76,classList:{normal:"tbshare_wrapper",coco:"tbshare_wrapper_theme_coco"},typeClassList:{normal:"",vertical:"vertical"},initial:function(t){if(t=$.extend({theme:"normal",type:"normal"},t),this.className=this.classList[t.theme],this.typeClass=this.typeClassList[t.type],!t)throw new Error("no tbShare args provided");this.shareContent=$.extend({},this._baseConfig.common,t.shareContent),this.$dom=this._createShareComponent(t.targets),this.$qrcode=this._createQrcodeWrapper(),this.$qrcode.appendTo(this.$dom),this._bindEvents()},share:function(t){if("weixin"==t)return this.$qrcode.show(),!1;if("copy"==t)return prompt("\u8BF7\u6309\u4E0B Ctrl+C \u590D\u5236\u94FE\u63A5\u5230\u9ECF\u8D34\u677F",$.tb.location.getHref()),!1;var e=this._baseConfig.Parnter[t],i=this.shareContent||this._baseConfig.common;i=this._dataEncodeURI(i);var r=$.tb.format(e.urlTmp,i);return window.open(r),!1},_createShareComponent:function(t){for(var e="",i="",r="",o=0,s=t.length;s>o;o++)"[object Array]"==Object.prototype.toString.call(t[o])?(i=t[o][0],r=t[o][1]):(i=t[o],r=""),this._baseConfig.Parnter[i]&&(e+=["<li>",$.tb.format(this._baseConfig.tmp.btn,{short_name:i,text:r,title:this._baseConfig.Parnter[i].title,attr:this._baseConfig.Parnter[i].attr||""}),"</li>"].join(""));var n=$.tb.format(this._baseConfig.tmp.base,{share_btns:e}),a=$("<div></div>").addClass(this.className).addClass(this.typeClass).append(n);return a},_createQrcodeWrapper:function(){var t=$(this._baseConfig.tmp.qrcode),e=$.tb.location.getHref(),i=this.qrcodeSize;return $.JsLoadManager.use("http://tb1.bdstatic.com/tb/_/qrcode_f84ab06.js",function(){new window.QRCode(t.find(".tbshare_qrcode_content")[0],{text:e||"http://tieba.baidu.com",width:i,height:i})}),t.on("click",".tbshare_qrcode_mask",function(){t.hide()}),t.on("click",".tbshare_qrcode_close",function(){t.hide()}),t},setQrcodeContent:function(t){var e=this.$qrcode.find(".tbshare_qrcode_content"),i=this.qrcodeSize,r=e.find("img"),o=this;r.length?(r.remove(),e.find("canvas").remove(),new window.QRCode(e[0],{text:t,width:i,height:i})):setTimeout(function(t){o.setQrcodeContent(t)},500,t)},_dataEncodeURI:function(t){var e={};for(var i in t)e[i]=encodeURIComponent(t[i]);return e},_bindEvents:function(){var t=this;this.$dom.on("click",".tbshare_icon",function(){var e=$(this).data("share");return e=e||"tieba",t.share(e)})},_lazyAddTbcopyOnce:function(t){this.tbcopy=this.requireInstance("common/widget/tbcopy",{ele:t,text:$.tb.location.getHref()})},_AddTbcopyOnce:function(){var t=this.$dom.find(".tbshare_copy");this.tbcopy=this.requireInstance("common/widget/tbcopy",{ele:t,text:$.tb.location.getHref()}),this.copyElement=this.tbcopy.getFlashElement()},_getPageImgSrc:function(t){var e=[];return $("img").each(function(i){t>i&&e.push($(this).tbattr("src"))}),e},setShareContent:function(t){return"[object Object]"==Object.prototype.toString.call(t)&&$.extend(this.shareContent,t),t&&t.url!=this.shareContent.url&&this.setQrcodeContent(this.shareContent.url),this.shareContent},hideQrcode:function(){this.$qrcode.hide()}}});
;_.Module.define({path:"common/widget/tbshare/tbshare_more",requires:["common/widget/tbshare/tbshare_share","common/widget/tbshare/tbshare_all"],sub:{_tmp:['<div class="tbshare_more_wrapper">','<a class="tbshare_more_enter" href="#" title="\u66F4\u591A">#{text}</a>','<div class="tbshare_float_wrapper tbshare_more_right"></div>','<div class="tbshare_slide_main">','<div class="tbshare_more_main">','<div class="tbshare_header">',"<h6>\u5206\u4EAB\u5230</h6>","</div>",'<div class="tbshare_main clearfix">',"</div>",'<div class="tbshare_footer"></div>',"</div>","</div>",'<div class="tbshare_float_wrapper tbshare_more_left"></div>',"</div>"].join(""),moreColumnWidth:[120,218],_args:{targets:[["qqzone","QQ\u7A7A\u95F4"],["tieba","\u767E\u5EA6\u8D34\u5427"],["renren","\u4EBA\u4EBA\u7F51"],["tsina","\u65B0\u6D6A\u5FAE\u535A"],["weixin","\u5FAE\u4FE1"],["douban","\u8C46\u74E3"],["tsohu","\u641C\u72D0\u5FAE\u535A"],["copy","\u590D\u5236"]]},initial:function(t){if(!t)throw new Error("no tbMore args provided");this.args=$.extend({text:"",columnNum:2,$container:null,show:!0,noAll:!1},t),this.$dom=this._createBaseDom(this.args.text),this.$moreWrapper=this._createBaseMoreWrapper(this.args.shareContent,this.args.targets),this.columnNum=this.args.columnNum,this.initMoreWrapperWidth(this.args.columnNum),this.args.slide&&-1!=$.inArray(this.args.slide.type,["left","right"])?(this.slide=this.args.slide,this._initSlide()):(this.args.noAll||(this.allInstance=this.requireInstance("common/widget/tbshare/tbshare_all",[]),this.allInstance.setShareContent(this.args.shareContent)),this._bindNormalEvents()),this._addToContainer()},_createBaseDom:function(t){t=t||"";var e=$.tb.format(this._tmp,{text:t});return $(e)},_createBaseMoreWrapper:function(t,e){return this._args.shareContent=t||{},"undefined"!=typeof e&&(this._args.targets=e),this.shareInstance=this.requireInstance("common/widget/tbshare/tbshare_share",[this._args]),this.shareInstance.$dom.appendTo(this.$dom.find(".tbshare_main")),this.$dom.find(".tbshare_more_main")},_bindNormalEvents:function(){var t=this;this.$dom.on("mouseenter",".tbshare_more_enter",function(){t.showMoreInNicePosition()}).on("click",".tbshare_more_enter",function(){return t.showAll()}).mouseleave(function(e){return $(e.relatedTarget)[0]?(t.hideMore(),void 0):!1})},_initSlide:function(){this.slideStatus="hide",this.$slideMain=this.$dom.find(".tbshare_slide_main"),this._setSlideStyle(),this._bindSlideEvents()},_setSlideStyle:function(){var t=this.slide.type,e=this.slide.position||"fixed";if(this.$slideBtn=this.$dom.find(".tbshare_more_"+t),this.$slideBtn.show(),this.showMore(),this.$slideMain.css({width:0}),this.$moreWrapper.css({position:"static"}),this.$dom.addClass("tbshare_slide_wrapper"),this.$dom.find(".tbshare_more_enter").hide(),"right"==t?this.$dom.css({right:0}):this.$dom.css({left:0}),!$.inArray(e,["absolute","fixed"]))throw new Error("The position setting not be supported");this.$dom.css({position:e})},_bindSlideEvents:function(){var t=this;this.$slideBtn.mouseenter(function(){"show"!=t.slideStatus&&(t.slideStatus="show",t.slideShowMore(t.slide.type))}),this.$dom.mouseleave(function(e){return $(e.relatedTarget)[0]?(t.slideStatus="hide",t.slideHideMore(t.slide.type),void 0):!1})},_addToContainer:function(){this.args.$container&&this.$dom.appendTo(this.args.$container),this.args.show&&this.show()},show:function(){this.$dom.show()},hide:function(){this.$dom.hide()},showMore:function(t,e){return"undefined"!=typeof t&&"undefined"!=typeof e&&this.$moreWrapper.css({left:t,top:e}),this.$moreWrapper.show(),this.$moreWrapper},showMoreInNicePosition:function(){var t=$(document).scrollTop()+$(window).height(),e=$(document).scrollLeft()+$(window).width(),i={top:this.$dom.offset().top,left:this.$dom.offset().left,width:this.$moreWrapper.width(),height:this.$moreWrapper.height()},s=0,r=0;i.top+i.height>t?r=-i.height:s+=16,i.left+i.width>e&&(s=-i.width,r+=20),this.showMore(s,r)},initMoreWrapperWidth:function(t){if(t&&t>0&&t<=this.moreColumnWidth.length+1){this.columnNum=t;var e=this.moreColumnWidth[this.columnNum-1];this.$moreWrapper.css({width:e})}},slideShowMore:function(t,e){var i=parseInt(this.$moreWrapper.css("width"));if("left"==t);else if("right"!=t)return!1;e&&this.$moreWrapper.css({top:e}),this.columnNum&&(i=this.moreColumnWidth[this.columnNum-1]+2,this.$slideMain.animate({width:i},100,"linear"))},slideHideMore:function(){this.$slideMain.animate({width:0},100,"linear")},hideMore:function(){this.$moreWrapper.hide()},showAll:function(){return this.allInstance&&this.allInstance.showAll(),!1},setShareContent:function(t){return this.shareInstance.setShareContent(t),this.allInstance&&this.allInstance.setShareContent(t),this}}});
;_.Module.define({path:"common/widget/tbshare/tbshare_popup",requires:["common/widget/tbshare/tbshare_share"],sub:{_tmp:['<div class="tbshare_popup_wrapper">','<div class="tbshare_popup_enter"></div>','<div class="tbshare_popup_main clearfix"></div>',"</div>"].join(""),_sharebase_args:{theme:"coco",targets:["tieba","weixin","tsina","qqzone","copy"]},_popup_args:{$container:null,type:"cross",itemIconPosition:"origin"},initial:function(e){if(!e)throw new Error("no tbMore args provided");this._popup_args=$.extend(this._popup_args,{$container:e.$container,type:e.type,itemIconPosition:e.itemIconPosition}),this._sharebase_args=$.extend(this._sharebase_args,{shareContent:e.shareContent||{},targets:e.targets,type:e.type}),this.$dom=this._createBaseDom(),this.$popupWrapper=this._createBaseMoreWrapper(),this._bindEvents(),this._popup_args.$container.append(this.$dom)},_createBaseDom:function(e){e=e||"";var t=this._tmp,s=$(t);return"vertical"==this._popup_args.type&&s.addClass("popup_vertical"),"left"==this._popup_args.itemIconPosition&&s.addClass("popup_icon_left"),s},_createBaseMoreWrapper:function(){return this.shareInstance=this.requireInstance("common/widget/tbshare/tbshare_share",[this._sharebase_args]),this.shareInstance.$dom.appendTo(this.$dom.find(".tbshare_popup_main")),this.$dom.find(".tbshare_popup_main")},_qrcodeShow:function(){this.shareInstance.$qrcode.show(),this.shareInstance.$dom.find(".tbshare_weixin").addClass("hover_on_qrcode")},_qrcodeHide:function(){this.shareInstance.$qrcode.hide(),this.shareInstance.$dom.find(".tbshare_weixin").removeClass("hover_on_qrcode")},_bindEvents:function(){var e=this;this.$dom.on("mouseenter",".tbshare_popup_main li",function(){$(this).find(".tbshare_weixin").length?e._qrcodeShow():e._qrcodeHide()}),this.$dom.on("mouseenter",function(t){$(this).find($(t.relatedTarget)).length||!$(t.relatedTarget).parent().length,e._qrcodeHide(),e.$popupWrapper.show()}),this.mouseenterInFlash=!1,this.$dom.on("mouseleave",function(t){var s=t.relatedTarget;if(s){if(s==e.shareInstance.copyElement)return e.mouseenterInFlash=!0,void 0}else if(e.mouseenterInFlash)return;e.$popupWrapper.hide(),e._reinitialCopy()});var t=$(this.shareInstance.copyElement);t.parent().on("mouseleave",function(t){var s=t.relatedTarget;e.args.$container.removeClass("copy_mouse_hover"),e.$dom.find($(s))||(e.mouseenterInFlash=!1)}),t.parent().on("mouseenter",function(){e.args.$container.addClass("copy_mouse_hover")})},_reinitialCopy:function(){this.$dom.find(".tbshare_copy .tbshare_title_box").removeClass("copy_done"),this.$dom.find(".tbshare_copy .tbshare_title_box").html("\u590D\u5236\u94FE\u63A5")},_setCopyCallback:function(){var e=this;e.shareInstance.tbcopy.setSuccessCallback(function(){e.$dom.find(".tbshare_copy .tbshare_title_box").addClass("copy_done"),e.$dom.find(".tbshare_copy .tbshare_title_box").html("\u5DF2\u590D\u5236\u94FE\u63A5")})},show:function(){this.$dom.show()},hide:function(){this.$dom.hide()},showMore:function(e,t){return"undefined"!=typeof e&&"undefined"!=typeof t&&this.$moreWrapper.css({left:e,top:t}),this.$moreWrapper.show(),this.$moreWrapper},hideMore:function(){this.$moreWrapper.hide()},setShareContent:function(e){return this.shareInstance.setShareContent(e),this}}});
;_.Module.define({path:"common/widget/tbshare/tbshare_all",requires:["common/widget/tbshare/tbshare_share"],sub:{_tmp:['<div class="tbshare_all_wrapper">',"<h5>\u5206\u4EAB\u5230",'<p class="j_tbshare_all_close"></p>',"</h5>",'<div class="tbshare_all_main"></div>','<div class="tbshare_all_footer"></div>',"</div>"].join(""),_args:{targets:[["qqzone","QQ\u7A7A\u95F4"],["tieba","\u767E\u5EA6\u8D34\u5427"],["renren","\u4EBA\u4EBA\u7F51"],["tsina","\u65B0\u6D6A\u5FAE\u535A"],["weixin","\u5FAE\u4FE1"],["douban","\u8C46\u74E3"],["tsohu","\u641C\u72D0\u5FAE\u535A"],["copy","\u590D\u5236"]]},initial:function(t){t=t||{},this.args=$.extend({show:!1,$container:$("body")},t),this.$container=this.args.$container,this._createElement(),this._bindEvents(),this._addToContainer()},_createElement:function(){this.$dom=$(this._tmp),this.$share_all_main=this.$dom.find(".tbshare_all_main"),this.share=this.requireInstance("common/widget/tbshare/tbshare_share",[this._args]),this.share.$dom.appendTo(this.$share_all_main)},_bindEvents:function(){var t=this;this.$dom.on("click",".j_tbshare_all_close",function(){t.hideAll()})},_addToContainer:function(){this.$container&&this.$container.append(this.$dom),this.args.show&&this.showAll()},setShareContent:function(t){return this.share.setShareContent(t),this},showAll:function(){return this.$dom.show(),this},hideAll:function(){return this.$dom.hide(),this}}});
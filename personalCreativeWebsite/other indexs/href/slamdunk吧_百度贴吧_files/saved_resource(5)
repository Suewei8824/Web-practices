_.Module.define({path:"adsense/widget/loader_async",requires:["adsense/widget/tool_async"],sub:{initial:function(e){var a=this.requireInstance("adsense/widget/tool_async"),t="/dasense/"+e.url,n=e.extraData||{},s=e.specialDataName||[];this.tool=a,t=a.getUrl({url:t}),this.dataname=e.dataname||null,this.dfd=$.Deferred(),this._getData(t,n,s)},_getData:function(e,a,t){var n=this,s=this.tool.getDirInfo(),i=this.tool.getSpecialInfo(t);a=$.extend(null,a,s,i,{ie:"utf-8"}),$.getJSON(e,a,function(e){if(0!=e.errno||!n.dataname)return!1;var a=$.getPageData("data.adsense",{},e);n.data=a[n.dataname]||[],n._loadTPL()})},_loadTPL:function(){for(var e=!0,a=null,t=0,n=this.data.length;n>t;t++){var s=this.data[t];s.first_screen&&"0"!=s.first_screen||!e||(a=-1==(s.tpl_name+"").indexOf("ASYNC_")?"tpl_async_"+s.tpl_name:"tpl_"+s.tpl_name,a="adsense/widget/"+a,this.requireInstanceAsync(a,[{adData:s,needStats:!0}]))}this._resolve()},_resolve:function(){var e=null;e=this.data.length?{no:0,error:""}:{no:1,error:"has no data"},this.dfd.resolve(e)}}});_.Module.define({requires:["adsense/widget/loader_async"],path:"ucenter/widget/LikeTip",sub:{initial:function(e,s,i,t){var a=this;if(this.userForumList=t||"",i&&i.like_no&&i.like_no>=1){var r=$.dialog.open(['<div id="do_like_back_wrapper">','<img class="like_back_img" src="http://tb2.bdstatic.com/tb/static-ucenter/widget/like_tip/img/like_back_c3abf90.jpg">',this.like_forum_tmp,"</div>"].join(""),{width:478,acceptValue:"\u77E5\u9053\u4E86"});$(r.element[0]).find(".dialogJcontent").css("padding-bottom","0px"),$(r.element[0]).find(".dialogJanswers").css("padding-top","0px"),r.bind("onaccept",function(){a.reloadAndGotop()}).bind("onclose",function(){a._postDaLikeTrack("\u5173\u95ED"),a.reloadAndGotop()})}else{var n=this.getTipContent(e,s,i),l={title:"\u6210\u529F\u63D0\u793A",width:478,modal:!e};this.isSuperMember()&&(l.width=535);var r=$.dialog.open(n,l);e&&$(r.element[0]).css("padding","2px"),$(r.element[0]).find(".dialogJcontent").tbattr("id","balv_first_like_dialog"),$(r.element[0]).find(".userlike_tip_span a").click(function(){Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=entryimallinpop")}),$(r.element[0]).on("click",".userlike_supermember_btn",function(){window.open("/tbmall/mall/forumMember"),a.reloadAndGotop()}),r.bind("onclose",function(){a._postDaLikeTrack("\u5173\u95ED"),a.reloadAndGotop()})}this.initLikeForum(r)},like_forum_tmp:['<div id="content-recommend-like-forum">','<p class="like-btn-wrapper">\u4F60\u53EF\u80FD\u8FD8\u60F3\u5173\u6CE8<button class="btn-default btn-small pull-right a-like-all-btn">\u4E00\u952E\u5173\u6CE8</button></p>','<div class="adsense-content-recommend-forum"></div>',"</div>"].join(""),initLikeForum:function(e){var s=100,i=this.requireInstance("adsense/widget/loader_async",[{url:"recommend",dataname:"PC_RECOMM_BOTTOM",extraData:{user_forum_list:this.userForumList}}]),t=$("#content-recommend-like-forum"),a=this;t.on("click",".a-like-all-btn",function(){a._postDaLikeTrack("\u4E00\u952E\u5173\u6CE8"),t.find(".a-like-btn.btn-sub:lt(4)").trigger("click")}),i.dfd.done(function(i){0==i.no&&t.html().length&&(t.show(),e.setPosition(null,s))})},_postDaLikeTrack:function(e,s,i,t){"undefined"==typeof e&&(e=""),"undefined"==typeof t&&(t="click"),i=i||{},s&&(i=$.extend({obj_name:s.game_name,obj_game_id:s.game_id},i)),$.stats.track(e,"\u5206\u53D1\u5173\u6CE8\u5427\u63A8\u8350","",t,i)},getTipContent:function(e,s,i){var t=PageData,a=t.user.level_id?t.user:t.user.balv,r="<span>";e&&(r+=e+"\uFF0C"),r+="\u606D\u559C\u4F60\u6210\u4E3A\u672C\u5427\u7B2C</span>",r+="<span class='tip_font_orange'>"+i.index+"</span>",r+="<span>\u4F4D\u4F1A\u5458</span>";var n="";n+='<div class="userlike_tip_join" id="userlike_tip_join">',n+='<div class="userlike_tip_info" id="userlike_tip_info">'+r+"</div>",e?n+='<div class="user_rights_msg"><span class="user_rights_msg_gray">\u83B7\u5F97\u5934\u8854&nbsp;</span><img class="user_rights_msg_img" src="/tb/static-frs/img/balv/lv_join.png">&nbsp;'+a.level_name+'<span class="user_rights_msg_gray">&nbsp;\u5347\u7EA7\u4EAB\u7279\u6743\uFF0C<span><a class="user_rights_msg_link" target="_blank" href="/f/like/level?kw='+t.forum.name_url+'">\u67E5\u770B\u4F1A\u5458\u6743\u5229</a></div>':1==a.level_id?n+='<div class="user_rights_msg">\u83B7\u5F97\u5934\u8854&nbsp;<img class="user_rights_msg_img" src="/tb/static-frs/img/balv/lv_join.png">&nbsp;'+a.level_name+'\uFF0C\u5347\u7EA7\u4EAB\u7279\u6743\uFF0C<a target="_blank" href="/f/like/level?kw='+t.forum.name_url+'">\u67E5\u770B\u5347\u7EA7\u79D8\u7C4D</a></div>':(n+='<div class="user_rights_msg">\u6839\u636E\u4F60\u5728\u672C\u5427\u7684\u6D3B\u8DC3\u8868\u73B0\uFF0C\u76F4\u63A5\u6388\u4E88<img src="http://tb2.bdstatic.com/tb/static-member/img/badges/'+a.level_id+'.png">&nbsp;'+a.level_name+"\uFF0C\u7ED9\u529B\uFF01</div>",n+='<div class="userlike_tip_span">\u672C\u5427\u767E\u5B9D\u7BB1\u5BF9\u4F60\u5F00\u653E\u4E86\uFF0C<a target="_blank" href="/imall/mall?kw='+t.forum.name_url+'">\u53BB\u767E\u5B9D\u7BB1\u770B\u770B\u6709\u54EA\u4E9B\u7279\u6743\u548C\u5B9D\u8D1D</a></div>'),this.isSuperMember()&&(n+=this.getSuperMemberHtml()),n+=this.like_forum_tmp,n+='<div class="lvlup_tip_btnzone">';var l="";return this.isSuperMember()&&(n+='<input class="userlike_supermember_btn userlike_sm_btn_style" type="button" value="\u8BE6\u7EC6\u4E86\u89E3\u7279\u6743"/>',l="userlike_sm_btn_style"),e&&(n+='<a class="userlike_tip_cancel" target="_blank" href="/home/forum?id='+t.user.portrait+"&fr="+t.product+'">\u5982\u4F55\u53D6\u6D88\u4F1A\u5458</a>'),n+="</div></div>"},reloadAndGotop:function(){$.tb.location.setHref($.tb.location.getHref().split("#")[0])},getSuperMemberHtml:function(){var e=[],s=PageData.user?PageData.user.Parr_props?PageData.user.Parr_props.level?PageData.user.Parr_props.level:{}:{}:{},i=PageData.forum.name||PageData.forum.forum_name;return e.push('<div class="userlike_supermember">'),e.push('<div class="userlike_sm_up clearfix">'),e.push('<div class="userlike_sm_up_gift"></div>'),e.push('<div class="userlike_sm_up_info">'),e.push('<h3>\u5C0A\u8D35\u7684<span class="userlike_sm_up_icon">\u8D34\u5427\u8D85\u7EA7\u4F1A\u5458</span></h3>'),e.push("<h2>\u60A8\u5DF2\u6210\u529F\u83B7\u5F97<b>\u3010"+i+"\u5427\u7279\u6743\u5305\u3011</b></h2>"),e.push("<p>\u6709\u6548\u671F\u81F3"+this.getFormatZhTime(1e3*s.end_time)+"</p>"),e.push("</div>"),e.push("</div>"),e.push('<div class="userlike_sm_down clearfix">'),e.push('<div class="userlike_sm_down_item">'),e.push('<div class="userlike_sm_down_title">\u7EA2\u8272\u6807\u9898</div>'),e.push('<div class="userlike_sm_down_pic userlike_sm_down_pic_1"></div>'),e.push("</div>"),e.push('<div class="userlike_sm_down_item">'),e.push('<div class="userlike_sm_down_title">\u7ECF\u9A8C\u52A0\u901F</div>'),e.push('<div class="userlike_sm_down_pic userlike_sm_down_pic_2"></div>'),e.push("</div>"),e.push("</div>"),e.push("</div>"),e.join("")},isSuperMember:function(){var e=PageUnit.load("like_tip_svip_black_list");if(e)return!1;var s=PageData.user?PageData.user.Parr_props?PageData.user.Parr_props.level?PageData.user.Parr_props.level:{}:{}:{};return 1e3*s.end_time>1*new Date&&2===s.props_id&&!PageData.forum.is_star},getFormatZhTime:function(e){return"number"!=typeof e?"":(e=new Date(e),[e.getFullYear()+"\u5E74",parseInt(e.getMonth()+1)+"\u6708",e.getDate()+"\u65E5"].join(""))}}});_.Module.define({path:"user/widget/myCurrentForum",sub:{initial:function(e){this._opt=e,this.forum=PageData.forum,this.bindEvents()},bindEvents:function(){var e=this;$(".user_level .badge, .user_level .badge_block").bind("click",function(){return window.open("/f/like/level?kw="+e.forum.name_url+"&lv_t=lv_nav_intro"),!1}),$(".user_level .exp_bar").bind("click",function(){return window.open("/f/like/level?kw="+e.forum.name_url+"&lv_t=lv_nav_who"),!1})}}});_.Module.define({path:"user/widget/tbSpam",requires:[],sub:{initial:function(){$("body").append($("#tb_spam_notice_html").html())}}});_.Module.define({path:"user/widget/myTieba",requires:["common/widget/wallet_dialog","common/widget/Card","common/widget/tcharge_dialog"],sub:{config:{url:{dolike:"/f/like/commit/add",undolike:"/f/like/commit/delete",closetip:"/f/like/commit/notice/delete"}},initial:function(e){var i=this,t=e||{};i.user=PageData.user,i.forum=PageData.forum,i.balvInfo=t.balvInfo,i.style=t.style||"",i.isBySys=t.isBySys||!0,i.scoreTip=null,i.daysTofree=0,i.block_bubble=null,i.product=t.product||null},init:function(){var e=this;e.user.forbidden?e.daysTofree=e.user.forbidden.days_to_free:e.user.balv&&(e.daysTofree=e.user.balv.days_tofree),-1!=$.inArray(e.product,["frs","pb"])&&(_.Module.use("ueglibs/widget/Ban",[],function(i){e.BanLib=i}),this.user.is_login&&e.showOfflineCard()),this.user.is_login&&(this.bindEvents(),$(".user_profile .sign_highlight").length>0&&this.show_orange_tip(),this.showNewpropsTip()),this.dolikeEvent()},showOfflineCard:function(){var e=this,i=1*new Date;i>1408032e6||$.tb.Storage.get("balv_tdou_update")>i||(this.offline_card=this.use("common/widget/Card",{content:'<span style="cursor:pointer;position: absolute;width: 10px; height: 10px; right: 5px; top: 6px;" class="j_close"></span><a target="_blank" class="j_link" href="/p/3199708402"><img style="margin: 4px 4px 0;" src="http://tb1.bdstatic.com/tb/static-ucenter/img/offline1.png"></a>',clazz:"doupiao_offline",arrow_dir:"left",card_css:{width:172,"z-index":1010,left:198,top:9},arrow_pos:{left:-7,top:20},wrap:$(".user_profile"),card_leave_display:!0}),this.offline_card._j_card.on("click",".j_close",function(){$.tb.Storage.set("balv_tdou_update",i+864e5),e.offline_card._j_card.remove()}).on("click",".j_link",function(){$.tb.Storage.set("balv_tdou_update",i+864e5),e.offline_card._j_card.remove()}),this.offline_card.showCard())},bindEvents:function(){var e=this;if($("#user_info").on("click",".j_score_num",function(i){i.preventDefault(),e.requireInstance("common/widget/wallet_dialog").show()}),$(".userliked_ban_content").on("click.bawuAppealLink",".j_appealLink",function(){$.stats.track("balvAppealLink","uegCount","bawuAppeal","click")}),$(".userlike_blacked").bind("mouseover",function(){e.show_black_tip($(this))}),$(".userlike_prisoned").bind("mouseover",function(){e.daysTofree>0&&e.daysTofree<360?e.show_shortblock_tip($(this),e.daysTofree,e.isBySys?"\u7CFB\u7EDF":"\u5427\u4E3B",e.isBySys?"system":"bawu"):e.show_block_tip($(this))}),$("body").delegate(".tbmall_tip_close","click",function(){return $("#tbmall_tip_card").remove(),e.tbmallTip=null,$.cookie("close_tbmall_tip","1",{expires:365}),!1}),$("#j_tcharge_dialog").on("click",function(){$.stats.track(e.formatForm(),"\u4F1A\u5458\u5B98\u7F51\u7EDF\u8BA1"),e.use("common/widget/tcharge_dialog")}),this.user.balv&&this.user.balv.has_liked||this.user.is_like)if(PageData.is_ipad)$("a.p_balv_btnmanager").show();else{var i=$(".p_balv_btnmanager");$(".my_tieba_mod").hover(function(){i.show()},function(){i.hide()})}},formatForm:function(){var e=this,i="";return i=e.product?e.product:e.urlFormat(),i+"\u83B7\u53D6T\u8C46"},urlFormat:function(){return location.href.split("/").pop()},dolikeEvent:function(){var e=this;$(".balv_dolike_comforum,.balv_dolike_star").bind("click",function(){return e.user.is_login?e.user.balv&&e.user.balv.is_block||e.user.forbidden&&e.user.forbidden.isForbid?e.showAlert(e.BanLib.render("balvLike")):e.user.balv&&e.user.balv.is_black||e.user.is_black?e.showAlert("\u4F60\u88AB\u5427\u4E3B\u52A0\u5165\u672C\u5427\u9ED1\u540D\u5355\uFF0C\u6682\u65F6\u4E0D\u80FD\u8FDB\u884C\u64CD\u4F5C"):e.dolike():_.Module.use("common/widget/LoginDialog",["","ilike"]),!1})},showAlert:function(e){var i='<div style="padding:20px 20px; text-align:cente; line-height:20px;font-size:13px;">'+e+"</div>";$.dialog.open(i,{title:"\u64CD\u4F5C\u5931\u8D25",width:380})},howtojoin:function(){$.dialog.alert("<div style='padding:20px;line-height:30px;padding-bottom:0px;'>\u70B9\u51FB\u53F3\u4FA7\u4E0A\u65B9\u201C<img align='absmiddle' src='"+PageData.staticDomain+"tb/static-member/img/whatlevel.png'></img>\u201D<br/>\u5373\u53EF\u52A0\u5165\u672C\u5427\uFF0C\u70B9\u4EAE\u5934\u8854\uFF0C\u4ECE\u521D\u7EA7\u7C89\u4E1D\u5F00\u59CB\u6210\u957F\uFF01</div>",{title:"\u5982\u4F55\u52A0\u5165",width:325})},dolike:function(){var e=this;if(this.user.is_login&&this.user.no_un)return TbCom.process("User","buildUnameFrame","\u586B\u5199\u7528\u6237\u540D","\u6709\u7528\u6237\u540D\u624D\u80FD\u70B9\u4EAE\u201C\u6211\u5173\u6CE8\u201D\uFF0C\u8D76\u5FEB\u7ED9\u81EA\u5DF1\u8D77\u4E00\u4E2A\u5427~"),!1;var i={fid:this.forum.forum_id,fname:$.tb.escapeHTML(this.forum.forum_name),uid:this.user.name_url,ie:"gbk",tbs:PageData.tbs};$.post(this.config.url.dolike,i,function(i){if(i&&0==i.no)_.Module.use("ucenter/widget/LikeTip",["",!1,{index:i.data.ret.index,like_no:i.like_no}]);else{var t="";t=8==i.no||9==i.no?e.BanLib.render("balvLike"):220==i.no?"\u4F60\u88AB\u5427\u4E3B\u52A0\u5165\u9ED1\u540D\u5355\uFF0C\u6682\u65F6\u4E0D\u80FD\u8FDB\u884C\u64CD\u4F5C":221==i.no?"\u4F60\u5DF2like\u4E86\u672C\u5427,\u8BF7\u4E0D\u8981\u91CD\u590D\u64CD\u4F5C":"\u62B1\u6B49\uFF0C\u5F02\u5E38\u9519\u8BEF\uFF0C\u5EFA\u8BAE\u5237\u65B0\u9875\u9762\u91CD\u8BD5\u4E00\u4E0B",e.showAlert(t)}},"json")},undolike:function(){var e={fid:this.forum.forum_id,fname:$.tb.escapeHTML(this.forum.forum_name),uid:this.user.name_url,ie:"utf-8",tbs:PageData.tbs};$.tb.post(this.config.url.undolike,e,function(e){e&&0==e.no&&$.tb.location.reload(!0)})},show_shortblock_tip:function(e){this.block_render(e,this.BanLib.render("balvAside"))},show_block_tip:function(e){this.block_render(e,this.BanLib.render("balvAside"))},show_black_tip:function(e){var i=new Array;i.push("<div style='width:180px;text-align:left;margin:6px 0px 6px 10px;'>"),i.push("<span>\u4F60\u5DF2\u88AB\u5427\u4E3B\u62C9\u5165\u9ED1\u540D\u5355\uFF0C</span></br><span>\u4F60\u5728\u672C\u5427\u7684\u5934\u8854\u548C\u6743\u9650\u4E5F\u88AB\u6536\u56DE\u3002</span>"),i.push("</div>"),this.block_render(e,i.join(""))},show_lvup_tip:function(e,i){var t=this,o=new Array;if(o.push("<div class='lvup_tip_container'>"),o.push("<div class='lvlup_con_msg'>\u5347\u7EA7\u5566!\u4F60\u5DF2\u62E5\u6709\u672C\u5427"+e+"\u7EA7\u5934\u8854!</div>"),o.push('<div class="lvlup_pop_rights">'+i+"</div>"),"\u52A0\u6CB9~\u7EE7\u7EED\u6512\u7ECF\u9A8C\uFF01"==i)o.push("<a style='float:left;' href='/f/like/level?kw="+this.forum.name_url+"' target='_blank'>\u67E5\u770B\u5347\u7EA7\u79D8\u7B08</a>");else{var s='Stats.sendRequest("fr=tb0_forum&st_mod=frs&st_type=balvupguide&lv='+e+'")';o.push("<a href='#sub' style='float:left;' onclick='rich_postor.jumpToTry("+e+");"+s+"'>\u73B0\u5728\u53BB\u8BD5\u8BD5~~</a>")}o.push("</div>");var l=o.join(""),n={content:l,arrow_dir:"up",bubble_css:{top:4,right:-5,width:232,"z-index":9999},arrow_pos:{left:209},attr:"lvup_tip_table",wrap:$("#userlike_info_tip"),closeBtn:!0},r=new UiBubbleTipBase(n);r.j_bubble.find(".j_content").css("padding","2px").addClass("lvup_tip_table"),r.showBubble(),r.bind("onclose",function(){t.close_lvup_tip()},!0),this.user.is_block||setTimeout(function(){r.closeBubble(),t.close_lvup_tip()},8e3)},block_render:function(e,i){if(!this.block_bubble){var t=this,o={content:i,arrow_dir:"up",bubble_css:{top:36,right:4,width:232,"z-index":9999},arrow_pos:{left:209},attr:"",wrap:e,closeBtn:!0};this.block_bubble=new UiBubbleTipBase(o),this.block_bubble.j_bubble.find(".j_content").css("padding","2px"),this.block_bubble.showBubble(),this.block_bubble.bind("onclose",function(){t.block_bubble.closeBubble(),t.block_bubble=null});{setTimeout(function(){t.block_bubble&&(t.block_bubble.closeBubble(),t.block_bubble=null)},5e3)}}},close_lvup_tip:function(){var e={fid:this.forum.forum_id,fname:this.forum.name_url,uid:this.user.name_url,ie:"utf-8",tbs:PageData.tbs,type:2};$.tb.post(this.config.url.closetip,e,function(e){e&&0==e.no})},show_orange_tip:function(){if("false"!=$.cookie("close_sign_tip_o")){$.cookie("close_sign_tip_o",!0,{expires:14});var e={content:"\u8FDE\u7EED\u7B7E\u523030\u5929ID\u5373\u53EF\u9AD8\u4EAE\u5C55\u793A\uFF0C\u4E00\u8D77\u95EA\u8000\u5427\uFF01",arrow_dir:"down",bubble_css:{top:3,right:25,width:145,"z-index":9999},arrow_pos:{left:88},attr:" ",wrap:$(".user_profile .user_name"),closeBtn:!0},i=new UiBubbleTipBase(e);i.j_bubble.find(".j_body").css("padding-right","3px"),i.showBubble(),i.bind("onclose",function(){$.cookie("close_sign_tip_o",!1,{expires:14})},!0);{setTimeout(function(){$(".j_wrap .j_close").click()},8e3)}}},showNewpropsTip:function(){var e=$.cookie("NEWS_PROPS_NOTICE"),i=this.user.global&&this.user.global.tbmall_newprops||"";(!e&&i>0||e&&i>e)&&this.buildNewpropsTip()},buildNewpropsTip:function(){var e=this,i={content:'<a class="j_newprops_tip" href="/tbmall/home?sn=1" target="_blank" style="text-align:center;display:block;">\u6709\u65B0\u9053\u5177\u4E0A\u7EBF\u54E6~</a>',arrow_dir:"up",arrow_pos:{left:40},bubble_css:{top:-35,left:100,width:100},wrap:$("#j_profile_pop"),closeBtn:!0},t=new UiBubbleTipBase(i),o="";t.bind("onclose",function(){t.closeBubble(),o=e.user.global&&e.user.global.tbmall_newprops||"",$.cookie("NEWS_PROPS_NOTICE",o,{expires:30,path:"/"})}),t.showBubble(),t.j_bubble.find(".j_newprops_tip").on("click",function(){$.post("/tbmall/post/addpropstoucenter",null,function(){}),t.closeBubble(),o=e.user.global&&e.user.global.tbmall_newprops||"",$.cookie("NEWS_PROPS_NOTICE",o,{expires:30,path:"/"})})},hasLevel:function(){var e=Math.floor((new Date).getTime()/1e3);return this.user.Parr_props&&this.user.Parr_props.level&&this.user.Parr_props.level.end_time>e}}});_.Module.define({path:"encourage/widget/myApp",sub:{MY_APP_THEME_KEY:"my_app_theme_cls",initial:function(a){var t=this;t._root=$("#encourage_entry"),$.extend(t,a),$.tb.Storage.remove("my_app_theme_cls"),"1"==t.is_pull_recommendation&&t.pullRecommendation(),t._stats()},_stats:function(){var a=this,t=a._root.find(".list50").length>0;a._root.on("click","a",function(){var e=$(this).data("log"),n=$(this).closest(".j_app_item").find(".j_app_recommend").length>0||"1"!=a.is_pull_recommendation,p={is_recommendation:n,is_50:t};$.stats.track(e,"\u53F3\u4FA7\u5165\u53E3-\u6211\u7684\u5E94\u7528",PageData.product,"click",p)}),a._viewStats(a._root,{is_50:t})},_viewStats:function(a,t){var e=!1,n=null,p=function(){e||($.stats.track("\u5C55\u73B0","\u53F3\u4FA7\u5165\u53E3-\u6211\u7684\u5E94\u7528",PageData.product,"show",t),e=!0)},i=function(){var t=a.offset().top,e=a.offset().top+a.height(),n=$("body").scrollTop(),p=$(window).height()+n,i=!1;return(t>n&&p>=t||e>n&&p>=e)&&(i=!0),i};i()?p():$(window).on("scroll",function(){i()&&(clearTimeout(n),n=setTimeout(p,200))})},setTheme:function(){var a=this,t="list50",e="list60",n=$.tb.Storage.get(a.MY_APP_THEME_KEY);n||(n="1"==a.is_pull_recommendation?a.user_id%2==0?t:e:a.random(0,99)%2==0?t:e,$.tb.Storage.set(a.MY_APP_THEME_KEY,n)),a._root.find(".j_app_list").addClass(n)},random:function(a,t){return null==t&&(t=a,a=0),a+Math.floor(Math.random()*(t-a+1))},pullRecommendation:function(){var a=this,t={ie:"utf-8",tbs:PageData.tbs};a._ajax&&a._ajax.abort(),a._ajax=$.ajax({type:"post",url:"/tbapp/user/getRecommendApp",data:t,dataType:"json"}).success(function(t){t&&0===t.no&&a.renderAppList(t.data)})},renderAppList:function(a){var t=this,e=0;t.wrapper=$("#encourage_entry");for(var n="",p='<li  class="media_vertical app_icon_wrap j_app_item #{last_app_item}"><div class="media_top"><a href="/f?ie=utf-8&kw=#{app_name}" data-log="#{app_name}" target="_blank" class="app_icon_link"  title="#{app_name}"><img src="#{app_img}"></a>#{recommend_title}</div><a href="/f?ie=utf-8&kw=#{app_name}" data-log="#{app_name}" target="_blank"  class="media_bottom text_overflow"  title="#{app_name}">#{app_name}</a></li>',i=0,o=a.length;o>i&&12>i;i++){var _=a[i],r={last_app_item:(i+1)%3===0?"last_app_item":"",app_name:_.forum_name,app_img:_.forum_portrait_image,recommend_title:1==_.type?(e++,'<span  class="j_app_recommend media_caption app_recommend">\u8350</span>'):""};n+=$.tb.format(p,r)}var s=t.wrapper.find(".j_add_app_item");12==a.length?s.hide():s.show(),t.wrapper.find(".j_app_list").prepend(n),e==a.length?(t.wrapper.find(".j_encourage_title").html("\u63A8\u8350\u5E94\u7528"),t.wrapper.find(".j_app_recommend").hide()):(t.wrapper.find(".j_encourage_title").html("\u6211\u7684\u5E94\u7528"),t.wrapper.find(".j_app_recommend").show())}}});_.Module.define({path:"ucenter/widget/tbSpam",requires:[],sub:{initial:function(){$("body").append($("#tb_spam_notice_html").html())}}});_.Module.define({path:"frs/widget/ForumInfo",requires:["frs/widget/ForumInfo/ForumInfoManager"],sub:{initial:function(e,o,n,t){try{var i=this.use("ForumInfoManager",t),r=$("#"+e);if(!r.length)return;var f=r.find(".j_forum_team"),a=r.find(".member_setup:first");f.length&&f.click(function(){try{return i.showForumTeamList(),!1}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/forum_info/forum_info_main.js",method:"",ln:24}),e}}),a.length&&a.click(function(){try{return i.setMemberName(),!1}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/forum_info/forum_info_main.js",method:"",ln:30}),e}}),$(window).bind("load",function(){i.displayApplyInfo(n)})}catch(m){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:m.message||m.description,path:"frs:widget/forum_info/forum_info_main.js",method:"",ln:34}),m}}}});
;_.Module.define({path:"frs/widget/ForumInfo/ForumInfoManager",sub:{_forumData:null,_tip_dialog:null,_has_right:!1,initial:function(a){try{var e=this;e._forumData=a,_.Module.use("ueglibs/widget/Ban",[],function(a){e.BanLib=a})}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_info/forum_info_manager.js",method:"",ln:14}),t}},_getCandidatesLink:function(a,e){var t="\u67E5\u770B"+a+"\u4F4D\u5427\u4E3B\u5019\u9009\u4EBA";return this._forumData.mgr_num>0&&"voting"==e&&(t="\u7ED9"+a+"\u4F4D\u5427\u4E3B\u5019\u9009\u4EBA\u6295\u7968"),'<a href="/bawu2/platform/listCandidateInfo?word='+this._forumData.name_url+'&manager_type=1" target="_blank">['+t+"]</a>"},_getApplyLink:function(a,e,t){if(a)return $('<a href="/managerapply/apply?kw='+this._forumData.name_url+"&forum_id="+PageData.forum.forum_id+'" target="_blank" data-checkun="un">\u7533\u8BF7\u5427\u4E3B</a>');var n="";return n=t===!1?'<a href="/managerapply/applyIntern?kw='+this._forumData.name_url+"&forum_id="+PageData.forum.forum_id+'" target="_blank" class="tbManagerApplyIntern btn_default btn_small"  data-checkun="un" title="\u7533\u8BF7\u5B9E\u4E60\u5427\u4E3B">\u7533\u8BF7\u5B9E\u4E60\u5427\u4E3B</a>':e?this.team_link+'<a href="/managerapply/apply?kw='+this._forumData.name_url+"&forum_id="+PageData.forum.forum_id+'" target="_blank"  data-checkun="un">\u7533\u8BF7\u5427\u4E3B</a>':'<a href="/managerapply/apply?kw='+this._forumData.name_url+"&forum_id="+PageData.forum.forum_id+'" target="_blank" class="tbManagerApply btn_default btn_small"  data-checkun="un" title="\u7533\u8BF7\u672C\u5427\u5427\u4E3B">\u7533\u8BF7\u672C\u5427\u5427\u4E3B</a>'},_getManagerApplying:function(){var a="";return 0==this._forumData.mgr_num&&(a=this.team_link),a+'<span style="background:#b8b8b8;padding:4px 5px 1px;color:#fff;">\u7533\u8BF7\u5904\u7406\u4E2D</span>'},_getCandidateHandleLink:function(a){return'<a href="/bawu2/platform/auditPend?word='+this._forumData.name_url+'" target="_blank">'+a+"\u4E2A\u5427\u4E3B\u7533\u8BF7</a>"},_getAdminTip:function(a){if(a>0){var e=[];return e.push("\u5F85\u5904\u7406\uFF1A"),e.push(this._getCandidateHandleLink(a)),e.join("")}return""},showForumTeamList:function(){var a="/f/bawu/admin_group?kw="+this._forumData.name_encode+"&fid="+this._forumData.id;$.dialog.open(a,{title:"\u5427\u52A1\u56E2\u961F",width:550,height:260,contentType:"iframe"})},setMemberName:function(){var a,e="",t=$("#member_name_link"),n=t.html(),i=this;this._checkBarsName(n)||(n=""),e='<div style="margin:20px 0 0 10px">',e+='<div style="color:red;line-height:20px">\u6CE8\u610F\uFF1A\u4F1A\u5458\u540D\u79F0\u4E00\u4E2A\u6708\u53EA\u80FD\u4FEE\u6539\u4E00\u6B21\uFF0C\u8BF7\u614E\u91CD\u4FEE\u6539\u3002</div>',e+='<span style="font-weight:bold;margin-right:10px;">\u672C\u5427\u4F1A\u5458\u540D\u79F0\u8BBE\u7F6E\uFF1A</span>',e+='<input value="'+n+'" id="bars_name" size="17" maxlenth="16" /> ',e+='<button id="bars_name_set" style="padding:0 2px 0 2px">\u786E\u5B9A</button><br />',e+='<span style="line-height:26px">',e+='<span id="bars_message" style="line-height: 20px;font-size:12px">\u4EC5\u9650\u4F7F\u7528\u6C49\u5B57\u3001\u5B57\u6BCD\u3001\u6570\u5B57\u548C\u4E0B\u5212\u7EBF</span></span>',e+="</div>",a=new $.dialog({title:"\u8BBE\u7F6E",width:400,height:120,html:e}),$("#bars_name_set").click(function(){try{i._submitSetBarsName(this,a,t)}catch(e){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/forum_info/forum_info_manager.js",method:"",ln:122}),e}})},_submitSetBarsName:function(a,e,t){var n=$("#bars_name").val()||"",i=this;return n=n.toString(),this._checkBarsName(n)?($.ajax({url:"/f/bawu/commit/update_member_alias",type:"post",dataType:"json",async:!1,data:{kw:$.tb.escapeHTML(PageData.forum.forum_name),mbr_alias:n,tbs:PageData.tbs},success:function(a){a&&(0==a.no&&(t.html(n),setTimeout(function(){e.close()},2e3)),i._showMessage(a.no))}}),void 0):!1},_checkBarsName:function(a){"string"!=typeof a&&(a=a.toString()||a.value);for(var e=0;e<a.length;e++)if(a.charCodeAt(e)<127&&!a.substr(e,1).match(/^\w+$/gi))return this._showMessage("605"),!1;return a&&a.replace(/[^\u0000-\u007f]/g,"aa").length>8?(this._showMessage("604"),!1):!0},_showMessage:function(a){var e=this,t="",n="",i=$("#bars_message"),r={1:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",2:"\u5427\u4E0D\u5B58\u5728",3:"\u60A8\u5F53\u524D\u672A\u767B\u5F55",13:"\u60A8\u7684IP\u88AB\u5C01\u7981\uFF0C\u6682\u4E0D\u80FD\u4FEE\u6539",607:"\u62B1\u6B49\uFF0C\u4F1A\u5458\u540D\u79F0\u4E00\u4E2A\u6708\u53EA\u80FD\u4FEE\u6539\u4E00\u6B21\uFF0C\u76EE\u524D\u65E0\u6CD5\u4FEE\u6539\u3002",603:"\u60A8\u8F93\u5165\u7684\u5185\u5BB9\u5305\u542B\u4E0D\u9002\u5B9C\u6587\u5B57\uFF0C\u8BF7\u91CD\u8BD5",604:"\u957F\u5EA6\u4E0D\u80FD\u8D85\u8FC74\u4E2A\u6C49\u5B57\uFF0C\u8BF7\u91CD\u8BD5",605:"\u4EC5\u9650\u4F7F\u7528\u6C49\u5B57\u3001\u5B57\u6BCD\u3001\u6570\u5B57\u548C\u4E0B\u5212\u7EBF",606:"\u60A8\u6CA1\u6709\u64CD\u4F5C\u6743\u9650",1e3:"\u53D1\u751F\u4E86\u672A\u77E5\u9519\u8BEF"};r["12"]=e.BanLib.render("forumInfoManager"),0==a?t='<span style="color:#2e2">\u64CD\u4F5C\u6210\u529F</span>':(n=r[a]||r["1000"],t='<span style="color:#f00">'+n+"</span>"),i.html(t)},displayApplyInfo:function(a){var e=this,t=["ie=utf-8"];t.push("kw="+this._forumData.name_url),t.push("fid="+this._forumData.id),t.push("is_mgr="+a),t.push("mgr_num="+this._forumData.mgr_num),t.push("t="+(new Date).getTime().toString(32));var n="/managerapply/data/frs?"+t.join("&");$.ajax({type:"GET",url:n,success:function(t){var n=$.json.decode(t);if("undefined"!=typeof n){var i="",r=null;n.is_applying?(i=e._getManagerApplying(),r=$(i)):(0==e._forumData.mgr_num?i=e._getApplyLink(!1,n.is_banned,n.is_key_op):e._forumData.mgr_num<3&&1!=a&&(i=e._getApplyLink(!0,!1,!0)),r=$(i),0==n.is_key_op&&0==e._forumData.mgr_num?r.bind("click",function(){try{return e.verify("/managerapply/preSubmitIntern")}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/forum_info/forum_info_manager.js",method:"",ln:240}),a}}):r.bind("click",function(){try{return e.verify("/managerapply/preSubmit")}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/forum_info/forum_info_manager.js",method:"",ln:244}),a}})),""!==i&&$("#tbManagerApply").append(r).parent().show(),n.candidates_num>0&&$("#tbManagerCandidatesNum").html(e._getCandidatesLink(n.candidates_num,n.state)).css("display","block"),n.assist_candidates_num>0&&$("#assistCandidatesNum").html('<a href="/bawu2/platform/listCandidateInfo?word='+e._forumData.name_url+'&manager_type=2" target="_blank" class="assist_candidates_num">[\u67E5\u770B'+n.assist_candidates_num+"\u4F4D\u5C0F\u5427\u4E3B\u5019\u9009\u4EBA]</a>").css("display","block"),1==a&&$("#tbAdminTip").html(e._getAdminTip(n.unhandled_manager_num)).css("display","block")}}})},verify:function(a){var e=this,t=a+"?forum_id="+PageData.forum.id+"&kw="+PageData.forum.name_encode+"&t="+(new Date).getTime().toString(32),n={170001:"\u672A\u6EE1\u8DB3\u5427\u4E3B\u7533\u8BF7\u6761\u4EF6\u3002",170002:"\u62B1\u6B49\uFF0C\u7533\u8BF7\u672C\u5427\u5427\u4E3B\u5427\u5185\u4F1A\u5458\u7B49\u7EA7\u4E0D\u5F97\u4F4E\u4E8E3\u7EA7\u3002",170003:"\u62B1\u6B49\uFF0C\u60A8\u8FD8\u672A\u5173\u6CE8\u672C\u5427\u3002",170004:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u6682\u65F6\u4E0D\u63A5\u53D7\u5427\u4E3B\u7533\u8BF7\u3002",170005:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u4E09\u4E2A\u5427\u4E3B\u804C\u4F4D\u5DF2\u6EE1\u3002",170006:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u4E09\u4E2A\u5427\u4E3B\u804C\u4F4D\u5DF2\u6EE1\u6216\u8BE5\u5427\u5DF2\u6709\u5B9E\u4E60\u5427\u4E3B\u3002",170007:"\u62B1\u6B49\uFF0C\u60A8\u5DF2\u62C5\u4EFB\u4E09\u4E2A\u5427\u7684\u5427\u4E3B\u804C\u4F4D\uFF0C\u4E0D\u80FD\u518D\u6B21\u7533\u8BF7\u3002",170008:"\u62B1\u6B49\uFF0C\u8BE5\u6761\u7533\u8BF7\u4FE1\u606F\u5DF2\u5904\u7406\u5B8C\u6BD5\uFF0C\u65E0\u9700\u91CD\u590D\u63D0\u4EA4\u5904\u7406\u3002",170009:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u6682\u65E0\u7B26\u5408\u6761\u4EF6\u7684\u7533\u8BF7\u4FE1\u606F\u3002",170010:"\u62B1\u6B49\uFF0C\u8BE5\u6761\u7533\u8BF7\u4FE1\u606F\u5DF2\u5904\u7406\u5B8C\u6BD5\uFF0C\u65E0\u9700\u91CD\u590D\u63D0\u4EA4\u5904\u7406\u3002",170011:"\u62B1\u6B49\uFF0C\u60A8\u7684\u7533\u8BF7\u4FE1\u606F\u5DF2\u4E8E\u4ECA\u5929\u88AB\u53D7\u7406\uFF0C24\u5C0F\u65F6\u5185\u4E0D\u53EF\u518D\u6B21\u7533\u8BF7\u3002",170012:"\u62B1\u6B49\uFF0C\u60A8\u5DF2\u63D0\u4EA4\u7684\u7533\u8BF7\u4FE1\u606F\u6B63\u5728\u5BA1\u6838\u4E2D\uFF0C\u4E0D\u80FD\u91CD\u590D\u63D0\u4EA4\u7533\u8BF7\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85\u3002",170013:"\u62B1\u6B49\uFF0C\u60A8\u5DF2\u662F\u8BE5\u5427\u5427\u4E3B\uFF0C\u4E0D\u53EF\u91CD\u590D\u7533\u8BF7\u3002",170014:"\u62B1\u6B49\uFF0C\u81EA\u8BE5\u5427\u8F9E\u804C\u5427\u4E3B\u6743\u9650\u4E00\u4E2A\u6708\u5185\u4E0D\u53EF\u518D\u6B21\u7533\u8BF7\u8BE5\u5427\u5427\u4E3B\u3002",170015:"\u62B1\u6B49\uFF0C\u60A8\u4E8E\u8FD1\u671F\u88AB\u64A4\u9500\u8BE5\u5427\u5427\u4E3B\u6743\u9650\uFF0C60\u5929\u5185\u4E0D\u53EF\u518D\u6B21\u7533\u8BF7\u3002",170016:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u5DF2\u6709\u5427\u4E3B\uFF0C\u6682\u4E0D\u63A5\u53D7\u5B9E\u4E60\u5427\u4E3B\u7533\u8BF7\u3002",170017:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u6682\u4E0D\u63A5\u53D7\u5B9E\u4E60\u5427\u4E3B\u7533\u8BF7\u3002",170018:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u6682\u4E0D\u63A5\u53D7\u5B9E\u4E60\u5427\u4E3B\u7533\u8BF7\u3002",170019:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u6682\u4E0D\u63A5\u53D7\u5B9E\u4E60\u5427\u4E3B\u7533\u8BF7\u3002",170020:"\u62B1\u6B49\uFF0C\u60A8\u7684ip\u4E0E\u5F53\u524D\u5427\u4E3B\u76F8\u540C\u6216\u8FD1\u4F3C\uFF0C\u8BF7\u60A8\u66F4\u6362ip\u540E\u91CD\u65B0\u7533\u8BF7\u3002\u8BF7\u4E0D\u8981\u7528\u591A\u4E2A\u5E10\u53F7\u62C5\u4EFB\u540C\u4E00\u4E2A\u5427\u7684\u5427\u4E3B\u804C\u4F4D\u3002",170021:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u5427\u4E3B\u4E3A\u5B9E\u4E60\u5427\u4E3B\uFF0C\u6682\u4E0D\u63A5\u53D7\u5427\u4E3B\u7533\u8BF7\u3002\u8BF7\u60A8\u4E8E\u5B9E\u4E60\u5427\u4E3B\u8F6C\u6B63\u6216\u8005\u8BE5\u5427\u65E0\u5427\u4E3B\u65F6\u518D\u6B21\u7533\u8BF7\u3002",250114:"\u62B1\u6B49\uFF0C\u60A8\u6CA1\u6709\u64CD\u4F5C\u6743\u9650\u3002",220012:e.BanLib.render("forumManagerApply"),110000:"\u62B1\u6B49\uFF0C\u60A8\u8FD8\u672A\u767B\u5F55\u8D34\u5427\uFF0C\u8BF7\u60A8\u767B\u5F55\u540E\u91CD\u65B0\u64CD\u4F5C\u3002",110003:"\u8C03\u7528\u5931\u8D25",210009:"\u53C2\u6570\u9519\u8BEF",210011:"\u6821\u9A8C\u5931\u8D25"};return $.ajax({type:"GET",url:t,async:!1,success:function(t){var i=$.json.decode(t);if("undefined"==typeof i)return!1;var r={not_member:124,is_voting:94,not_meet_limit:134,banned_forum:94,meet_max_apply:94,meet_max_manager:94,is_prisoner:94,fired_manager:94,banned_user:134,is_manager:94,manager_is_full:94,is_applying:94};if(e.has_right=0===i.errno?!0:!1,i.errno)if("not_login"==i.invalid_type)TbCom.process("User","buildLoginFrame");else if("no_username"==i.invalid_type)TbCom.process("User","buildUnameFrame");else{var s="";i.invalid_type in r&&(s=r[i.invalid_type]);var o=n[i.errno];o&&""!=o||(o="\u672A\u77E5\u9519\u8BEF"),170001===i.errno&&"/managerapply/preSubmit"===a?o="\u62B1\u6B49\uFF0C\u7533\u8BF7\u672C\u5427\u5427\u4E3B\u9700\u8FBE\u5230\u5982\u4E0B\u6761\u4EF6\uFF1A</br>\u53D1\u8A00\u6570\u4E0D\u5F97\u5C11\u4E8E"+(i.data.user_post_num||0)+"\u8D34\uFF0C\u6210\u4E3A\u4F1A\u5458\u5929\u6570\u4E0D\u5F97\u5C11\u4E8E"+(i.data.member_days||0)+"\u5929\u3002</br>\u5F53\u524D\u53D1\u8D34\u6570\uFF1A"+(i.data.cur_user_post_num||0)+"\uFF0C\u5DF2\u7ECF\u6210\u4E3A\u4F1A\u5458\u5929\u6570\uFF1A"+(i.data.cur_member_days||0)+"\u3002":170001===i.errno&&"/managerapply/preSubmitIntern"===a&&(o="\u62B1\u6B49\uFF0C\u7533\u8BF7\u672C\u5427\u5B9E\u4E60\u5427\u4E3B\u9700\u8FBE\u5230\u5982\u4E0B\u6761\u4EF6\uFF1A\u53D1\u8A00\u6570\u4E0D\u5F97\u5C11\u4E8E10\u8D34\u3002");var m='<div class="apply_manager"><p class="ui_text_emphasize">'+o+'</p><p style="padding:5px 0 10px;text-align:center;"><input id="forum_info_dialog_close" type="button" onclick="return false;" class="close_btn" value="\u786E \u5B9A" style="width:75px;" /></p></div>';m=m.replace(/#memIndexLink#/gi,document.getElementById("member_name_link").href),m=m.replace(/#memBALVINFOLink#/gi,"/f/like/level?kw="+PageData.forum.name_url),e._tip_dialog=$.dialog.open(m,{title:"\u5427\u4E3B\u7533\u8BF7",width:470,height:s}),$("#forum_info_dialog_close").bind("click",function(){try{e._tip_dialog.close()}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/forum_info/forum_info_manager.js",method:"",ln:351}),a}})}}}),e.has_right}}});_.Module.define({path:"common/component/image_exif",requires:[],sub:{initial:function(){},getOrientation:function(t){if(null==t)return 0;for(var e=0,r=0;e+3<t.length&&255==(255&t[e++]);){var i=255&t[e];if(255!=i&&(e++,216!=i&&1!=i)){if(217==i||218==i)break;if(r=this.pack(t,e,2,!1),2>r||e+r>t.length)return 0;if(225==i&&r>=8&&1165519206==this.pack(t,e+2,4,!1)&&0==this.pack(t,e+6,2,!1)){e+=8,r-=8;break}e+=r,r=0}}if(r>8){var a=this.pack(t,e,4,!1);if(1229531648!=a&&1296891946!=a)return 0;var n=1229531648==a,s=this.pack(t,e+4,4,n)+2;if(10>s||s>r)return 0;e+=s,r-=s;for(var o=this.pack(t,e-2,2,n);o-->0&&r>=12;){if(a=this.pack(t,e,2,n),274==a){var c=this.pack(t,e+4,4,n),h=this.pack(t,e+8,c,n);switch(h){case 1:return 0;case 3:return 180;case 6:return 90;case 8:return 270}return 0}e+=12,r-=12}}return 0},pack:function(t,e,r,i){var a=1;i&&(e+=r-1,a=-1);for(var n=0;r-->0;)n=n<<8|255&t[e],e+=a;return n},rotateByorientation:function(t,e){var r=new FileReader,i=this;t.size||this.trigger("success",t),r.onload=function(){var r=this.result,a=new Uint8Array(r),n=i.getOrientation(a);i.trigger("degreeloaded",n),e||i.rotateFile(t,n)},r.readAsArrayBuffer(t)},rotateFile:function(t,e){if(90!=e&&180!=e&&270!=e)return this.trigger("success",t),void 0;var r=new FileReader,i=this;r.onload=function(){var t=this.result,r=new Image;r.onload=function(){i.rotateImage(r,e)},r.src=t},r.readAsDataURL(t)},rotateImage:function(t,e){var r=document.createElement("canvas"),i=r.getContext("2d"),a=t.width,n=t.height;i.save(),90==e||270==e?(r.width=n,r.height=a,90==e?i.translate(r.width,0):i.translate(0,r.height)):(r.width=a,r.height=n,i.translate(r.width,r.height)),i.rotate(e*Math.PI/180),i.drawImage(t,0,0,a,n),i.restore(),this.trigger("success",r)}}});_.Module.define({path:"common/component/ImageUploader",requires:["common/component/image_exif"],sub:{_url:"",_xhr:null,_active:!1,_successFilter:null,_variable:null,_MAX_SIZE:3145728,initial:function(t,e,i){this._url=t,this._successFilter=e||null,i=i||{},this._compressWidth=i.maxWidth||3e3,this._compressHeight=i.maxHeight||3e3},_createHXR:function(){var t=this,e=this._successFilter;this._xhr=new XMLHttpRequest,this._xhr.onload=function(){var i;try{i=$.parseJSON(t._xhr.responseText)}catch(r){i=t._xhr.responseText}e?e(i)?t.trigger("success",t._xhr,i):t.trigger("error",t._xhr,i):t.trigger("success",t._xhr,i)},this._xhr.onerror=function(){t.trigger("error",t._xhr)},this._xhr.onabort=function(){t.trigger("abort",t._xhr)},this._xhr.upload.onprogress=function(e){t.trigger("progress",e.loaded,e.total)}},_dataURLtoBlob:function(t){for(var e=atob(t.split(",")[1]),i=t.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(e.length),o=new Uint8Array(r),s=0;s<e.length;s++)o[s]=e.charCodeAt(s);var n=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;if(n){var a=new n;return a.append(r),a.getBlob(i)}return Blob?new Blob([r],{type:i}):null},_compressFormDataURI:function(t,e){var i=this._dataURLtoBlob(t),r=i.size,o=this;if(e>=r)o._uploadBlob(i);else{var s=new Image,n=document.createElement("canvas");s.onload=function(){var t=o._getCompressSize(s.width,s.height);n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(s,0,0,s.width,s.height,0,0,t.width,t.height),s.onload=null,s.src="about:blank",s=null;var a=n.toDataURL("image/jpeg",(e/r).toFixed(1));n.getContext("2d").clearRect(0,0,t.width,t.height),n.width=n.height=0,n=null,i=o._dataURLtoBlob(a),i.size>e?o.trigger("error"):o._uploadBlob(i)},s.src=t}},_uploadBlob:function(t){var e=new FormData,i=this._variables;if(i&&"object"==typeof i)for(var r in i)e.append(r,i[r]);e.append("file",t),this._active=!0,this._xhr||this._createHXR(),this._xhr.open("POST",this._url,!0),this._xhr.withCredentials=!0,this._xhr.send(e),i&&i.html5stat&&$.stats.sendRequest("fr=tb0&st_type=html5upload&st_value=send")},_getCompressSize:function(t,e){var i=this._compressWidth,r=this._compressHeight,o=t/e,s={};return t>i||e>r?o>i/r?(s.width=i,s.height=i/o):(s.height=r,s.width=r*o):s={width:t,height:e},s},setVariable:function(t){this._variables=t},upload:function(t,e,i){if(t){e="undefined"==typeof e?this._MAX_SIZE:e;var r,o=this;if(t.getContext)r=i?t.toDataURL(i):t.toDataURL("image/jpeg",.8),t.getContext("2d").clearRect(0,0,t.width,t.height),t.width=t.height=0,t=null,o._compressFormDataURI(r,e);else if(t.size){var s=this.use("common/component/image_exif");s.bind("success",function(s,n){if(n.getContext)o.upload(n,e,i);else if(t.size>e){var a=new FileReader;a.onload=function(t){a.onload=null,r=t.target.result,o._compressFormDataURI(r,e)},a.readAsDataURL(n)}else o._uploadBlob(n)}),s.rotateByorientation(t)}}},abort:function(){this._active&&(this._xhr.abort(),this._active=!1)},distroy:function(){this.abort(),this.unbind("success"),this.unbind("error"),this.unbind("abort"),this.unbind("progress"),this._xhr=null}}});_.Module.define({path:"common/widget/image_uploader_manager/uploader_flash",requires:[],sub:{initial:function(t){var a={container:null,width:200,height:50,isAutoUp:!1,queueLen:10,maxParallel:2,maxSize:3145728,maxWidth:1e3,maxHeight:1e3,uploadUrl:"",getUploadParams:null};this._options=$.extend(a,t||{}),this._token=this._makeToken(),this._flashVars="",this._version="1_0_1_3",this._EVENTS=["onFileSelected","onStartUpload","onProgressListen","onComplete","onError"],this._reset()},_reset:function(){this._initFlashvars(),this._generateCallBack(),this._initUI()},_initFlashvars:function(){this._flashVars=["maxSize="+encodeURIComponent(this._options.maxSize),"maxWidth="+encodeURIComponent(this._options.maxWidth),"maxHeight="+encodeURIComponent(this._options.maxHeight),"isAutoUp="+encodeURIComponent(this._options.isAutoUp),"queueLen="+encodeURIComponent(this._options.queueLen),"maxParallel="+encodeURIComponent(this._options.maxParallel),"useWorker=false","uploadURL="+encodeURIComponent(this._options.uploadUrl),"get_upload_params="+(this._options.get_upload_params?encodeURIComponent(this._options.get_upload_params):"")].join("&")},_initUI:function(){var t,a=this._flashChecker(),e=a.version,o="flashUploader"+this._token;a.hasFlash||this._flashError(),t=e[0]<11||e[1]<4?"http://tb2.bdstatic.com/tb/static-common/img/uploader/uploaderwithoutworker_ade2e66.swf":"http://tb2.bdstatic.com/tb/static-common/img/uploader/uploader_66720f8.swf";var i='<object id="'+o+'" name="'+o+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="https://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+this._options.width+'" height="'+this._options.height+'"><param name="allowScriptAccess" value="always" /><param value="transparent" name="wmode"><param name="flashvars" value="'+this._flashVars+'" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+t+'" /></object>',n='<object id="'+o+'" type="application/x-shockwave-flash" data="'+t+'" width="'+this._options.width+'" height="'+this._options.height+'"><param name="allowScriptAccess" value="always" /><param value="transparent" name="wmode"><param name="flashvars" value="'+this._flashVars+'" /></object>';this._options.container||(this._options.container=$("<div>").appendTo(document.body).css({position:"absolute",width:"1px",height:"1px",overflow:"hidden",left:1,bottom:1})),-1!=navigator.appName.indexOf("Microsoft")?this._options.container.html(i):this._options.container.html(n),this.flash=document[o]||window[o]},_generateCallBack:function(){for(var t=this,a=0;a<this._EVENTS.length;a++){var e=this._EVENTS[a],o=e+this._token;window[o]=function(a){return function(){var e=Array.prototype.slice.call(arguments,0);e.unshift(a),t.trigger.apply(t,e)}}(e),this._flashVars+="&"+this._decodeCamel(e)+"="+o}},_decodeCamel:function(t){return t.replace(/([A-Z])/g,function(t,a){return"_"+a.toLowerCase()})},start:function(){this.flash.startUpload()},stop:function(){this.flash.pauseUpload()},deleteFile:function(t){this.flash.deleteFile(t)},clearList:function(){this.flash.clearList()},reUploadError:function(t){this.flash.resetErrorStatus(t)},_flashChecker:function(){var t,a,e=!1,o=$.browser.msie;return o?(a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),a&&(e=!0,t=a.GetVariable("$version"))):navigator.plugins&&navigator.plugins.length>0&&(a=navigator.plugins["Shockwave Flash"],a&&(e=!0,t=a.description)),{hasFlash:e,version:t.match(/\d+/g)}},_flashError:function(){$.dialog.alert('\u68C0\u6D4B\u5230\u60A8\u7684\u6D4F\u89C8\u5668\u6CA1\u6709\u5B89\u88C5\u6700\u65B0Adobe Flash Player\u63D2\u4EF6\uFF0C\u8FD9\u4F1A\u5F71\u54CD\u60A8\u8BBF\u95EE\u672C\u9875\u9762\u7684\u90E8\u5206\u529F\u80FD\u3002<br /><center>\u8BF7<a href="http://get.adobe.com/cn/flashplayer/" target="_blank">\u70B9\u6B64</a>\u5B89\u88C5</center>')},_makeToken:function(){var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return t()+t()+"_"+t()+t()+t()},uploadBase64:function(t,a){var e="flashUploadBase64_"+this._makeToken();window[e]=function(t){return function(a){t(a)}}(a),this.flash.uploadBase64(t,e)}}});
;_.Module.define({path:"common/widget/image_uploader_manager/uploader_html5",requires:["common/component/ImageUploader"],sub:{initial:function(e){var t={container:null,width:200,height:50,isAutoUp:!1,queueLen:10,maxParallel:16,maxSize:3145728,limitSize:10485760,maxWidth:1e3,maxHeight:1e3,uploadUrl:"",getUploadParams:null};this._options=$.extend(t,e||{}),this._uploadQueue=[],this._fileStatusArr=[],this._currentUploadNum=0,this._uploadTimer=null,this._activeTotal=0,this._typeFilter="image/jpeg, image/jpg, image/png, image/gif, image/bmp",this._reset()},start:function(){this._trigger("onStartUpload"),this._startProgress()},stop:function(){this._stopProgress()},deleteFile:function(e){for(var t=0;t<this._uploadQueue.length;t++){var i=this._uploadQueue[t];if(i&&i.id==e){i.uploader.distroy(),i.isStarted&&i.percent<100&&this._activeTotal--,this._uploadQueue.splice(t,1);break}}},clearList:function(){this._uploadQueue.length=0},reUploadError:function(e){this._resetErrorStatus(e),this.start()},_reset:function(){this._initUI(),this._bindEvents()},_initUI:function(){this._fileInput=$('<input type="file" id="multi_file" style="display:none" multiple accept="'+this._typeFilter+'" />').get(0)},_bindEvents:function(){var e=this;this._fileInput.onclick=function(){e._fileInput.value=""},this._fileInput.onchange=function(){e._selectFile(e._fileInput.files)},this._options.container&&this._options.container.bind("click",function(){e._fileInput.value="",e._fileInput.click()})},_selectFile:function(e){for(var t=[],i=0,r=e.length;r>i&&i<this._options.queueLen;i++){var n=e[i];""!=n.type&&this._typeFilter.indexOf(n.type)>=0&&t.push(this._add(n))}this._trigger("onFileSelected",{imageList:t,percent:0})},_add:function(e){var t,i=this,r=i._uploadQueue,n={name:e.name,size:e.size,id:"img_"+this._makeToken()+"_"+r.length+"_"+e.type,percent:0,status:"",errorCode:0,errorMessage:null,source:e,isStarted:!1};return r.push(n),e.size>this._options.limitSize?(n.errorCode=1,n.errorMessage="\u6587\u4EF6\u5927\u5C0F\u8D85\u51FA\u9650\u5236",this._trigger("error",n),n.percent=100,n.isStarted=!0,n):(t=i.use("common/component/ImageUploader",this._options.uploadUrl,null,{maxWidth:this._options.maxWidth,maxHeight:this._options.maxHeight}),n.uploader=t,t.id=n.id,t.bind("success",this._uploadedHandler,this),t.bind("error",this._uploadedHandler,this),t.bind("progress",function(e){return function(t,i,r){e.percent=Math.min(e.percent+parseInt(20*i/r,10),99)}}(n)),n)},_upload:function(){for(var e=0,t=!0,i=0;i<this._uploadQueue.length;i++){var r=this._uploadQueue[i];r&&(r.percent<100&&(t=!1),this._activeTotal<this._options.maxParallel&&!r.isStarted&&(r.isStarted=!0,r.percent=5,this.getUploadParams&&r.uploader.setVariable(this.getUploadParams(r.id)),r.uploader.upload(r.source,this._options.maxSize),this._activeTotal++),r.percent<50&&(r.percent+=5),e+=r.percent/this._uploadQueue.length)}t?(this._percent=100,this.stop(),this._trigger("onComplete")):(this._percent=parseInt(e,10),this._trigger("onProgressListen"))},_uploadedHandler:function(e,t,i){var r=e.target.id;this._activeTotal--;var n=this._getFileById(r);return n?("error"==e.type&&(n.errorCode=2,n.errorMessage="\u7F51\u7EDC\u9519\u8BEF",this._trigger("error",n),n.percent=100),"success"==e.type&&(n.response=i.data||i||null,n.percent=100),e.target.unbind("success",this._uploadedHandler),e.target.unbind("error",this._uploadedHandler),void 0):!1},_trigger:function(e,t){this.trigger(e,t||{imageList:this._uploadQueue,percent:this._percent})},_getFileById:function(e){for(var t=0;t<this._uploadQueue.length;t++){var i=this._uploadQueue[t];if(i&&i.id==e)return i}return null},_resetErrorStatus:function(e){for(var t=0;t<this._uploadQueue.length;t++){var i=this._uploadQueue[t];if(i&&0!==i.errorCode&&(!e||e&&i.id==e)&&(i.percent=0,i.errorCode=0,i.errorMessage=null,i.isStarted=!1,i.response=null,e))break}},_startProgress:function(){if(!this._uploadTimer){var e=this;this._uploadTimer=setInterval(function(){e._upload()},1e3)}},_stopProgress:function(){clearInterval(this._uploadTimer),this._uploadTimer=null},_makeToken:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"_"+e()+e()+e()}}});
;_.Module.define({path:"common/widget/image_uploader_manager",requires:["common/widget/image_uploader_manager/uploader_flash","common/widget/image_uploader_manager/uploader_html5"],sub:{initial:function(t){var e={container:null,width:200,height:50,isAutoUp:!1,queueLen:10,needWatermark:!1,fid:"",maxSize:3145728,maxWidth:3e3,maxHeight:3e3,uploadUrl:"http://upload.tieba.baidu.com/upload/pic",getUploadParams:null,tbsUrl:"http://tieba.baidu.com/dc/common/imgtbs",isFlash:!1,save_yun_album:0};this._options=$.extend(e,t||{}),this.uploader=null,this.EVENTS=["onFileSelected","onStartUpload","onProgressListen","onComplete","onError"],this._reset()},_initUploadUrl:function(t){var e=this;if(this._options.uploadUrl.indexOf("tbs")>0)return t&&t.apply(e),void 0;var o=$.ajax({url:this._options.tbsUrl,dataType:"json"});o.done(function(o){0===Number(o.no)?(e._options.uploadUrl+="?tbs="+o.data.tbs+(e._options.isWater?"&is_wm=1":"")+"&fid="+(e._options.fid||"")+"&save_yun_album="+e._options.save_yun_album,t&&t.apply(e)):t&&e._error()}).fail(function(){t&&e._error()})},_reset:function(){var t=navigator.userAgent.toLowerCase().match(/chrome\/([\d]+)/);t&&parseInt(t[1])>=21||$.browser.mozilla||$.browser.safari||(this._options.isFlash=!0),this._initUploadUrl(this._startImageUploader)},_startImageUploader:function(){this._options.isFlash?this.uploader=this.use("common/widget/image_uploader_manager/uploader_flash",this._options):this._options.container&&(this.uploader=this.use("common/widget/image_uploader_manager/uploader_html5",this._options)),this._options.container&&this._generateCallBack()},_generateCallBack:function(){for(var t=this,e=0;e<this.EVENTS.length;e++){var o=this.EVENTS[e];this.uploader.bind(o,function(e){return function(o,a){t.trigger(e,a||o)}}(o))}},start:function(){this.uploader.start()},startUpload:function(){this.uploader.start()},stop:function(){this.uploader.stop()},stopUpload:function(){this.uploader.stop()},deleteFile:function(t){this.uploader.deleteFile(t)},clearList:function(){this.uploader.clearList()},reUploadError:function(t){this.uploader.resetErrorStatus(t)},uploadBase64:function(t,e){var o=this;this._options.isFlash?this._flashUploadBase64(t,e):this._initUploadUrl(function(){o._ajaxUploadBase64(t,e)})},_ajaxUploadBase64:function(t,e){var o=this;$.ajax({url:o._options.uploadUrl+"&_token="+(new Date).getTime(),data:{filetype:"base64",file:t},type:"POST",success:function(t){e.call(o,{errorCode:0,errorMessage:"",response:t})},error:function(t){e.call(o,{errorCode:1,errorMessage:"\u4E0A\u4F20\u5931\u8D25",response:t})},dataType:"json"})},_flashUploadBase64:function(t,e){var o=this;this.uploader&&this.uploader.uploadBase64?this.uploader.uploadBase64(t,e):setTimeout(function(){o._flashUploadBase64(t,e)},100)},_error:function(t){t=$.extend({percent:0,errorCode:400,errorMessage:"\u521D\u59CB\u5316\u51FA\u9519",imageList:{}},t||{}),this.trigger("onError",t)}}});!function(){function t(t,e,n){function i(){}i.prototype=e.prototype;var o=new i;o.constructor=t,t.superclass=e;for(var s in n)o[s]=n[s];t.prototype=o}function e(){this._events={}}function n(t){n.superclass.call(this),this.timer=null,this.container=t,this.holder=document.createElement("div"),this.holder.className="tb-editor-overlay",this.holder.style.display="none";var e=this;s.addEvent(this.holder,"mouseover",function(){e.mouseover()}),s.addEvent(this.holder,"mouseout",function(){e.mouseout()}),this.content=document.createElement("div"),this.content.className="overlay-content",this.arrow=document.createElement("span"),this.arrow.className="arrow",this.holder.appendChild(this.arrow),this.holder.appendChild(this.content),this.container.appendChild(this.holder)}function i(t){i.superclass.call(this),this.container=t,this.holder=document.createElement("div"),this.holder.className="tb-editor-overlay",this.holder.style.display="none",this.closeBtn=document.createElement("span"),this.closeBtn.className="close";var e=this;s.addEvent(this.closeBtn,"click",function(){e.close()}),this.content=document.createElement("div"),this.content.className="overlay-content",this.arrow=document.createElement("span"),this.arrow.className="arrow",this.holder.appendChild(this.closeBtn),this.holder.appendChild(this.arrow),this.holder.appendChild(this.content),this.container.appendChild(this.holder)}function o(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=void 0!==t[n]?t[n]:e[n])}window.TED=window.TED||{},window.TED.extend=t,window.TED.EventDispatcher=e,e.prototype={on:function(t,e,n,i){n=n||this,this._events[t]=this._events[t]||[],this._events[t].push({listener:e,scope:n,args:i})},fireEvent:function(t,e,n){var i,o,s,r=this._events[t];if(!r)return!1;for(o=0,s=r.length;s>o;o++)i=r[o],e=i.scope,n=n||i.args||[],i.listener.apply(e,n)},remove:function(t,e){if(!this._events[t])return!1;var n,i,o=this._events[t];for(n=0,i=o.length;i>n;n++)if(o[n].listener===e){o.splice(n,1);break}0===o.length&&delete this._events[t]}};var s={addEvent:function(t,e,n){var i;i=t.addEventListener?function(t,e,n){t.addEventListener(e,n,!1)}:function(t,e,n){t.attachEvent("on"+e,n)},i(t,e,n),this.addEvent=i},removeEvent:function(t,e,n){var i;i=t.addEventListener?function(t,e){t.removeEventListener(e,linstener,!1)}:function(t,e,n){t.detachEvent("on"+e,n)},i(t,e,n),this.addEvent=i}};window.TED.Event=s,window.TED.HoverOverlay=n,t(n,e,{container:null,holder:null,content:null,currentOpen:null,isOpen:!1,closefunction:null,open:function(t,e,n,i,o,s,r){this.isOpen=!0,this.currentOpen=r,this.arrow.style.left=o;var a=this.holder.style;a.left=t,a.top=e,a.width=n,a.height=i,a.display="block",this.content.innerHTML='<iframe width="100%" height="100%" frameborder="0" scrolling="no" src="'+s+'"></iframe>'},close:function(){this.isOpen=!1,this.content.innerHTML="",this.holder.style.display="none",this.currentOpen&&(this.currentOpen.className=this.currentOpen.className.replace(" open",""),this.currentOpen=null),this.fireEvent("close")},mouseover:function(){this.closefunction=this.close,this.close=function(){},null!=this.timer&&clearTimeout(this.timer)},mouseout:function(){var t=this;t.close=t.closefunction,t.timer=setTimeout(function(){t.close()},500)}}),window.TED.Overlay=i,t(i,e,{closeButton:null,container:null,holder:null,content:null,currentOpen:null,isOpen:!1,open:function(t,e,n,i,o,s){if(1==this.isOpen&&TED.Editor&&TED.Editor.Status.isPicassoOpen===!0){var r=this,a=$.dialog.confirm('<div id="maincontent" style="position:absolute;"><img style="margin:10px 10px 10px 10px;width:68px;height:68px;" src="http://tb1.bdstatic.com/tb/editor/v2/picasso/alarm.gif" /><div id="tipscontent" style="position:absolute;left:100px;top:15px;width:270px;font-size:14px;font-family:\u5B8B\u4F53" ><b>\u60A8\u6B63\u5728\u7F16\u8F91\u6D82\u9E26\uFF0C\u73B0\u5728\u9000\u51FA\u5C06\u4E0D\u4F1A\u4FDD\u5B58\uFF0C\u60A8\u786E\u5B9A\u8981\u9000\u51FA\uFF1F</b></div></div>',{title:"\u6D82\u9E26\u7F16\u8F91\u5668",acceptValue:"\u786E\u5B9A",cancelValue:"\u53D6\u6D88"});a.width(420),a.height(90),a.bind("onaccept",function(){TED.Editor.Status.isPicassoOpen=!1,r.picassoPanel&&(r.picassoPanel.destroy(),r.picassoPanel=null),r.isOpen=!0,r.arrow.style.left=o;var a=r.holder.style;a.left=t,a.top=e,a.width=n,a.height=i,a.display="block",r.content.innerHTML='<iframe width="100%" height="100%" frameborder="0" scrolling="no" src="'+s+'"></iframe>'})}else{this.isOpen=!0,this.arrow.style.left=o;var l=this.holder.style;l.left=t,l.top=e,l.width=n,l.height=i,l.display="block",this.content.innerHTML='<iframe width="100%" height="100%" frameborder="0" scrolling="no" src="'+s+'"></iframe>'}this.fireEvent("open")},close:function(t){if(TED.Editor&&TED.Editor.Status.isPicassoOpen===!0&&t!==!0){var e=this,n=$.dialog.confirm('<div id="maincontent" style="position:absolute;"><img style="margin:10px 10px 10px 10px;width:68px;height:68px;" src="http://static.tieba.baidu.com/tb/editor/v2/picasso/alarm.gif" /><div id="tipscontent" style="position:absolute;left:100px;top:15px;width:270px;font-size:14px;font-family:\u5B8B\u4F53"><b>\u60A8\u6B63\u5728\u7F16\u8F91\u6D82\u9E26\uFF0C\u73B0\u5728\u9000\u51FA\u5C06\u4E0D\u4F1A\u4FDD\u5B58\uFF0C\u60A8\u786E\u5B9A\u8981\u9000\u51FA\uFF1F</b></div></div>',{title:"\u6D82\u9E26\u7F16\u8F91\u5668",acceptValue:"\u786E\u5B9A",cancelValue:"\u53D6\u6D88"});n.width(420),n.height(90),n.bind("onaccept",function(){TED.Editor.Status.isPicassoOpen=!1,e.picassoPanel&&(e.picassoPanel.destroy(),e.picassoPanel=null),e.isOpen=!1,e.content.innerHTML="",e.holder.style.display="none",e.currentOpen&&(e.currentOpen.className=e.currentOpen.className.replace(" open",""),e.currentOpen=null),e.fireEvent("close")})}else 1==t&&TED.Editor&&(TED.Editor.Status.isPicassoOpen=!1),this.isOpen=!1,this.content.innerHTML="",this.holder.style.display="none",this.currentOpen&&(this.currentOpen.className=this.currentOpen.className.replace(" open",""),this.currentOpen=null),this.fireEvent("close")},toggle:function(t,e,n,i,o,s,r){this.currentOpen&&this.currentOpen===r?this.close():(r.className=r.className+" open",this.currentOpen=r,this.open(t,e,n,i,o,s))}}),window.TED.augmentObject=o;var r={get:function(t,e,n){var i=this.getXHR();i.open("GET",t,!0),i.setRequestHeader("cache",!1),i.onreadystatechange=function(){4===i.readyState&&(200==i.status?"function"==typeof e&&e(i.responseText):"function"==typeof n&&n(i.statusText),i=null)},i.send(null)},getXHR:function(){if(window.XMLHttpRequest)return function(){return new window.XMLHttpRequest};if(window.ActiveXObject)return function(){return new window.ActiveXObject("Microsoft.XMLHTTP")};throw"\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301AJAX!"}()};window.TED.SimpleAjax=r;var a=function(){function t(t){return t.replace(/[_\s]/g,function(t){return"_"==t?"__":"_s"})}function e(){return document.getElementById(r+"-storage")}function n(t){return"[object Date]"==={}.toString.call(t)&&"Invalid Date"!==t.toString()&&!isNaN(t)}function i(){var t;return window.localStorage?t=s():window.ActiveXObject&&(t=o()),t}function o(){var i=document.createElement("div");return i.style.display="none",i.id=r+"-storage",document.body.appendChild(i),e().addBehavior("#default#userData"),{set:function(i,o,s){var r=e(),a=t(i),l=s&&s.expires?s.expires:(new Date).getTime()+31536e6;n(l)&&(l=l.getTime()),r.expires=new Date(l).toUTCString();try{r.setAttribute(a,o),r.save(a)}catch(c){throw"baidu.data.storage.set error! Maybe space overflow."}r=null},get:function(n){var i=e(),o=t(n),s=null;try{return i.load(o),s=i.getAttribute(o)}catch(r){throw r.message}},del:function(n){var i,o=e(),s=t(n);try{return o.load(s),i=o.getAttribute(s),i?(o.removeAttribute(s),o.expires=new Date(315532799e3).toUTCString(),o.save(s),!0):!1}catch(r){return!1}}}}function s(){return{set:function(e,i,o){var s=window.localStorage,r=t(e),a=o&&o.expires?o.expires:0;n(a)&&(a=a.getTime());try{s.setItem(r,a+"|"+i)}catch(l){throw"baidu.data.storage.set error! Maybe space overflow."}},get:function(e){var n,i,o=window.localStorage,s=t(e),r=null;try{r=o.getItem(s)}catch(a){return null}return r?(n=r.indexOf("|"),i=parseInt(r.substring(0,n),10),new Date(i).getTime()>(new Date).getTime()||0==i?r=r.substring(n+1,r.length):(r=null,this.del(e),null)):null},del:function(e){var n=window.localStorage,i=t(e),o=null;try{o=n.getItem(i)}catch(s){return!1}return o?(o=o.substring(o.indexOf("|")+1,o.length),o&&n.removeItem(i),!0):!1}}}var r="tieba";return{set:function(){var t=this;!t._storage&&(t._storage=i()),t._storage.set.apply(t._storage,arguments)},get:function(){var t=this;return!t._storage&&(t._storage=i()),t._storage.get.apply(t._storage,arguments)},remove:function(){var t=this;return!t._storage&&(t._storage=i()),t._storage.del.apply(t._storage,arguments)},isSupport:function(){return!(!window.localStorage&&!window.ActiveXObject)}}}();window.TED.Storage=a}();
;!function(){function Refer(e){e=e||{},augmentObject(e,this.constructor.defaultConfig),this.config=e}function Box(e){Box.superclass.call(this),this.container=e,this.holder=document.createElement("div"),this.holder.innerHTML='<span class="box-title">\u60F3\u7528@\u63D0\u5230\u8C01\uFF1F<span>',this.holder.className="box-holder",this.holder.style.display="none",this.ul=document.createElement("ul"),this.ul.className="box-ul-empty",this.holder.appendChild(this.ul),e.appendChild(this.holder),this.initEvents()}function Data(e,t){Data.superclass.call(this),this.url=e,this.uid=t}var extend=TED.extend,EventDispatcher=TED.EventDispatcher,Event=TED.Event,Overlay=TED.Overlay,augmentObject=TED.augmentObject,Ajax=TED.SimpleAjax,Storage=TED.Storage;window.TED.EditorPlugins=window.TED.EditorPlugins||{},window.TED.EditorPlugins.Refer=Refer,Refer.defaultConfig={checkDelay:100,offsetLeft:1,offsetTop:18,dataUrl:"/at-sug",uid:null},Refer.prototype={constructor:Refer,disabled:!1,boxWrapper:null,init:function(e){e.on("keydown",this.onEditorKeydown,this),e.on("keyup",this.onEditorKeyup,this),e.on("click",this.onEditorClick,this),e.on("blur",function(){this.hide()},this),this.box=new Box(e.editAreaWrapper),this.box.on("select",this.onSelect,this),this.data=new Data(this.config.dataUrl,this.config.uid),this.data.on("datachange",this.box.update,this.box),this.editor=e},destroy:function(){},enable:function(){this.disabled=!1},disable:function(){this.disabled=!0},query:function(e){this.data.getData(e)},onSelect:function(e){var t=this.editor.getSelectedElement();null!==e&&(t.innerHTML="@"+e),this.breakMode(32)},onEditorKeydown:function(e){if(!this.disabled&&this.box.isShow){switch(e.keyCode){case 38:this.box.pre();break;case 40:this.box.next();break;case 13:this.onSelect(this.box.getValue()),this.box.hide();break;default:return}e.preventDefault?e.preventDefault():e.returnValue=!1,e.exitFunction=!0}},onEditorKeyup:function(e){if(!this.disabled){var t=e.keyCode;(50===t&&e.shiftKey||50===t&&16===this.lastUpCode)&&this.checkEnterMode();var i=this;clearTimeout(this.timer),this.timer=setTimeout(function(){i.checkShowBox()},this.config.checkDelay),this.lastUpCode=e.keyCode}},onEditorClick:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout(function(){e.checkShowBox()},this.config.checkDelay)},checkEnterMode:function(){var e,t,i=this.editor,n=i.getSelection();if(i.ua.ie?"none"===n.type.toLowerCase():n.isCollapsed){if(e=i.getRange(),i.ua.ie){if(this.editor.isEmpty())return;e.moveStart("character",-1),e.select(),t=e.text}else{var s=e.startContainer,o=e.startOffset;1===s.nodeType&&o>0&&(s=s.childNodes[o-1],o=s.length),3===s.nodeType&&o>0&&(e.setStart(s,o-1),n.removeAllRanges(),n.addRange(e),t=n.toString())}var a=i.getSelectedElement();"@"!==t||"at"===a.className&&"@"===a.innerHTML?i.ua.ie?(e.collapse(!1),e.select()):n.collapseToEnd():i.execCommand("inserthtml",'<span class="at">@</span>')}},checkShowBox:function(){var e,t=this.editor.getSelectedElement(),i=t.innerHTML;"at"===t.className&&"@"===i.charAt(0)?(e=i.substring(1).replace(/<br.*>$/i,""),-1===e.search(/[^\w\u4E00-\u9FA5]/)?(this.show(t.offsetLeft+this.config.offsetLeft-this.editor.editArea.scrollLeft,t.offsetTop+this.config.offsetTop-this.editor.editArea.scrollTop),this.query(e)):this.hide()):this.hide()},hide:function(){this.box.hide(),this.data.getting=null},show:function(e,t){this.box.show(e,t)},breakMode:function(e){var t,i,n=this.editor,o=n.getSelectedElement();32===e?(t=document.createElement("span"),t.innerHTML="&nbsp;",t=t.firstChild):t=document.createTextNode(String.fromCharCode(e)),o.nextSibling?o.parentNode.insertBefore(t,o.nextSibling):o.parentNode.appendChild(t),n.ua.ie?(i=document.selection.createRange(),i.moveEnd("character",1),i.collapse(!1),i.select()):(s=window.getSelection(),i=document.createRange(),i.selectNode(t),s.removeAllRanges(),s.addRange(i),s.collapseToEnd())}},extend(Box,EventDispatcher,{isShow:!1,index:null,length:0,initEvents:function(){var e=this;this.bindClick=function(){e.onClick.apply(e,arguments)},this.bindMousedown=function(){e.onMousedown.apply(e,arguments)},Event.addEvent(this.ul,"click",this.bindClick),Event.addEvent(this.ul,"mousedown",this.bindMousedown)},onMousedown:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},onClick:function(e){var t=e.target||e.srcElement;"li"===t.tagName.toLowerCase()&&(this.fireEvent("select",null,[t.innerHTML]),this.hide())},update:function(e){this.isShow&&(0===e.length?(this.ul.innerHTML="",this.ul.className="box-ul-empty"):(this.ul.className="",this.ul.innerHTML='<li unselectable="on">'+e.join('</li><li unselectable="on">')+"</li>"),this.length=e.length)},pre:function(){0!==this.length&&(null===this.index?this.select(this.length-1):this.select(0===this.index?this.length-1:this.index-1))},next:function(){0!==this.length&&(null===this.index?this.select(0):this.select(this.index===this.length-1?0:this.index+1))},select:function(e){null!==this.index&&(this.ul.childNodes[this.index].className=""),this.ul.childNodes[e].className="focus",this.index=e},getValue:function(){return null!==this.index?this.ul.childNodes[this.index].innerHTML:null},show:function(e,t){if(this.isShow){if(e===this.x&&t===this.y)return;this.reset()}else this.holder.style.display="block",this.isShow=!0;this.holder.style.left=e+"px",this.holder.style.top=t+"px",this.x=e,this.y=t},hide:function(){this.isShow&&(this.reset(),this.holder.style.display="none",this.isShow=!1)},reset:function(){this.ul.innerHTML="",this.length=0,this.ul.className="box-ul-empty"}}),extend(Data,EventDispatcher,{dataCache:{},queryCache:{},data:null,getData:function(e){if(this.getting!==e){if(this.getting=e,""===e)return this.setData([],!0),void 0;if(this.dataCache[e])return this.setData(this.dataCache[e],!0),void 0;if(!this.queryCache[e]){this.queryCache[e]=!0;var t=this;Ajax.get(this.url+"?query="+encodeURIComponent(e)+"&uid="+this.uid+"&ie=utf-8",function(i){delete t.queryCache[e],i=t.parseData(i),t.dataCache[e]=i,t.setData(i,e===t.getting)},function(i){delete t.queryCache[e],t.fireEvent("error",[i])})}}},setData:function(e,t){this.data=e,t&&this.fireEvent("datachange",null,[e])},parseData:function(data){try{if(data=eval("("+data+")"),0===data.error)return data.msg;throw new Error("\u670D\u52A1\u5668\u8FD4\u56DE\u9519\u8BEF\uFF1A"+data.error)}catch(e){throw new Error("\u670D\u52A1\u5668\u8FD4\u56DE\u6570\u636E\u683C\u5F0F\u6709\u8BEF\uFF01")}}})}();
;!function(){function e(t){e.superclass.call(this),this.init(t||{})}function t(e){t.superclass.call(this),this.area=document.createElement("textarea"),e.is_ipad&&(this.area.className="textarea_ipad"),this.area.style.width=e.width,this.area.style.height=e.height,e.autoEnable===!1&&(this.area.disabled=!0),document.getElementById(e.container).appendChild(this.area),this.init()}var i=TED.extend,n=TED.EventDispatcher,s=TED.EditorPlugins.Refer;e.defaultConfig={height:"200px",width:"400px",maxHeight:null,autoFocus:!0,autoEnable:!0,autoHeight:!1,editAreaClassName:"tb-editor-editarea",editAreaWrapperClassName:"tb-editor-editarea-wrapper",wrapperClassName:"tb-editor-wrapper",disabledEditAreaClassName:"tb-editor-editarea disabled",disabledWrapperClassName:"tb-editor-wrapper disabled",imageClassName:"BDE_Image",smileyClassName:"BDE_Smiley",emptyClassName:"BDE_Empty",musicClassName:"BDE_Music",didaDelay:300,imageWidthLimit:560},e.ResizeImage=function(t){if(t.removeAttribute("onload"),t.removeAttribute("onerror"),t.width>e.defaultConfig.imageWidthLimit){var i=t.width,n=t.height;t.setAttribute("width",e.defaultConfig.imageWidthLimit),t.setAttribute("height",e.defaultConfig.imageWidthLimit*n/i),t.setAttribute("changedsize",!0)}},i(e,n,{config:null,enabled:!1,focused:!1,autoHeighted:!1,wrapper:null,editArea:null,container:null,id:null,editValidHTML:["br","embed"],submitValidHTML:["br","embed"],execCommand:function(e,t){if(!this.enabled)return!1;this.focused||this.focus();var i,n=!0,e=e.toLowerCase();if("function"==typeof this["cmd_"+e]){for(var s=[],a=1;a<arguments.length;a++)s.push(arguments[a]);i=this["cmd_"+e].apply(this,s),n=i[0],i[1]&&(e=i[1]),i[2]&&(t=i[2])}if(n)try{document.execCommand(e,!1,t)}catch(r){throw new Error("\u6267\u884Caction\u65F6\uFF0C\u53D1\u751F\u5F02\u5E38\uFF1A"+r.message)}this.ua.ie||this.saveRange()},getImageNum:function(){return this.getTagNum("img",this.config.imageClassName)},getSmileyNum:function(){return this.getTagNum("img",this.config.smileyClassName)},getHtml:function(){return this.fireEvent("gethtml"),this.filteSubmitHTML()},setHtml:function(e){this.editArea.innerHTML=e},enable:function(){this.enabled?this.config.autoFocus&&!this.focused&&this.focus():(this.attachEvents(),this.editArea.style.display="none",this.editArea.contentEditable=!0,this.editArea.style.display="block",this.ua.gecko&&""===this.editArea.innerHTML&&(this.editArea.innerHTML="<br>"),this.editArea.className=this.config.editAreaClassName,this.wrapper.className=this.config.wrapperClassName,this.config.autoFocus&&this.focus(),this.enabled=!0)},disable:function(){this.enabled&&(this.focused&&this.blur(),this.detachEvents(),this.editArea.contentEditable=!1,this.wrapper.className=this.config.disabledWrapperClassName,this.editArea.className=this.config.disabledEditAreaClassName,this.enabled=!1)},focus:function(){this.editArea.focus(),this.ua.webkit&&this.resumeRange()},blur:function(){this.ua.ie||this.saveRange(),this.editArea.blur()},isEmpty:function(){return this.isEmptyContent(this.editArea.innerHTML)},enableAutoHeight:function(e){if(e&&e<=parseInt(this.config.height))return this.autoHeighted&&this.disableAutoHeight(),void 0;if(e=e||this.config.maxHeight,this.ua.ie>0&&this.ua.ie<=6){var t,i=parseInt(this.config.height);t=e?"this.scrollHeight <= "+i+' ? "'+i+'px" : (this.scrollHeight >= '+e+' ? "'+e+'px" : "auto")':"this.scrollHeight <= "+i+' ? "'+i+'px" : "auto"',this.editArea.style.setExpression("height",t)}else this.editArea.style.minHeight=this.config.height,this.editArea.style.height="auto",e&&(this.editArea.style.maxHeight=e+"px");this.autoHeighted=!0},disableAutoHeight:function(){this.ua.ie>0&&this.ua.ie<=6&&this.editArea.style.removeExpression("height"),this.editArea.style.height=this.config.height,this.autoHeighted=!1},empty:function(){this.editArea.innerHTML=""},ua:function(){var e,t=function(e){var t=0;return parseFloat(e.replace(/\./g,function(){return 1==t++?"":"."}))},i=navigator,n={ie:0,opera:0,gecko:0,webkit:0,mobile:null,air:0,caja:i.cajaVersion,secure:!1,os:null},s=navigator&&navigator.userAgent,a=window&&window.location,r=a&&a.href;if(n.secure=r&&0===r.toLowerCase().indexOf("https"),s){/windows|win32/i.test(s)?n.os="windows":/macintosh/i.test(s)&&(n.os="macintosh");var o;(o=/Trident\/(\d+)/.exec(s))&&(n.trident=o[1]),/KHTML/.test(s)&&(n.webkit=1),e=s.match(/AppleWebKit\/([^\s]*)/),e&&e[1]&&(n.webkit=t(e[1]),/ Mobile\//.test(s)?n.mobile="Apple":(e=s.match(/NokiaN[^\/]*/),e&&(n.mobile=e[0])),e=s.match(/AdobeAIR\/([^\s]*)/),e&&(n.air=e[0])),n.webkit||(e=s.match(/Opera[\s\/]([^\s]*)/),e&&e[1]?(n.opera=t(e[1]),e=s.match(/Opera Mini[^;]*/),e&&(n.mobile=e[0])):(e=s.match(/MSIE\s([^;]*)/),e&&e[1]?n.ie=t(e[1]):(e=s.match(/Gecko\/([^\s]*)/),e&&(n.gecko=1,e=s.match(/rv:([^\s\)]*)/),e&&e[1]&&(n.gecko=t(e[1]))))))}return n}(),isUCWeb:function(){var e=navigator.userAgent.toString();return e.indexOf("X11;")>-1&&e.indexOf("Linux i686;")>-1&&e.indexOf("Gecko")>-1&&e.indexOf("Firefox")<0&&e.indexOf("Opera")<0?!0:!1},isAndroidOS:function(){var e=navigator.userAgent.toString();return null!=e.match(/android/i)?!0:!1},isEmptyContent:function(e){return e?""===e.replace(/<br[^>]*>/gi,"").replace(/<\/?(?:span|a)[^>]*>/gi,"").replace(/[\u3000\s]+/g,"").replace(/&nbsp;/g,""):!0},init:function(e){this.augmentObject(e,this.constructor.defaultConfig||{}),this.config=e,this.constructor.registerInstance&&(this.id=this.constructor.registerInstance(this,e.id)),this.initComponents(e),this.appendToDom(),this.initEvents(),this.initConfig(e)},initComponents:function(e){e.container&&("string"==typeof e.container?this.container=document.getElementById(e.container):"object"==typeof e.container&&1===e.container.nodeType&&(this.container=e.container)),this.container=this.container||document.body,this.editArea=document.createElement("div"),this.editArea.className=e.disabledEditAreaClassName,this.wrapper=document.createElement("div"),this.wrapper.className=e.disabledWrapperClassName,this.editAreaWrapper=document.createElement("div"),this.editAreaWrapper.className=e.editAreaWrapperClassName,this.editArea.style.height=e.height,this.wrapper.style.width=e.width},appendToDom:function(){this.editAreaWrapper.appendChild(this.editArea),this.wrapper.appendChild(this.editAreaWrapper),this.container.appendChild(this.wrapper)},initConfig:function(e){if(e.autoHeight&&this.enableAutoHeight(),e.enableRefer&&this.addPlugin("refer",new s({uid:this.config.uid})),e.autoEnable){var t=this;setTimeout(function(){t.enable(),t.fireEvent("initcomplete")},10)}else this.fireEvent("initcomplete")},initEvents:function(){var e=this;this.bindMousedown=function(){e.onMousedown.apply(e,arguments)},this.bindMouseup=function(){e.onMouseup.apply(e,arguments)},this.bindClick=function(){e.onClick.apply(e,arguments)},this.bindDoubleclick=function(){e.onDoubleclick.apply(e,arguments)},this.bindKeydown=function(){e.onKeydown.apply(e,arguments)},this.bindKeyup=function(){e.onKeyup.apply(e,arguments)},this.bindKeypress=function(){e.onKeypress.apply(e,arguments)},this.bindPaste=function(){e.onPaste.apply(e,arguments)},this.bindBlur=function(){e.onBlur.apply(e,arguments)},this.bindFocus=function(){e.onFocus.apply(e,arguments)}},attachEvents:function(){var e=this.editArea;this.ua.ie?(e.attachEvent("onmousedown",this.bindMousedown),e.attachEvent("onmouseup",this.bindMouseup),e.attachEvent("onclick",this.bindClick),e.attachEvent("ondblclick",this.bindDoubleclick),e.attachEvent("onkeypress",this.bindKeypress),e.attachEvent("onkeyup",this.bindKeyup),e.attachEvent("onkeydown",this.bindKeydown),e.attachEvent("onpaste",this.bindPaste),e.attachEvent("onbeforedeactivate",this.bindBlur),e.attachEvent("onbeforeactivate",this.bindFocus)):(e.addEventListener("mousedown",this.bindMousedown,!1),e.addEventListener("mouseup",this.bindMouseup,!1),e.addEventListener("click",this.bindClick,!1),e.addEventListener("dblclick",this.bindDoubleclick,!1),e.addEventListener("keypress",this.bindKeypress,!1),e.addEventListener("keyup",this.bindKeyup,!1),e.addEventListener("keydown",this.bindKeydown,!1),e.addEventListener("paste",this.bindPaste,!1),e.addEventListener("blur",this.bindBlur,!1),e.addEventListener("focus",this.bindFocus,!1)),this.on("dida",this.onDida,this)},detachEvents:function(){var e=this.editArea;this.ua.ie?(e.detachEvent("onmousedown",this.bindMousedown),e.detachEvent("onmouseup",this.bindMouseup),e.detachEvent("onclick",this.bindClick),e.detachEvent("ondblclick",this.bindDoubleclick),e.detachEvent("onkeypress",this.bindKeypress),e.detachEvent("onkeyup",this.bindKeyup),e.detachEvent("onkeydown",this.bindKeydown),e.detachEvent("onpaste",this.bindPaste),e.detachEvent("onbeforedeactivate",this.bindBlur),e.detachEvent("onbeforeactivate",this.bindFocus)):(e.removeEventListener("mousedown",this.bindMousedown,!1),e.removeEventListener("mouseup",this.bindMouseup,!1),e.removeEventListener("click",this.bindClick,!1),e.removeEventListener("dblclick",this.bindDoubleclick,!1),e.removeEventListener("keypress",this.bindKeypress,!1),e.removeEventListener("keyup",this.bindKeyup,!1),e.removeEventListener("keydown",this.bindKeydown,!1),e.removeEventListener("paste",this.bindPaste,!1),e.removeEventListener("blur",this.bindBlur,!1),e.removeEventListener("focus",this.bindFocus,!1)),this.remove("dida",this.onDida)},onMousedown:function(e){e.target&&"IMG"===e.target.tagName&&e.preventDefault&&e.preventDefault(),this.fireEvent("mousedown",null,[e]),e.exitFunction},onMouseup:function(e){this.fireEvent("mouseup",null,[e]),e.exitFunction||this.ua.ie||this.saveRange()},onClick:function(e){this.fireEvent("click",null,[e]),e.exitFunction},onDoubleclick:function(e){this.fireEvent("doubleclick",null,[e]),e.exitFunction},onKeydown:function(e){if(this.fireEvent("keydown",null,[e]),!e.exitFunction&&8===e.keyCode&&this.ua.ie){var t=this.getRange();t.item&&(t.item(0).outerHTML="",e.returnValue=!1)}},onKeypress:function(e){if(this.fireEvent("keypress",null,[e]),!e.exitFunction){var t=e.keyCode;switch(t){case 13:if(this.ua.ie){var i=this.getRange();i&&(i.pasteHTML("<br>"),i.collapse(!1),i.select()),e.returnValue=!1}else this.ua.webkit&&(document.execCommand("insertlinebreak"),e.preventDefault())}}},onKeyup:function(e){this.fireEvent("keyup",null,[e]),e.exitFunction||(this.ua.ie||this.saveRange(),e.stopPropagation&&e.stopPropagation())},onPaste:function(e){if(this.fireEvent("paste",null,[e]),!e.exitFunction)if(this.ua.ie)this.doPasteIE(e),this.fireEvent("afterpaste",null,[e]);else{var t=this;setTimeout(function(){t.doPaste(),t.fireEvent("afterpaste",null,[e])},5)}},didaTimer:null,savedHeight:null,startDida:function(){var e=this;this.didaTimer=setInterval(function(){e.fireEvent("dida")},this.config.didaDelay)},stopDida:function(){clearInterval(this.didaTimer)},onDida:function(){if(this.autoHeighted){if(null===this.savedHeight)return this.savedHeight=this.wrapper.scrollHeight,void 0;var e=this.wrapper.scrollHeight;this.savedHeight&&e!==this.savedHeight&&(this.fireEvent("heightChanged",null,[e,e-this.savedHeight]),this.savedHeight=e)}},onBlur:function(e){this.stopDida(),this.focused=!1,this.fireEvent("blur",null,[e]),e.exitFunction||this.ua.ie&&this.saveRange()},onFocus:function(e){this.startDida(),this.focused=!0,this.fireEvent("focus",null,[e]),e.exitFunction||this.resumeRange()},augmentObject:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=void 0!==e[i]?e[i]:t[i])},getSelection:function(){return window.getSelection?window.getSelection():document.selection},getRange:function(){return this.ua.ie?document.selection.createRange():window.getSelection().getRangeAt(0)},createRange:function(){return this.ua.ie?document.body.createTextRange():document.createRange()},getSelectedElement:function(){var e=this.getRange();if(this.ua.ie)return e.item?e.item(0):e.parentElement();var t=e.commonAncestorContainer;return 3===t.nodeType&&(t=t.parentNode),t},doPasteIE:function(e){var t=clipboardData.getData("Text");return t&&""!=t?(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/\s/g,"&nbsp;").replace(/\u3000/g,"&nbsp;&nbsp;"),this.execCommand("inserthtml",t),e.returnValue=!1,void 0):!0},doPaste:function(){this.saveCursor(),this.editArea.innerHTML=this.filteEditHTML(),this.ensureCursor()},filteEditHTML:function(){return html=this.editArea.innerHTML.replace(/_moz_dirty=""/gi,"").replace(/\[/g,"[[-").replace(/\]/g,"-]]").replace(/<\/ ?tr[^>]*>/gi,"[br]").replace(/<\/ ?td[^>]*>/gi,"&nbsp;&nbsp;").replace(/<(ul|dl|ol)[^>]*>/gi,"[br]").replace(/<(li|dd)[^>]*>/gi,"[br]").replace(/<p [^>]*>/gi,"[br]").replace(new RegExp("<(/?(?:"+this.editValidHTML.join("|")+")[^>]*)>","gi"),"[$1]").replace(new RegExp('<span([^>]*class="?at"?[^>]*)>',"gi"),"[span$1]").replace(new RegExp('<img([^>]*class="?(?:'+this.config.imageClassName+"|"+this.config.emptyClassName+"|"+this.config.smileyClassName+"|"+this.config.flashClassName+"|"+this.config.musicClassName+'"?[^>]*)>',"gi"),"[img$1]").replace(/<[^>]*>/g,"").replace(/\[\[\-/g,"[").replace(/\-\]\]/g,"]").replace(new RegExp("\\[(/?(?:"+this.editValidHTML.join("|")+"|img|span)[^\\]]*)\\]","gi"),"<$1>").replace(/\r?\n/gi,"<br>")},filteSubmitHTML:function(){this.reLayout(!0);var e=this.editArea.innerHTML.replace(/_moz_dirty=""/gi,"").replace(/\[/g,"[[-").replace(/\]/g,"-]]").replace(new RegExp("<(/?(?:"+this.submitValidHTML.join("|")+")[^>]*)>","gi"),"[$1]").replace(/<strong[^>]*>/gi,"[strong]").replace(/<\/strong[^>]*>/gi,"[/strong]").replace(/<b[^>]*>/gi,"[strong]").replace(/<\/b[^>]*>/gi,"[/strong]").replace(new RegExp('<span([^>]*class="?edit_font_normal"?[^>]*)>@</span>',"gi"),"@").replace(/<span([^>]*)>/gi,"[span$1]").replace(/<\/span[^>]*>/gi,"[/span]").replace(/<font[^>]*color=(\")?#E10602(\")?[^>]*>/gi,'[span class="edit_font_color"]').replace(/<font[^>]*color=(\")?#333333(\")?[^>]*>/gi,'[span class="edit_font_normal"]').replace(/<font[^>]*>/gi,'[span class="edit_font_normal"]').replace(/<\/font[^>]*>/gi,"[/span]").replace(new RegExp('<img([^>]*class="?(?:'+this.config.imageClassName+"|"+this.config.smileyClassName+"|"+this.config.flashClassName+"|"+this.config.musicClassName+')"?[^>]*)>',"gi"),"[img$1]").replace(/<[^>]*>/g,"").replace(/\[\[\-/g,"[").replace(/\-\]\]/g,"]").replace(new RegExp("\\[(/?(?:"+this.submitValidHTML.join("|")+"|img|span|strong)[^\\]]*)\\]","gi"),"<$1>").replace(new RegExp("<span[^>]*>@</span>","gi"),"@").replace(new RegExp("<span[^>]*>@(.*?)</span>","gi"),"@$1 "),t=document.createElement("div");t.innerHTML=e;var i,n,s,a,r=t.getElementsByTagName("span"),o=[];for(s=0,a=r.length;a>s;s++)"edit_font_normal"===r[s].className&&o.push(r[s]);for(s=0,a=o.length;a>s;s++){for(n=o[s],i=document.createDocumentFragment();n.firstChild;)i.appendChild(n.firstChild);n.parentNode.replaceChild(i,n)}return this.parseURL(t),t.innerHTML},filteHTML:function(e,t){return e.replace(/_moz_dirty=""/gi,"").replace(/\[/g,"[[-").replace(/\]/g,"-]]").replace(new RegExp("<(/?(?:"+t.join("|")+")[^>]*)>","gi"),"[$1]").replace(/<[^>]*>/g,"").replace(/\[\[\-/g,"[").replace(/\-\]\]/g,"]").replace(new RegExp("\\[(/?(?:"+t.join("|")+")[^\\]]*)\\]","gi"),"<$1>")},selectNodeContents:function(e,t){if(e){var i,n;this.ua.ie?(i=document.body.createTextRange(),i.moveToElementText(e),t&&i.collapse(!1),i.select()):(n=this.getSelection(),i=document.createRange(),i.selectNodeContents(e),n.removeAllRanges(),n.addRange(i),t&&n.collapseToEnd())}},hasSelection:function(){var e=this.getSelection();if(this.ua.ie)return e.type?"none"!==e.type.toLowerCase():!1;if(this.ua.opera){var t=this.getRange();return!(e.isCollapsed&&t.startContainer&&t.startContainer===t.endContainer&&t.startOffset===t.endOffset)}return!e.isCollapsed},saveCursor:function(){if(this.focused){var e=document.getElementById("editor-tmp-img");e&&e.parentNode.removeChild(e),this.execCommand("inserthtml",'<img class="'+this.config.emptyClassName+'" id="editor-tmp-img" style="width:1px;height:1px">')}},ensureCursor:function(){this.focused||this.focus();var e=document.getElementById("editor-tmp-img");if(e)if(this.ua.ie&&(!document.documentMode||document.documentMode<9))this.selectNodeContents(e),this.execCommand("delete");else{var t=document.createRange();t.selectNode(e);var i=window.getSelection();i.removeAllRanges(),i.addRange(t),this.execCommand("delete")}},savedRange:null,saveRange:function(){this.savedRange=this.getRange()},resumeRange:function(e){if(e=e||this.savedRange,!e)return!1;if(this.ua.ie)try{e.select()}catch(t){}else{var i=this.getSelection();i.removeAllRanges(),i.addRange(e)}},cmd_inserthtml:function(e){if(this.ua.ie){var t=this.getRange();return t.item?t.item(0).outerHTML=e:t.pasteHTML(e),[!1]}if(7==this.ua.trident){var i=this.savedRange||window.getSelection().getRangeAt(0),n=document.createElement("span");return n.innerHTML=e,i.insertNode(n.firstChild),i.collapse(!0),[!1]}return[!0]},insertImage:function(t,i,n,s,a,r){var o="";"undefined"!=typeof s&&(o=s);var c=' onload="TED.EditorCore.ResizeImage(this);"';if(a>0){if(a>e.defaultConfig.imageWidthLimit){var l=a,d=r;a=e.defaultConfig.imageWidthLimit,r=e.defaultConfig.imageWidthLimit*d/l}c=' height="'+r+'" width="'+a+'"'}if(8===this.ua.ie){this.execCommand("inserthtml",'<img unselectable="on"  pic_type="'+o+'"  class="'+i+'" id="editor-tmp-img" src="'+t+'" '+c+">");var u=document.getElementById("editor-tmp-img");if(u.removeAttribute("id"),u.parentNode.lastChild===u){var h=document.createElement("br");u.parentNode.appendChild(h);var g=document.body.createTextRange();g.moveToElementText(h),n?g.collapse(!1):g.collapse(!0),g.select()}else n&&this.execCommand("insertlinebreak")}else this.execCommand("inserthtml",'<img unselectable="on"   pic_type="'+o+'" class="'+i+'" src="'+t+'" '+c+">"),n&&this.execCommand("insertlinebreak")},cmd_insertlinebreak:function(){if(this.ua.webkit)document.execCommand("insertlinebreak",!1,null);else if(this.ua.gecko){document.execCommand("inserthtml",!1,'<br id="editor-tmp-br">');var e=document.getElementById("editor-tmp-br");if(e.removeAttribute("id"),e.parentNode.lastChild===e){e.parentNode.removeChild(e),document.execCommand("inserthtml",!1,'<br><br id="editor-tmp-br">'),e=document.getElementById("editor-tmp-br"),e.removeAttribute("id");var t=window.getSelection(),i=document.createRange();i.setStartBefore(e),i.setEndBefore(e),t.removeAllRanges(),t.addRange(i)}}else if(this.ua.ie){var n=this.getRange();n&&(n.pasteHTML("<br>"),n.collapse(!1),n.select())}return[!1]},cmd_insertsmiley:function(e){return this.insertImage(e,this.config.smileyClassName),[!1]},cmd_insertimage:function(e,t,i){if("string"==typeof e)this.insertImage(e,this.config.imageClassName,!0,t);else if("[object Array]"===Object.prototype.toString.apply(e))if("obj"==i)for(var n=0,s=e.length;s>n;n++)this.insertImage(e[n].url,this.config.imageClassName,!0,t,e[n].width,e[n].height);else for(var n=0,s=e.length;s>n;n++)this.insertImage(e[n],this.config.imageClassName,!0,t);return[!1]},cmd_focus2end:function(){var e=this.editArea;if(this.ua.ie)e.innerHTML=e.innerHTML;else if(e.lastChild){var t=document.createRange(),i=window.getSelection();t.setStartAfter(e.lastChild),t.setEndAfter(e.lastChild),i.removeAllRanges(),i.addRange(t)}else e.focus();return[!1]},editorPlugins:null,addPlugin:function(e,t){t.init(this),this.editorPlugins=this.editorPlugins||{},this.editorPlugins[e]=t},augmentObject:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=void 0!==e[i]?e[i]:t[i])},setStatsRequest:function(e){var t=new Image;window["bd_pv_"+(new Date).getTime()]=t,t.src="http://tb1.bdstatic.com/tb/img/pv.gif?fr=tb0_forum&st_mod=frspb&st_type=editor&st_value="+e+"&t="+(new Date).getTime(),t=null},getTagNum:function(e,t){var i=this.editArea.getElementsByTagName(e),n=i.length;if(t){n=0;for(var s=0,a=i.length;a>s;s++)i[s].className===t&&n++}return n},reLayout:function(e){for(var t=this.editArea.getElementsByTagName("img"),i=this.config.imageWidthLimit,n=[],s=0,a=t.length;a>s;s++)img=t[s],0!==img.width&&0!==img.height?(e&&img.removeAttribute("unselectable"),img.className===this.config.imageClassName?(img.width>i?(img.setAttribute("width",i),img.setAttribute("changedsize",!0)):img.setAttribute("width",img.width),img.setAttribute("height",img.height)):img.className===this.config.smileyClassName?(img.width>100?img.setAttribute("width",100):img.setAttribute("width",img.width),img.setAttribute("height",img.height)):(img.setAttribute("width",img.width),img.setAttribute("height",img.height)),img.removeAttribute("onload")):n.push(img);for(var s=0,a=n.length;a>s;s++)n[s].parentNode.removeChild(n[s])},parseURL:function(e){var t="(=*+)",i="(+*=)",n=4,s=function(e){if(3==e.nodeType){var a=e.nodeValue;a&&a.length>n&&(a="."+a,a=a.replace(/([^0-9a-zA-Z])((www\.|http:\/\/|mms:\/\/|rtsp:\/\/|ftp:\/\/|https:\/\/)[0-9a-zA-Z\.\!\~\#\?\:\/\&\%\-\+\*\'\=\@\_\$]+)/gi,"$1"+t+'a href="$2" target="_blank"'+i+"$2"+t+"/a"+i),a=a.substring(1),e.nodeValue=a)}else if(1==e.nodeType)for(var r=e.firstChild;r;)"A"!=r.nodeName.toUpperCase()&&s(r),r=r.nextSibling};s(e),e.innerHTML=e.innerHTML.replace(/\(\=\*\+\)a\ href="www\./gi,'<a href="http://www.').replace(/\(\=\*\+\)/gi,"<").replace(/\(\+\*\=\)/gi,">")}}),window.TED.EditorCore=e;var a={instanceNum:0,idPrefix:"tb-editor-",registerInstance:function(e,t){return this.instances=this.instances||{},t=t||this.generateID(),this.instances[t]=e,t},generateID:function(){return this.idPrefix+ ++this.instanceNum},getInstanceById:function(e){return e&&this.instances?this.instances[e]:null}};window.TED.EditorInstanceManager=a,i(t,n,{isMobile:!0,init:function(){var e=this;this.area.onfocus=function(){e.fireEvent("focus")},this.area.onclick=function(){e.fireEvent("click")},this.constructor.registerInstance&&(this.id=this.constructor.registerInstance(this))},getImageNum:function(){return 0},getSmileyNum:function(){return 0},getFlashNum:function(){return 0},getMusicNum:function(){return 0},getHtml:function(){return this.area.value.replace(/&/gi,"&amp;").replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/\r?\n/gi,"<br>").replace(/[\u3000\s]/gi,"&nbsp;").replace(/\t/gi,"&nbsp;&nbsp;&nbsp;&nbsp;")},focus:function(){this.area.focus()},blur:function(){this.area.blur()},isEmpty:function(){var e=this.area;return!(e&&e.value&&""!=e.value.replace(/[\u3000\s]/gi,"").replace(/\r?\n/gi,"").replace(/\t/gi,""))},quoteContainer:null,quote:function(e,t,i){if(e=parseInt(e),e>1){null===this.quoteContainer&&(this.quoteContainer=document.createElement("div"),this.quoteContainer.className="editor-quote",this.area.parentNode.insertBefore(this.quoteContainer,this.area));var n=document.getElementById("post_content_"+t).innerHTML.replace(/<img[^>]*>/gi,"[\u56FE\u7247]").replace(/<embed[^>]*>/gi,"[\u89C6\u9891]").replace(/<br[^>]*>/gi," ").replace(/<a[^>]*>/gi,"").replace(/<\/a>/gi,"").subByte(270);this.quoteContainer.innerHTML='<blockquote class="quote quote_simple"><a href="javascript:void(0);" onmousedown="return false;" onclick="TED.TextInput.getInstanceById(\''+this.id+'\').unQuote();Stats.sendRequest(\'fr=tb0_forum&st_mod=pb&st_type=quote&st_value=delete\');" class="close" title="\u5220\u9664\u5F15\u7528">\u2573</a><p class="quote_title">\u5F15\u7528&nbsp;'+i+'&nbsp;(<a href="#'+t+'">'+e+'\u697C</a>)</p><p class="quote_content">'+n+"</p></blockquote>",this.quoteContainer.style.display="block",this.fireEvent("quote",null,[t])}else this.unQuote(),Stats.sendRequest("fr=tb0_forum&st_mod=pb&st_type=quote&st_value=replyfirst");var s=this;setTimeout(function(){s.focus()},100)},unQuote:function(){this.quoteContainer&&(this.quoteContainer.style.display="none"),this.fireEvent("unquote")}}),TED.augmentObject(t,a),window.TED.TextInput=t}();!function(){function e(e,i){this.container=e,this.holder=document.createElement("div"),this.holder.style.position="relative",this.holder.className="insertsmiley_holder",this.options=i,this.container.appendChild(this.holder)}function i(e){this.maxNum=e||130,this.holder=document.createElement("div"),this.holder.className="wordlimit-holder",this.holder.style.visibility="hidden"}var t=window.TED.Overlay,o=window.TED.Event;window.TED.EditorPlugins.InsertSmiley=e,e.prototype={init:function(e){this.editor=e;var i=this;this.overlay=new t(this.holder),_.Module.use("common/component/EditorLayer",[{container:$(this.holder)}],function(e){i.editor.overlay=e,window.PAGESMILELAYER=i.editor.overlay,o.addEvent(i.holder,"click",function(e){var t=e.target||e.srcElement;t===i.holder&&(i.clickHandler(e),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)})})},clickHandler:function(){var e={layerPos:{left:-472,top:29},layerSize:{height:315,width:552},arrowPos:{left:472,top:-7},content:{height:313},arrowType:"arrow_up",layerType:""};e=$.extend(e,this.options);var i=this;this.smileLayer?i.editor.overlay.toggle(e,this.smileLayer,this.editor,i.holder,"smile"):_.Module.use("common/component/EditorSmiley",[],function(t){i.smileLayer=t,i.editor.overlay.toggle(e,i.smileLayer,i.editor,i.holder,"smile")})},closeOverlay:function(){this.editor.overlay.close()}},window.TED.EditorPlugins.WordLimit=i,i.prototype={showLimit:10,checkTimer:null,checkDelay:300,isShow:!1,exceed:!1,init:function(e){this.editor=e,this.container=e.wrapper,this.container.appendChild(this.holder),e.on("keyup",this.handlerEvent,this),e.on("focus",this.handlerEvent,this),this.check()},handlerEvent:function(){clearTimeout(this.checkTimer);var e=this;this.checkTimer=setTimeout(function(){e.check()},this.checkDelay)},check:function(){var e=this.maxNum-this.editor.getContentLength();e<=this.showLimit?(this.holder.style.visibility="visible",this.isShow=!0,0>e?(this.exceed||(this.editor.fireEvent("overflow"),this.exceed=!0),this.holder.innerHTML='\u5DF2\u7ECF\u8D85\u51FA<span style="font-size:18px;font-family:Arial;color:#f00;">'+-e+"</span>\u4E2A\u5B57"):(this.exceed&&(this.editor.fireEvent("unoverflow"),this.exceed=!1),this.holder.innerHTML='\u8FD8\u80FD\u8F93\u5165<span style="font-size:18px;font-family:Arial;">'+e+"</span>\u4E2A\u5B57")):this.isShow&&(this.holder.style.visibility="hidden",this.isShow=!1,this.exceed&&(this.editor.fireEvent("unoverflow"),this.exceed=!1))}}}();
;!function(){function e(i){e.superclass.call(this,i)}var i=window.TED.EditorCore,a=window.TED.extend,t=window.TED.EditorInstanceManager,r=window.TED.augmentObject;e.defaultConfig={height:"100px",width:"400px",maxHeight:null,autoFocus:!0,autoEnable:!0,autoHeight:!1,wrapperClassName:"tb-simpleeditor-wrapper",editAreaClassName:"tb-editor-editarea",editAreaWrapperClassName:"tb-editor-editarea-wrapper",disabledEditAreaClassName:"tb-editor-editarea tb-editor-editarea-disabled",disabledWrapperClassName:"tb-simpleeditor-wrapper tb-simpleeditor-wrapper-disabled",imageClassName:"BDE_Image",smileyClassName:"BDE_Smiley",rootPath:"/tb/static-common/",enableRefer:!0,emptyClassName:"BDE_Empty",flashClassName:"BDE_Flash",flashNumLimit:10,didaDelay:300,imageWidthLimit:570},a(e,i,{getContentLength:function(){return Math.ceil(this.filteHTML(this.editArea.innerHTML,["img","br"]).replace(/<img[^>]*>/gi,"mm").replace(/<br[^>]*>/gi,"m").replace(/&nbsp;/gi,"m").replace(/[^\x00-\xff]/g,"mm").length/2)},filteEditHTML:function(){var e=this.editArea.innerHTML.replace(/_moz_dirty=""/gi,"").replace(/\[/g,"[[-").replace(/\]/g,"-]]").replace(new RegExp("<(/?(?:br)[^>]*)>","gi"),"[$1]").replace(new RegExp('<span([^>]*class="?at"?[^>]*)>',"gi"),"[span$1]").replace(new RegExp('<img([^>]*class="?(?:'+this.config.emptyClassName+"|"+this.config.smileyClassName+')"?[^>]*)>',"gi"),"[img$1]").replace(/<[^>]*>/g,"").replace(/\[\[\-/g,"[").replace(/\-\]\]/g,"]").replace(new RegExp("\\[(/?(?:br|img|span)[^\\]]*)\\]","gi"),"<$1>");return e},getConfig:function(){return this.config},filteSubmitHTML:function(){this.reLayout();var e=this.editArea.innerHTML.replace(/_moz_dirty=""/gi,"").replace(/\[/g,"[[-").replace(/\]/g,"-]]").replace(new RegExp("<(/?(?:"+this.submitValidHTML.join("|")+")[^>]*)>","gi"),"[$1]").replace(new RegExp('<img([^>]*class="?(?:'+this.config.imageClassName+"|"+this.config.smileyClassName+"|"+this.config.flashClassName+"|"+this.config.musicClassName+')"?[^>]*)>',"gi"),"[img$1]").replace(/<[^>]*>/g,"").replace(/\[\[\-/g,"[").replace(/\-\]\]/g,"]").replace(new RegExp("\\[(/?(?:"+this.submitValidHTML.join("|")+"|img)[^\\]]*)\\]","gi"),"<$1>"),i=document.createElement("div");return i.innerHTML=e,this.parseURL(i),i.innerHTML}}),r(e,t),window.TED.SimpleEditor=e}();_.Module.define({path:"frs/widget/ForumManager",requires:["frs/widget/ForumManager/BazhuSkinManager","frs/widget/ForumManager/BaVisitCardManager"],sub:{initial:function(a,e,t,n,i){try{var r=this;r.delThreadBubble(),"album"==t||n||r.batchDeleteTip();var o=window.userSkinManager;if(null!=o){var s=null;$("#adminModePanel").find(".j_btn_skin_mgr").bind("click",function(){try{null==s&&(s=r.use("BazhuSkinManager",{skinId:a.background.bg_id||null,fid:a.id,tbs:e.post_params.tbs,fname:a.name,userSkinManager:o})),s.openDlg()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_manager/forum_manager_main.js",method:"",ln:28}),t}})}var c=null;null==c&&(c=r.use("BaVisitCardManager",{})),$("#adminModePanel").find(".j_btn_visit_card").bind("click",function(){try{c.openDlgOrBubble()}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/forum_manager/forum_manager_main.js",method:"",ln:38}),a}}),r.setAttentionRecomment(i)}catch(d){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:d.message||d.description,path:"frs:widget/forum_manager/forum_manager_main.js",method:"",ln:41}),d}},setAttentionRecomment:function(a){var e=this;e.data=a,$(".j_fourth_manage").click(function(a){try{return _.Module.use("frs/widget/platform_attention_recommend",[{tbs:e.data.tbs,uid:e.data.uid,frs_access:!0,is_forum_fourth_manager:e.data.is_forum_fourth_manager,avatar:e.data.avatar}]),!1}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/forum_manager/forum_manager_main.js",method:"",ln:54}),a}})},batchDeleteTip:function(){if("1"!=$.cookie("bacard"+PageData.forum.forum_id)){var a=$("#j_visit_card_bubble_wrap"),e=a.siblings(".j_btn_visit_card").position().left-16,t={content:"\u4F60\u7684\u5427\u8FD8\u6CA1\u63D0\u4EA4\u8D85\u9177\u4E2A\u6027\u5316\u5427\u540D\u7247\u54E6\uFF0C\u8D76\u7D27\u6765\u8BBE\u7F6E\u4E00\u4E0B\u5427\uFF01<a class='turnToDesc' target='_blank' href='/p/2289921250#31931628862'>\u4EC0\u4E48\u662F\u5427\u540D\u7247>></a>",arrow_dir:"up",bubble_css:{top:1,left:e,width:166},arrow_pos:{left:30},attr:"",wrap:a,closeBtn:!0},n=new UiBubbleTipBase(t);n.showBubble(),n.bind("onclose",function(){$.cookie("bacard"+PageData.forum.forum_id,1,{expires:30,path:"/"})},!0),n.j_bubble.find(".turnToDesc").click(function(){try{$.cookie("bacard"+PageData.forum.forum_id,1,{expires:30,path:"/"})}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/forum_manager/forum_manager_main.js",method:"",ln:86}),a}})}},delThreadBubble:function(){var a,e=0,t=["\u674E\u8FB0\u53F7","lol","\u674E\u6BC5","\u9B54\u517D\u4E16\u754C","\u5730\u4E0B\u57CE\u4E0E\u52C7\u58EB","\u51E1\u4EBA\u4FEE\u4ED9\u4F20"],n=(PageData&&PageData.forum&&PageData.forum.name||"").toLowerCase(),i=$("#j_visit_card_bubble_wrap"),r=$("#adminModePanel"),o=r.find(".btn_batch_manage");if(o[0]&&1!=$.cookie("isDTBC")&&($.each(t,function(a,t){(t==n||t+"\u5427"==n)&&(e=1)}),e)){a={content:"\u5220\u8D34\u6709\u5956\u52B1\uFF0C\u5FEB\u6765\u67E5\u770B~",arrow_dir:"right",bubble_css:{top:-93,right:o.position().left,width:150},arrow_pos:{right:0,top:6},wrap:i,closeBtn:!0};var s=new UiBubbleTipBase(a);s.bind("onclose",function(){$.cookie("isDTBC",1,{expires:30,path:"/"})},!0),s.showBubble()}}}});
;_.Module.define({path:"frs/widget/ForumManager/bannerImageUpload",requires:["common/widget/image_uploader_manager"],sub:{BANNER_DATA:{width:980,height:180,maxSize:1e8},API:{check:"/toutu/isCommite",setBanner:"/toutu/addToutu"},ORINAL_PIC_URL_PREFIX:"http://imgsrc.baidu.com/forum/pic/item/",_status:-1,_val:"",initial:function(){try{var e=this;e._initBannerUploadTip(),e._initDialog(),e._initUpload(),e._bindEvent()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_manager/banner_image_upload.js",method:"",ln:27}),t}},_bindEvent:function(){var e=this;$("#adminModePanel .j_banner_image_upload").on("click",function(t){try{$.ajax({url:e.API.check,type:"post",data:{fid:PageData.forum.forum_id},dataType:"json"}).done(function(t){0===t.errno?(e._status=t.ret,e._setTipSubmit(),e.dialog.show()):$.dialog.alert("\u670D\u52A1\u5668\u5F00\u5C0F\u5DEE\u4E86\uFF0C\u8BF7\u91CD\u65B0\u8BD5\u4E00\u4E0B",{title:"\u8D34\u5427\u63D0\u793A"})}).fail(function(){$.dialog.alert("\u670D\u52A1\u5668\u6709\u70B9\u52A8\u8361\uFF0C\u8BF7\u91CD\u65B0\u8BD5\u4E00\u4E0B",{title:"\u8D34\u5427\u63D0\u793A"})})}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_manager/banner_image_upload.js",method:"",ln:50}),t}})},_initBannerUploadTip:function(){var e="fcardbanner"+PageData.forum.forum_id;if(!("1"==$.cookie(e)||+new Date>+new Date(2014,5,23))){var t=$("#j_banner_image_upload_wrap"),i={content:"\u4F60\u7684\u5427\u8FD8\u6CA1\u63D0\u4EA4\u8D85\u9177\u4E2A\u6027\u5316\u5427\u5934\u56FE\u54E6\uFF0C\u8D76\u7D27\u6765\u8BBE\u7F6E\u4E00\u4E0B\u5427\uFF01",arrow_dir:"up",bubble_css:{top:25,left:-160,width:166},arrow_pos:{left:110},attr:"",wrap:t,closeBtn:!0},a=new UiBubbleTipBase(i);a.showBubble(),a.bind("onclose",function(){$.cookie(e,1,{expires:30,path:"/"})},!0),a.j_bubble.find(".turnToDesc").click(function(){try{$.cookie(e,1,{expires:30,path:"/"})}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_manager/banner_image_upload.js",method:"",ln:83}),t}})}},_initDialog:function(){var e=this;e.dialog=new $.dialog({html:['<div class="uploadHeadImage">',"<table>","<tr>",'<td class="des">\u4E0A\u4F20\u56FE\u7247\uFF1A</td>','<td class="cnt">','<div class="img_upload"><a href="#3" class="img_upload_btn" onclick="return false;"></a></div>','<div class="tip_image ui_text_summary">',"<h4>\u8BF4\u660E\uFF1A</h4>","<p>1. \u4E0A\u4F20\u5C3A\u5BF8\u4E3A980*180</p>","<p>2. \u4E0D\u80FD\u542B\u6709QQ\u3001\u7535\u8BDD\u53F7\u7801\u7B49</p>","<p>3. \u5FC5\u987B\u4E0E\u5427\u4E3B\u9898\u7B26\u5408</p>","<p>4. \u5BA1\u6838\u901A\u8FC7\u540E\uFF0C2\u5929\u5185\u4E0D\u80FD\u4FEE\u6539\uFF0C\u8BF7\u614E\u91CD\u9009\u62E9</p>","<p>5. \u4EC5\u652F\u6301jpg\u3001png\u683C\u5F0F\u7684\u6587\u4EF6</p>","</div>","</td>","</tr>","<tr>",'<td class="des"></td>','<td class="cnt">','<span class="submit_btns">','<a href="#" onclick="return false;" class="ui_btn_disable ui_btn_m_disable j_preview"><span><em>\u9884 \u89C8</em></span></a>','<a href="#" onclick="return false;" class="ui_btn_disable ui_btn_m_disable j_submit"><span><em>\u63D0 \u4EA4</em></span></a>',"</span>",'<span class="tip_submit ui_text_emphasize"></span>',"</td>","</tr>","</table>","</div>"].join(""),holderClassName:"uploadHeadImageDialog",title:"\u4E0A\u4F20\u5934\u56FE",draggable:!0,width:560,hideOnclose:!0,show:!1}),e.$tipSubmitEl=e.dialog.element.find(".tip_submit"),e.dialog.element.on("click",".j_preview",function(t){try{if(!e._val)return!1;$("#container .card_banner img").tbattr("src",e._val),window.scrollTo(0,0)}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_manager/banner_image_upload.js",method:"",ln:133}),t}}),e.dialog.element.on("click",".j_submit",function(t){try{if(!e._val)return!1;$.ajax({url:e.API.setBanner,type:"post",data:{fid:PageData.forum.forum_id,avatar:e._val},dataType:"json"}).done(function(t){0===t.errno?(e._val="",e.dialog.hide(),$.dialog.alert("\u63D0\u4EA4\u6210\u529F\uFF0C\u8BF7\u7B49\u5F85\u5BA1\u6838\u901A\u8FC7\u3002",{title:"\u8D34\u5427\u63D0\u793A"})):e._setTipSubmit("\u670D\u52A1\u5668\u5F00\u5C0F\u5DEE\u4E86\uFF0C\u8BF7\u91CD\u65B0\u8BD5\u4E00\u4E0B",!0)}).fail(function(){e._setTipSubmit("\u670D\u52A1\u5668\u6709\u70B9\u52A8\u8361\uFF0C\u8BF7\u91CD\u65B0\u8BD5\u4E00\u4E0B",!0)})}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/forum_manager/banner_image_upload.js",method:"",ln:159}),t}})},_setTipSubmit:function(e,t){var i=this,a=e||"",n={1:"\u63D0\u4EA4\u6210\u529F\uFF0C\u5BA1\u6838\u4E2D",2:"\u8DDD\u79BB\u4E0A\u6B21\u4FEE\u6539\u4E0D\u6EE12\u5929\uFF0C\u65E0\u6CD5\u4FEE\u6539"};n.hasOwnProperty(i._status)&&(a=n[i._status]),i.$tipSubmitEl.text(a),t&&(clearTimeout(i.autoReset),i.autoReset=setTimeout(function(){i.$tipSubmitEl.text("")},3e3))},_initUpload:function(){var e=this,t=e.dialog.element.find(".img_upload_btn"),i=e.BANNER_DATA;e.upload=e.use("common/widget/image_uploader_manager",{width:t.width(),height:t.height(),container:t,maxSize:i.maxSize,queueLen:1,isFlash:!0,isAutoUp:!1}),e.upload.bind("onComplete",function(t,a){var n=a.imageList[0].response;e._setTipSubmit(""),0==n.error_code&&0==n.info.err_no?(n=n.info,n.fullpic_width!=i.width||n.fullpic_height!=i.height?e._setTipSubmit("\u56FE\u7247\u5C3A\u5BF8\u4E0D\u5BF9",!0):(e._val=e.ORINAL_PIC_URL_PREFIX+n.pic_id_encode+".jpg",e.dialog.element.find(".j_preview").tbattr("class","j_preview ui_btn ui_btn_m"),e.dialog.element.find(".j_submit").tbattr("class","j_submit ui_btn ui_btn_m"))):e._setTipSubmit("\u56FE\u7247\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\u3002",!0)}),e.upload.bind("onStartUpload",function(){e._setTipSubmit("\u4E0A\u4F20\u4E2D...")}),e.upload.bind("onFileSelected",function(t,i){e._status<=0&&(i.imageList&&/\.(jpe*g|png)$/i.test(i.imageList[0].name)?e.upload.startUpload():e._setTipSubmit("\u4EC5\u652F\u6301jpg\u3001png\u683C\u5F0F\u7684\u6587\u4EF6",!0))})}}});
;_.Module.define({path:"frs/widget/ForumManager/BazhuSkinManager",requires:["frs/widget/ForumManager/SkinData","frs/widget/ForumManager/FrsSkinDlg"],sub:{_skinData:null,_skinDlg:null,_userSkinManager:null,initial:function(i){try{var n=this;this._skinData=this.use("SkinData",i),this._skinData.onSaved=function(i){n.afterSave(i)},this._userSkinManager=i.userSkinManager}catch(s){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"frs:widget/forum_manager/bazhu_skin_manager.js",method:"",ln:19}),s}},_initDlg:function(){var i=this,n=this.use("FrsSkinDlg","frs_skin_dlg",this._skinData);n.onSelectSkin=function(n){i._userSkinManager.setSkin(n)},n.onCancel=function(){var n=i._skinData.getSkinOriginal();i._userSkinManager.setSkin(n)},n.onOk=function(){var n=i._skinData.getSkinSelected();i._userSkinManager.resetSkin(n)},this._skinDlg=n},openDlg:function(){var i=this;null==this._skinDlg?this._loadData(function(){i._initDlg(),i._skinDlg.show()}):this._skinDlg.show()},_loadData:function(i){this._skinData.loadData(i)},closeDlg:function(){null!=this._skinDlg&&this._skinDlg.hide()},afterSave:function(i){i&&this._showSaveResult(i)},_showSaveResult:function(){var i='<div class="skin_success_dlg"><div class="skin_success_dlg_l1">\u4FDD\u5B58\u6210\u529F</div><div class="skin_success_dlg_l2">\u672C\u7A97\u53E3\u57283\u79D2\u540E\u81EA\u52A8\u5173\u95ED</div></div>',n=new $.dialog({html:i,title:"\u80CC\u666F\u8BBE\u7F6E",width:300});setTimeout(function(){n.close()},3e3)}}});
;_.Module.define({path:"frs/widget/ForumManager/FrsSkinDlg",sub:{_id:"",_skinData:null,_dlgInstance:null,_tabCapacity:8,_status:0,initial:function(t,i){try{this._id=t,this._skinData=i,this._dlgInstance=this._initDlgInstance(),this.restoreDlg(),this.bindEvents()}catch(n){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message||n.description,path:"frs:widget/forum_manager/frs_skin_dlg.js",method:"",ln:20}),n}},_initDlgInstance:function(){var t=this._createDlgHtml(),i=null;return i=new $.dialog({html:t,title:"\u80CC\u666F\u8BBE\u7F6E",showShadow:!1,width:498,hideOnclose:!0,show:!1})},_createDlgHtml:function(){var t=['<div id="',this._id,'" class="skindlg">',this._createTabNavHtml(),'<ul class="skindlg_skinshelf j_skindlg_skinshelf"></ul>','<ul class="skindlg_pager j_skindlg_pager"></ul>','<div class="skindlg_btns"><input class="skindlg_btnok j_skindlg_btnok" type="button" value="\u4FDD&nbsp;\u5B58"/><input class="skindlg_btncl j_skindlg_btncl" type="button" value="\u53D6&nbsp;\u6D88"/></div>',"</div>"];return t.join("")},_createTabNavHtml:function(){for(var t=['<ul class="skindlg_nav j_skindlg_nav">'],i=this._skinData.getSkinDataConfig(),n=0,s=i.length;s>n;n++)t.push("<li tabidx="),t.push(n),t.push('><a href="#" onclick="return false;" tabidx='),t.push(n),t.push(">"),t.push(i[n].groupName),t.push("</a></li>");return t.push("</ul>"),t.join("")},_createTabContenHtml:function(t,i){var n=[],s=this._skinData.getSkinDataConfig()[t].skinList,a=(i-1)*this._tabCapacity,e=a+this._tabCapacity;e=e>s.length?s.length:e;for(var l=a;e>l;l++){var r=s[l].skinId,o=s[l].skinName,c=this._skinData.getSkinCover(r);n.push('<li><a style="background:url('),n.push(c),n.push(')" href="#" onclick="return false" bid="'),n.push(r),n.push('"><span class="skindlg_skinmask"></span><span class="skindlg_skintitle">'),n.push(o),n.push("</span></a></li>")}return n.join("")},_createPagerContentHtml:function(t,i){var n=this._skinData.getSkinDataConfig()[t].skinList,s=this._tabCapacity,a=Math.ceil(n.length/s);if(n.length>s)if(1==i){for(var e=['<li>\u4E0A\u4E00\u9875</li><li class="skindlg_pager_disable">1</li>'],l=2;a>=l;l++)e.push("<li tabidx="+t+'><a href="#" onclick="return false" tabidx='+t+" pn="+l+">"+l+"</a></li>");e.push("<li tabidx="+t+'><a href="#" onclick="return false" tabidx='+t+" pn="+(i+1)+">\u4E0B\u4E00\u9875</a></li>")}else if(i==a){for(var e=["<li tabidx="+t+'><a href="#" onclick="return false" tabidx='+t+" pn="+(i-1)+">\u4E0A\u4E00\u9875</a></li>"],l=1;a-1>=l;l++)e.push("<li tabidx="+t+'><a href="#" onclick="return false" tabidx='+t+" pn="+l+">"+l+"</a></li>");e.push('<li class="skindlg_pager_disable">'+a+"</li><li>\u4E0B\u4E00\u9875</li>")}else{for(var e=["<li tabidx="+t+'><a href="#" onclick="return false" tabidx='+t+" pn="+(i-1)+">\u4E0A\u4E00\u9875</a></li>"],l=1;a>=l;l++)l==i?e.push('<li class="skindlg_pager_disable">'+l+"</li>"):e.push("<li tabidx="+t+'><a href="#" onclick="return false" tabidx='+t+" pn="+l+">"+l+"</a></li>");e.push("<li tabidx="+t+'><a href="#" onclick="return false" tabidx='+t+" pn="+(i+1)+">\u4E0B\u4E00\u9875</a></li>")}else var e=[""];return e.join("")},showTab:function(t,i){var n=this._createTabContenHtml(t,i),s=$("#"+this._id);s.find(".j_skindlg_skinshelf").tb_html(n),this.focusSkinCover(this._skinData.getSkinSelected()),s.find(".j_skindlg_nav li").each(function(){var i=$(this);i.toggleClass("focus",i.tbattr("tabidx")==t?!0:!1)})},showPager:function(t,i){var n=this._createPagerContentHtml(t,i),s=$("#"+this._id);s.find(".j_skindlg_pager").tb_html(n)},focusSkinCover:function(t){$("#"+this._id).find(".j_skindlg_skinshelf a").each(function(){var i=$(this);i.toggleClass("focus",i.tbattr("bid")==t?!0:!1)})},restoreDlg:function(){var t=0;this.showTab(t,1),this.showPager(t,1)},bindEvents:function(){var t=this,i=$("#"+this._id),n=i.find(".j_skindlg_btnok"),s=i.find(".j_skindlg_btncl");i.delegate(".j_skindlg_nav a","click",function(){try{t.showTab($(this).tbattr("tabidx"),1),t.showPager($(this).tbattr("tabidx"),1)}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/forum_manager/frs_skin_dlg.js",method:"",ln:202}),i}}),i.delegate(".j_skindlg_skinshelf a","click",function(){try{var i=$(this).tbattr("bid");t.focusSkinCover(i),t.onSelectSkin(i)||t._skinData.setSkinSelected(i)}catch(n){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message||n.description,path:"frs:widget/forum_manager/frs_skin_dlg.js",method:"",ln:210}),n}}),i.delegate(".j_skindlg_pager a","click",function(){try{var i=$(this).tbattr("tabidx"),n=parseInt($(this).tbattr("pn"));t.showTab(i,n),t.showPager(i,n)}catch(s){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"frs:widget/forum_manager/frs_skin_dlg.js",method:"",ln:217}),s}}),n.bind("click",function(){try{t.onOk()||(t._skinData.save(),t.hide(1))}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/forum_manager/frs_skin_dlg.js",method:"",ln:225}),i}}),s.bind("click",function(){try{t.hide(0)}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/forum_manager/frs_skin_dlg.js",method:"",ln:228}),i}}),this._setBtnEffect(n,"skindlg_btnok"),this._setBtnEffect(s,"skindlg_btncl"),this._dlgInstance.bind("onhide",function(){0==t._status&&t._cancel(),t._status=0})},_setBtnEffect:function(t,i){var n=[i,i+"_hover",i+"_active"],s=n.join(" ");t.mouseover(function(){t.removeClass(s).addClass(n[1])}),t.mouseout(function(){t.removeClass(s).addClass(n[0])}),t.mousedown(function(){t.removeClass(s).addClass(n[2])})},_cancel:function(){this.onCancel()||(this._skinData.restore(),this.restoreDlg())},show:function(){this._dlgInstance.show()},hide:function(t){self._status=t,this._dlgInstance.hide()},onSelectSkin:function(){},onOk:function(){},onCancel:function(){}}});
;_.Module.define({path:"frs/widget/ForumManager/SkinData",sub:{_skinOriginal:null,_skinSelected:null,_skinDataConfig:null,_saveUrl:"/frsbgcui/frsbgcui",_getSkinDataUrl:"/frsbgcui/getfrsbg",_postData:{},_loadParam:{},initial:function(t){try{return this._skinOriginal=t.skinId,this._skinSelected=this._skinOriginal,this._postData={fid:t.fid,fname:t.fname,tbs:t.tbs},this._loadParam={fid:t.fid,fname:t.fname,ie:"utf-8"},this}catch(i){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/forum_manager/skin_data.js",method:"",ln:36}),i}},onSaved:function(){},onDataLoaded:function(){},save:function(){var t=this,i=$.extend({bgid:this._skinSelected},this._postData);t._skinOriginal=t._skinSelected,$.tb.post(t._saveUrl,i,function(i){i&&0==i.no?t.onSaved(!0):t.onSaved(!1)})},setSkinSelected:function(t){this._skinSelected=t},getSkinSelected:function(){return this._skinSelected},getSkinOriginal:function(){return this._skinOriginal},restore:function(){this._skinSelected=this._skinOriginal},getSkinDataConfig:function(){return this._skinDataConfig},getSkinCover:function(t){return["http://tb2.bdstatic.com/tb/cms/frs/bg/bg_",t,"_thum.jpg?v=1"].join("")},_getSkinData:function(){var t=this;$.getJSON(this._getSkinDataUrl,this._loadParam,function(i){t._skinDataConfig=i.data.skinData,t.onDataLoaded()})},loadData:function(t){null!=t&&(this.onDataLoaded=t),this._getSkinData()}}});_.Module.define({path:"common/widget/verifyManagerPhone",requires:[],sub:{_hasNextTimeButton:null,_template:{_confirmDialog:["<h2>","#{title}","</h2>","<p>","#{text}","</p>"].join(""),_changeBind:["<div>* \u5982\u60A8\u9700\u8981\u6362\u7ED1\u60A8\u7684\u624B\u673A\u540E\u518D\u8FDB\u884C\u7ED1\u5B9A\u9A8C\u8BC1\uFF0C\u8BF7<a target='_blank' href='#{href}'>\u70B9\u6B64\u6362\u7ED1</a>\u3002</div>"].join(""),_complain:["<div>* \u5982\u679C\u60A8\u7533\u8BC9\u8FC7\u7A0B\u4E2D\u51FA\u73B0\u95EE\u9898\u5BFC\u81F4\u65E0\u6CD5\u9A8C\u8BC1\uFF0C\u8BF7<a target='_blank' href='#{href}'>\u70B9\u6B64\u4E13\u8D34</a>\u53CD\u9988\u3002</div>"].join("")},_url:{nextTime:"/bawu2/checkphone/commitActsctrl",getPopPassData:"/bawu2/checkphone/getPhoneToken",verifyDone:"/bawu2/checkphone/commitCheckTime"},initial:function(t){var e=this;e._hasNextTimeButton=!t,e._title=null,e._text=null,t?(e._title="\u5C0A\u656C\u7684\u8D34\u5427\u5427\u4E3B\u7528\u6237",e._text="\u4E3A\u4E86\u60A8\u7684\u8D26\u53F7\u5B89\u5168\uFF0C\u8BF7\u60A8\u8FDB\u884C\u624B\u673A\u7ED1\u5B9A\u9A8C\u8BC1\uFF0C<br/>\u4EE5\u9632\u8D26\u53F7\u88AB\u76D7\u9020\u6210\u635F\u5931\u3002<span class='verify_manager_phone_tip_strong'>\uFF08\u8BBE\u7F6E\u6210\u529F\u540E\u4E0D\u518D\u63D0\u793A\uFF09</span>"):(e._title="\u5C0A\u656C\u7684\u8D34\u5427\u5427\u4E3B\u7528\u6237\uFF1A",e._text="\u4E3A\u4E86\u60A8\u7684\u8D26\u53F7\u5B89\u5168\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u60A8\u8FDB\u884C\u624B\u673A\u7ED1\u5B9A\u9A8C\u8BC1\uFF0C<br/>\u4EE5\u9632\u8D26\u53F7\u88AB\u76D7\u9020\u6210\u635F\u5931\u3002<span class='verify_manager_phone_tip_strong'>\uFF08\u8BBE\u7F6E\u6210\u529F\u540E\u4E0D\u518D\u63D0\u793A\uFF09</span>"),e._popConfirmDialog()},_startVerify:function(){var t=this;t._getPopPassData(function(e){t._popPassDialog(e.hasBind?"verify":"bind",e.token)},function(){t._onVerifyFail()})},_onVerifyFail:function(t){var e=this;t||(t="\u9A8C\u8BC1\u5931\u8D25~ T_T \u8BF7\u91CD\u8BD5~~");var n={message:"<h2>\u9A8C\u8BC1\u624B\u673A\u5931\u8D25\uFF1A</h2><p>"+t+"</p>",holderClassName:"verify_manager_phone_dialog",buttons:[{text:"\u91CD\u8BD5",callback:function(){e._startVerify()}},{text:"\u53D6\u6D88"}]};n.buttons[0]["class"]="ui_btn_m btn_left",n.buttons[1]["class"]="ui_btn_sub_m",$.tb.alert(n)},_popConfirmDialog:function(){function t(){n._startVerify()}function e(){n._informServerNextTime()}var n=this,a={text:"\u4E0B\u6B21\u518D\u8BF4",callback:e};a["class"]="ui_btn_sub_m";var i={text:"\u7ACB\u5373\u8BBE\u7F6E",callback:t};i["class"]="ui_btn_m btn_left";var o=[i];n._hasNextTimeButton&&o.push(a),$.tb.alert({message:$.tb.format(n._template._confirmDialog,{title:n._title,text:n._text}),holderClassName:"verify_manager_phone_dialog",buttons:o})},_getPopPassData:function(t,e){var n=this;$.ajax({url:n._url.getPopPassData,dataType:"json",success:function(n){n&&0===n.errno?t(n.data):e()},error:e})},_popPassDialog:function(t,e){function n(t){o._informServerVerifyDone(t)}function a(){o._informServerVerifyDone()}function i(){o._onVerifyFail()}var o=this;"verify"===t?o._showMobileVerify(e,a,i):o._showMobileBind(e,n,i)},_showMobileVerify:function(t,e,n){var a=this;$.JsLoadManager.use(["http://passport.baidu.com/passApi/js/uni_forceverify_wrapper.js?cdnversion="+a._getTimeStamp(),"http://passport.bdimg.com/passApi/js/wrapper.js?cdnversion="+a._getTimeStamp()],function(){var i=window.passport.pop.initForceverify({token:t,curType:"mobile",onRender:function(){var t=this,e=$(t.getById("content")),n=e.find(".footer-tip");a._updatePassDialogZIndex(t);var i=$($.tb.format(a._template._changeBind,{href:"http://passport.baidu.com/v2/accountsecurity?act=rebindmobile"}));n.prepend(i);var o=$($.tb.format(a._template._complain,{href:"http://tieba.baidu.com/p/3472422906"}));n.prepend(o);var r=n.html(),s=r.lastIndexOf("<br>");n.html(r.substring(0,s))},onSubmitSuccess:e,onGetapiError:n,onSubmitFailure:n});i.show()},!0,"utf-8")},_showMobileBind:function(t,e,n){var a=this;$.JsLoadManager.use(["http://passport.baidu.com/passApi/js/uni_armorwidget_wrapper.js?cdnversion="+a._getTimeStamp(),"http://passport.bdimg.com/passApi/js/wrapper.js?cdnversion="+a._getTimeStamp()],function(){var i=window.passport.pop.ArmorWidget("bindmobile",{token:t,onRender:function(){var t=this,e=$(t.getById("content")),n=e.find(".footer-tip");a._updatePassDialogZIndex(this);var i=$($.tb.format(a._template._complain,{href:"http://tieba.baidu.com/p/3472422906"}));n.prepend(i);var o=n.html(),r=o.lastIndexOf("<br>");n.html(o.substring(0,r))},successCountdown:0,onSubmitSuccess:function(t){e(t.bindid)},onInitFail:n});i.show()},!0,"utf-8")},_informServerNextTime:function(){var t=this;$.ajax(t._url.nextTime)},_informServerVerifyDone:function(t){var e=this,n=function(){$.tb.alert({message:"<h2>\u8BBE\u7F6E\u6210\u529F\uFF01</h2>",holderClassName:"verify_manager_phone_dialog",onclose:function(){location.reload()},buttons:[{text:"\u786E\u8BA4"}]})},a=function(){e._onVerifyFail()},i=e._url.verifyDone;t&&(i+="?bindid="+t),$.ajax({url:i,dataType:"json",success:function(t){t&&0===t.errno?n():a()},error:a})},_getTimeStamp:function(){var t=(new Date).getTime();return Math.floor(t/6e4)},_updatePassDialogZIndex:function(t){var e=$(t.getById("mask")),n=$(t.getById("wrapper"));e.css("zIndex",5e4+parseInt(e.css("zIndex"))),n.css("zIndex",5e4+parseInt(n.css("zIndex")))}}});!function(){var e=!1;_.Module.define({path:"common/widget/detectManagerBlock",requires:["common/widget/verifyManagerPhone"],sub:{initial:function(){},setBlockState:function(n){e=n},getBlockState:function(){return e},doOnNotBlocked:function(n,o){void 0===o&&(o=!0),e?o&&this.requireInstance("common/widget/verifyManagerPhone",[!0]):n()},doOnBlocked:function(n){e&&n()}}})}();_.Module.define({path:"common/widget/blockUser",requires:["common/widget/detectManagerBlock"],sub:{template:'<div class="block_user_wrapper"> <ul class="b_u_items">   <li class="b_u_items_outer">  <label>\u7528\u6237\u540D</label><div class="b_username" ></div> </li>  <li class="b_u_items_outer">    <label>\u5C01\u7981\u65F6\u957F:</label>  <div class="b_block_time"> <span class="b_fixed_time">1\u5929</span>   <select class="b_select_time"> <option data-info="1">1\u5929</option> <option data-info="3">3\u5929</option><option data-info="10">10\u5929</option>  </select>  </div>   </li>  <li class="b_u_items_outer"> <label>\u5C01\u7981\u539F\u56E0:</label> <div class="b_reason_box"><ul class="b_reason_ul">   <li class="b_reason_item" data-prefix="1."></li><li class="b_reason_item" data-prefix="2."></li> <li class="b_reason_item" data-prefix="3."></li>  <li class="b_reason_item" data-prefix="4."></li>  <li class="b_reason_item" data-prefix="5."></li> <li class="b_reason_item" data-prefix="6."></li>  </ul><div class="b_reason_content">    <div class="b_reason_top">   <div class="b_top_mod_bar" > <div class="b_mod_bar"><span></span>\u4FEE\u6539</div>  <div class="b_del_bar"><span></span>\u5220\u9664</div>   </div><div class="b_top_save_bar">  <div class="b_save_bar"><span></span>\u4FDD\u5B58</div> <div class="b_cancel_bar"><span></span>\u53D6\u6D88</div></div>     </div>   <div class="b_reason_textarea">  <label for="b_user_textarea" class="b_label_tips">\u62B1\u6B49\uFF0C\u4F60\u7684\u53D1\u8D34\u64CD\u4F5C\u6216\u53D1\u8868\u8D34\u5B50\u7684\u5185\u5BB9\u8FDD\u53CD\u4E86\u672C\u5427\u7684\u5427\u89C4\uFF0C\u5DF2\u7ECF\u88AB\u5C01\u7981\uFF0C\u5C01\u7981\u671F\u95F4\u4E0D\u80FD\u5728\u672C\u5427\u7EE7\u7EED\u53D1\u8A00\u3002</label><textarea id="b_user_textarea" class="b_textarea"></textarea>      </div>    </div>   </div>   </li>   </ul>   <div class="block_btns">  <div class="block_tips"></div> <div class="b_id_btn">\u5C01\u7981ID</div> <div class="b_fixed_tips"></div>  </div> </div>',errTemplate:'<div class="block_response_info"></div> ',initial:function(e,t,a,o,n){var i=this,s=i.requireInstance("common/widget/detectManagerBlock",[]);s.doOnNotBlocked(function(){i._block(e,t,a,o,n)})},_block:function(e,t,a,o,n){this.config={block_reason_list:"/pmc/tpl",add_block_reason:"/pmc/tpl",modify_block_reason:"/pmc/tpl",del_block_reason:"/pmc/tpl",save_block_id:"/pmc/blockid"},this.blockList=$.extend(!0,[],e),this.power=t,this.forum=a,this.tbs=o,this.sucCallback=n,this.user_num=this.blockList.length,this.add_new_temp="<span>+</span>\u65B0\u5EFA\u6A21\u677F",this.textarea_maxlength=200,this.curr_pattern="",this.$blockPopWinHtml=$(this.template),this.$responseBlockInfo=$(this.errTemplate),this.paramValidate(),this.setBlockDefaultInfo(),this.textareaKeyupEvtBind(),this.blockIDbtnEvtBind(),this.tabSwitchEvtBind(),this.textareaFocusEvtBind(),this.textareaBlurEvtBind(),this.logicalControl(),this.blockDialog.show(),this.trigger("show")},duplicateRemoval:function(e){for(var t={},a=[],o=e.length,n=0;o>n;n++)t[e[n]]||(a.push(e[n]),t[e[n]]=!0);return a},paramValidate:function(){var e=this;null===e.power.ban_id||null===e.power.ban_ip||""===e.power.ban_id||""===e.power.ban_ip?(this.blockDialog=new $.dialog({title:"\u5C01\u7981\u63D0\u793A",width:"556",html:this.$responseBlockInfo}),e.$responseBlockInfo.find(".block_response_info").html("\u4F60\u6CA1\u6709\u5C01\u7981\u64CD\u4F5C\u6743\u9650\uFF01")):e.blockDialog=new $.dialog({title:"\u5C01\u7981\u64CD\u4F5C",width:"556",html:this.$blockPopWinHtml}),e.blockDialog.bind("onclose",function(){e.user_num>1&&$.tb.location.reload()}),e.blockDialog.bind("onhide",function(){e.user_num>1&&$.tb.location.reload()})},insertDefaultNewTemp:function(){var e=this,t=0,a=0,o=!1;if($(".b_reason_ul .b_reason_item").each(function(e,o){$(o).hasClass("b_add_new_reason")||($(o).data("reasonId")&&""!=$(o).data("reasonId")&&$(o).data("isBuiltinTpl")===!1&&t++,a++)}),6>t){$(".b_reason_ul .b_reason_item").each(function(t,n){o&&$(".b_reason_ul .b_reason_item").eq(t).remove(),""!==$(n).html().trim()||o||($(n).tbattr("data-is-builtin-tpl",!1).tbattr("data-prefix",a),$(n).addClass("b_add_new_reason").append(e.add_new_temp),o=!0)});var n=$(".b_reason_ul .b_add_new_reason").length;0==n&&$(".b_reason_ul").append('<li class="b_reason_item b_add_new_reason" data-is-builtin-tpl="false" data-prefix="'+(a+1)+'.">'+e.add_new_temp+"</li>")}},setTextareaVal:function(){var e=this;0!=e.$blockPopWinHtml.find(".b_reason_curr").length||e.$blockPopWinHtml.find(".b_reason_item").eq(0).hasClass("b_add_new_reason")||e.$blockPopWinHtml.find(".b_reason_item").eq(0).addClass("b_reason_curr");var t=e.$blockPopWinHtml.find(".b_reason_curr");if(t.hasClass("b_add_new_reason"))e.$blockPopWinHtml.find(".b_textarea").val("");else if(t.html()){var a=t.html(),o=2;t.data("prefix")>=10&&(o=3),e.$blockPopWinHtml.find(".b_textarea").val(a.substr(o,a.length))}},noReasonCantModify:function(){var e=0,t=this;t.$blockPopWinHtml.find(".b_reason_item").each(function(t,a){"undefined"!=typeof $(a).tbattr("data-reason-id")&&e++}),0==e&&(t.$blockPopWinHtml.find(".b_add_new_reason").removeClass("b_reason_curr"),t.$blockPopWinHtml.find(".b_reason_top").hide(),""==t.$blockPopWinHtml.find(".b_textarea").val()&&t.$blockPopWinHtml.find(".b_label_tips").show())},setBlockReasonList:function(){var e=this,t=!1;$.ajax({url:e.config.block_reason_list,type:"POST",dataType:"json",data:{fid:e.forum.forum_id,tbs:e.tbs},success:function(a){if("0"==a.errno){var o=a.data;if(0==o.length)e.$blockPopWinHtml.find(".b_label_tips").show(),e.$blockPopWinHtml.find(".b_textarea").val(""),e.noReasonCantModify(),e.$blockPopWinHtml.find(".b_reason_item").each(function(e,t){$(t).removeAttr("data-reason-id").html("")}),e.$blockPopWinHtml.find(".b_reason_item").removeClass("b_reason_curr");else{var n=e.$blockPopWinHtml.find(".b_reason_item").length,i=o.length,s=i-n;if(s>0){for(var l=n,r="";s>0;)r+='<li class="b_reason_item" data-prefix="'+(l+1)+'." ></li>',l++,s--;$(".b_reason_ul").append(r)}e.$blockPopWinHtml.find(".b_reason_item").each(function(a,n){0==a&&(e.curr_pattern="undefined"!=typeof o[a]?"modify":"add"),"undefined"!=typeof o[a]?$(n).html(a+1+"."+o[a].template_text).tbattr("data-reason-id",o[a].template_id).tbattr("data-is-builtin-tpl",o[a].is_builtin_tpl).tbattr("data-prefix",a+1):$(n).html(""),$(n).hasClass("b_add_new_reason")&&!t&&($(n).removeClass("b_add_new_reason"),t=!0)}),e.$blockPopWinHtml.find(".b_reason_item").each(function(t,a){""==$(a).html()&&e.$blockPopWinHtml.find(".b_reason_item").eq(t).remove(),$(a).hasClass("b_reason_curr")&&($(a).data("isBuiltinTpl")?$(".b_top_mod_bar .b_del_bar").hide():$(".b_top_mod_bar .b_del_bar").show())})}(e.power.ban_id&&e.power.ban_ip||e.power.can_filter_id&&e.power.can_filter_ip)&&e.insertDefaultNewTemp(),e.setTextareaVal()}else e.setResponseTips(2,"\u83B7\u53D6\u5C01\u7981\u539F\u56E0\u5217\u8868\u5931\u8D25!")},error:function(t){e.setNewDialogRespTips(2,t)}})},setBlockDefaultInfo:function(){for(var e=this,t=[],a=0;a<e.blockList.length;++a)-1===$.inArray(e.blockList[a].username,t)&&t.push(e.blockList[a].username);t=t.join(),e.$blockPopWinHtml.find(".b_username").html($.tb.subByte(t,30,"\u2026")),e.setBlockReasonList()},textareaKeyupEvtBind:function(){var e=this;e.$blockPopWinHtml.find(".b_textarea").on("keyup",function(){var t=$(this).val(),a=$.tb.getByteLength(t),o=e.$blockPopWinHtml.find(".block_tips");o.css({display:"block"}),e.textarea_maxlength-a>0?($(this).hasClass("input_right_pattern")||$(this).addClass("input_right_pattern"),$(this).removeClass("input_error_pattern"),o.html("\u8FD8\u53EF\u8F93\u5165"+parseInt((e.textarea_maxlength-a)/2)+"\u5B57").addClass("b_green")):($(this).hasClass("input_error_pattern")||$(this).addClass("input_error_pattern"),$(this).removeClass("input_right_pattern"),o.removeClass("b_green").addClass("b_red").html("\u5DF2\u8D85\u51FA"+parseInt(parseInt((a-e.textarea_maxlength)/2)+1)+"\u5B57"))})},textareaFocusEvtBind:function(){var e=this;e.$blockPopWinHtml.on("focus.showEditor",".b_textarea",function(){e.curr_pattern="add",e.toogleToolBar(),e.$blockPopWinHtml.find(".block_tips").html("").removeClass("b_red,b_green"),e.$blockPopWinHtml.find(".b_label_tips").css({display:"none"}),e.power.ban_id&&e.power.ban_ip||e.power.can_filter_id&&e.power.can_filter_ip?e.$blockPopWinHtml.find(".b_reason_top").show():e.$blockPopWinHtml.find(".b_reason_top").hide()})},textareaBlurEvtBind:function(){var e=this;e.$blockPopWinHtml.on("click",function(t){var a=$(t.target);if(0==a.closest(".b_reason_box").length){e.curr_pattern="modify",e.toogleToolBar(),0==e.$blockPopWinHtml.find(".b_reason_curr").length&&e.$blockPopWinHtml.find(".b_reason_top").hide();var o="undefined"==e.power.can_filter_id?!e.power.ban_id||!e.power.ban_ip:!e.power.can_filter_id||!e.power.can_filter_ip;o&&(""==e.$blockPopWinHtml.find(".b_textarea").val()?e.$blockPopWinHtml.find(".b_label_tips").show():e.$blockPopWinHtml.find(".b_label_tips").hide()),e.$blockPopWinHtml.find(".block_tips").html(""),e.noReasonCantModify()}})},modifyTextareaCon:function(){var e=this;e.$blockPopWinHtml.find(".b_mod_bar").on("click",function(){e.$blockPopWinHtml.find(".b_textarea").trigger("focus")})},deleteTextareaCon:function(){var e=this;e.$blockPopWinHtml.find(".b_del_bar").on("click",function(){if("undefined"==typeof e.$blockPopWinHtml.find(".b_reason_curr").tbattr("data-reason-id")||e.$blockPopWinHtml.find(".b_reason_curr").hasClass("b_add_new_reason")||e.$blockPopWinHtml.find(".b_reason_curr").data("isBuiltinTpl"))return!1;var t={op:"del",id:e.$blockPopWinHtml.find(".b_reason_curr").tbattr("data-reason-id"),fid:e.forum.forum_id,tbs:e.tbs};$.ajax({url:e.config.del_block_reason,type:"POST",dataType:"json",data:t,success:function(t){"0"==t.errno?(e.$blockPopWinHtml.find(".b_reason_curr").removeAttr("data-reason-id"),e.setBlockReasonList(),e.setResponseTips(1,"\u5220\u9664\u6210\u529F\uFF01")):e.setResponseTips(2,"\u5220\u9664\u5931\u8D25!")},error:function(t){e.setNewDialogRespTips(2,t)}})})},toogleToolBar:function(){var e=this;e.power.ban_id&&e.power.ban_ip||e.power.can_filter_id&&e.power.can_filter_ip?(e.$blockPopWinHtml.find(".b_reason_top").css({display:"block"}),"modify"==this.curr_pattern?(e.$blockPopWinHtml.find(".b_top_mod_bar").css({display:"block"}),e.$blockPopWinHtml.find(".b_top_save_bar").css({display:"none"})):"add"==this.curr_pattern&&(e.$blockPopWinHtml.find(".b_top_mod_bar").css({display:"none"}),e.$blockPopWinHtml.find(".b_top_save_bar").css({display:"block"}))):e.$blockPopWinHtml.find(".b_reason_top").css({display:"none"})},saveTextareaCon:function(){var e,t=this,a={},o=t.$blockPopWinHtml.find(".b_textarea");t.$blockPopWinHtml.find(".b_save_bar").on("click",function(){if(!t.checkCanbeBlocked())return!1;var n=t.$blockPopWinHtml.find(".b_reason_curr").hasClass("b_add_new_reason")||0==t.$blockPopWinHtml.find(".b_reason_curr").length;n?(a={op:"add",tbs:t.tbs,fid:t.forum.forum_id,ie:"gbk",text:$.tb.escapeHTML(o.val())},e=t.config.add_block_reason):(a={op:"update",tbs:t.tbs,fid:t.forum.forum_id,ie:"gbk",text:$.tb.escapeHTML(t.$blockPopWinHtml.find(".b_textarea").val()),id:t.$blockPopWinHtml.find(".b_reason_curr").tbattr("data-reason-id")},e=t.config.modify_block_reason),$.ajax({url:e,type:"POST",dataType:"json",data:a,success:function(e){t.curr_pattern="modify",t.toogleToolBar(),"0"==e.errno?(t.setBlockReasonList(),t.setResponseTips(1,"\u4FDD\u5B58\u6210\u529F\uFF01"),n?$.stats.track("AddReasonItem","uegCount","bawuAppeal","success"):$.stats.track("modifyReasonItem"+$(".b_reason_curr").index(),"uegCount","bawuAppeal","success")):t.setResponseTips(2,"\u4FDD\u5B58\u5931\u8D25!")},error:function(e){t.setNewDialogRespTips(2,e)}})})},cancelTextareaCon:function(){var e=this;e.$blockPopWinHtml.find(".b_cancel_bar").on("click",function(){e.setTextareaVal(),e.curr_pattern="modify",e.toogleToolBar(),e.$blockPopWinHtml.find(".b_reason_curr").hasClass("b_add_new_reason")&&e.$blockPopWinHtml.find(".b_reason_item").siblings().removeClass("b_reason_curr").end().eq(0).addClass("b_reason_curr")})},getSavesData:function(e){var t=this,a={};a.day="block"===t.$blockPopWinHtml.find(".b_fixed_time").css("display")?"1":t.$blockPopWinHtml.find(".b_select_time").find("option:selected").tbattr("data-info"),a.fid=t.forum.forum_id,a.tbs=t.tbs,a.ie="gbk",a.user_name=[],a.pid=[];for(var o=0;o<t.blockList.length;++o){var n=t.blockList[o];-1===$.inArray(n.username,a.user_name)&&a.user_name.push($.tb.escapeHTML(n.username)),n.pid&&a.pid.push(n.pid)}var i=t.$blockPopWinHtml.find(".b_textarea"),s=0;return t.$blockPopWinHtml.find(".b_reason_item").each(function(e,t){"undefined"==typeof $(t).tbattr("data-reason-id")&&s++}),a.reason=6==s&&""===i.val().trim()?t.$blockPopWinHtml.find(".b_label_tips").html():t.$blockPopWinHtml.find(".b_textarea").val(),a.reason=$.tb.escapeHTML(a.reason),2===e&&(a.ip="1"),a},checkCanbeBlocked:function(){var e=this,t=e.$blockPopWinHtml.find(".b_textarea"),a=0;return t.hasClass("input_error_pattern")||""===t.val().trim()?(e.$blockPopWinHtml.find(".b_reason_item").each(function(e,t){"undefined"==typeof $(t).tbattr("data-reason-id")&&a++}),6==a?!0:(e.$blockPopWinHtml.find(".b_textarea").trigger("focus"),t.hasClass("input_error_pattern")?e.setResponseTips(2,"\u5C01\u7981\u539F\u56E0\u4E0D\u80FD\u8D85\u51FA100\u5B57"):e.setResponseTips(2,"\u5C01\u7981\u539F\u56E0\u4E0D\u80FD\u4E3A\u7A7A"),!1)):!0},blockIDbtnEvtBind:function(){var e=this;e.$blockPopWinHtml.find(".b_id_btn").on("click",function(){if(!e.checkCanbeBlocked())return!1;var t=e.getSavesData(1),a=function(o){t=o?$.extend(t,o):t,$.ajax({url:e.config.save_block_id,type:"POST",dataType:"json",data:t,success:function(t){"0"==t.errno?(e.setNewDialogRespTips(1,"\u5C01\u7981\u6210\u529F\uFF01"),(e.sucCallback||"function"==typeof e.sucCallback)&&e.sucCallback()):224011==t.errno?e.getCaptcha(t,a,e):e.setNewDialogRespTips(2,"\u5C01\u7981\u5931\u8D25\uFF01")},error:function(t){e.setNewDialogRespTips(2,t)}})};a()})},getCaptcha:function(e,t,a){var o=this;a=a||o;var n=PageData.forum_name||(PageData.forum?PageData.forum.forum_name:""),i=PageData.forum_id||(PageData.forum?PageData.forum.forum_id:"");this.requireInstanceAsync("common/component/CaptchaDialog",[{title:"\u5C01\u7981",message:"\u5C01\u7981\u4E86\u90A3\u4E48\u591A\u4EBA\uFF0C\u8F93\u4E2A\u7801\u9A8C\u8BC1\u4E0B\u8EAB\u4EFD\u5427~",vCode:e.res.captcha_vcode_str,vCodeType:e.res.captcha_code_type,forumName:n,forumId:i,postType:"thread",paramsCallback:function(){return{}}}],function(e){o.captchaDialog=e,e.bind("onclose",function(){return e.hide(),!1}),e.bind("onaccept",function(){var o={vcode:e.getInputValue(),vcode_md5:e.getVCode()};t.call(a,o)}),e.show()})},setResponseTips:function(e,t){var a=this,o=a.$blockPopWinHtml.find(".block_tips");1==e?o.removeClass("b_red").addClass("b_green").html(t):o.removeClass("b_green").addClass("b_red").html(t),window.setTimeout(function(){o.hasClass("b_green")&&o.html("")},2e3)},setNewDialogRespTips:function(e,t){var a=this,o=a.$blockPopWinHtml;o.html(a.$responseBlockInfo),1==e?o.find(".block_response_info").removeClass("b_red").addClass("b_green").html(t):o.find(".block_response_info").removeClass("b_green").addClass("b_red").html(t),window.setTimeout(function(){a.blockDialog.hide(),a.user_num>1&&$.tb.location.reload(),a.trigger("hide")},2e3)},tabSwitchEvtBind:function(){var e=this;e.$blockPopWinHtml.on("click",".b_reason_item",function(){return $(this).data("isBuiltinTpl")?$(".b_top_mod_bar .b_del_bar").hide():$(".b_top_mod_bar .b_del_bar").show(),"undefined"!=typeof $(this).tbattr("data-reason-id")||$(this).hasClass("b_add_new_reason")?("none"==e.$blockPopWinHtml.find(".b_reason_top").css("display")&&e.$blockPopWinHtml.find(".b_reason_top").css({display:"block"}),$(this).siblings(".b_reason_item").removeClass("b_reason_curr").end().addClass("b_reason_curr"),$(this).hasClass("b_add_new_reason")?(e.curr_pattern="add",e.$blockPopWinHtml.find(".b_textarea").trigger("focus")):(e.curr_pattern="modify",$.stats.track("reasonItem"+$(this).index(),"uegCount","bawuAppeal","click")),e.setTextareaVal(),e.toogleToolBar(),void 0):!1})},logicalControl:function(){var e=this,t=e.$blockPopWinHtml.find(".b_fixed_time"),a=e.$blockPopWinHtml.find(".b_select_time");e.$blockPopWinHtml.find(".b_reason_item").eq(0).addClass("b_reason_curr"),e.power.ban_id&&e.power.ban_ip||e.power.can_filter_id&&e.power.can_filter_ip?(e.$blockPopWinHtml.find(".b_fixed_tips").html("\u63D0\u793A\uFF1A\u5927\u5427\u4E3B\u53EF\u7F16\u8F91\u539F\u56E0\u6A21\u7248\uFF0C\u4FDD\u5B58\u540E\u5C0F\u5427\u4E3B\u53EF\u76F4\u63A5\u4F7F\u7528\u6587\u6848~"),e.user_num>1?(t.css({display:"block"}),a.css({display:"none"})):1==e.user_num&&(t.css({display:"none"}),a.css({display:"block"})),e.$blockPopWinHtml.find(".b_reason_top,.b_top_mod_bar").css({display:"block"}),e.modifyTextareaCon(),e.deleteTextareaCon(),e.saveTextareaCon(),e.cancelTextareaCon()):(e.$blockPopWinHtml.find(".b_fixed_tips").html("\u63D0\u793A\uFF1A\u539F\u56E0\u6A21\u7248\u53EA\u6709\u5927\u5427\u4E3B\u53EF\u4EE5\u7F16\u8F91\uFF0C\u5C0F\u5427\u4E3B\u4E5F\u53EF\u76F4\u63A5\u5728\u8F93\u5165\u6846\u4E2D\u5199\u4E0A\u5185\u5BB9\u5E76\u5B8C\u6210\u5C01\u7981~"),t.css({display:"block"}),a.css({display:"none"}))}}});_.Module.define({path:"frs/widget/ThreadBatchDelete",requires:["common/widget/BlockUser","common/widget/detectManagerBlock"],sub:{hasDom:!1,initial:function(){try{var e=this,t=e.requireInstance("common/widget/detectManagerBlock",[]);$(".j_btn_batch_delete").click(function(){try{e.switchMode()}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/thread_batch_delete/thread_batch_delete.js",method:"",ln:16}),t}}),"true"==$.cookie("batch_delete_mode")&&t.doOnNotBlocked(function(){$(".j_btn_batch_delete").click()},!1),$(document).bind("listReload",function(){"true"==$.cookie("batch_delete_mode")?(e.initStatus(),t.doOnNotBlocked(function(){e.switchMode()},!1)):e.initStatus()})}catch(a){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/thread_batch_delete/thread_batch_delete.js",method:"",ln:32}),a}},initStatus:function(){var e=this;e.hasDom=!1,$(".j_batch_delete").remove(),$(".j_batch_delete_btn_area").remove(),$(".j_btn_batch_delete span").html("\u7BA1\u7406\u6A21\u5F0F"),$(".th_footer_2").show()},addCheckedBox:function(){var e=$(".j_btn_batch_delete span");"\u666E\u901A\u6A21\u5F0F"==$.trim(e.html())&&$(".j_thread_list").each(function(e,t){if("true"!=$(this).tbattr("addcheckbox")){var a=$(t).getData()||{};a.reply_num>1e7||1==a.is_good||1==a.is_bakan||1==a.is_protal||1==a.is_top||1==a.is_membertop||$(t).append("<div class='batch_delete j_batch_delete'><input type='checkbox' class='batch_delete_select j_batch_delete_select'/><span class='batch_delete_text'>\u52FE\u9009</span></div>"),$(this).tbattr("addcheckbox","true")}})},createChooseNode:function(){var e=this;e.hasDom=!0,e.addCheckedBox(),$(".th_footer_2").after("<div class='batch_delete_btn_area j_batch_delete_btn_area clearfix'><button type='button' class='btn_sub deleteThreads btn_small j_deleteThreads'>\u5220\u9664</button><button class='btn_sub btn_small j_deleteAndBan'>\u5220\u9664\u5E76\u5C01\u7981\u697C\u4E3B\u4E00\u5929</button></div>"),$(".th_footer_2").hide(),$(".j_deleteThreads").click(function(){try{e.deleteThread(0)}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/thread_batch_delete/thread_batch_delete.js",method:"",ln:71}),t}}),$(".j_deleteAndBan").click(function(){try{e.deleteThread(1)}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/thread_batch_delete/thread_batch_delete.js",method:"",ln:74}),t}})},switchMode:function(){var e=this,t=e.requireInstance("common/widget/detectManagerBlock",[]);t.doOnNotBlocked(function(){var t=$(".j_btn_batch_delete span");"\u7BA1\u7406\u6A21\u5F0F"==t.html()?(t.html("\u666E\u901A\u6A21\u5F0F"),e.intoDeleteMode()):(t.html("\u7BA1\u7406\u6A21\u5F0F"),e.intoNormalMode())})},intoDeleteMode:function(){var e=this;e.hasDom?($(".j_batch_delete").show(),$(".j_batch_delete_btn_area").show(),$(".th_footer_2").hide()):e.createChooseNode(),"false"==$.cookie("batch_delete_mode")&&$.tb.location.reload(),$.cookie("batch_delete_mode",!0,{expires:30,path:"/"})},intoNormalMode:function(){$(".j_batch_delete").hide(),$(".j_batch_delete_btn_area").hide(),$(".th_footer_2").show(),"true"==$.cookie("batch_delete_mode")&&$.tb.location.reload(),$.cookie("batch_delete_mode",!1,{expires:30,path:"/"})},deleteThread:function(e,t){var a=this,o="",d=[],c=[];$(".j_batch_delete_select:checked").each(function(e,t){var a=$(t).parent().parent(),n=a.getData();d.push({username:n.author_name,pid:n.first_post_id}),c.push(n.id),o=0==e?n.id:o+"_"+n.id});var n={fid:PageData.forum.id,tbs:PageData.tbs,tid:o,kw:PageData.forum.name,isBan:0};n=t?$.extend(n,t):n,""!=o&&$.tb.post("/f/commit/thread/batchDelete",n,function(t){if(0==t.no)e?a.requireInstanceAsync("common/widget/BlockUser",[d,{ban_id:!0,ban_ip:!0},PageData.forum,PageData.tbs,function(){$.tb.location.reload()}]):$.tb.location.reload();else if(12==t.no)$.dialog.alert("<p>\u62B1\u6B49\uFF0C\u8D26\u53F7\u5904\u4E8E\u5C01\u7981\u72B6\u6001\uFF0C\u6682\u65F6\u4E0D\u80FD\u5220\u8D34\u3002<a href='http://tieba.baidu.com/upc/userinfo?fid="+PageData.forum.id+"' target='_blank'>\u70B9\u51FB\u6B64\u5904</a>\u67E5\u770B\u8BE6\u7EC6\u4FE1\u606F</p>");else if(13==t.no)$.dialog.alert("<p>\u62B1\u6B49\uFF0C\u7F51\u7EDC\u5730\u5740\u5904\u4E8E\u5C01\u7981\u72B6\u6001\uFF0C\u6682\u65F6\u4E0D\u80FD\u5220\u8D34\u3002<a href='http://tieba.baidu.com/upc/userinfo?fid="+PageData.forum.id+"' target='_blank'>\u70B9\u51FB\u6B64\u5904</a>\u67E5\u770B\u8BE6\u7EC6\u4FE1\u606F</p>");else if(899==t.no)$.dialog.alert("<p>\u60A8\u65E0\u6CD5\u5220\u9664\u8BE5\u8D34\u5B50\u3002</p>");else if(34==t.no)$.dialog.alert("<p>\u4EB2\u7231\u7684\u5C0F\u4F19\u4F34\uFF0C\u4F60\u4ECA\u5929\u7684\u5220\u8D34\u6570\u91CF\u5DF2\u7ECF\u8FBE\u5230\u6700\u5927\u9650\u989D("+t.data.reason+"\u6761/\u5929\uFF09\uFF0C\u660E\u5929\u518D\u6765\u8BD5\u8BD5\u5427~</p>");else if(4009==t.no)$.dialog.alert("<p>\u4EB2\uFF0C\u7531\u4E8E\u672C\u8D34\u5B50\u7684\u5185\u5BB9\u975E\u5E38\u8D5E\u6240\u4EE5\u88AB\u4FDD\u62A4\u8D77\u6765\u5566\uFF0C\u60F3\u8981\u5220\u9664\u7684\u8BDD\u8BF7\u8054\u7CFB\u697C\u4E3B\u672C\u4EBA\u54E6~</p>");else{if(4011==t.no)return a._getCaptcha(t,e),void 0;""==t.error?$.dialog.alert("\u51FA\u9519\u5566\uFF0C\u5237\u65B0\u9875\u9762\u770B\u4E0B\u5427\u3002"):$.dialog.alert(t.error)}})},_getCaptcha:function(e,t){var a=this;a.requireInstanceAsync("common/component/CaptchaDialog",{title:"\u5220\u9664\u8D34\u5B50",message:"\u5220\u4E86\u90A3\u4E48\u591A\u8D34\u5B50\uFF0C\u8F93\u4E2A\u7801\u9A8C\u8BC1\u4E0B\u8EAB\u4EFD\u5427~",vCode:e.data.vcode.captcha_vcode_str,vCodeType:e.data.vcode.captcha_code_type,forumName:PageData.forum.forum_name,forumId:PageData.forum.forum_id,postType:"thread",paramsCallback:function(){return{}}},function(e){a.captchaDialog=e,e.bind("onclose",function(){return e.hide(),!1}),e.bind("onaccept",function(){var o={vcode:e.getInputValue(),vcode_md5:e.getVCode()};a.deleteThread.call(a,t,o)}),e.show()})}}});_.Module.define({path:"bawu/widget/manager_apply_post",sub:{_managerErrorMap:{170001:"\u672A\u6EE1\u8DB3\u5427\u4E3B\u7533\u8BF7\u6761\u4EF6\u3002",170002:"\u62B1\u6B49\uFF0C\u7533\u8BF7\u672C\u5427\u5427\u4E3B\uFF0C\u5427\u5185\u4F1A\u5458\u7B49\u7EA7\u4E0D\u5F97\u4F4E\u4E8E3\u7EA7\u3002",170003:"\u62B1\u6B49\uFF0C\u60A8\u8FD8\u672A\u5173\u6CE8\u672C\u5427\u3002",170004:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u6682\u65F6\u4E0D\u63A5\u53D7\u5427\u4E3B\u7533\u8BF7\u3002",170005:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u4E09\u4E2A\u5427\u4E3B\u804C\u4F4D\u5DF2\u6EE1\u3002",170006:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u4E09\u4E2A\u5427\u4E3B\u804C\u4F4D\u5DF2\u6EE1\u6216\u8BE5\u5427\u5DF2\u6709\u5B9E\u4E60\u5427\u4E3B\u3002",170007:"\u62B1\u6B49\uFF0C\u60A8\u5DF2\u62C5\u4EFB\u4E09\u4E2A\u5427\u7684\u5427\u4E3B\u804C\u4F4D\uFF0C\u4E0D\u80FD\u518D\u6B21\u7533\u8BF7\u3002",170008:"\u62B1\u6B49\uFF0C\u8BE5\u6761\u7533\u8BF7\u4FE1\u606F\u5DF2\u5904\u7406\u5B8C\u6BD5\uFF0C\u65E0\u9700\u91CD\u590D\u63D0\u4EA4\u5904\u7406\u3002",170009:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u6682\u65E0\u7B26\u5408\u6761\u4EF6\u7684\u7533\u8BF7\u4FE1\u606F\u3002",170010:"\u62B1\u6B49\uFF0C\u8BE5\u6761\u7533\u8BF7\u4FE1\u606F\u5DF2\u5904\u7406\u5B8C\u6BD5\uFF0C\u65E0\u9700\u91CD\u590D\u63D0\u4EA4\u5904\u7406\u3002",170011:"\u62B1\u6B49\uFF0C\u60A8\u7684\u7533\u8BF7\u4FE1\u606F\u5DF2\u4E8E\u4ECA\u5929\u88AB\u53D7\u7406\uFF0C24\u5C0F\u65F6\u5185\u4E0D\u53EF\u518D\u6B21\u7533\u8BF7\u3002",170012:"\u62B1\u6B49\uFF0C\u60A8\u5DF2\u63D0\u4EA4\u7684\u7533\u8BF7\u4FE1\u606F\u6B63\u5728\u5BA1\u6838\u4E2D\uFF0C\u4E0D\u80FD\u91CD\u590D\u63D0\u4EA4\u7533\u8BF7\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85\u3002",170013:"\u62B1\u6B49\uFF0C\u60A8\u5DF2\u662F\u8BE5\u5427\u5427\u4E3B\uFF0C\u4E0D\u53EF\u91CD\u590D\u7533\u8BF7\u3002",170014:"\u62B1\u6B49\uFF0C\u81EA\u8BE5\u5427\u8F9E\u804C\u5427\u4E3B\u6743\u9650\u4E00\u4E2A\u6708\u5185\u4E0D\u53EF\u518D\u6B21\u7533\u8BF7\u8BE5\u5427\u5427\u4E3B\u3002",170015:"\u62B1\u6B49\uFF0C\u60A8\u4E8E\u8FD1\u671F\u88AB\u64A4\u9500\u8BE5\u5427\u5427\u4E3B\u6743\u9650\uFF0C60\u5929\u5185\u4E0D\u53EF\u518D\u6B21\u7533\u8BF7\u3002",170016:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u5DF2\u6709\u5427\u4E3B\uFF0C\u6682\u4E0D\u63A5\u53D7\u5B9E\u4E60\u5427\u4E3B\u7533\u8BF7\u3002",170017:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u6682\u4E0D\u63A5\u53D7\u5B9E\u4E60\u5427\u4E3B\u7533\u8BF7\u3002",170018:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u6682\u4E0D\u63A5\u53D7\u5B9E\u4E60\u5427\u4E3B\u7533\u8BF7\u3002",170019:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u6682\u4E0D\u63A5\u53D7\u5B9E\u4E60\u5427\u4E3B\u7533\u8BF7\u3002",170020:"\u62B1\u6B49\uFF0C\u60A8\u7684ip\u4E0E\u5F53\u524D\u5427\u4E3B\u76F8\u540C\u6216\u8FD1\u4F3C\uFF0C\u8BF7\u60A8\u66F4\u6362ip\u540E\u91CD\u65B0\u7533\u8BF7\u3002\u8BF7\u4E0D\u8981\u7528\u591A\u4E2A\u5E10\u53F7\u62C5\u4EFB\u540C\u4E00\u4E2A\u5427\u7684\u5427\u4E3B\u804C\u4F4D\u3002",170021:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u5427\u4E3B\u4E3A\u5B9E\u4E60\u5427\u4E3B\uFF0C\u6682\u4E0D\u63A5\u53D7\u5427\u4E3B\u7533\u8BF7\u3002\u8BF7\u60A8\u4E8E\u5B9E\u4E60\u5427\u4E3B\u8F6C\u6B63\u6216\u8005\u8BE5\u5427\u65E0\u5427\u4E3B\u65F6\u518D\u6B21\u7533\u8BF7\u3002",220012:"\u62B1\u6B49\uFF0C\u60A8\u7684\u5E10\u53F7\u88AB\u5C01\u7981\uFF0C\u6682\u65F6\u65E0\u6CD5\u7533\u8BF7\u5427\u4E3B\u3002",250114:"\u62B1\u6B49\uFF0C\u60A8\u6CA1\u6709\u64CD\u4F5C\u6743\u9650\u3002",110000:"\u62B1\u6B49\uFF0C\u60A8\u8FD8\u672A\u767B\u5F55\u8D34\u5427\uFF0C\u8BF7\u60A8\u767B\u5F55\u540E\u91CD\u65B0\u64CD\u4F5C\u3002",110003:"\u5185\u90E8\u9519\u8BEF",210009:"\u53C2\u6570\u9519\u8BEF",210011:"\u6821\u9A8C\u5931\u8D25"},_assistErrorMap:{170001:"\u672A\u6EE1\u8DB3\u5C0F\u5427\u4E3B\u7533\u8BF7\u6761\u4EF6\u3002",170002:"\u62B1\u6B49\uFF0C\u7533\u8BF7\u672C\u5427\u5C0F\u5427\u4E3B\uFF0C\u5427\u5185\u4F1A\u5458\u7B49\u7EA7\u4E0D\u5F97\u4F4E\u4E8E3\u7EA7\u3002",170003:"\u62B1\u6B49\uFF0C\u60A8\u8FD8\u672A\u5173\u6CE8\u672C\u5427\u3002",170004:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u6682\u65F6\u4E0D\u63A5\u53D7\u5C0F\u5427\u4E3B\u7533\u8BF7\u3002",170005:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u5C0F\u5427\u4E3B\u804C\u4F4D\u5DF2\u6EE1\u3002",170006:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u6CA1\u6709\u5427\u4E3B\uFF0C\u6682\u65F6\u4E0D\u63A5\u53D7\u5C0F\u5427\u4E3B\u7533\u8BF7\u3002",170007:"\u62B1\u6B49\uFF0C\u60A8\u62C5\u4EFB\u5C0F\u5427\u4E3B\u804C\u4F4D\u7684\u540D\u989D\u5DF2\u6EE1\uFF0C\u4E0D\u80FD\u518D\u6B21\u7533\u8BF7\u3002",170008:"\u62B1\u6B49\uFF0C\u8BE5\u6761\u7533\u8BF7\u4FE1\u606F\u5DF2\u5904\u7406\u5B8C\u6BD5\uFF0C\u65E0\u9700\u91CD\u590D\u63D0\u4EA4\u5904\u7406\u3002",170009:"\u62B1\u6B49\uFF0C\u8BE5\u5427\u6682\u65E0\u7B26\u5408\u6761\u4EF6\u7684\u7533\u8BF7\u4FE1\u606F\u3002",170010:"\u62B1\u6B49\uFF0C\u8BE5\u6761\u7533\u8BF7\u4FE1\u606F\u5DF2\u5904\u7406\u5B8C\u6BD5\uFF0C\u65E0\u9700\u91CD\u590D\u63D0\u4EA4\u5904\u7406\u3002",170011:"\u62B1\u6B49\uFF0C\u60A8\u7684\u7533\u8BF7\u4FE1\u606F\u5DF2\u4E8E\u4ECA\u5929\u88AB\u53D7\u7406\uFF0C24\u5C0F\u65F6\u5185\u4E0D\u53EF\u518D\u6B21\u7533\u8BF7\u3002",170012:"\u62B1\u6B49\uFF0C\u60A8\u5DF2\u63D0\u4EA4\u7684\u7533\u8BF7\u4FE1\u606F\u6B63\u5728\u5BA1\u6838\u4E2D\uFF0C\u4E0D\u80FD\u91CD\u590D\u63D0\u4EA4\u7533\u8BF7\uFF0C\u8BF7\u60A8\u8010\u5FC3\u7B49\u5F85\u3002",170013:"\u62B1\u6B49\uFF0C\u60A8\u5DF2\u662F\u8BE5\u5427\u5427\u4E3B\uFF0C\u4E0D\u53EF\u91CD\u590D\u7533\u8BF7\u3002",170025:"\u62B1\u6B49\uFF0C\u60A8\u5DF2\u662F\u8BE5\u5427\u5C0F\u5427\u4E3B\uFF0C\u4E0D\u53EF\u91CD\u590D\u7533\u8BF7\u3002",220012:"\u62B1\u6B49\uFF0C\u60A8\u7684\u5E10\u53F7\u88AB\u5C01\u7981\uFF0C\u6682\u65F6\u65E0\u6CD5\u7533\u8BF7\u5C0F\u5427\u4E3B\u3002",250114:"\u62B1\u6B49\uFF0C\u60A8\u6CA1\u6709\u64CD\u4F5C\u6743\u9650\u3002",110000:"\u62B1\u6B49\uFF0C\u60A8\u8FD8\u672A\u767B\u5F55\u8D34\u5427\uFF0C\u8BF7\u60A8\u767B\u5F55\u540E\u91CD\u65B0\u64CD\u4F5C\u3002",110003:"\u5185\u90E8\u9519\u8BEF",210009:"\u53C2\u6570\u9519\u8BEF",210011:"\u6821\u9A8C\u5931\u8D25"},initial:function(){var t=this;t._wrap=$("body"),t.bindEvents(),t.requireInstanceAsync("ueglibs/widget/Ban",[],function(a){t._managerErrorMap["220012"]=a.render("forumManagerApply"),t._assistErrorMap["220012"]=a.render("forumManagerApply")})},bindEvents:function(){var t=this;this._wrap.delegate(".j_btn_apply_manager","click",function(){return t.isLogin()&&t.managerApply(),!1}),this._wrap.delegate(".j_btn_apply_assist","click",function(){return t.isLogin()&&t.assistApply(),!1})},isLogin:function(){return PageData.user.is_login?PageData.user.no_un?(TbCom.process("User","buildUnameFrame"),!1):!0:(this.requireInstanceAsync("common/widget/LoginDialog",["","userBar"]),!1)},managerApply:function(){var t,a=this,i="";0==PageData.forum.is_key_op&&0==PageData.forum.mgr_num?(t=!0,i="/managerapply/preSubmitIntern"):(t=!1,i="/managerapply/preSubmit");var s=i+"?forum_id="+PageData.forum.id+"&kw="+PageData.forum.name_encode+"&t="+(new Date).getTime().toString(32);$.ajax({type:"GET",url:s,async:!1,success:function(i){var s=$.json.decode(i);if(0===s.errno)a.openApplyLink(t);else{var e=a._managerErrorMap[s.errno];e&&""!=e||(e="\u672A\u77E5\u9519\u8BEF"),170001!==s.errno||t?170001===s.errno&&t&&(e="\u62B1\u6B49\uFF0C\u7533\u8BF7\u672C\u5427\u5B9E\u4E60\u5427\u4E3B\u9700\u8FBE\u5230\u5982\u4E0B\u6761\u4EF6\uFF1A\u53D1\u8A00\u6570\u4E0D\u5F97\u5C11\u4E8E10\u8D34\u3002"):e="\u62B1\u6B49\uFF0C\u7533\u8BF7\u672C\u5427\u5427\u4E3B\u9700\u8FBE\u5230\u5982\u4E0B\u6761\u4EF6\uFF1A</br>\u53D1\u8A00\u6570\u4E0D\u5F97\u5C11\u4E8E"+(s.data.user_post_num||0)+"\u8D34\uFF0C\u6210\u4E3A\u4F1A\u5458\u5929\u6570\u4E0D\u5F97\u5C11\u4E8E"+(s.data.member_days||0)+"\u5929\u3002</br>\u5F53\u524D\u53D1\u8D34\u6570\uFF1A"+(s.data.cur_user_post_num||0)+"\uFF0C\u5DF2\u7ECF\u6210\u4E3A\u4F1A\u5458\u5929\u6570\uFF1A"+(s.data.cur_member_days||0)+"\u3002";var n='<div class="apply_manager" style="text-align:center;margin:20px auto;"><p class="ui_text_emphasize">'+e+'</p><p style="padding:5px 0 10px;text-align:center;"><input id="forum_info_dialog_close" type="button" onclick="return false;" class="close_btn" value="\u786E \u5B9A" style="width:75px;" /></p></div>';a._tip_dialog=$.dialog.open(n,{title:"\u7533\u8BF7\u5427\u4E3B",width:470,height:134}),$("#forum_info_dialog_close").bind("click",function(){a._tip_dialog.close()})}}})},openApplyLink:function(t){var a=t?"/managerapply/applyIntern":"/managerapply/apply",i=a+"?forum_id="+PageData.forum.id+"&kw="+PageData.forum.name_url;window.open(i)},assistApply:function(){var t=this;this.assistPreAjax&&this.assistPreAjax.abort(),this.assistPreAjax=$.ajax({url:"/managerapply/assist/preSubmit",type:"post",data:{forum_id:PageData.forum.forum_id,tbs:PageData.tbs},dataType:"json"}).done(function(a){0===a.errno?t.openAssitApplyDlg(a.data):t.assistMsgDialog(a.errno)})},openAssitApplyDlg:function(t){var a=['<p class="requirement_title">\u672C\u5427\u5C0F\u5427\u4E3B\u7533\u8BF7\u8981\u6C42\uFF1A</p>','<ol class="requirement_wrap">',"<li>\u672C\u5427\u7B49\u7EA7\u4E0D\u4F4E\u4E8E3\u7EA7</li>","<li>#{assist_condition}</li>","</ol>",'<p class="assist_num">\u672C\u5427\u76EE\u524D\u5DF2\u6709\u5C0F\u5427\u4E3B#{assist_cur_num}\u540D\uFF0C\u8FD8\u6709<span style="color:red;">#{assist_left_num}</span>\u4E2A\u540D\u989D</p>','<p class="apply_statement_title">\u7533\u8BF7\u611F\u8A00\uFF1A</p>','<div class="statement_wrap j_statement_wrap">','<textarea class="ui_textfield statement j_statement"></textarea>',"</div>",'<div class="btn_wrap">','<p class="error_text"></p>','<a href="#" class="ui_btn ui_btn_m submit j_submit">',"<span><em>\u7533&nbsp;\u8BF7</em></span>","</a>","</div>"].join("");this._assit_apply_dlg=new $.dialog({html:$.tb.format(a,t),title:"\u7533\u8BF7\u5C0F\u5427\u4E3B",width:550,holderClassName:"assist_apply_dlg"}),this.bindDlgEvent()},bindDlgEvent:function(){var t=this;this.j_dlg_wrap=$(".assist_apply_dlg"),this.j_statement=this.j_dlg_wrap.find(".j_statement"),this.j_dlg_wrap.find(".j_submit").bind("click",function(){return t.checkInputs()&&t.initAssistPost(),!1});var a={container:".j_statement_wrap",inputObj:".j_statement",showLimit:400,maxNum:400,numStyle:{color:"red"}};t.requireInstanceAsync("common/widget/WordLimit",[a],function(a){t.word_limit_instance=a,a.init()})},checkInputs:function(){var t=this,a=this.j_dlg_wrap.find(".error_text"),i=this.j_statement.val();return""===i?(a.html("\u7533\u8BF7\u611F\u8A00\u4E3A\u7A7A").show(),!1):t.word_limit_instance.exceed?(a.html("\u7533\u8BF7\u611F\u8A00\u5B57\u6570\u5DF2\u8D85\u4E0A\u9650").show(),!1):!0},initAssistPost:function(){var t=this,a={declaration:$.tb.escapeHTML(this.j_statement.val()),forum_id:PageData.forum.forum_id,ie:"utf-8",tbs:PageData.tbs};$.ajax({url:"/managerapply/assist/submit",type:"post",data:a,dataType:"json"}).done(function(a){0===a.errno?t.showSuccess():(t._assit_apply_dlg.close(),t.assistMsgDialog(a.errno))}).fail(function(){t._assit_apply_dlg.close(),t.assistMsgDialog("POST ERROR")})},showSuccess:function(){var t=this,a="http://tieba.baidu.com/bawu2/platform/listCandidateInfo?word="+PageData.forum.name_url,i=['<div style="margin:20px auto 0;text-align:center;height:100px;">',"<div>",'<div style="font-size:14px;font-weight:bold;"><img style="width:20px;height:20px;vertical-align:bottom;margin-right:5px;" src="/tb/static-ucenter/img/success.png">\u63D0\u4EA4\u6210\u529F\uFF0C\u5427\u4E3B\u5C06\u5C3D\u5FEB\u5904\u7406</div>','<div style="margin:10px 0;">\u60A8\u53EF\u4EE5<a href="'+a+'">\u70B9\u51FB\u67E5\u770B\u60A8\u7684\u7533\u8BF7\u4FE1\u606F>></a></div>','<a href="#" class="ui_btn ui_btn_m j_dlg_close">',"<span><em>\u786E\u5B9A</em></span>","</a>","</div>","</div>"].join("");this._assit_apply_dlg.setContent(i),this.j_dlg_wrap.addClass("no_title"),$(".j_dlg_close").click(function(){return t._assit_apply_dlg.close(),!1})},assistMsgDialog:function(t){var a=this,i=this._assistErrorMap[t];i&&""!=i||(i="\u672A\u77E5\u9519\u8BEF");var s=['<div style="margin:20px auto 0;text-align:center;height:100px;">',"<div>",'<div style="font-size:14px;font-weight:bold;">\u63D0\u4EA4\u5931\u8D25\uFF1A</div>','<div style="margin:10px 0;color:red;">'+i+"</div>",'<a href="#" class="ui_btn ui_btn_m j_dlg_close">',"<span><em>\u786E\u5B9A</em></span>","</a>","</div>","</div>"].join("");a._tip_dialog=$.dialog.open(s,{title:"\u7533\u8BF7\u5C0F\u5427\u4E3B",width:470,height:150}),$(".j_dlg_close").click(function(){return a._tip_dialog.close(),!1})}}});_.Module.define({path:"frs/widget/Zyq",sub:{initial:function(){try{$("#zyq_mod_album").length&&this.album("zyq_mod_album"),$("#zyq_mod_video").length&&this.video("zyq_mod_video"),$("#zyq_mod_friend").length&&this.friend("zyq_mod_friend"),$("#mod_stock").length&&this.stock("mod_stock"),$("#zyq .zyq_mod_link_items .j_mod_item").on("click",function(){try{$.stats.track("\u81EA\u5B9A\u4E49\u94FE\u63A5\u70B9\u51FB","\u5427\u4E3B\u914D\u7F6E\u6570\u636E\u7EDF\u8BA1","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/zyq/zyq.js",method:"",ln:20}),t}}),$("#zyq .zyq_mod_friend_items .j_mod_item").on("click",function(){try{$.stats.track("\u53CB\u60C5\u8D34\u5427\u94FE\u63A5\u70B9\u51FB","\u5427\u4E3B\u914D\u7F6E\u6570\u636E\u7EDF\u8BA1","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/zyq/zyq.js",method:"",ln:24}),t}}),$("#aside_album_good a").on("click",function(){try{$.stats.track("\u56FE\u518C\u7CBE\u9009\u94FE\u63A5\u70B9\u51FB","\u5427\u4E3B\u914D\u7F6E\u6570\u636E\u7EDF\u8BA1","frs","click")}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/zyq/zyq.js",method:"",ln:28}),t}})}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/zyq/zyq.js",method:"",ln:29}),t}},friend:function(t){var e=$("#"+t);e.delegate(".j_mod_item","mousedown",function(){var t={st_mod:"aside_friend_forum",st_type:"enterba",st_from:encodeURIComponent(PageData.product),st_uid:PageData.user.id,st_benba:encodeURIComponent(PageData.forum.name),st_goto:encodeURIComponent($(this).text())};$.tb.Stats.sendRequest("http://tb1.bdstatic.com/tb/img/hive.gif",t)})},album:function(t){var e=$("#"+t);!e.length,e.hide();var i=e.find(".alb_box_inner img:first");i.length&&i.tbattr("isrc")&&(i.bind("load",function(){resizePic_temp(this,133,170)}),i.tbattr("src",i.tbattr("isrc")))},video:function(t){if(t&&$("#"+t).length){var e=$("#"+t).tbattr("video-num");if(!(0>=e)){var i={ITEMWiDTH:120,FRAMEHWIDTH:140,SPACHEWIDTH:10,_leftPadding:0,scroll:function(){var t=document.getElementById("scrollCt"),e=document.getElementById("itemsCt");if(t&&e){var o=parseInt(e.offsetWidth),n=function(){i._leftPadding<=-o+i.FRAMEHWIDTH-5?(i._leftPadding=0,t.style.left=i._leftPadding+"px"):(i._leftPadding=i._leftPadding-2,t.style.left=i._leftPadding+"px")};o+10>=2*(i.ITEMWiDTH+i.SPACHEWIDTH)&&(timer=setInterval(n,120))}}};$(window).bind("load",i.scroll)}}},stock:function(t){t&&$("#"+t).length&&$.JsLoadManager.use("http://tb1.bdstatic.com/tb/static-frs/js/zyq_mod_frs_stock_9b8b49b.js",function(){$("#j_zyq_stock").bind("click",function(){try{changeToKChart(),Common.statistic(11)}catch(t){throw"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/zyq/zyq.js",method:"",ln:97}),t}})})}}});_.Module.define({path:"common/widget/asidead",sub:{initial:function(t,s){if(t.length>0&&t.getData()){var a=t.getData(),i=this;t.find(".aside_ad_pic").on("click",function(){i._stats(s,"\u53F3\u4FA7","\u5546\u4E1A\u63A8\u5E7F\u4F4D\u7EDF\u8BA1",a,"\u70B9\u51FB"),i._stats(s,"frs\u9875_\u53F3\u4FA7\u63A8\u5E7F_\u56FE","PC\u7AEF\u5546\u4E1A\u5316\u6E38\u620F\u7EDF\u8BA1",a,"\u70B9\u51FB")}),i._stats(s,"\u53F3\u4FA7","\u5546\u4E1A\u63A8\u5E7F\u4F4D\u7EDF\u8BA1",a,"\u5C55\u73B0"),i._stats(s,"frs\u9875_\u53F3\u4FA7\u63A8\u5E7F_\u56FE","PC\u7AEF\u5546\u4E1A\u5316\u6E38\u620F\u7EDF\u8BA1",a,"\u5C55\u73B0")}},_stats:function(t,s,a,i,_){$.stats.track(s,a,t,_,{obj_id:i.id||"",obj_name:i.title||"",obj_url:i.pic||"",obj_type:"\u6E38\u620F",obj_subtype:i.subtype||""})}}});
;_.Module.define({path:"common/widget/asidead/asidead_slide",requires:["common/component/SlideShow"],sub:{_slideConfig:{target:"#aside_ad .asidead_slidewrap",nav:"#aside_ad .asidead_navs",activeClass:"active",interval:5e3,auto:!0,prev:"#aside_ad .asidead_control_left",next:"#aside_ad .asidead_control_right",delayLoadPic:!0,slide:{speed:400}},initial:function(){console.log(9),this.use("common/component/SlideShow",this._slideConfig)}}});_.Module.define({path:"liveshow/widget/frs_aside_slide",requires:["common/component/SlideShow"],sub:{_slideConfig:{nav:".live_show_aside .page_turn",target:".live_show_aside .tbui_slideshow_container",activeClass:"turn_icon_cur",interval:2e3,auto:!0,effect:"fade"},initial:function(e){var a=this;$(".live_show_aside").delegate(".hover","mouseenter",function(){$(this).find(".zhe2").show()}).delegate(".hover","mouseleave",function(){$(this).find(".zhe2").hide()}),$(".live_show_aside").delegate(".j_aside_title, .j_photo_aside, .j_user_name, .j_tag","click",function(){$.stats.track("frs-aside-xiu8","\u79C0\u5427aside_"+e.product,e.product,"click")}),$.stats.track("\u53F3\u4FA7","\u79C0\u5427\u6A21\u5757\u5C55\u793A","","view"),a._bindEvents()},_tpl:["<dl>",'<dt class="cur">','   <a target="_blank" href="#{url}" class="j_photo_aside">','       <img src="#{pic}">',"   </a>",'   <em class="people"><i></i> #{chat_weight}</em>',"   #{is_live}","</dt>",'<dd class="name_dd j_user_name">','   <a class="name_link" target="_blank" href="#{url}" title="#{user_name}">','       <em class="name">#{user_name}</em></a>','   <em class="area"><i></i>#{address}</em>','   <a class="j_tag" target="_blank" href="#{url}">','       <em class="dashu">#{tag}</em>',"   </a>","</dd>","</dl>",'<a target="_blank" href="#{url}" class="zhe2 j_photo_aside" style="display: none;"><em></em></a>'].join(""),_buildPerTpl:function(e){for(var a="",i=0,t=5;t>i;i++){var s=e[i],l=user.myTieba,r=l.forum,_=l.product,n=s.is_live?'<em class="live">\u76F4\u64AD</em>':"",d="http://spread.xiu8.com/spreed!baiduGo.jspa?pid=1072&sid="+("frs"===_?"4":"6")+"&t=2&roomId=",o=d+s.room_id+"&fr="+_+"&fr_fname="+r.forum_name+"&ie=utf-8&fr_fid="+r.forum_id+"&ie=utf-8",c=s.chat_weight;c>1e4&&(c=Math.ceil(c/1e4)+"\u4E07"),a+=['<li class="hover">',$.tb.format(this._tpl,$.extend({},e[i],{is_live:n,url:o,chat_weight:c})),"</li>"].join("")}return a},_bindEvents:function(){var e=this;$(".j_aside_change").on("click",function(a){a.preventDefault(),$.ajax({type:"get",url:"/tbliveact/data/getLiveList?t="+1*new Date,dataType:"json"}).success(function(a){if(a&&0===a.no){var i=a.data.xiu8_live_list;$(".live_show_list").html(e._buildPerTpl(i))}})})}}});_.Module.define({path:"encourage/widget/npc_vote/npc_vote_action",sub:{initial:function(e){this._opt=e,this._bindEvents()},_bindEvents:function(){var e=this,t=this._opt.$root;t.on("click",".j-btn-vote",function(){if(!PageData.user.is_login)return e.requireInstanceAsync("common/widget/LoginDialog"),void 0;var a=$(this).data("id"),n=$(this).data("forumname");$.post("/celebrity/submit/voteNpc",{tbs:PageData.tbs,id:a},function(a){switch(a.no){case 0:t.find(".j_vote_npc_"+a.data.id).find(".j_vote_num").text(a.data.vote_num),e._success();break;case 952710:e._attention(n);break;case 11e4:e.requireInstanceAsync("common/widget/LoginDialog");break;case 952711:e._alert({msg:"\u5427\u7B49\u7EA7\u8FBE\u5230"+(a.data+1)+"\u7EA7\u624D\u80FD\u652F\u6301\u672C\u5427\u54E6"});break;case 952712:e._alert({msg:"\u60A8\u7533\u8BF7\u7684\u540D\u4EBA\u5DF2\u522B\u7533\u8BF7\u8FC7\u4E86~"});break;case 952713:e._alert({msg:"\u672C\u671F\u6295\u7968\u7ED3\u675F\uFF0C\u4E0B\u4E00\u671F\u5373\u5C06\u542F\u52A8\uFF0C\u656C\u8BF7\u671F\u5F85"});break;case 952709:e._alert({msg:"\u5F53\u524D\u7528\u6237\u4E0D\u662F\u5427\u4E3B"});break;case 65534:e._alert({msg:"\u6BCF\u5929\u53EA\u80FD\u7ED93\u4E2A\u5427\u6295\u7968 \u0CA5_\u0CA5"});break;case 65533:e._alert({msg:"\u6BCF\u5929\u53EA\u80FD\u7ED9\u4E00\u4E2A\u5427\u62951\u7968\uFF0C\u8BF7\u660E\u5929\u7EE7\u7EED\u652F\u6301"});break;case 65532:e._alert({msg:"IP\u4E00\u5929\u8D85\u8FC7500"});break;default:$.dialog.alert(a.error,{title:"\u63D0\u793A"})}})})},_success:function(){var e='<div class="npc-vote-dialog"><p>\u6295\u7968\u6210\u529F</p><div class="btn-group"><a href="/celebrity/rankHome#npc_vote" class="btn-default btn-small mr10 j-see-rank">\u67E5\u770B\u699C\u5355</a> <a href="javascript:;" class="btn-sub btn-small j_close">\u53D6 \u6D88</a></div></div>',t=this._alert({html:e});$(t.element).find(".j-see-rank").on("click",function(){t.close()})},_alert:function(e){var t=e.html||'<div class="npc-vote-dialog"><p>'+e.msg+'</p><div class="btn-group">  <a href="#" class="btn-default btn-small j_close">\u786E \u8BA4</a></div></div>',a=new $.dialog({width:380,html:t,title:"\u63D0\u793A",draggable:!1});return $(a.element).find(".j_close").on("click",function(){return a.close(),!1}),a},_attention:function(e){var t='<div class="npc-vote-dialog"><p>\u672A\u5173\u6CE8\u672C\u5427\u4E0D\u80FD\u6295\u7968\u54E6~</p><div class="btn-group"> <a href="/f?kw='+encodeURIComponent(e)+'" class="btn-default btn-small">\u53BB\u5173\u6CE8</a></div></div>';new $.dialog({width:350,html:t,title:"\u63D0\u793A",draggable:!1})}}});_.Module.define({path:"tbmall/widget/tshow_out_date_warn",requires:["common/widget/JoinVipDialog"],sub:{initial:function(t){var o=this;this.joinVipDialog=this.use("common/widget/JoinVipDialog"),setTimeout(function(){t.show_pre?o.buildPreHtml.call(o):t.show_suf&&o.buildSufHtml.call(o)},3e3)},buildPreHtml:function(){var t=this,o=$("#tshow_out_date_warn_pre_html").html(),e={html:o,title:"\u63D0\u9192",draggable:!1,width:601};this._dialog=new $.dialog(e),$.cookie("tshow_out_hide",1,{expires:1}),this._dialog.onclose(function(){$.cookie("tshow_out_hide",1,{expires:1})}),this._dialog.element.on("click",".j_join_vip",function(o){o.preventDefault(),t.joinVipDialog.getMemberDialog(),t._dialog.close()})},buildSufHtml:function(){var t=this,o=$("#tshow_out_date_warn_suf_html").html(),e=$("#com_userbar"),i=$("#com_userbar_message"),s=parseInt(e.css("top")),a=parseInt(i.css("top"));$(o).css("height",0).prependTo("body").animate({height:100},500,"swing",function(){$(window).trigger("resize")}),$.cookie("tshow_out_hide",1,{expires:1}),e.parent().hasClass("search_form")?e.parent().hasClass("core_title")&&(e.css({top:6}),i.animate({top:125},500)):(e.animate({top:100+s},500),i.animate({top:125},500)),$(window).on("scroll",function(){$.cookie("tshow_out_hide")||(setTimeout(function(){e.parent().hasClass("search_form")?e.css({top:s}):e.parent().hasClass("core_title")?e.css({top:6}):e.css({top:100+s})},2),setTimeout(function(){i.hasClass("ui_bubble_wrap_fixed")||i.css({top:125})},10))}),$("#tshow_out_date_warn_close_btn").click(function(){$("#tshow_out_date_warn").animate({height:0},500,"swing",function(){$("#tshow_out_date_warn").remove(),$(window).trigger("resize")}),e.animate({top:s},500),i.animate({top:a},500),$.cookie("tshow_out_hide",1,{expires:1})}),$("#tshow_out_date_warn_btn").click(function(){t.joinVipDialog.getMemberDialog(),$("#tshow_out_date_warn").animate({height:0},500,"swing",function(){$("#tshow_out_date_warn").remove(),$(window).trigger("resize")}),e.animate({top:s},500),i.animate({top:a},500),$.cookie("tshow_out_hide",1,{expires:1})})}}});_.Module.define({path:"tbmall/widget/ticketWarning",requires:[],sub:{_dialog:[],_tpl:['<div class="ticket_video_main clearfix">','<div class="ticket_video_pic"><img src="',"<%=image_url%>",'" width="170" height="95"/></div>','<div class="ticket_video_intro">',"<h4>Hi, <%=user_name%></h4>","<p>\u60A8\u8D2D\u4E70\u7684<%=ticket_name%>\u5C06\u4E8E<span><%=end_time%></span> \u5F00\u59CB\u6F14\u51FA\u3002</p>","<p>\u8BB0\u5F97\u5230\u65F6\u89C2\u770B\u54E6~</p>","</div>","</div>",'<div class="ticket_video_operate">','<a href="#" class="ticket_video_btn ticket_video_ok_btn j_ticket_video_ok_btn">\u6211\u77E5\u9053\u4E86</a>','<a href="<%=link_url%>" target="_blank" class="ticket_video_btn ticket_video_go_btn j_ticket_video_go_btn">\u5148\u53BB\u770B\u770B</a>',"</div>"].join(""),i:0,initial:function(t){var i=this;if(t){var e=[];for(var _ in t)e.push({live_id:_,id:t[_].id});$.post("/starshow/browse/ticket/getTicketList",{ticket_id:e},function(e){var _=e.data;for(var a in _)_[a][0].end_time_str=t[a].end_time_str,i.showPop(_[a][0])},"json")}},showPop:function(t){var i=this,e=1e3*t.show_time,_=$.tb.Storage.get("ticket_seed_"+t.ticket_name),a=$.tb.Storage.get("ticket_close_"+t.ticket_name);_>=e||a||1*new Date<e-864e5||1*new Date>e||setTimeout(function(){i.initDialog(t),i.bindEvents()},2e3*this.i++)},initDialog:function(t){var i={user_name:PageData.user.user_name,ticket_name:t.ticket_name,end_time:t.end_time_str,link_url:"http://tieba.baidu.com/"+t.forum_name,image_url:t.image_url},e=baidu.template(this._tpl,i);this._dialog.push(new $.dialog({html:e,title:i.ticket_name+"\u5F00\u6F14\u63D0\u9192",width:520,height:260})),this._dialog[this._dialog.length-1].onclose(function(){$.tb.Storage.set("ticket_seed_"+t.ticket_name,t.end_time)}),$(this._dialog[this._dialog.length-1].element).tbattr("data-tname",t.ticket_name)},bindEvents:function(){var t=this,i=$(this._dialog[this._dialog.length-1].element);i.on("click",".j_ticket_video_ok_btn",function(e){e.preventDefault(),t._dialog[t._dialog.length-1].close(),t._dialog=t._dialog.slice(0,-1);var _=i.tbattr("data-tname");$.tb.Storage.set("ticket_close_"+_,1)}).on("click",".j_ticket_video_go_btn",function(){t._dialog[t._dialog.length-1].close(),t._dialog=t._dialog.slice(0,-1)})}}});_.Module.define({path:"comforum/widget/GamePopWindow",sub:{nextDay:new Date((new Date).getTime()+864e5-1e3*(60*(new Date).getHours()*60+60*(new Date).getMinutes()+(new Date).getSeconds())),nextTenMinutes:new Date((new Date).getTime()+6e5),nextHalfHour:new Date((new Date).getTime()+18e5),tmp:['<div id="game_pop_window">','<div class="pop_head">','<a class="pop_head_close" href="#" onclick="return false;"></a>',"</div>",'<div class="pop_body">','<div class="game_info">','<a class="game_image" href="#{game_link}" target="_blank">','<img src="#{game_image}" />',"</a>",'<p class="game_name">','<a href="#{game_link}" target="_blank">#{game_name}</a>',"</p>",'<div class="game_hot clearfix">#{game_hot}</div>',"</div>",'<div class="game_reco">','<div class="game_icon"></div>','<p class="game_reco_info">#{game_reco_info}</p>',"</div>",'<a class="game_btn" href="#{game_link}" target="_blank"></a>','<p class="game_desc clearfix">',"<span>#{game_desc_text}</span>",'<a href="#{game_desc_link}" target="_blank">\u8BE6\u60C5\u4ECB\u7ECD</a>',"</p>","</div>","</div>"].join(""),initial:function(){this.hanldeBaiduId(),this.hanldeUserId();var e=this.initPopFromStorageOrLimitShow();e?this.checkLimitShow()&&this.loadBaiduYouxiScript():this.initPopFromAjax()},hanldeBaiduId:function(){var e=$.tb.Storage.get("game_pop_baidu_id"),t=$.cookie("BAIDUID");e!=t&&($.tb.Storage.remove("game_pop_window_data_storage"),$.tb.Storage.remove("game_pop_window_limit_show"),$.tb.Storage.set("game_pop_baidu_id",t,this.nextDay))},hanldeUserId:function(){var e=parseInt($.tb.Storage.get("game_pop_user_id"))||0,t=parseInt($.getPageData("user.user_id"))||0;e!=t&&($.tb.Storage.remove("game_pop_window_data_storage"),$.tb.Storage.remove("game_pop_window_limit_show"),$.tb.Storage.set("game_pop_user_id",t,this.nextDay))},initPopFromStorageOrLimitShow:function(){var e=this.loadPopWindowDataFromStorage();return e?(this.initWindow(e),!0):this.checkLimitShow()?!0:!1},initPopFromAjax:function(){var e=this;$.getJSON("/gamepopup/getPopup?timestamp="+(new Date).getTime()).done(function(t){var a=t.data;return!a||$.isEmptyObject(a)?(e.setLimitShow(),e.loadBaiduYouxiScript(),void 0):(a={game_name:a.name,game_image:a.icon,game_link:a.link,game_desc:a.desc,game_desc_link:a.desc_link,game_hot:a.hot,pop_type:2,start_time:a.start_time,end_time:a.end_time,damn_friends:a.damn_friends,task_name:a.task_name||"",taks_id:a.id||0},e.initWindow(a),e.storePopWindowData(),void 0)})},loadBaiduYouxiScript:function(){return},initWindow:function(e){return e||$.isEmptyObject(e)?(this.data=e,this.game_name=this.data.game_name,this.task_name=this.data.task_name,this.task_id=this.data.taks_id||0,this.popWindow=null,this.buildTmp(this.data),this.bindEvents(this.data),this.runStrategy(this.data),void 0):!1},checkToShow:function(e){var t=parseInt((new Date).getTime()/1e3);return e.start_time&&e.end_time&&e.start_time<t&&e.end_time>t},checkLimitShow:function(){var e=$.tb.Storage.get("game_pop_window_limit_show");return e?!0:!1},setLimitShow:function(e){e=e||this.nextHalfHour,$.tb.Storage.set("game_pop_window_limit_show",1,e)},storePopWindowData:function(){$.tb.Storage.set("game_pop_window_data_storage",$.json.encode(this.data),this.nextDay)},clearPopWindowData:function(){$.tb.Storage.remove("game_pop_window_data_storage")},notPopWindowUntilNextDay:function(){this.clearPopWindowData(),this.setLimitShow(this.nextDay),$.tb.Storage.set("game_pop_window_not_load_baiduyouxi",1,this.nextDay)},loadPopWindowDataFromStorage:function(){var e=$.tb.Storage.get("game_pop_window_data_storage");try{e=$.json.parseJSON(e)}catch(t){return!1}return e},sendPopupAction:function(e){var t="/gamepopup/setPopup",a={task_id:this.data.id||-1,game_name:this.data.game_name,action:e};$.post(t,a)},bindEvents:function(e){{var t=this;1==e.pop_type?"\u5427\u63A8\u8350\u5F39\u7A97":"\u7528\u6237\u63A8\u8350\u5F39\u7A97","frs"==PageData.product?"frs\u9875_":"pb\u9875_"}$("#game_pop_window").on("click",".pop_head_close",function(){t.sendPopupAction("close"),t.notPopWindowUntilNextDay(),t.postTrack("\u5173\u95ED\u5F39\u7A97"),t.hidePop(),t.clearStrategy()}).on("click",".game_name a",function(){t.sendPopupAction("play"),t.notPopWindowUntilNextDay(),t.postTrack("\u8FDB\u5165\u6E38\u620F","\u6E38\u620F\u540D\u79F0"),t.hidePop(),t.clearStrategy()}).on("click",".game_image",function(){t.sendPopupAction("play"),t.notPopWindowUntilNextDay(),t.postTrack("\u8FDB\u5165\u6E38\u620F","\u6E38\u620F\u56FE\u6807"),t.hidePop(),t.clearStrategy()}).on("click",".game_btn",function(){t.sendPopupAction("play"),t.notPopWindowUntilNextDay(),t.postTrack("\u8FDB\u5165\u6E38\u620F","\u6E38\u620F\u6309\u94AE"),t.hidePop(),t.clearStrategy()}).on("click",".game_desc a",function(){t.sendPopupAction("view"),t.postTrack("\u8BE6\u60C5\u4ECB\u7ECD","\u6E38\u620F\u6309\u94AE")}).on("click",".forum_title",function(){t.postTrack("\u63A8\u8350\u5427\u70B9\u51FB",$(this).getData().forum_name)}).on("click",".user_link",function(){t.postTrack("\u63A8\u8350\u7528\u6237\u70B9\u51FB",$(this).getData().user_name)})},postTrack:function(e,t,a){var i="frs"==PageData.product?"frs\u9875_":"pb\u9875_",o=1==this.data.pop_type?"\u5427\u63A8\u8350\u5F39\u7A97":"\u7528\u6237\u63A8\u8350\u5F39\u7A97";"undefined"==typeof a&&(a="click");var n={obj_type:"\u6E38\u620F",obj_subtype:o,obj_game:this.game_name,obj_uid:$.cookie("BAIDUID"),obj_url:this.task_name,obj_task_id:this.task_id};t&&(n.obj_name=t),$.stats.track(i+"\u5F39\u7A97_"+e,"\u4E2A\u6027\u5316\u5F39\u7A97\u5B9E\u9A8C","",a,n)},buildTmp:function(e){var t="",a={game_name:$.tb.subByte(e.game_name,16),game_image:e.game_image,game_link:e.game_link,game_hot:this.buildGameHot(e),game_reco_info:this.buildGameRecoInfo(e),game_desc_text:$.tb.subByte(e.game_desc,44),game_desc_link:e.game_desc_link};t=$.tb.format(this.tmp,a),this.popWindow=$(t).appendTo("body")},runStrategy:function(e){var t=$.cookie("game_pop_window");if(t=3,!t||0>t||t>3)this.resetStrategy(),this.stepStrategy();else if(3==t)this.showPop(e),this.resetStrategy();else{if(0==t)return;this.stepStrategy()}},resetStrategy:function(){$.cookie("game_pop_window",1,{expires:this.nextDay})},stepStrategy:function(){var e=$.cookie("game_pop_window");$.cookie("game_pop_window",++e,{expires:this.nextDay})},clearStrategy:function(){$.cookie("game_pop_window",0,{expires:this.nextDay})},showPop:function(e){var t=this,a=(1==e.pop_type?"\u5427\u63A8\u8350\u5F39\u7A97":"\u7528\u6237\u63A8\u8350\u5F39\u7A97","frs"==PageData.product?"frs\u9875_":"pb\u9875_",setTimeout(function(){t.popWindow.show().css("bottom","-280px").animate({bottom:0},500),clearTimeout(a),a=null},2e3)),i=setTimeout(function(){t.hidePop(),clearTimeout(i),i=null},15e3);t.postTrack("\u5C55\u73B0","","view")},hidePop:function(){this.popWindow.animate({bottom:"-280px"},500,function(){$(this).hide()})},buildGameHot:function(e){var t=0,a="",i=parseInt(e.game_hot)||0,o=i>9?9:i;for(t;o>t;++t)t%2!=1&&(a+='<span class="full"></span>');for(t%2==0&&(a+='<span class="half"></span>'),t;10>t;++t)t%2!=1&&(a+='<span class="empty"></span>');return a+='<span class="score">'+e.game_hot+"</span>"},buildGameRecoInfo:function(e){var t,a="";if(1==e.pop_type){var i=$.tb.dataField({forum_name:e.forum_name});a+='<a class="forum_title" href="/f?kw='+e.forum_name+'&ie=utf8" '+i+' target="_blank" >'+$.tb.subByte(e.forum_name,12)+"\u5427</a>\u91CC\u5DF2\u7ECF\u6709<span>"+e.user_num+"</span>\u4F4D\u8D34\u5427\u5C0F\u4F19\u4F34\u5728\u73A9\u8FD9\u6B3E\u6E38\u620F\uFF0C\u9A6C\u4E0A\u52A0\u5165\u5230\u4ED6\u4EEC\u7684\u884C\u5217\uFF01"}else if(2==e.pop_type)if(e.damn_friends)a+=e.damn_friends;else if("\u571F\u8C6A\u8DB3\u7403"==e.game_name)a+="\u5DF4\u897F\u4E16\u754C\u676F\u6FC0\u60C5\u5F00\u6218\uFF0C\u8D34\u5427\u4E3A\u4F60\u5F00\u542F\u4E13\u4EAB\u7684\u4E16\u754C\u676F\uFF01";else if("2014\u5DF4\u897F\u4E16\u754C\u676F"==e.game_name)a+="\u6851\u5DF4\u8363\u8000\uFF0C\u8C01\u80FD\u95EE\u9F0E\u4E16\u754C\u5DC5\u5CF0\uFF1F\u8D34\u5427\u9080\u4F60\u4E00\u8D77\u5F81\u6218\uFF01";else{for(t=0;t<e.user_info.length&&!(t>3);++t){var o=$.tb.dataField({user_name:e.user_info[t]});a+='<a class="user_link" href="/home/main/?ie=utf8&un='+e.user_info[t]+'"'+o+' target="_blank" >'+$.tb.subByte(e.user_info[t],12)+"</a>\u3001"}a=a.slice(0,a.length-1),a+="\u7B49\u591A\u4F4D\u8D34\u5427\u5C0F\u4F19\u4F34\u5728\u73A9\u8FD9\u6B3E\u6E38\u620F\uFF0C\u9A6C\u4E0A\u8DDF\u4ED6\u4EEC\u4E00\u8D77\u73A9\uFF01"}return a}}});_.Module.define({path:"common/widget/advertiseRight",requires:[],sub:{initial:function(){var e=$.tb.Storage.get("oldtime"),t=(new Date).getTime();t-e>864e5&&$(".advertise_right_index").css("display","block"),this.bindEvents()},bindEvents:function(){$(".adv_close_button").click(function(){$(".advertise_right_index").css("display","none"),$.tb.Storage.set("oldtime",1*new Date)})}}});_.Module.define({path:"encourage/widget/firework",requires:["encourage/widget/firework/fireworkTemplate","tbmall/widget/TbeanSafeAjax"],sub:{$btn:$(".j_firework_sender"),fireworkUnits:{},dialog:null,_buyFireworkUrl:"/tbmall/submit/giftpkg/buyGiftPkg",_getFireworkUrl:"/tbmall/submit/giftpkg/getBonus",_likeForumUrl:"/f/like/commit/add",_likeUserUrl:"/home/post/follow",_productType:"frs"===PageData.product?0:1,_productId:"frs"===PageData.product?PageData.forum.forum_id:PageData.thread.thread_id,scores:PageData.user.Parr_scores&&PageData.user.Parr_scores.scores_total,FIREWORK_PRICE:99e3,FIREWORK_TYPE_99:0,FIREWORK_UNIT_COUNT:8,ERROR_TIP_MAP:{220012:"\u68C0\u6D4B\u5230\u60A8\u8D26\u53F7\u5DF2\u88AB\u5C01\u7981\uFF0C\u8BF7\u89E3\u7981\u540E\u91CD\u8BD5",220034:"\u60A8\u62A2\u5F97\u592A\u9891\u7E41\u5566\uFF0C\u8FD9\u6B21\u5C31\u8BA9\u4E00\u8BA9\u5176\u4ED6\u5C0F\u4F19\u4F34\u5427",2270055:"T\u8C46\u5DF2\u88AB\u62A2\u5149\uFF0C\u4E0B\u6B21\u8981\u773C\u75BE\u624B\u5FEB\u54E6",2270056:"\u6BCF\u4E2A\u70DF\u82B1\u53EA\u80FD\u6361\u4E00\u6B21\u54E6\uFF0C\u53BB\u6C42\u571F\u8C6A\u7EE7\u7EED\u53D1\u5427",2270057:"T\u8C46\u5DF2\u88AB\u62A2\u5149\uFF0C\u4E0B\u6B21\u8981\u773C\u75BE\u624B\u5FEB\u54E6",2270058:"\u5C0F\u4F19\u4F34\u592A\u591A\u6211\u6491\u4E0D\u4F4F\u5566\uFF0C\u5F85\u4F1A\u518D\u6765\u561B",9999990:"\u5173\u6CE8\u6210\u529F"},waitToPlayList:[],isPlayingSwf:!1,initial:function(e){this.tpl=this.requireInstance("encourage/widget/firework/fireworkTemplate"),this.banner_link=PageUnit.load("firework_banner_link"),this.banner_src=PageUnit.load("firework_banner_src"),this.button_link=PageUnit.load("firework_button_link"),this.button_txt=PageUnit.load("firework_button_txt"),this.firework_link=PageUnit.load("firework_firework_link"),this.skinConfig=e.skinConfig,this.renderPreFireworks(e.fireworks),this.bindEvents()},renderPreFireworks:function(e){if($.isArray(e))for(var i=0,t=e.length;t>i;i++){var o=this.fireworkManager(e[i].package_id);o?1==o&&this.renderFirework(e[i]):this.showFireworkSwf(e[i])}},bindEvents:function(){var e=this,i=$("body");this.observe("play.firework",function(i,t){t.location_type==e._productType&&t.location_id==e._productId&&e.showFireworkSwf(t)}),this.observe("buy.firework",function(){e.buyFirework()}),this.$btn.on("click",function(){return PageData.user.is_login?e.showFireworkDialog():e.requireInstanceAsync("common/widget/LoginDialog"),!1}).on("mouseover",function(){$(this).css("backgroundPosition","0 -50px")}).on("mouseout",function(){$(this).css("backgroundPosition","0 0")}),i.on("click",".j_firework_unit",function(){var i=$(this).tbattr("data-firework-id");PageData.user.is_login||e.requireInstanceAsync("common/widget/LoginDialog");var t=function(o){$.tb.post(e._getFireworkUrl,$.extend({package_id:i,forum_name:PageData.forum.forum_name,tbs:PageData.tbs,location_id:e._productId,location_type:e._productType,forum_id:PageData.forum.forum_id},o),function(o){if(0==o.no&&o.data.scores>0)e.removeFirework(i),e.showTdouTip(o);else switch(o.no){case 11e4:e.requireInstanceAsync("common/widget/LoginDialog");break;case 220040:e.requireInstanceAsync("common/component/CaptchaDialog",{message:o.data.str_reason,vCode:o.data.captcha_vcode_str,vCodeType:o.data.captcha_code_type,title:"\u83B7\u53D6\u70DF\u82B1\u9A8C\u8BC1\u7801",checkUrl:"/tbmall/submit/giftpkg/checkVcode",vCodeUrl:"/tbmall/submit/giftpkg/getVcode",paramsCallback:function(){return{tbs:PageData.tbs||PageData.user.tbs}}},function(e){e.bind("onclose",function(){e.hide()}),e.bind("onaccept",function(){var i={captcha_input_str:e.getInputValue(),captcha_vcode_str:e.getVCode()};t(i)})});break;default:e.showTdouTip(o),e.removeFirework(i)}},"json")};t()})},showTdouTip:function(e){var i=e.data||{ulike:1,flike:1},t=e.no,o=this.ERROR_TIP_MAP[t]||"\u670D\u52A1\u5668\u62BD\u98CE\u4E86",r=this,n=i.scores,a=i.ulike&&i.flike,s="\u5173 \u95ED",l=this.button_txt,c=$.tb.format(this.tpl.getTdouTipBannerTpl(),{banner_link:this.banner_link,banner_src:this.banner_src});switch(a||(l="\u4E00\u952E\u5173\u6CE8",s="\u6B8B\u5FCD\u62D2\u7EDD",c=this.tpl.getTdouTipAttentionBannerTpl()),String(t)){case"0":o='\u606D\u559C\u4F60\u6361\u5230<span class="got_tdou">'+i.uname+'</span>\u6492\u843D\u7684<span class="got_tdou">'+n+"</span>T\u8C46";break;case"2270055":o="\u624B\u6162\u4E86\uFF0C<span class='got_tdou'>"+i.uname+"</span>\u6492\u843D\u7684T\u8C46\u5DF2\u88AB\u62A2\u5149"}var u=new $.dialog({html:$.tb.format(this.tpl.getTdouTipTpl(),{text:o,username:i.uname,score:n,banner:c,button_link:this.button_link,button_txt:l,close_txt:s}),width:420,noTitle:!0});u.element.find(".j_close_btn").one("click",function(){return u.close(),!1}),a||u.element.find(".j_firework_attention_btn").one("click",function(e){e.preventDefault(),r.likeForumAndUser(i.uname),u.close()})},showFireworkDialog:function(){var e=this;this.dialog=new $.dialog({holderClassName:"firework_buy_dialog",title:e.skinConfig.title,width:e.skinConfig.width,height:e.skinConfig.height,closeable:!1,html:$.tb.format(e.tpl.getDialogTpl(),{firework_link:this.firework_link,preview_style:PageUnit.load("firework_preview_style"),buy_style:PageUnit.load("firework_buy_style"),close_style:PageUnit.load("firework_close_style"),table_style:PageUnit.load("firework_table_style"),extra:PageUnit.load("firework_extra")})}),this.dialog.element.css("background","url("+PageUnit.load("firework_dialog_bg")+") no-repeat");var i=this.dialog.element.find(".j_preview_btn"),t=this.dialog.element.find(".j_buy_btn"),o=this.dialog.element.find(".j_close_btn"),r=i.height(),n=t.height(),a=o.height();i.one("click",function(){return e.dialog.close(),e.showFireworkSwf({user_name:PageData.user.user_name,preview:!0}),e.fire("firework.global_preview"),!1}).on("mouseover",function(){$(this).css("backgroundPosition","0 -"+r+"px")}).on("mouseout",function(){$(this).css("backgroundPosition","0 0")}),t.one("click",function(){return e.dialog.close(),e.scores<e.FIREWORK_PRICE?e.requireInstanceAsync("common/widget/tcharge_dialog"):e.buyFirework(),!1}).on("mouseover",function(){$(this).css("backgroundPosition","0 -"+n+"px")}).on("mouseout",function(){$(this).css("backgroundPosition","0 0")}),o.one("click",function(){return e.dialog.close(),!1}).on("mouseover",function(){$(this).css("backgroundPosition","0 -"+a+"px")}).on("mouseout",function(){$(this).css("backgroundPosition","0 0")}),e.renderRank(this.dialog.element)},buyFirework:function(){var e=this,i=this.requireInstance("tbmall/widget/TbeanSafeAjax");i.post(e._buyFireworkUrl,{location_id:e._productId,location_type:e._productType,gift_pkg_type:e.FIREWORK_TYPE_99,tbs:PageData.tbs,forum_name:PageData.forum.forum_name,forum_id:PageData.forum.forum_id,ie:"utf8"},function(i){0==i.no?(e.fire("firework.global_notice",$.extend({},i.data,{forum_name:PageData.forum.forum_name,location_id:e._productId,location_type:e._productType,scores:5e4,user_name:PageData.user.user_name,portrait:PageData.user.portrait,msg_type:1e4})),e.showFireworkSwf(i.data)):2270005==i.no&&e.requireInstanceAsync("common/widget/tcharge_dialog")},"json")},renderFirework:function(e){function i(e,i){return Math.random()*(i-e)+e}var t,o,r=$(),n=+new Date,a=e.package_id,s=e.end_time,l=this;if(!(a&&this.fireworkManager(a)>1||this.fireworkUnits[a]||n/1e3>s)){for(var c=0,u=this.FIREWORK_UNIT_COUNT;u>c;c++)t=$('<div class="firework_unit j_firework_unit" data-firework-id="'+a+'">'),t.css({marginTop:i(-200,200),marginLeft:i(-300,300)}),r=r.add(t);$("body").append(r),o=setTimeout(function(){l.removeFirework(a)},1e3*s-n),this.fireworkUnits[a]={},this.fireworkUnits[a].elements=r,this.fireworkUnits[a].timeout_id=o}},removeFirework:function(e){this.fireworkUnits[e]&&(this.fireworkUnits[e].elements.remove(),clearTimeout(this.fireworkUnits[e].timeout_id),delete this.fireworkUnits[e],this.fireworkManager(e,2))},fireworkManager:function(e,i){var t=$.parseJSON($.tb.Storage.get("fireworks"));if(t||(t=[]),"undefined"==typeof i){var o=null;return $.each(t,function(i,t){return t.pid==e?(o=t.v,!1):void 0}),o}var r=!1;$.each(t,function(t,o){return o.pid==e?(o.v=i,r=!0,!1):void 0}),r||(t.length>200&&(t=t.slice(-200)),t.push({pid:e,v:i})),$.tb.Storage.set("fireworks",$.json.encode(t),+new Date+31536e6)},closeFlash:function(){$("#firework_swf_ctn").remove(),this.flash=null,this.isPlayingSwf=!1},showFireworkSwf:function(e){var i=this,t=e.end_time,o=+new Date;if(!(e.package_id&&this.fireworkManager(e.package_id)>0||o/1e3>t))if(this.isPlayingSwf)i.waitToPlayList.push(e);else{this.isPlayingSwf=!0;var r=$('<div id="firework_swf_ctn" class="firework_swf_ctn"></div>');$("body").append(r),e.package_id&&this.fireworkManager(e.package_id,1);var n=PageUnit.load("firework_swf");this.flash=new $.swf(n,{id:"firework",container:"#firework_swf_ctn",width:980,height:470,vars:{user_name:e.user_name+"\u653E\u7684"+i.skinConfig.item},callBacks:{closeFlash:_.throttle(function(){if(i.closeFlash(),e.preview)i.showFireworkDialog(),i.fire("firework.global_preview_close");else{i.renderFirework(e);var t=i.waitToPlayList.shift();t&&i.showFireworkSwf(t)}},3e3)}})}},renderRank:function(e){var i=this;$.get("/minigame/rank/getRank",{t:(new Date).getTime()},function(t){if(t="object"==typeof t?t:$.parseJSON(t),0==t.no){var o=t.data.fireworks,r=i.tpl.getFireworkRankTpl(),n=baidu.template(r,{rank:o});e.find(".j_firework_rank_body").html(n)}})},likeForumAndUser:function(e){var i=this,t=PageData.tbs,o=PageData.forum.forum_id,r=PageData.forum.forum_name,n=$.tb.post(this._likeForumUrl,{fid:o,fname:r,tbs:t}),a=$.tb.post(this._likeUserUrl,{un:e,tbs:t});$.when(n,a).then(function(){i.showTdouTip({no:"9999990",data:{ulike:1,flike:1}})})}}});
;_.Module.define({path:"encourage/widget/firework/fireworkTemplate",sub:{_dialogTpl:{general:['<a href="#" class="btn_preview j_preview_btn" style="#{preview_style}"></a>','<a href="#" class="btn_buy j_buy_btn" style="#{buy_style}"></a>','<a href="#" class="btn_close j_close_btn" style="#{close_style}"></a>',"#{extra}",'<div class="firework_rank_body j_firework_rank_body" style="#{table_style}"></div>'].join("")},_buyDialogTpl:["<div>","\u6B63\u5728\u8D2D\u4E70","</div>"].join(""),_tdouTipResultTpl:['\u606D\u559C\u4F60\u6361\u5230<span class="got_tdou">#{username}</span>\u6492\u843D\u7684<span class="got_tdou">#{score}</span>T\u8C46'],_tdouTipTpl:['<div class="get_tdou_tip">','<p class="result">#{text}</p>',"#{banner}",'<div class="btn_wrap">','<a href="#{button_link}" locate="\u70DF\u82B1\u5E7F\u544A\u6309\u94AE#\u653E\u70DF\u82B1\u7EDF\u8BA1" target="_blank" class="ui_btn ui_btn_m button_link j_firework_attention_btn">',"<span><em>#{button_txt}</em></span>","</a>",'<a href="#" class="ui_btn ui_btn_sub_m j_close_btn">',"<span><em>#{close_txt}</em></span>","</a>","</div>","</div>"].join(""),_tdouTipBannerTpl:['<a href="#{banner_link}" locate="\u70DF\u82B1\u5E7F\u544A\u56FE#\u653E\u70DF\u82B1\u7EDF\u8BA1" target="_blank" class="banner_link">','<img src="#{banner_src}" />',"</a>"].join(""),_tdouTipAttentionBannerTpl:['<p class="firework_attention_tip">\u5173\u6CE8\u672C\u5427\u548C\u6492\u94B1\u5927\u58D5\uFF0C\u4F1A\u66F4\u5BB9\u6613\u62A2\u5230\u8C46\u5B50\u54E6</p>'].join(""),_tdouErrorTipTpl:['<div class="get_tdou_tip">','<p class="result">#{text}</p>',"#{banner}",'<div class="btn_wrap">','<a href="#{button_link}" locate="\u70DF\u82B1\u5E7F\u544A\u6309\u94AE#\u653E\u70DF\u82B1\u7EDF\u8BA1" target="_blank" class="ui_btn ui_btn_m button_link j_firework_attention_btn">',"<span><em>#{button_txt}</em></span>","</a>",'<a href="#" class="ui_btn ui_btn_m j_close_btn">',"<span><em>#{close_txt}</em></span>","</a>","</div>","</div>"].join(""),_fireworkRankTpl:["<table>",'<tr><td width="40">&nbsp;</td><td width="120">&nbsp;</td><td width="30">&nbsp;</td></tr>',"<% for (var i = 0, len = rank.length; i < len; i++) { %>","<tr>","<td><%=i + 1%></td>","<td>",'<a data-field="<%=$.json.encode({un: rank[i][\'user_name\']})%>" href="/home/main?id=<%=rank[i][\'portrait\']%>" target="_blank"><span><%=rank[i]["user_name"]%></span></a>',"</td>",'<td align="center"><%=rank[i]["win"]%></td>',"</tr>","<% } %>","</table>"].join(""),initial:function(){},getDialogTpl:function(){return this._dialogTpl.general},getBuyDialogTpl:function(){return this._buyDialogTpl},getTdouTipTpl:function(){return this._tdouTipTpl},getTdouTipBannerTpl:function(){return this._tdouTipBannerTpl},getTdouTipAttentionBannerTpl:function(){return this._tdouTipAttentionBannerTpl},getTdouErrorTipTpl:function(){return this._tdouErrorTipTpl},getFireworkRankTpl:function(){return this._fireworkRankTpl}}});